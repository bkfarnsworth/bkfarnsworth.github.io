(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{1222:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var PIXELS_PER_INCH,reportRenderer,regenerator=__webpack_require__(18),regenerator_default=__webpack_require__.n(regenerator),asyncToGenerator=__webpack_require__(24),taggedTemplateLiteral=__webpack_require__(64),assertThisInitialized=__webpack_require__(29),esm_get=__webpack_require__(36),classCallCheck=__webpack_require__(19),createClass=__webpack_require__(17),possibleConstructorReturn=__webpack_require__(22),getPrototypeOf=__webpack_require__(15),inherits=__webpack_require__(21),react=__webpack_require__(1),react_default=__webpack_require__.n(react),bundle_module=__webpack_require__(0),build_bundle_module=__webpack_require__(5),ui_build_bundle_module=__webpack_require__(23),ui_core_build_bundle_module=__webpack_require__(3),react_drag_drop_build_bundle_module=__webpack_require__(28),l10nify_build_bundle_module=__webpack_require__(2),react_essence_build_bundle_module=__webpack_require__(27),withRouter=__webpack_require__(704),dom_util_build_bundle_module=__webpack_require__(26),toConsumableArray=__webpack_require__(76);function doLoad(_x,_x2){return _doLoad.apply(this,arguments)}function _doLoad(){return(_doLoad=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(project,app){var errors;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(0!==(errors=project.currentWorkspace.getLoadingErrors()).length){_context.next=11;break}return _context.prev=2,_context.next=5,ReportRenderer_render(project);case 5:return _context.abrupt("return");case 8:_context.prev=8,_context.t0=_context.catch(2),errors.push(_context.t0);case 11:app.newRelic.noticeError(errors,{errorType:"REPORT_RENDERER"}),reportRenderer.logError(errors);case 13:case"end":return _context.stop()}},_callee,null,[[2,8]])}))).apply(this,arguments)}function wait(_x3){return _wait.apply(this,arguments)}function _wait(){return(_wait=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee2(ms){return regenerator_default.a.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return",new Promise(function(resolve,reject){setTimeout(resolve,ms)}));case 1:case"end":return _context2.stop()}},_callee2)}))).apply(this,arguments)}function ReportRenderer_render(_x4){return workspace_ReportRenderer_render.apply(this,arguments)}function workspace_ReportRenderer_render(){return(workspace_ReportRenderer_render=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee3(project){var renderTypes,renderInfo,csvData;return regenerator_default.a.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return reportRenderer.progress(reportRenderer.RENDER_CALLED||"RENDER_CALLED"),console.log("FULLY_RENDERED"),prepareForPrint(),reportRenderer.progress(reportRenderer.PREPARING_RENDER||"PREPARING_RENDER"),_context3.next=6,wait(1e3);case 6:return adjustWidthToFitContent(),Object(ui_build_bundle_module.mb)("script").remove(),Object(ui_build_bundle_module.mb)("svg.global-cv-pathing-defs").height(0),console.log("Adjusted Width. Waiting for AFTER_RESIZE_SETTLE_TIME_IN_MILLISECONDS:",reportRenderer.AFTER_RESIZE_SETTLE_TIME_IN_MILLISECONDS),_context3.next=12,wait(reportRenderer.AFTER_RESIZE_SETTLE_TIME_IN_MILLISECONDS);case 12:if(setPagePrintSize(),console.log("Completed the setPagePrintSize. Start create PDF..."),reportRenderer.progress(reportRenderer.READY_TO_RENDER||"READY_TO_RENDER"),renderTypes=reportRenderer.renderTypes.map(function(renderType){return renderType.toUpperCase()}),renderInfo=[],renderTypes.includes("PDF")&&renderInfo.push({type:"PDF"}),!renderTypes.includes("HTML")){_context3.next=24;break}return _context3.t0=renderInfo,_context3.next=22,renderHtml();case 22:_context3.t1=_context3.sent,_context3.t0.push.call(_context3.t0,_context3.t1);case 24:if(renderTypes.includes("CSV")&&(csvData=project.formatCSV(),renderInfo.push({type:"CSV",data:csvData})),!(renderInfo.length>0)){_context3.next=29;break}reportRenderer.finish(renderInfo),_context3.next=30;break;case 29:throw new Error("No known renderTypes provided.");case 30:console.log("Rendering step completed. Close this window to continue.");case 31:case"end":return _context3.stop()}},_callee3)}))).apply(this,arguments)}function prepareForPrint(){Object(ui_build_bundle_module.mb)("body").removeClass("coral-Shell"),Object(ui_build_bundle_module.mb)(".aw-report-content").css({margin:0,position:"relative",padding:"calc(0.25in - 10px)","padding-top":0,"box-sizing":"border-box",width:"9.5in",overflow:"hidden"})}function setPagePrintSize(){var size=getPageSize(),contentHeight=size.height+1.2*size.dpi,contentWidth=size.width/size.dpi,pageHeight=Math.min(199,contentHeight/size.dpi);console.log("setPagePrintSize HEIGHT in pixels:",size.height),console.log("setPagePrintSize HEIGHT in inches:",contentHeight/size.dpi);var style=["<style>","@page {","\tsize: "+contentWidth+"in "+pageHeight+"in;\n","\tmargin: 0;\n","  padding: 0;\n","\tbackground: #FFF;\n","}","</style>"].join("\n");Object(ui_build_bundle_module.mb)(style).appendTo(Object(ui_build_bundle_module.mb)("head"))}function renderHtml(){return _renderHtml.apply(this,arguments)}function _renderHtml(){return(_renderHtml=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee4(){return regenerator_default.a.wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return Object(ui_build_bundle_module.mb)("canvas").each(function(){var $this=Object(ui_build_bundle_module.mb)(this),embeddedImage=new Image,$embeddedImage=Object(ui_build_bundle_module.mb)(embeddedImage);embeddedImage.src=this.toDataURL(),$embeddedImage.attr("id",$this.attr("id")),$embeddedImage.attr("class",$this.attr("class")),$embeddedImage.attr("style",$this.attr("style")),$this.replaceWith(embeddedImage)}),_context4.next=3,Promise.all(Object(toConsumableArray.a)(document.querySelectorAll("link")).map(function(el){if(el.href&&el.href.startsWith("blob:http"))return replaceBlobUrlWithDataUrl(el)}));case 3:return _context4.next=5,Promise.all(Object(toConsumableArray.a)(document.querySelectorAll("link")).map(function(el){if(el.href&&el.href.includes("static/css/main.css"))return replaceMainCssWithInlineCss(el)}));case 5:return _context4.abrupt("return",{type:"HTML",size:getPageSize()});case 6:case"end":return _context4.stop()}},_callee4)}))).apply(this,arguments)}function replaceBlobUrlWithDataUrl(_x5){return _replaceBlobUrlWithDataUrl.apply(this,arguments)}function _replaceBlobUrlWithDataUrl(){return(_replaceBlobUrlWithDataUrl=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee5(el){var dataUrl;return regenerator_default.a.wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,fetchUrl(el.href,"readAsDataURL");case 2:dataUrl=_context5.sent,el.href=dataUrl;case 4:case"end":return _context5.stop()}},_callee5)}))).apply(this,arguments)}function replaceMainCssWithInlineCss(_x6){return _replaceMainCssWithInlineCss.apply(this,arguments)}function _replaceMainCssWithInlineCss(){return(_replaceMainCssWithInlineCss=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee6(el){var cssStr,styleNode;return regenerator_default.a.wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,fetchUrl(el.href,"readAsText");case 2:cssStr=_context6.sent,styleNode=document.createElement("style"),cssStr=cssStr.replace(new RegExp("../../static/","g"),window.aauiLoadBaseUrl+"static/"),styleNode.innerHTML=cssStr,styleNode.id="main-css",Object(ui_build_bundle_module.mb)(el).replaceWith(styleNode);case 8:case"end":return _context6.stop()}},_callee6)}))).apply(this,arguments)}function fetchUrl(_x7){return _fetchUrl.apply(this,arguments)}function _fetchUrl(){return(_fetchUrl=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee7(url){var readType,blob,_args7=arguments;return regenerator_default.a.wrap(function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return readType=_args7.length>1&&void 0!==_args7[1]?_args7[1]:"readAsDataURL",_context7.next=3,fetch(url).then(function(r){return r.blob()});case 3:return blob=_context7.sent,_context7.abrupt("return",new Promise(function(resolve,reject){var reader=new FileReader;reader.addEventListener("loadend",function(){resolve(reader.result)}),reader[readType](blob)}));case 5:case"end":return _context7.stop()}},_callee7)}))).apply(this,arguments)}function getPageSize(){return{width:getContentWidth(),height:Object(ui_build_bundle_module.mb)("body").outerHeight(),dpi:pixelsPerInch()}}function pixelsPerInch(){if(!PIXELS_PER_INCH){var div=Object(ui_build_bundle_module.mb)("<div/>").css({width:"1in",height:"1in"}).appendTo(Object(ui_build_bundle_module.mb)("body"));PIXELS_PER_INCH=div.width(),div.remove()}return PIXELS_PER_INCH}function adjustWidthToFitContent(){if(reportRenderer.reportSettings&&reportRenderer.reportSettings.widthInPixels)return setContentWidth(reportRenderer.reportSettings.widthInPixels),void document.body.dispatchEvent(new CustomEvent("content:resize"));var MAX_WIDTH=30*pixelsPerInch(),ratios=Object(ui_build_bundle_module.mb)("table").toArray().map(function(table){var actualWidth=Object(ui_build_bundle_module.mb)(table).outerWidth();return function(table){var measuringTable=Object(ui_build_bundle_module.mb)("<table>");(function(table){return Object(ui_build_bundle_module.mb)(table).find("tr").toArray().map(function(tr){return Object(ui_build_bundle_module.mb)(tr).find("td").toArray().map(function(td){return Object(ui_build_bundle_module.mb)(td).text().trim()})})})(table).forEach(function(row){var tr=Object(ui_build_bundle_module.mb)("<tr>").appendTo(measuringTable);row.forEach(function(col){var td=Object(ui_build_bundle_module.mb)('<td style="padding: 8px">').appendTo(tr);td.text(col)})}),measuringTable.appendTo(Object(ui_build_bundle_module.mb)("body"));var idealWidth=measuringTable.width();return measuringTable.remove(),idealWidth}(table)/actualWidth});Math.max.apply(Math,Object(toConsumableArray.a)(ratios))>1&&getContentWidth()<MAX_WIDTH?(setContentWidth(getContentWidth()+pixelsPerInch()),adjustWidthToFitContent()):document.body.dispatchEvent(new CustomEvent("content:resize"))}function getContentWidth(){return Object(ui_build_bundle_module.mb)(".aw-report-content").outerWidth()}function setContentWidth(width){Object(ui_build_bundle_module.mb)(".aw-report-content").width(width)}"undefined"!==typeof window&&window.adobeReportRenderer&&((reportRenderer=window.adobeReportRenderer).projectLoaded=function(project,app){"undefined"!==typeof window&&reportRenderer.progress(reportRenderer.SPA_VERSION||"SPA_VERSION",{spaVersion:window.analyticsuiBuildId||"localhost",spaBuildDate:window.analyticsuiPublishDate||"localhost",versions:{electron:reportRenderer.electronVersion,chrome:reportRenderer.chromeVersion},xserver:"none"});if(project.currentWorkspace.fullyLoaded)return void doLoad(project,app);project.currentWorkspace.on("change:fullyLoaded",function(){doLoad(project,app)})});var essence_build_bundle_module=__webpack_require__(7),ProjectComponent_ProjectComponent=function(_AppComponent){function ProjectComponent(props,context){var _this;return Object(classCallCheck.a)(this,ProjectComponent),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(ProjectComponent).call(this,props,context))).state={project:props.view.project},_this._onChangeProject=_this._onChangeProject.bind(Object(assertThisInitialized.a)(_this)),_this.state.project&&_this.updateProjectListeners(_this.state.project),_this}return Object(inherits.a)(ProjectComponent,_AppComponent),Object(createClass.a)(ProjectComponent,[{key:"componentWillReceiveProps",value:function(nextProps){this.props.view&&this.props.view.off("change:project",this._onChangeProject),nextProps.view&&nextProps.view.on("change:project",this._onChangeProject)}},{key:"componentWillMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(ProjectComponent.prototype),"componentWillMount",this).call(this),!this.state.project&&this.props.view.project&&(this.state.project=this.props.view.project,this.updateProjectListeners(this.state.project)),this.props.view.on("change:project",this._onChangeProject)}},{key:"componentWillUnmount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(ProjectComponent.prototype),"componentWillUnmount",this).call(this),this.props.view.off("change:project",this._onChangeProject)}},{key:"_onChangeProject",value:function(e){this.updateProjectListeners(e.newValue,e.oldValue),this.setState({project:e.newValue})}},{key:"updateProjectListeners",value:function(project,oldProject){bundle_module.q.forIn(this.projectListeners(),function(fn,key){oldProject&&oldProject!==project&&oldProject.off(key,fn),project&&project!==oldProject&&project.on(key,fn)})}},{key:"projectListeners",value:function(){return{undoRedoComplete:this._debouncedChangeHandler.bind(this)}}},{key:"project",get:function(){return this.state.project}}]),ProjectComponent}(ui_build_bundle_module.d);function _templateObject2(){var data=Object(taggedTemplateLiteral.a)(['Click "Show All Components" to view all components you have permission to access.']);return _templateObject2=function(){return data},data}function _templateObject(){var data=Object(taggedTemplateLiteral.a)(["A limited set of components is being displayed because curation has been applied."]);return _templateObject=function(){return data},data}var WorkspaceDraggableStack_DraggableStack=function(_ProjectComponent){function DraggableStack(props,context){var _this;return Object(classCallCheck.a)(this,DraggableStack),_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(DraggableStack).call(this,props,context)),Object.assign(_this.state,{filters:[],showAllComponentsClicked:!1}),_this._granularities=null,_this.selectedComponents=null,_this}return Object(inherits.a)(DraggableStack,_ProjectComponent),Object(createClass.a)(DraggableStack,null,[{key:"defaultProps",get:function(){return{project:null}}}]),Object(createClass.a)(DraggableStack,[{key:"cache",value:function(){return["segments","dimensions","combinedMetrics","dateRanges","tags","metricViews"]}},{key:"projectListeners",value:function(){var listeners={"change:definition.viewDensity":this.onViewDensityChange.bind(this),"change:isCurating":this.onProjectIsCuratingChange.bind(this),undoRedoComplete:this.onUndoRedoComplete.bind(this)};return build_bundle_module.db.isActive("dynamicSelection")&&(listeners["change:selectedItem"]=this.onProjectSelectionChange.bind(this)),listeners}},{key:"onViewDensityChange",value:function(){this.groupedItemsList&&this.groupedItemsList.updateRowHeights(),this.forceUpdate()}},{key:"onUndoRedoComplete",value:function(events){events.find(function(e){return"additionalCuratedComponents"===e.property})&&this.forceUpdate()}},{key:"onProjectSelectionChange",value:function(e){var _this2=this,projectSelection=e.newValue,filters=[];projectSelection&&projectSelection!==this.project&&filters.push({label:projectSelection.name||projectSelection.label,onRemove:function(){_this2.project.selectedItem=_this2.project}}),this.setState({filters:filters})}},{key:"onProjectIsCuratingChange",value:function(e){this.forceUpdate()}},{key:"onActionClick",value:function(action){"delete"===action&&this.selectedComponents.splice(0),this.forceUpdate()}},{key:"getRawGroups",value:function(){var _this3=this,projectSelection=this.projectSelection;if(!this.loading){var includeTemplates=Boolean(projectSelection),dimensions=this._sortByRelevancy(this._removeInvalidItems(this.state.dimensions,includeTemplates)),metrics=this._sortByRelevancy(this._removeInvalidItems(this.state.combinedMetrics,includeTemplates)),segments=this._sortByRelevancy(this._removeInvalidItems(this.state.segments,includeTemplates));segments=bundle_module.q.uniq(segments,"id");var dateRanges=(this.state.dateRanges||[]).concat(this.granularities);dateRanges=this._sortByRelevancy(this._removeInvalidItems(dateRanges,includeTemplates));var groups=[{id:"dimensions",label:Object(l10nify_build_bundle_module.a)("Dimensions"),items:dimensions,itemTypes:["dimension"],icon:"dimension"},{id:"metrics",label:Object(l10nify_build_bundle_module.a)("Metrics"),items:metrics,itemTypes:["metric","calc-metric"],icon:"event"},{id:"segments",label:Object(l10nify_build_bundle_module.a)("Segments"),items:segments,itemTypes:["segment"],icon:"users"},{id:"times",label:Object(l10nify_build_bundle_module.a)("Time"),items:dateRanges,itemTypes:["dateRange"],icon:"clock"}];return this.reportSuite.permissions.calculatedMetricCreation&&(groups[1].addItem=function(){return _this3.app.inAppEditors.showCalculatedMetricBuilder({reportSuite:_this3.reportSuite})}),this.reportSuite.permissions.segmentCreation&&(groups[2].addItem=function(){return _this3.app.inAppEditors.showSegmentBuilder()}),this.reportSuite.permissions.dateRangeCreation&&(groups[3].addItem=function(){return _this3.app.inAppEditors.showDateRangeBuilder()}),projectSelection&&projectSelection.sortDraggableStackGroups?projectSelection.sortDraggableStackGroups(groups):groups}return[]}},{key:"_removeInvalidItems",value:function(items){var includeTemplates=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return items.filter(function(item){return item instanceof build_bundle_module.S?!item.internal:"All_Visits"===item.id||(item.template?includeTemplates:!item.internal&&"builderOnly"!==item.visibility)})}},{key:"_sortByRelevancy",value:function(items){return items.sort(function(a,b){return bundle_module.q.get(b,"usageSummary.relevancyScore",0)-bundle_module.q.get(a,"usageSummary.relevancyScore",0)})}},{key:"getGroupsAndAdditionalSearchData",value:function(){var groups=this.getRawGroups(),additionalSearchData=null;if(this.reportSuite.curationEnabled&&((additionalSearchData=[]).push(this.getNonCuratedVRSData(groups)),this.reportSuite.curationEnabled&&(groups=ui_build_bundle_module.jb.groupsWithOnlyCuratedVRSItems({groups:groups}))),this.project.isCurated&&!this.loading){var projectSelection=this.projectSelection,allItemsFromGroupsBeforeProjectCuration=ui_build_bundle_module.jb.allItemsFromGroups(groups);groups.forEach(function(group){group.items=group.items.filter(projectSelection.isSupportedComponent.bind(projectSelection))});var allItemsFromGroupsAfterProjectCuration=ui_build_bundle_module.jb.allItemsFromGroups(groups);if(!this.reportSuite.curationEnabled||this.reportSuite.curationEnabled&&this.state.showAllComponentsClicked){additionalSearchData=additionalSearchData||[];var nonCuratedProjectItems=allItemsFromGroupsBeforeProjectCuration.filter(function(item){return!allItemsFromGroupsAfterProjectCuration.includes(item)}),nonCuratedProjectData=this.getNonCuratedProjectData(nonCuratedProjectItems);this.reportSuite.curationEnabled?additionalSearchData.splice(Math.max(0,additionalSearchData.length-1),0,nonCuratedProjectData):additionalSearchData.push(nonCuratedProjectData)}}return{groups:groups,additionalSearchData:additionalSearchData}}},{key:"getNonCuratedVRSData",value:function(groups){var _this4=this;return ui_build_bundle_module.jb.getNonCuratedVRSSearchData({groups:groups,app:this.app,userOwnsCurrentEntity:this.project&&this.project.userIsOwner(this.app.user),showComponentsNotIncludedInVrs:this.state.showAllComponentsClicked,onShowComponentsNotIncludedInVrs:function(){return _this4.setState({showAllComponentsClicked:!0})}})}},{key:"getNonCuratedProjectData",value:function(items){var _this5=this,projectSelection=bundle_module.q.get(this,"project.selectedItem",this.project);if(this.project.isCurated&&!this.loading){if(!items){var _this$state=this.state,dimensions=_this$state.dimensions,combinedMetrics=_this$state.combinedMetrics,segments=_this$state.segments,dateRanges=_this$state.dateRanges;items=dimensions.concat(combinedMetrics,segments,dateRanges)}var userOwnsCurrentProject=this.project.userIsOwner(this.app.user);return items=items.filter(function(item){return!(!(_this5.reportSuite.curationEnabled||_this5.app.user.isAdmin||userOwnsCurrentProject)&&(item instanceof build_bundle_module.Hb||item instanceof build_bundle_module.X))&&!projectSelection.isSupportedComponent.call(projectSelection,item)}),{title:Object(l10nify_build_bundle_module.a)("Non-Curated Project Components"),items:this._removeInvalidItems(items,!0),getItemGroupForFilteredItems:function(filteredItems,itemsListPanelState){if(!_this5.state.showAllComponentsClicked&&filteredItems.length){var showMoreButton={renderItem:function(){return react_default.a.createElement("div",{className:"enhanceGroupedItemsListPanelWithVRSCuration-show-more-btn-wrapper"},react_default.a.createElement(ui_core_build_bundle_module.f,{className:"enhanceGroupedItemsListPanelWithVRSCuration-show-more-btn",onClick:function(){return _this5.setState({showAllComponentsClicked:!0})}},Object(l10nify_build_bundle_module.a)("Show All Components")))}};return{title:Object(l10nify_build_bundle_module.a)("Displaying Limited Components"),tooltip:react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("p",null,Object(l10nify_build_bundle_module.a)(_templateObject())),react_default.a.createElement("p",null,Object(l10nify_build_bundle_module.a)(_templateObject2()))),items:[showMoreButton],className:"enhanceGroupedItemsListPanelWithVRSCuration-center-additional-data"}}return{title:Object(l10nify_build_bundle_module.a)("Non-Curated Project Components"),tooltip:Object(l10nify_build_bundle_module.a)("This is a list of components not included in the curated set for this project."),items:filteredItems}}}}return null}},{key:"render",value:function(){var _this6=this,_this$getGroupsAndAdd=this.getGroupsAndAdditionalSearchData(),groups=_this$getGroupsAndAdd.groups,additionalSearchData=_this$getGroupsAndAdd.additionalSearchData;return react_default.a.createElement(ui_build_bundle_module.B,{ref:function(node){return _this6.groupedItemsList=node},viewDensity:this.project.definition.viewDensity,groups:groups,additionalSearchData:additionalSearchData,tags:this.state.tags,filters:this.state.filters,onSelectionChange:function(selectedItems){return _this6.selectedComponents=selectedItems},noItemsAvailableLabel:Object(l10nify_build_bundle_module.a)("No Components Available"),onContextMenu:function(e){return ui_build_bundle_module.k.show(e,_this6.selectedComponents,".an-ItemsListItem",_this6.onActionClick.bind(_this6),_this6.app)},loading:this.loading,hideEmptyGroups:!1,toolbar:ui_build_bundle_module.Z})}},{key:"loading",get:function(){return!this.state.segments||!this.project}},{key:"granularities",get:function(){if(!this._granularities&&this.state.dimensions){var granularities=this.state.dimensions.filter(function(dimension){return dimension.isTime});this._granularities=granularities.map(function(granularityDimension){return build_bundle_module.wb.fromJSON(granularityDimension.toJSON())})}return this._granularities||[]}},{key:"projectSelection",get:function(){return build_bundle_module.db.isActive("dynamicSelection")?bundle_module.q.get(this,"project.selectedItem",this.project):this.project}},{key:"reportSuite",get:function(){return this.props.reportSuite}}]),DraggableStack}(ProjectComponent_ProjectComponent);function setViewDensityCSSVariables(viewDensity){if("undefined"!==typeof document&&"undefined"!==typeof document.documentElement)if("expanded"===viewDensity){document.documentElement.style.setProperty("--an-FreeformReportlet-column-header-container-padding","8px, 0"),document.documentElement.style.setProperty("--an-FreeformReportlet-column-header-container-single-row-min-height","50px"),document.documentElement.style.setProperty("--an-FreeformReportlet-column-header-container-min-height","34px"),document.documentElement.style.setProperty("--an-FreeformReportlet-column-header-sublabel-margin-top","2px"),document.documentElement.style.setProperty("--an-FreeformReportlet-column-settings-row-height","33px"),document.documentElement.style.setProperty("--an-CohortTable-cell-height","44px"),document.documentElement.style.setProperty("--an-CohortTable-headerDimension-height","50px"),document.documentElement.style.setProperty("--GroupedItemsListPanel-tagged-select-search-margin-bottom","16px"),document.documentElement.style.setProperty("--GroupedItemsListPanel-dimensionValuesSearch-margin-bottom","17px"),document.documentElement.style.setProperty("--GroupedItemsListPanel-headerContainer-margin-top","15px"),document.documentElement.style.setProperty("--GroupedItemsListePanel-shortList-margin-bottom","8px"),document.documentElement.style.setProperty("--an-selected-component-toolbar-margin-bottom","16px"),document.documentElement.style.setProperty("--items-list-item-line-height","40px"),document.documentElement.style.setProperty("--items-list-item-height","42px"),document.documentElement.style.setProperty("--items-list-item-grouped-list-first-child-colored-sidebar-height","calc(".concat("42px"," - 2.5px)")),document.documentElement.style.setProperty("--items-list-item-infinite-list-colored-sidebar-height","calc(".concat("42px"," + 0.5px)")),document.documentElement.style.setProperty("--items-list-item-infinite-list-last-child-colored-sidebar-height","calc(".concat("42px"," - 0.25px)")),document.documentElement.style.setProperty("--items-list-item-colored-sidebar-height","calc(".concat("42px"," - 1px)")),document.documentElement.style.setProperty("--items-list-item-dragHandle-height","21px"),document.documentElement.style.setProperty("--items-list-item-dragHandle-padding","13px 7px 0 10px"),document.documentElement.style.setProperty("--items-list-item-label-padding","0px 7px 0 0"),document.documentElement.style.setProperty("--an-ItemsListPanel-iconTitleWrapper-margin","24px 7px 5px 0px")}else"compact"===viewDensity?(document.documentElement.style.setProperty("--an-FreeformReportlet-column-header-container-padding","0"),document.documentElement.style.setProperty("--an-FreeformReportlet-column-header-container-single-row-min-height","30px"),document.documentElement.style.setProperty("--an-FreeformReportlet-column-header-container-min-height","20px"),document.documentElement.style.setProperty("--an-FreeformReportlet-column-header-sublabel-margin-top","0px"),document.documentElement.style.setProperty("--an-FreeformReportlet-column-settings-row-height","21px"),document.documentElement.style.setProperty("--an-CohortTable-cell-height","24px"),document.documentElement.style.setProperty("--an-CohortTable-headerDimension-padding-top","1px"),document.documentElement.style.setProperty("--an-CohortTable-headerDimension-height","25px"),document.documentElement.style.setProperty("--GroupedItemsListPanel-tagged-select-search-margin-bottom","6px"),document.documentElement.style.setProperty("--GroupedItemsListPanel-dimensionValuesSearch-margin-bottom","7px"),document.documentElement.style.setProperty("--GroupedItemsListPanel-headerContainer-margin-top","10px"),document.documentElement.style.setProperty("--GroupedItemsListePanel-shortList-margin-bottom","4px"),document.documentElement.style.setProperty("--an-selected-component-toolbar-margin-bottom","6px"),document.documentElement.style.setProperty("--items-list-item-line-height","24px"),document.documentElement.style.setProperty("--items-list-item-height","24px"),document.documentElement.style.setProperty("--items-list-item-colored-sidebar-height","23px"),document.documentElement.style.setProperty("--items-list-item-grouped-list-first-child-colored-sidebar-height","21.5px"),document.documentElement.style.setProperty("--items-list-item-infinite-list-colored-sidebar-height","23px"),document.documentElement.style.setProperty("--items-list-item-infinite-list-last-child-colored-sidebar-height","23px"),document.documentElement.style.setProperty("--items-list-item-dragHandle-height","15px"),document.documentElement.style.setProperty("--items-list-item-dragHandle-padding","8px 7px 0 10px"),document.documentElement.style.setProperty("--items-list-item-label-padding","0px 7px 0px 0"),document.documentElement.style.setProperty("--an-ItemsListPanel-iconTitleWrapper-margin","14px 7px 5px 0px")):"comfortable"===viewDensity&&(document.documentElement.style.setProperty("--an-FreeformReportlet-column-header-container-padding","2px, 0"),document.documentElement.style.setProperty("--an-FreeformReportlet-column-header-container-single-row-min-height","37px"),document.documentElement.style.setProperty("--an-FreeformReportlet-column-header-container-min-height","25px"),document.documentElement.style.setProperty("--an-FreeformReportlet-column-header-sublabel-margin-top","1px"),document.documentElement.style.setProperty("--an-FreeformReportlet-column-settings-row-height","27px"),document.documentElement.style.setProperty("--an-CohortTable-cell-height","32px"),document.documentElement.style.setProperty("--an-CohortTable-headerDimension-height","38px"),document.documentElement.style.setProperty("--GroupedItemsListPanel-tagged-select-search-margin-bottom","6px"),document.documentElement.style.setProperty("--GroupedItemsListPanel-dimensionValuesSearch-margin-bottom","7px"),document.documentElement.style.setProperty("--GroupedItemsListPanel-headerContainer-margin-top","10px"),document.documentElement.style.setProperty("--GroupedItemsListePanel-shortList-margin-bottom","4px"),document.documentElement.style.setProperty("--an-selected-component-toolbar-margin-bottom","6px"),document.documentElement.style.setProperty("--items-list-item-line-height","32px"),document.documentElement.style.setProperty("--items-list-item-height","32px"),document.documentElement.style.setProperty("--items-list-item-colored-sidebar-height","31px"),document.documentElement.style.setProperty("--items-list-item-grouped-list-first-child-colored-sidebar-height","29.5px"),document.documentElement.style.setProperty("--items-list-item-infinite-list-colored-sidebar-height","31"),document.documentElement.style.setProperty("--items-list-item-infinite-list-last-child-colored-sidebar-height","31"),document.documentElement.style.setProperty("--items-list-item-dragHandle-height","15px"),document.documentElement.style.setProperty("--items-list-item-dragHandle-padding","12px 7px 0 10px"),document.documentElement.style.setProperty("--items-list-item-label-padding","0px 7px 0px 0"),document.documentElement.style.setProperty("--an-ItemsListPanel-iconTitleWrapper-margin","14px 7px 5px 0px"))}var PublicTemplates=__webpack_require__(768),CACHED_COMPONENT_TYPES=["combinedMetrics","metrics","computedComponents","dimensions","dateRanges","segments","tags","metricViews","reportSuites","attributionTemplates"],ProjectLoader_ProjectLoader=function(){function ProjectLoader(app){Object(classCallCheck.a)(this,ProjectLoader),this.app=app,this.pasteBinService=new build_bundle_module.Tb(this.app.appService)}return Object(createClass.a)(ProjectLoader,[{key:"loadProject",value:function(args){var loadMethod="_loadNewProject";return args.id?loadMethod="_loadProjectUsingId":args.legacyId?loadMethod="_loadProjectUsingJpj":args.template?loadMethod="_createNewProjectFromStandardTemplateId":args.jobId?loadMethod="_loadProjectUsingJobId":args.customTemplateId?loadMethod="_createNewProjectFromCustomTemplateId":args.pasteId&&(loadMethod="_loadProjectUsingPasteId"),this.app.settings.demoMode&&(loadMethod="_loadDemoProject"),this[loadMethod](args).then(this._hydrateProject.bind(this)).then(this._validatePermissionToNestedComponentsInProject.bind(this,{isReloadProject:!1,returnToProjectsButton:!0})).then(this._updateProjectUsage.bind(this)).then(this._displayAlertForAutosavedEntry.bind(this)).then(this._doPostValidationProcessing.bind(this,loadMethod)).catch(function(err){throw console.error("An Unknown error kept the project from loading",err),err})}},{key:"_doPostValidationProcessing",value:function(loadMethod,project){return"_createNewProjectFromStandardTemplateId"===loadMethod&&build_bundle_module.mc.doAdditionalVisualizationProcessing(project,{app:this.app,reportSuite:this.app.reportSuite}),project}},{key:"reloadProject",value:function(project){var _this$app$cache;return(_this$app$cache=this.app.cache).when.apply(_this$app$cache,CACHED_COMPONENT_TYPES).then(function(){return project}).then(this._updateCachedDimensionItems.bind(this)).then(this._loadHiddenOrMissingComponents.bind(this)).then(this._validatePermissionToNestedComponentsInProject.bind(this,{isReloadProject:!0,returnToProjectsButton:!1}))}},{key:"_loadHiddenOrMissingComponents",value:function(){var _loadHiddenOrMissingComponents2=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(project){var hiddenOrNoAccessEntities;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!(hiddenOrNoAccessEntities=project.getEmbeddedEntities().filter(function(e){return!0===e.hidden||!0===e.noAccess})).length){_context.next=4;break}return _context.next=4,this.app.repo.loadEntities(hiddenOrNoAccessEntities);case 4:return _context.abrupt("return",project);case 5:case"end":return _context.stop()}},_callee,this)}));return function(_x){return _loadHiddenOrMissingComponents2.apply(this,arguments)}}()},{key:"_loadProjectUsingId",value:function(args){var _this=this;return this.app.repo.get(build_bundle_module.Ub,args.id,{hydrate:!1,params:{expansion:this.defaultExpansions.join(",")}}).then(function(project){return args.overrideReportSuite&&(project.reportSuite=args.overrideReportSuite),_this._validateReportSuite(project.reportSuite).then(function(reportSuite){return reportSuite.rsid!==project.reportSuite.rsid&&(project.reportSuite=reportSuite),project})})}},{key:"_loadProjectUsingJpj",value:function(args){var _this2=this;return new build_bundle_module.Vb(this.app).jpjToProject(args.legacyId,args.legacyReportName).then(function(project){return project._expansions=_this2._expansions,project})}},{key:"_loadDemoProject",value:function(args){return Promise.resolve(build_bundle_module.Ub.fromJSON(build_bundle_module.Ec))}},{key:"_createNewProjectFromStandardTemplateId",value:function(args){var _this3=this;return this._projectFromTemplate(args).then(function(project){return _this3._validateReportSuite(project.reportSuite).then(function(reportSuite){return reportSuite.rsid!==project.reportSuite.rsid&&(project.reportSuite=reportSuite),project.templateId=args.template,project.clearAutosavedEntryFromLocalStorage(project.autosaveKey),project._expansions=_this3._expansions,project})})}},{key:"_createNewProjectFromCustomTemplateId",value:function(){var _createNewProjectFromCustomTemplateId2=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee2(args){var templateProject,project;return regenerator_default.a.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,this.app.repo.get(build_bundle_module.Ub,args.customTemplateId,{hydrate:!1,params:{expansion:this.defaultExpansions.join(",")}});case 2:return templateProject=_context2.sent,(project=new build_bundle_module.Ub({type:templateProject.type,name:templateProject.name,definition:templateProject.definition})).reportSuite=this.app.reportSuite,_context2.abrupt("return",project);case 6:case"end":return _context2.stop()}},_callee2,this)}));return function(_x2){return _createNewProjectFromCustomTemplateId2.apply(this,arguments)}}()},{key:"_projectFromTemplate",value:function(args){var templateId=args.template,Template=PublicTemplates.a.byId[templateId];return Template?new Template(this.app).load(args):Promise.resolve(build_bundle_module.Ub.createBlankProject({},this.app.user.uiSettings.getAttribute("newBlankPanelAsDefault")))}},{key:"_loadProjectUsingJobId",value:function(args){var _this4=this;return new build_bundle_module.Vb(this.app).alertToProject(args.jobId).then(function(project){return project._expansions=_this4._expansions,project})}},{key:"_loadProjectUsingPasteId",value:function(){var _loadProjectUsingPasteId2=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee3(args){var result,project;return regenerator_default.a.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,this.pasteBinService.get(args.pasteId);case 2:return(result=_context3.sent).data?project=build_bundle_module.Ub.fromJSON(result.data):(console.error("Unable to request any data for pasteId: ".concat(args.pasteId,".")),project=new build_bundle_module.Ub({reportSuite:this.app.reportSuite})),_context3.abrupt("return",project);case 5:case"end":return _context3.stop()}},_callee3,this)}));return function(_x3){return _loadProjectUsingPasteId2.apply(this,arguments)}}()},{key:"_loadNewProject",value:function(args){var project=build_bundle_module.Ub.createBlankProject({name:Object(l10nify_build_bundle_module.a)("New Project"),reportSuite:this.app.reportSuite},this.app.user.uiSettings.getAttribute("newBlankPanelAsDefault"));return project._expansions=this._expansions,Promise.resolve(project)}},{key:"_updateProjectUsage",value:function(project){return ui_build_bundle_module.bb.track(this.app,"projects",[{rsid:project.reportSuite.rsid,itemId:project.id||project.templateId||"blank-project",itemDetails:{oid:null}}]),Promise.resolve(project)}},{key:"_hydrateProject",value:function(project){return this.app.repo.hydrate(project,{waitForCache:CACHED_COMPONENT_TYPES,ignoreIfMissing:!0,onIgnore:function(entity){entity.id&&(bundle_module.q.set(entity,"hidden",!0),bundle_module.q.set(entity,"noAccess",!0))}})}},{key:"_updateCachedDimensionItems",value:function(project){var _this5=this,items=project.getEmbeddedEntitiesExcludingCuratedComponents().filter(function(entity){return entity instanceof build_bundle_module.Y});return items.length?this.app.repo.getWithIds(build_bundle_module.Y,items.map(function(item){return item.id})).then(function(items){return items.forEach(function(item){return _this5.app.cache.update(item)}),project}):Promise.resolve(project)}},{key:"_validateReportSuite",value:function(reportSuite){var _this6=this;return reportSuite.rsid===this.app.reportSuite.rsid||this.app.serverRender?Promise.resolve(reportSuite):this.app.appService.get("/collections/suites",{params:{rsids:reportSuite.rsid}}).then(function(suites){return suites.length?_this6.app.changeReportSuiteUsingRsid(reportSuite.rsid):new Promise(function(resolve){ui_build_bundle_module.E.show({rsid:"undefined",onReportSuiteChange:function(reportSuite){return resolve(reportSuite)}})})})}},{key:"_getMissingAndNoAccessEntitiesForProject",value:function(project){var _this7=this;return project.getEmbeddedEntitiesExcludingCuratedComponents().filter(function(c){return!_this7.app.componentIsUsable(c)})}},{key:"_projectTemplateHasSetupMessage",value:function(project){return build_bundle_module.db.isActive("advertisingAccounts")&&project.templateId&&bundle_module.q.get(PublicTemplates.a,"byId[".concat(project.templateId,"].getSetupMessage"))}},{key:"_getIncompatibleReportSuiteMessageForProject",value:function(project,missingEntities){if(this._projectTemplateHasSetupMessage(project))return PublicTemplates.a.byId[project.templateId].getSetupMessage({project:project,missingComponents:missingEntities,app:this.app});return react_default.a.createElement("div",null,react_default.a.createElement("p",null,Object(l10nify_build_bundle_module.a)("This report suite does not have all the dimensions/metrics enabled that are needed to display this project. Please change the report suite or enable the required dimensions/metrics in the admin console.")),react_default.a.createElement("br",null),react_default.a.createElement("h4",{className:"an-ProjectLoader-missing-components-label"},Object(l10nify_build_bundle_module.a)("Missing Components:")),react_default.a.createElement(ui_core_build_bundle_module.mb,{items:missingEntities.map(function(entity){return entity.label||Object(l10nify_build_bundle_module.a)('Nameless component with the id "%s"',[entity.id])})}))}},{key:"_getIncompatibleReportSuiteProps",value:function(project,options,hiddenOrNoAccessEntities,resolve){var _this8=this;return{title:this._projectTemplateHasSetupMessage(project)?Object(l10nify_build_bundle_module.a)("Template Setup"):Object(l10nify_build_bundle_module.a)("Incompatible Report Suite"),returnToProjectsButton:options.returnToProjectsButton,message:this._getIncompatibleReportSuiteMessageForProject(project,hiddenOrNoAccessEntities),onContinue:function(){return resolve(project)},onReportSuiteChange:function(){var _onReportSuiteChange=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee4(reportSuite){var nextHiddenOrMissing;return regenerator_default.a.wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return project.reportSuite=reportSuite,_context4.next=3,_this8._hydrateProject(project);case 3:nextHiddenOrMissing=_this8._getMissingAndNoAccessEntitiesForProject(project),!options.isReloadProject&&nextHiddenOrMissing.length>0?ui_build_bundle_module.E.show(_this8._getIncompatibleReportSuiteProps(project,options,nextHiddenOrMissing,resolve)):resolve(project);case 5:case"end":return _context4.stop()}},_callee4)}));return function(_x4){return _onReportSuiteChange.apply(this,arguments)}}()}}},{key:"_validatePermissionToNestedComponentsInProject",value:function(){var _this9=this,options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},project=arguments.length>1?arguments[1]:void 0;if(this.app.serverRender)return Promise.resolve(project);var hiddenOrNoAccessEntities=this._getMissingAndNoAccessEntitiesForProject(project);return hiddenOrNoAccessEntities.length?new Promise(function(resolve){ui_build_bundle_module.E.show(_this9._getIncompatibleReportSuiteProps(project,options,hiddenOrNoAccessEntities,resolve))}):Promise.resolve(project)}},{key:"_displayAlertForAutosavedEntry",value:function(project){var _this10=this;return new Promise(function(resolve){var setupProject=function(){var projectType=project.id?"edit":"new";"edit"===projectType&&project.isCurated&&(projectType="curated");var userIsOwner=project.owner&&project.owner.id==parseFloat(_this10.app.user.id),trackingParams={projectId:project.id||"NEW_PROJECT",projectName:project.name,type:projectType,isSharedProject:!userIsOwner,isCuratedProject:project.isCurated,projectConvertedFromAHALoaded:project.isConvertedFromAHA};if(ui_core_build_bundle_module.lb.trackAction(null,"Project Load",trackingParams),"undefined"!==typeof URLSearchParams&&"undefined"!==typeof window){var urlParams=new URLSearchParams(window.location.search);if(urlParams.get("samplingRate")){var sampling=Number(urlParams.get("samplingRate"))||0;sampling>1&&(sampling/=100),sampling*=100,ui_core_build_bundle_module.lb.trackAction(null,"Sampling Rate",{samplingRate:sampling,projectId:trackingParams.projectId,projectName:trackingParams.projectName})}}resolve(project)};project.removeExpiredAutosavedEntries(),project.hasAutosavedEntry()?(_this10.app.emit("disableCoachmarks"),ui_core_build_bundle_module.o.alert(Object(l10nify_build_bundle_module.a)("This project has some changes that were not saved. Would you like to open the project where you left off?"),{title:Object(l10nify_build_bundle_module.a)("Project Recovery"),closeOnClickOutside:!1,actionButtons:[{label:Object(l10nify_build_bundle_module.a)("No"),variant:"quiet",reject:!0},{label:Object(l10nify_build_bundle_module.a)("Yes")}]}).then(function(){project=build_bundle_module.Ub.fromJSON(project.getAutosavedProject()),_this10._hydrateProject(project).then(setupProject)}).catch(function(){setupProject()})):setupProject()})}},{key:"defaultExpansions",get:function(){return["definition","ownerFullName","modified","favorite","approved","tags","shares","sharesFullName","reportSuiteName","companyTemplate"]}},{key:"_expansions",get:function(){var expansions={};return this.defaultExpansions.forEach(function(expansion){return expansions[expansion]=!0}),expansions}}]),ProjectLoader}(),objectSpread=__webpack_require__(51),FramesPerSecondTracker_FramesPerSecondTracker=function(){function FramesPerSecondTracker(){Object(classCallCheck.a)(this,FramesPerSecondTracker),this.timeoutCancelIds=[]}return Object(createClass.a)(FramesPerSecondTracker,[{key:"startTracking",value:function(extraTrackingParams){this.cancelAllTimers(),this.registerTrackingTimer(extraTrackingParams,bundle_module.q.random(0,60)),this.setRecurringTracker({numberOfTimesToTrack:5,avgTimeBetweenTests:300,initialOffset:60,extraTrackingParams:extraTrackingParams})}},{key:"cancelAllTimers",value:function(){this.timeoutCancelIds.forEach(function(timerId){return clearTimeout(timerId)}),this.timeoutCancelIds=[]}},{key:"setRecurringTracker",value:function(_ref){for(var _ref$numberOfTimesToT=_ref.numberOfTimesToTrack,numberOfTimesToTrack=void 0===_ref$numberOfTimesToT?5:_ref$numberOfTimesToT,_ref$avgTimeBetweenTe=_ref.avgTimeBetweenTests,avgTimeBetweenTests=void 0===_ref$avgTimeBetweenTe?300:_ref$avgTimeBetweenTe,_ref$initialOffset=_ref.initialOffset,initialOffset=void 0===_ref$initialOffset?60:_ref$initialOffset,extraTrackingParams=_ref.extraTrackingParams,i=0;i<numberOfTimesToTrack;i++){var lowerBound=initialOffset+i*avgTimeBetweenTests,upperBound=initialOffset+avgTimeBetweenTests+i*avgTimeBetweenTests;this.registerTrackingTimer(extraTrackingParams,bundle_module.q.random(lowerBound,upperBound))}}},{key:"registerTrackingTimer",value:function(extraTrackingParams,time){var cancelId=setTimeout(this.trackFPS.bind(this,extraTrackingParams,time),1e3*time);this.timeoutCancelIds.push(cancelId)}},{key:"trackFPS",value:function(extraTrackingParams,secondsSinceProjectOpen){var _this=this;this.documentIsVisible&&this.getAverageFPS().then(function(fps){_this.sendTrackingHit(fps,extraTrackingParams,secondsSinceProjectOpen)})}},{key:"sendTrackingHit",value:function(fps,extraTrackingParams,secondsSinceProjectOpen){var trackingParams=Object(objectSpread.a)({framesPerSecond:fps,secondsSinceProjectOpen:secondsSinceProjectOpen},extraTrackingParams);ui_core_build_bundle_module.lb.trackAction(null,"Frames Per Second",trackingParams)}},{key:"getAverageFPS",value:function(){var framesToTest=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60,frames=0,startTime=(new Date).getTime();return new Promise(function(resolve){requestAnimationFrame(function incrementFrames(){if(!(++frames<framesToTest)){var endTime=(new Date).getTime(),fps=frames/((endTime-startTime)/1e3),roundedFps=bundle_module.q.round(fps,2);return resolve(roundedFps)}requestAnimationFrame(incrementFrames)})})}},{key:"documentIsVisible",get:function(){return"undefined"!==typeof document&&!1===document.hidden}}]),FramesPerSecondTracker}(),ProjectViewModel_ProjectView=function(_Model){function ProjectView(data,config){var _this;return Object(classCallCheck.a)(this,ProjectView),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(ProjectView).call(this,data,config))).app=config.app,_this.projectLoader=new ProjectLoader_ProjectLoader(config.app),_this.framesPerSecondTracker=new FramesPerSecondTracker_FramesPerSecondTracker,_this._watchers=[],_this._unwatchProjectChange=_this.on("change:project",_this._onProjectChange.bind(Object(assertThisInitialized.a)(_this))),_this}return Object(inherits.a)(ProjectView,_Model),Object(createClass.a)(ProjectView,null,[{key:"properties",value:function(){return{project:{type:build_bundle_module.Ub},workspace:{type:build_bundle_module.Ac,setParent:!1,observe:!0},loading:{type:Boolean,default:!1}}}},{key:"fields",value:function(){return["_watchers","_unwatchProjectChange","app","projectLoader","_originalTabTitle","framesPerSecondTracker","switchingProjectInProgress"]}}]),Object(createClass.a)(ProjectView,[{key:"_setupUndo",value:function(project){project&&(setTimeout(function(){build_bundle_module.sc.autoTrackChanges(project)},build_bundle_module.sc.Timeout),this._watchers.push(project.on("saved",function(){var undoStack=build_bundle_module.sc.getUndoStack(project);project.lastSavedChangeSet=bundle_module.q.last(undoStack),project.isSaving=!1})))}},{key:"newProject",value:function(){var showBlankPanelWithViz=this.app.user.uiSettings.getAttribute("newBlankPanelAsDefault");this.project=build_bundle_module.Ub.createBlankProject({name:Object(l10nify_build_bundle_module.a)("New Project"),reportSuite:this.app.reportSuite},showBlankPanelWithViz)}},{key:"emptyCurrentProject",value:function(){var addBlankPanel=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],showBlankPanelWithViz=this.app.user.uiSettings.getAttribute("newBlankPanelAsDefault");this.project.currentWorkspace.panels=addBlankPanel?[build_bundle_module.Rb.createBlankProject({},showBlankPanelWithViz)]:[]}},{key:"loadProject",value:function(params,existingProject){var _this2=this,force=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return params.id&&bundle_module.q.get(this,"project.id")===params.id&&!force?Promise.resolve(this.project):(build_bundle_module.Lc.progress(build_bundle_module.Lc.LOADING_PROJECT),build_bundle_module.Mc.useCommonGroupId(),build_bundle_module.Yb.clearLoadingStats(),this.loading=!0,existingProject?Promise.resolve(this._onLoadProjectModel(existingProject)):(this.switchingProjectInProgress=!0,this.projectLoader.loadProject(params).then(function(project){_this2.switchingProjectInProgress=!1,_this2._onLoadProjectModel(project)},function(err){throw _this2.switchingProjectInProgress=!1,err})))}},{key:"_onLoadProjectModel",value:function(project){build_bundle_module.Lc.progress(build_bundle_module.Lc.LOADING_REPORT_DATA),bundle_module.s.setColors(project.colorScheme.value),setViewDensityCSSVariables(project.definition.viewDensity),this.app.user.viewDensity=project.definition.viewDensity,this.project=project,this.trackFramesPerSecond(project),this.app.appService.rtsProjectName=project.name,this.app.newRelic.setCustomAttribute("projectName",project.name),this.app.newRelic.setCustomAttribute("projectId",project.id),this.loading=!1}},{key:"trackFramesPerSecond",value:function(project){if(project){var trackingParams={projectId:project.id||"NEW_PROJECT"};Object.defineProperty(trackingParams,"fullyLoaded",{enumerable:!0,get:function(){return project.currentWorkspace.fullyLoaded}}),this.framesPerSecondTracker.startTracking(trackingParams)}}},{key:"_onProjectChange",value:function(e){var _this3=this;e.oldValue&&this._cleanupProject(e.oldValue);var project=e.newValue;if(project){this._watchers.push(project.on("change:reportSuite",this._onProjectReportSuiteChanged.bind(this))),this._watchers.push(this.app.on("change:reportSuite",this._onReportSuiteChanged.bind(this))),this._watchers.push(project.on("change:name",this._setBrowserTabTitle.bind(this))),build_bundle_module.Yb.countRepeatInstances=project.definition.countRepeatInstances,this._watchers.push(project.definition.on("change:countRepeatInstances",this._handleCountRepeatInstancesChange.bind(this))),this._watchers.push(project.definition.on("change:colorScheme",function(){bundle_module.s.setColors(project.colorScheme.value),project.broadcast("project:render")})),this._watchers.push(project.on("change:definition.viewDensity",function(){_this3.app.user.viewDensity=project.definition.viewDensity,_this3.app.emit("viewDensityChange",{viewDensity:project.definition.viewDensity}),setViewDensityCSSVariables(project.definition.viewDensity),project.broadcast("project:render")})),project.parentView=this;var workspace=project.currentWorkspace;this.workspace=workspace,this._watchers.push(workspace.on("change:fullyLoaded",this._onChangeFullyLoaded.bind(this))),this._watchers.push(workspace.on("change:fullyLoadedWithoutAnomalies",this._onChangeFullyLoadedWithoutAnomalies.bind(this))),this._watchers.push(workspace.panels.on("change",this._onPanelsChanged.bind(this))),workspace.fullyLoaded&&this._onChangeFullyLoaded(),workspace.fullyLoadedWithoutAnomalies&&this._onChangeFullyLoadedWithoutAnomalies(),this.workspace=workspace,this._setBrowserTabTitle({newValue:project.name}),this.app.appService.rtsProjectName=project.name,this.app.serverRender&&window.adobeReportRenderer.projectLoaded(project,this.app),project.initializeWatchersForWorkspaceProject(),this._setupUndo(project)}}},{key:"_cleanupProject",value:function(project){this._watchers.forEach(function(unwatch){return unwatch()}),this._watchers.splice(0),project.clearAutosavedEntryFromLocalStorage(),project.destroyWatchersForWorkspaceProject(),project.parentView=null,this.app.newRelic.setCustomAttribute("projectName",null),this.app.newRelic.setCustomAttribute("projectId",null)}},{key:"_onChangeFullyLoadedWithoutAnomalies",value:function(){this.trackProjectLoadTimesWithoutAnomalies()}},{key:"_onChangeFullyLoaded",value:function(e){this.project.currentWorkspace.fullyLoaded?(build_bundle_module.db.isActive("serverRenderDebug")&&console.log("**************** Fully Loaded ****************"),build_bundle_module.Lc.progress(build_bundle_module.Lc.REPORT_DATA_LOADED),build_bundle_module.Mc.useIndividualTimingIds(this.app),this.trackProjectLoadTime()):build_bundle_module.Lc.progress(build_bundle_module.Lc.LOADING_REPORT_DATA)}},{key:"trackProjectLoadTime",value:function(){var trackingParams={projectId:this.project.id||"NEW_PROJECT",projectName:this.project.name,loadTimeInSeconds:build_bundle_module.Yb.getLoadTimeInSeconds(),requestCount:build_bundle_module.Yb.completedRequestCount};ui_core_build_bundle_module.lb.trackAction(null,"Project Fully Loaded",trackingParams)}},{key:"trackProjectLoadTimesWithoutAnomalies",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Project Loaded without Anomaly Detection",{projectId:this.project.id||"NEW_PROJECT",projectName:this.project.name,loadTimeInSeconds:build_bundle_module.Yb.getLoadTimeInSeconds(),requestCount:build_bundle_module.Yb.completedRequestCount})}},{key:"_onProjectReportSuiteChanged",value:function(){var _onProjectReportSuiteChanged2=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(e){return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(build_bundle_module.sc.undoRedoInProgress){_context.next=2;break}return _context.abrupt("return");case 2:if(this.appReportSuiteMatchesProjectReportSuite()){_context.next=4;break}return _context.abrupt("return",this.app.changeReportSuite(this.project.reportSuite));case 4:return _context.abrupt("return",this._onReportSuiteChanged(e));case 5:case"end":return _context.stop()}},_callee,this)}));return function(_x){return _onProjectReportSuiteChanged2.apply(this,arguments)}}()},{key:"_onReportSuiteChanged",value:function(){var _onReportSuiteChanged2=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee2(e){var _this4=this;return regenerator_default.a.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(!this.switchingProjectInProgress){_context2.next=2;break}return _context2.abrupt("return");case 2:return this.loading=!0,_context2.abrupt("return",this.projectLoader.reloadProject(this.project).then(function(){_this4.loading=!1,_this4.project&&_this4.project.broadcast("project:change","down",{property:"rsid",newValue:_this4.project.rsid})}));case 4:case"end":return _context2.stop()}},_callee2,this)}));return function(_x2){return _onReportSuiteChanged2.apply(this,arguments)}}()},{key:"appReportSuiteMatchesProjectReportSuite",value:function(){return bundle_module.q.get(this,"app.reportSuite.id")===bundle_module.q.get(this,"project.rsid")}},{key:"_setBrowserTabTitle",value:function(projectName){this._originalTabTitle=this._originalTabTitle||document.title||Object(l10nify_build_bundle_module.a)("Analysis Workspace"),bundle_module.q.get(projectName,"newValue")?document.title=Object(l10nify_build_bundle_module.a)("%s - Analysis Workspace",[projectName.newValue]):document.title=this._originalTabTitle}},{key:"_handleCountRepeatInstancesChange",value:function(e){build_bundle_module.Yb.countRepeatInstances=e.newValue}},{key:"_onPanelsChanged",value:function(e){e.added&&(this.project.selectedItem=bundle_module.q.last(e.added))}},{key:"clearOutAutosavedEntryIfThereIsAProject",value:function(){this.project&&this.project.clearAutosavedEntryFromLocalStorage()}},{key:"destroy",value:function(){this._unwatchProjectChange(),this.project&&this._cleanupProject(this.project)}},{key:"hasUnsavedChanges",value:function(){return bundle_module.q.get(this,"project.hasUnsavedChanges",!1)}}]),ProjectView}(essence_build_bundle_module.c),classnames=__webpack_require__(6),classnames_default=__webpack_require__.n(classnames),CurateComponents_CurateComponents=(__webpack_require__(849),function(_ProjectComponent){function CurateComponents(props,context){var _this;return Object(classCallCheck.a)(this,CurateComponents),_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(CurateComponents).call(this,props,context)),Object.assign(_this.state,{visible:!1,showClearButton:!1,dropTargetItems:[]}),_this.removeEscapeKeyListener=null,_this}return Object(inherits.a)(CurateComponents,_ProjectComponent),Object(createClass.a)(CurateComponents,[{key:"projectListeners",value:function(){return{"change:isCurating":this.onCuratingStartStop.bind(this)}}},{key:"onCuratingStartStop",value:function(){var _this2=this;this.setState({visible:this.project.isCurating,showClearButton:this.project.isCurated},function(){_this2.project.isCurating&&_this2.props.dragManager.whitelistTargetElement(_this2.dropTarget.$el.get(0))}),this.project.isCurating?(this.setState({dropTargetItems:this.project.additionalCuratedComponents.slice()}),this.removeEscapeKeyListener=ui_core_build_bundle_module.rb.addHotkey({key:"ESC",action:this.cancelCurateComponents.bind(this)})):(this.removeEscapeKeyListener(),this.props.dragManager.clearWhitelistedDropTargets())}},{key:"cancelCurateComponents",value:function(){this.project.isCurating=!1,ui_core_build_bundle_module.lb.trackAction(null,"Curate: Cancel")}},{key:"clearCurateComponents",value:function(){this.project.additionalCuratedComponents=[],this.project.isCurated=!1,this.project.isCurating=!1,ui_core_build_bundle_module.lb.trackAction(null,"Curate: Clear")}},{key:"applyCurateComponents",value:function(){this.project.additionalCuratedComponents=this.state.dropTargetItems,ui_core_build_bundle_module.lb.trackAction(null,this.project.isCurated?"Curate: Clicked Apply For Existing Curated Project":"Curate: Clicked Apply For New Curated Project",{counterName:"Additional Curated Components",counterValue:this.project.additionalCuratedComponents.length,numCuratedComponents:this.project.projectComponents.length}),this.project.isCurated=!0,this.project.isCurating=!1}},{key:"onComponentsChange",value:function(e){this.setState({dropTargetItems:e.value})}},{key:"render",value:function(){var _this3=this,readOnlyItems=[];return this.project&&(readOnlyItems=bundle_module.q.chain(this.project.projectComponentsExcludingCuratedComponents).reject("internal").uniq(function(c){return c.id}).value()),react_default.a.createElement(ui_core_build_bundle_module.d,{transitionName:"curate-components"},this.state.visible?react_default.a.createElement("div",{className:"curate-components"},react_default.a.createElement("div",{className:"curate-components-container"},react_default.a.createElement(ui_build_bundle_module.A,{label:Object(l10nify_build_bundle_module.a)("Curated Components"),items:this.state.dropTargetItems,readOnlyItems:readOnlyItems,ref:function(dz){return _this3.dropTarget=dz},onChange:function(e){return _this3.onComponentsChange(e)}}),react_default.a.createElement("div",{className:"curate-components-actions"},react_default.a.createElement(ui_core_build_bundle_module.f,{variant:"quiet",onClick:function(e){return _this3.cancelCurateComponents(e)}},Object(l10nify_build_bundle_module.a)("Cancel")),this.state.showClearButton?react_default.a.createElement(ui_core_build_bundle_module.f,{variant:"silent",onClick:function(e){return _this3.clearCurateComponents(e)}},Object(l10nify_build_bundle_module.a)("Remove Curation")):null,react_default.a.createElement(ui_core_build_bundle_module.f,{variant:"primary",onClick:function(e){return _this3.applyCurateComponents(e)}},Object(l10nify_build_bundle_module.a)("Done"))))):null)}}]),CurateComponents}(ProjectComponent_ProjectComponent)),guid_build_bundle_module=__webpack_require__(11);__webpack_require__(850);function ProjectInfoDialog_templateObject(){var data=Object(taggedTemplateLiteral.a)(["Type ","-16 comma-separated hex values (e.g. #FF0000)"]);return ProjectInfoDialog_templateObject=function(){return data},data}var ProjectInfoDialog_ProjectInfoDialog=function(_AppComponent){function ProjectInfoDialog(props,context){var _this;Object(classCallCheck.a)(this,ProjectInfoDialog);var data=(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(ProjectInfoDialog).call(this,props,context))).props.data;return _this.state={name:data.name,description:data.description||"",tags:data.tags||[],countRepeatInstances:data.countRepeatInstances,colorScheme:data.colorScheme,customColorSchemeInput:(data.customColorSchemes[0]||{value:[]}).value.join(", "),customColorSchemes:data.customColorSchemes,selectedColorSchemeValue:data.colorScheme,viewDensity:data.viewDensity||"expanded"},_this.defaultColorSchemes=bundle_module.s.defaultColorSchemeOptions.map(function(item){return build_bundle_module.A.fromJSON(item)}),_this.viewDensityOnOpen=data.viewDensity,_this._originalStringifiedValues=_this.getStringifiedValues(),_this.browserSupportsColorPalette=_this.browserSupportsColorPalette.bind(Object(assertThisInitialized.a)(_this)),_this}return Object(inherits.a)(ProjectInfoDialog,_AppComponent),Object(createClass.a)(ProjectInfoDialog,[{key:"getStringifiedValues",value:function(){var values={name:this.state.name,description:this.state.description,tags:this.state.tags,countRepeatInstances:this.state.countRepeatInstances,colorScheme:this.state.colorScheme,viewDensity:this.state.viewDensity};return JSON.stringify(values)}},{key:"browserSupportsColorPalette",value:function(){return!(dom_util_build_bundle_module.a.isIE()&&dom_util_build_bundle_module.a.ieVersion()<12)}},{key:"updateModel",value:function(e){if(this.props.project.name=this.state.name,this.props.project.description=this.state.description,this.props.project.tags=this.state.tags,!bundle_module.q.isEqual(this.props.project.definition.colorScheme,this.state.colorScheme)){var colorPaletteType=this.state.colorScheme.isCustom?"custom":this.state.colorScheme.id,numColorPaletteValues=this.state.colorScheme.isCustom?this.state.colorScheme.value.length:null;ui_core_build_bundle_module.lb.trackAction(null,"Change Project Color Palette",{colorPaletteType:colorPaletteType,numColorPaletteValues:numColorPaletteValues}),bundle_module.s.setColors(this.state.colorScheme.value),this.props.project.currentWorkspace.resetSwatchColors(),this.props.project.currentWorkspace.updateSwatchColors(),this.props.project.definition.colorScheme=this.state.colorScheme}this.state.colorScheme.isCustom&&(this.props.project.definition.customColorSchemes[0]=this.state.colorScheme),this.viewDensityOnOpen!==this.state.viewDensity&&ui_core_build_bundle_module.lb.trackAction(null,"Change Project View Density",{viewDensity:this.state.viewDensity}),this.props.project.definition.viewDensity=this.state.viewDensity,this.updateCountRepeatInstances(),this.props.onAccept(),ui_core_build_bundle_module.P.close(e.target)}},{key:"onCancel",value:function(e){this.setState({tags:[]}),this.updateViewDensity(this.viewDensityOnOpen),this.props.listenersOff(),ui_core_build_bundle_module.P.close(e)}},{key:"updateCountRepeatInstances",value:function(){var oldCountRepeatInstances=this.props.project.definition.countRepeatInstances;this.props.project.definition.countRepeatInstances=this.state.countRepeatInstances,oldCountRepeatInstances!==this.state.countRepeatInstances&&this.props.project.broadcast("project:refresh")}},{key:"newOptionCreator",value:function(value){return{name:value,id:value,_isNew:!0}}},{key:"colorSchemeOptionRenderer",value:function(option){return react_default.a.createElement("div",{className:"an-color-scheme-swatch-and-icon-wrapper"},react_default.a.createElement("div",{className:classnames_default()("an-ProjectInfoDialog-color-scheme-swatch",{"custom-label":option.isCustom}),style:{display:"flex"}},option.value.length&&!option.isCustom?option.value.map(function(color,index){return react_default.a.createElement("div",{key:option.id+color+index,className:"an-ProjectInfoDialog-color-scheme-swatch-color",style:{backgroundColor:color}})}):react_default.a.createElement("div",{className:"custom-scheme-label"},option.label,react_default.a.createElement("span",null,react_default.a.createElement(ui_core_build_bundle_module.C.Help,{className:"ProjectInfoDialog-helpIcon"}),react_default.a.createElement(ui_core_build_bundle_module.kb,{hoverable:!0},react_default.a.createElement("span",null,Object(l10nify_build_bundle_module.a)("Enter comma-delimited hex values to create your own color palette. For inspiration, visit "),react_default.a.createElement(ui_core_build_bundle_module.F,{onMouseDown:function(e){e.preventDefault()},target:"_blank",href:"https://color.adobe.com/create/color-wheel/"},Object(l10nify_build_bundle_module.a)("Adobe Color")),"."))))),react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"check",size:"XS",className:classnames_default()("an-color-scheme-option-checkmark",{"show-checkmark":bundle_module.q.isEqual(option.value,this.state.colorScheme.value)})}))}},{key:"colorSchemeValueRenderer",value:function(option){return react_default.a.createElement("div",null,react_default.a.createElement("div",{className:"an-ProjectInfoDialog-color-scheme-swatch",style:{display:"flex"}},option.value.map(function(color,index){return react_default.a.createElement("div",{key:option.id+color+index,className:classnames_default()("an-ProjectInfoDialog-color-scheme-value-swatch-color",{"custom-color":bundle_module.q.get(option,"id","").includes("custom"),"sixteenth-child":15===index}),style:{backgroundColor:color}})})))}},{key:"handleColorSchemeSelectChange",value:function(currValue){currValue.id!==this.state.colorScheme.id&&this.setState({colorScheme:currValue,selectedColorSchemeValue:currValue})}},{key:"handleCustomColorInputChange",value:function(e){var _this2=this,value=e.target.value;this.setState({customColorSchemeInput:value});var newCustomColorSchemeValue=this.getScrubbedColorInputAsArray(value);(newCustomColorSchemeValue=newCustomColorSchemeValue.filter(function(item){return _this2.isValidHex(item)})).splice(16);var newCustomColorScheme=build_bundle_module.A.fromJSON({id:"custom_"+guid_build_bundle_module.a.create(),value:newCustomColorSchemeValue,label:Object(l10nify_build_bundle_module.a)("Custom Palette")});this.state.customColorSchemes[0]=newCustomColorScheme,this.setState({colorScheme:newCustomColorScheme})}},{key:"getScrubbedColorInputAsArray",value:function(customColorSchemeInput){return bundle_module.q.compact(bundle_module.q.trim(customColorSchemeInput.replace(/\s/g,""),",").split(","))}},{key:"isValidHex",value:function(value){return/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(value)}},{key:"customColorSchemeInputIsValid",value:function(){var _this3=this;if(!this.state.selectedColorSchemeValue.isCustom)return!0;var customSchemeArr=this.getScrubbedColorInputAsArray(this.state.customColorSchemeInput);return!!(customSchemeArr.every(function(item){return _this3.isValidHex(item)})&&customSchemeArr.length>1)}},{key:"projectNameIsValid",value:function(){return this.state.name.trim().length>=1}},{key:"updateViewDensity",value:function(newViewDensity){var _this4=this;build_bundle_module.sc.runAndIgnoreAllChanges(function(){_this4.setState({viewDensity:newViewDensity}),_this4.props.project.definition.viewDensity=newViewDensity})}},{key:"hasChanged",value:function(){return this._originalStringifiedValues!==this.getStringifiedValues()}},{key:"render",value:function(){var _this5=this;this.props.project;return react_default.a.createElement("div",{className:"project-info-container"},react_default.a.createElement(ui_core_build_bundle_module.u,{label:Object(l10nify_build_bundle_module.a)("Project Name"),className:"project-name-wrapper","data-test-id":"ProjectInfoDialog-project-name"},react_default.a.createElement("input",{className:"project-info-content project-name-input",type:"text",name:"name",value:this.state.name,onChange:function(e){_this5.setState({name:e.target.value})}})),react_default.a.createElement(ui_core_build_bundle_module.u,{label:Object(l10nify_build_bundle_module.a)("Created By")},react_default.a.createElement("div",{className:"project-info-content"},this.props.data.owner)),react_default.a.createElement(ui_core_build_bundle_module.u,{label:Object(l10nify_build_bundle_module.a)("Last Modified")},react_default.a.createElement("div",{className:"project-info-content"},this.props.data.modified)),react_default.a.createElement(ui_core_build_bundle_module.u,{label:Object(l10nify_build_bundle_module.a)("Tags")},react_default.a.createElement(ui_build_bundle_module.v,{variant:"quiet",value:this.state.tags,onChange:function(tags){_this5.setState({tags:tags}),_this5.forceUpdate()}})),react_default.a.createElement(ui_core_build_bundle_module.u,{label:Object(l10nify_build_bundle_module.a)("Description"),className:"project-description-wrapper"},react_default.a.createElement(ui_core_build_bundle_module.l,{value:this.state.description,onChange:function(text){_this5.setState({description:text})},size:"block",placeholder:Object(l10nify_build_bundle_module.a)("Project Information"),resizeable:!1,className:"project-description-input"})),react_default.a.createElement(ui_core_build_bundle_module.u,{label:Object(l10nify_build_bundle_module.a)("Settings")},react_default.a.createElement(ui_core_build_bundle_module.k,{label:Object(l10nify_build_bundle_module.a)("Count Repeat Instances"),onChange:function(e){_this5.setState({countRepeatInstances:e.target.checked})},checked:this.state.countRepeatInstances,"data-test-id":"project-info-count-repeat-instances"}),react_default.a.createElement(ui_core_build_bundle_module.C.Help,{className:"ProjectInfoDialog-helpIcon"}),react_default.a.createElement(ui_core_build_bundle_module.kb,{variant:"default",hoverable:!0},Object(l10nify_build_bundle_module.a)("Specifies whether repeat instances are counted in reports."),react_default.a.createElement("br",null),react_default.a.createElement("br",null),Object(l10nify_build_bundle_module.a)("Note: this setting does not apply to Flow or Fallout visualizations.")," ",react_default.a.createElement(ui_core_build_bundle_module.F,{label:Object(l10nify_build_bundle_module.a)("Learn More"),href:"https://marketing.adobe.com/resources/help/".concat(l10nify_build_bundle_module.a.config.currentLocale,"/analytics/analysis-workspace/freeform_overview.html"),target:"_blank"}))),react_default.a.createElement(ui_core_build_bundle_module.u,{label:Object(l10nify_build_bundle_module.a)("Project Color Palette"),tooltip:Object(l10nify_build_bundle_module.a)("Change the color palette used in this project.")},react_default.a.createElement(ui_core_build_bundle_module.W,{placeholder:this.colorSchemeValueRenderer({id:this.state.colorScheme.id,value:this.state.colorScheme.value}),valueRenderer:this.colorSchemeValueRenderer,options:this.colorSchemeOptions,optionRenderer:this.colorSchemeOptionRenderer.bind(this),className:"an-color-scheme-select",onChange:this.handleColorSchemeSelectChange.bind(this),value:this.state.colorScheme,clearable:!1,searchable:!1}),react_default.a.createElement("input",{className:classnames_default()("an-ProjectInfoDialog-custom-color-input",{"show-input":this.state.selectedColorSchemeValue&&this.state.selectedColorSchemeValue.isCustom,"invalid-input":!this.customColorSchemeInputIsValid(this.state.customColorSchemeInput)}),placeholder:Object(l10nify_build_bundle_module.a)(ProjectInfoDialog_templateObject(),2),value:this.state.customColorSchemeInput,onChange:this.handleCustomColorInputChange.bind(this),maxLength:"142"})),react_default.a.createElement(ui_core_build_bundle_module.u,{label:Object(l10nify_build_bundle_module.a)("View Density"),className:"an-ProjectInfoDialog-viewDensity"},react_default.a.createElement("div",{className:"an-ProjectInfoDialog-viewDensity-radio-container"},react_default.a.createElement(ui_core_build_bundle_module.S,{label:Object(l10nify_build_bundle_module.a)("Compact"),value:"compact",checked:"compact"===this.state.viewDensity,onChange:function(){_this5.updateViewDensity("compact")},"data-test-id":"select-compact-view-density"}),react_default.a.createElement(ui_core_build_bundle_module.S,{label:Object(l10nify_build_bundle_module.a)("Comfortable"),value:"comfortable",checked:"comfortable"===this.state.viewDensity,onChange:function(){_this5.updateViewDensity("comfortable")},"data-test-id":"select-comfortable-view-density"}),react_default.a.createElement(ui_core_build_bundle_module.S,{label:Object(l10nify_build_bundle_module.a)("Expanded"),value:"expanded",checked:"expanded"===this.state.viewDensity,onChange:function(){_this5.updateViewDensity("expanded")},"data-test-id":"select-expanded-view-density"}))),react_default.a.createElement("div",{className:"project-info-buttons"},react_default.a.createElement(ui_core_build_bundle_module.f,{className:"button-cancel",variant:"minimal",label:Object(l10nify_build_bundle_module.a)("Cancel"),"data-test-id":"ProjectInfoDialog-cancel-button",onClick:function(e){return _this5.onCancel(e)}}),react_default.a.createElement(ui_core_build_bundle_module.f,{className:"button-accept",variant:"primary",label:Object(l10nify_build_bundle_module.a)("Save"),"data-test-id":"ProjectInfoDialog-save-button",onClick:function(e){build_bundle_module.sc.runAndIgnoreAllChanges(function(){_this5.props.project.definition.viewDensity=_this5.viewDensityOnOpen}),_this5.updateModel(e)},disabled:!this.isEntireDialogValid})))}},{key:"colorSchemeOptions",get:function(){var customOptions=this.state.customColorSchemes;return[].concat(Object(toConsumableArray.a)(this.defaultColorSchemes),Object(toConsumableArray.a)(customOptions))}},{key:"isEntireDialogValid",get:function(){return this.customColorSchemeInputIsValid(this.state.customColorSchemeInput)&&this.projectNameIsValid()&&this.hasChanged()}}]),ProjectInfoDialog}(ui_build_bundle_module.d);ProjectInfoDialog_ProjectInfoDialog.showInfoModal=function(opts){ui_core_build_bundle_module.P.show({isModal:!0,dialog:{header:Object(l10nify_build_bundle_module.a)("Project Info & Settings"),variant:"info",closable:!1,padded:!0,contents:react_default.a.createElement(ProjectInfoDialog_ProjectInfoDialog,{project:opts.project,data:opts.data,onAccept:opts.onAccept,listenersOff:opts.listenersOff}),closeOnClickOutside:!1}})};var react_dom=__webpack_require__(9),react_dom_default=__webpack_require__.n(react_dom),ShareComponentDialog_ShareComponentDialog=(__webpack_require__(851),function(_AppComponent){function ShareComponentDialog(props,context){var _this;Object(classCallCheck.a)(this,ShareComponentDialog),_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(ShareComponentDialog).call(this,props,context));var componentClone=props.component.constructor.fromJSON(props.component.toJSON());return _this.app.repo.hydrate(componentClone),componentClone.shares=props.component.shares.slice(),componentClone._expansions={tags:!0,shares:!0,definition:!0},_this.state={component:componentClone,sharing:!1,componentIsAlreadyShared:props.component.shares.length>0,autoShareComponents:!1,forcePushLandingPage:!1},_this}return Object(inherits.a)(ShareComponentDialog,_AppComponent),Object(createClass.a)(ShareComponentDialog,null,[{key:"propTypes",get:function(){return{label:ui_core_build_bundle_module.R.string,component:ui_core_build_bundle_module.R.object.isRequired,canSetAsLandingPage:ui_core_build_bundle_module.R.bool,canAutoShareComponents:ui_core_build_bundle_module.R.bool,onSuccess:ui_core_build_bundle_module.R.func,onFailure:ui_core_build_bundle_module.R.func}}},{key:"defaultProps",get:function(){return{label:Object(l10nify_build_bundle_module.a)("Components"),canSetAsLandingPage:!1,canAutoShareComponents:!1,onSuccess:function(){},onFailure:function(){}}}}]),Object(createClass.a)(ShareComponentDialog,[{key:"cache",value:function(){return this.app.user.isAdmin?["tags","users","groups"]:["tags","users"]}},{key:"componentDidMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(ShareComponentDialog.prototype),"componentDidMount",this).call(this),this.observe(this.state.component)}},{key:"onCancel",value:function(e){this._closePopover()}},{key:"onShare",value:function(e){var _this2=this;this.setState({sharing:!0});var component=this.props.component,modifiedComponent=this.state.component;component.name=modifiedComponent.name,component.description=modifiedComponent.description,component.shares=modifiedComponent.shares.slice(),component.tags=modifiedComponent.tags.slice(),this.app.repo.save(component).then(function(){return _this2.onSaveSuccess(component)}).catch(function(err){_this2.app.addAlert({variant:"error",contents:Object(l10nify_build_bundle_module.a)("An error occurred while sharing the project or the embedded components")}),_this2.props.onFailure(err),console.error(err),_this2._closePopover()})}},{key:"onSaveSuccess",value:function(component){var _this3=this,onSuccess=function(){var successMessage=_this3.state.autoShareComponents?Object(l10nify_build_bundle_module.a)('Successfully shared "%s" and embedded components.',[component.name]):Object(l10nify_build_bundle_module.a)('Successfully shared "%s".',[component.name]);return _this3.state.component.id=component.id,_this3.setAsLandingPageIfChecked(),_this3.trackUserActions(),_this3.props.onSuccess(component,successMessage),_this3._closePopover(),component};return this.state.autoShareComponents&&this.props.canAutoShareComponents?this.autoShareEmbeddedComponents().then(onSuccess).catch(function(err){return _this3.app.addAlert({contents:Object(l10nify_build_bundle_module.a)("Successfully shared the project and embedded components"),variant:"success"}),onSuccess()}):(this.app.addAlert({contents:Object(l10nify_build_bundle_module.a)("Successfully shared the project"),variant:"success"}),onSuccess())}},{key:"trackUserActions",value:function(){var component=this.state.component;if(component.shares.length){var counts=bundle_module.q.countBy(component.shares,"type");ui_core_build_bundle_module.lb.trackAction(null,"Added Collaborators",{numOrgs:counts.all||0,numGroups:counts.group||0,numUsers:counts.user||0})}component.tags.length&&ui_core_build_bundle_module.lb.trackAction(null,"Added Tags",{numTags:component.tags.length})}},{key:"findDOMNode",value:function(element){return react_dom_default.a.findDOMNode(element)}},{key:"setAsLandingPageIfChecked",value:function(){var _setAsLandingPageIfChecked=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(){var canSetAsLandingPage,_this$state,component,forcePushLandingPage,userLogins,userIds,groupIds,postData,_this4=this;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(canSetAsLandingPage=this.props.canSetAsLandingPage,_this$state=this.state,component=_this$state.component,forcePushLandingPage=_this$state.forcePushLandingPage,!(canSetAsLandingPage&&forcePushLandingPage&&component instanceof build_bundle_module.Ub)){_context.next=16;break}if(!(component.shares.filter(function(share){return"all"===share.type}).length>0)){_context.next=8;break}userLogins=this.state.users.map(function(user){return user.login}),_context.next=15;break;case 8:if(userIds=component.shares.filter(function(share){return"user"===share.type}).map(function(share){return share.shareToId}),!(groupIds=component.shares.filter(function(share){return"group"===share.type}).map(function(share){return share.shareToId})).length){_context.next=13;break}return _context.next=13,Promise.all(groupIds.map(function(groupId){return _this4.app.appService.get("/usergroups/custom/".concat(groupId),{params:{expansion:"loginIds"}}).then(function(result){userIds.push.apply(userIds,Object(toConsumableArray.a)(result.data.loginIds.map(function(loginId){return loginId+""})))})}));case 13:userLogins=this.state.users.filter(function(user){return userIds.includes(user.id)}).map(function(user){return user.login}),userLogins=bundle_module.q.uniq(userLogins);case 15:userLogins.length&&(postData="project=".concat(encodeURIComponent(component.id),"&force_push_to_users=").concat(encodeURIComponent(userLogins.join(","))),this.app.omnitureService.postSuite("User.SetLanding",postData,{headers:{"Content-type":"application/x-www-form-urlencoded"}}));case 16:case"end":return _context.stop()}},_callee,this)}));return function(){return _setAsLandingPageIfChecked.apply(this,arguments)}}()},{key:"autoShareEmbeddedComponents",value:function(){var _autoShareEmbeddedComponents=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee2(){var component,shareableEmbeddedComponents,componentsWithoutSharesExpansion,_iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,embeddedComponent,_iteratorNormalCompletion3,_didIteratorError3,_iteratorError3,_iterator3,_step3,share,componentHasShare,componentIsSharedToAll,_this5=this;return regenerator_default.a.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(component=this.state.component,shareableEmbeddedComponents=bundle_module.q.chain(component.getEmbeddedEntities()).uniq("id").filter(function(entity){return entity.isEditable&&entity.isEditable(_this5.app)&&_this5.app.cache.has(entity.constructor,entity.id)}).map(function(comp){return _this5.app.cache.get(comp.constructor,comp.id)}).value(),!(componentsWithoutSharesExpansion=shareableEmbeddedComponents.filter(function(comp){return!comp._expansions||!comp._expansions.shares})).length){_context2.next=6;break}return _context2.next=6,Promise.all(componentsWithoutSharesExpansion.map(function(comp){return comp.reload(_this5.app,{shares:!0})}));case 6:_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0,_context2.prev=9,_iterator=shareableEmbeddedComponents[Symbol.iterator]();case 11:if(_iteratorNormalCompletion=(_step=_iterator.next()).done){_context2.next=35;break}for(embeddedComponent=_step.value,_iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0,_context2.prev=16,_iterator3=component.shares[Symbol.iterator]();!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=!0)share=_step3.value,componentHasShare=bundle_module.q.findIndex(embeddedComponent.shares,{shareToId:share.shareToId})>=0,componentIsSharedToAll=bundle_module.q.findIndex(embeddedComponent.shares,{type:"all"})>=0,componentHasShare||componentIsSharedToAll||embeddedComponent.shares.push(share);_context2.next=24;break;case 20:_context2.prev=20,_context2.t0=_context2.catch(16),_didIteratorError3=!0,_iteratorError3=_context2.t0;case 24:_context2.prev=24,_context2.prev=25,_iteratorNormalCompletion3||null==_iterator3.return||_iterator3.return();case 27:if(_context2.prev=27,!_didIteratorError3){_context2.next=30;break}throw _iteratorError3;case 30:return _context2.finish(27);case 31:return _context2.finish(24);case 32:_iteratorNormalCompletion=!0,_context2.next=11;break;case 35:_context2.next=41;break;case 37:_context2.prev=37,_context2.t1=_context2.catch(9),_didIteratorError=!0,_iteratorError=_context2.t1;case 41:_context2.prev=41,_context2.prev=42,_iteratorNormalCompletion||null==_iterator.return||_iterator.return();case 44:if(_context2.prev=44,!_didIteratorError){_context2.next=47;break}throw _iteratorError;case 47:return _context2.finish(44);case 48:return _context2.finish(41);case 49:return _context2.abrupt("return",this.app.appService.shareComponents(shareableEmbeddedComponents).then(function(r){var _iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=shareableEmbeddedComponents[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var updatedComponent=_step2.value;_this5.app.updateCollections(updatedComponent,"",!1)}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{_iteratorNormalCompletion2||null==_iterator2.return||_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}return r}));case 50:case"end":return _context2.stop()}},_callee2,this,[[9,37,41,49],[16,20,24,32],[25,,27,31],[42,,44,48]])}));return function(){return _autoShareEmbeddedComponents.apply(this,arguments)}}()},{key:"_closePopover",value:function(){ui_core_build_bundle_module.P.closeAll()}},{key:"render",value:function(){var _this6=this,_this$props=this.props,canAutoShareComponents=_this$props.canAutoShareComponents,canSetAsLandingPage=_this$props.canSetAsLandingPage,_this$state2=this.state,autoShareComponents=_this$state2.autoShareComponents,forcePushLandingPage=_this$state2.forcePushLandingPage,sharing=_this$state2.sharing,component=_this$state2.component,availableTags=this.availableTags,availableShares=this.availableShares;return react_default.a.createElement("div",{className:"anw-ShareComponentDialog"},react_default.a.createElement("div",{className:"anw-ShareComponentDialog-form"},react_default.a.createElement(ui_core_build_bundle_module.u,{label:Object(l10nify_build_bundle_module.a)("Name")},react_default.a.createElement(ui_core_build_bundle_module.n,{defaultValue:component.name,onChange:function(e){return component.name=e.currentTarget.value},placeholder:Object(l10nify_build_bundle_module.a)("Name")})),react_default.a.createElement(ui_core_build_bundle_module.u,{label:Object(l10nify_build_bundle_module.a)("Description")},react_default.a.createElement(ui_core_build_bundle_module.n,{defaultValue:component.description,onChange:function(e){return component.description=e.currentTarget.value},placeholder:Object(l10nify_build_bundle_module.a)("Description")})),react_default.a.createElement(ui_core_build_bundle_module.u,{label:Object(l10nify_build_bundle_module.a)("Tags")},react_default.a.createElement(ui_core_build_bundle_module.W,{multi:!0,size:"block",searchable:!0,icon:"tag",clearable:!0,hideArrow:!1,value:component.tags,options:availableTags,isLoading:!availableTags.length,placeholder:Object(l10nify_build_bundle_module.a)("Add Tags"),labelKey:"name",valueKey:"id",allowCreate:!0,newOptionCreator:function(value){return new build_bundle_module.oc({name:value})},onChange:function(tags){component.tags=tags||[],_this6.forceUpdate()}})),react_default.a.createElement(ui_core_build_bundle_module.u,{label:Object(l10nify_build_bundle_module.a)("Recipients")},react_default.a.createElement(ui_core_build_bundle_module.W,{multi:!0,size:"block",searchable:!0,icon:"share",clearable:!0,hideArrow:!1,value:component.shares,options:availableShares,isLoading:!availableShares.length,placeholder:Object(l10nify_build_bundle_module.a)("Add Recipients"),labelKey:"name",valueKey:"shareToId",groupKey:"type",groupLabelMappings:{group:Object(l10nify_build_bundle_module.a)("Group"),user:Object(l10nify_build_bundle_module.a)("User"),all:Object(l10nify_build_bundle_module.a)("Organization")},allowCreate:!1,onChange:function(shares){component.shares=shares||[],_this6.forceUpdate()}})),(canAutoShareComponents||canSetAsLandingPage)&&react_default.a.createElement(ui_core_build_bundle_module.u,{label:Object(l10nify_build_bundle_module.a)("Other Options"),tooltip:react_default.a.createElement("div",null,Object(l10nify_build_bundle_module.a)("These options are singular actions at the time of sharing. They do not persist to future recipients added to the shared project. To ensure future recipients receive these options, return to this sharing screen and re-select the desired options again. "),react_default.a.createElement(ui_core_build_bundle_module.F,{target:"_blank",href:"https://experiencecloud.adobe.com/resources/help/".concat(l10nify_build_bundle_module.a.config.currentLocale,"/analytics/analysis-workspace/curate.html")},Object(l10nify_build_bundle_module.a)("Learn More")))},canAutoShareComponents&&react_default.a.createElement(ui_core_build_bundle_module.k,{label:Object(l10nify_build_bundle_module.a)("Automatically Share Embedded Components with Recipients"),checked:autoShareComponents,onChange:function(e){return _this6.setState({autoShareComponents:e.target.checked})},"data-test-id":"share-embedded-components"}),canSetAsLandingPage&&react_default.a.createElement(ui_core_build_bundle_module.k,{label:Object(l10nify_build_bundle_module.a)("Set as Landing Page for Recipients"),checked:forcePushLandingPage,onChange:function(e){return _this6.setState({forcePushLandingPage:e.target.checked})},"data-test-id":"set-as-landing-page"}))),react_default.a.createElement(ui_core_build_bundle_module.o.Footer,null,react_default.a.createElement(ui_core_build_bundle_module.f,{label:Object(l10nify_build_bundle_module.a)("Cancel"),onClick:this.onCancel.bind(this)}),react_default.a.createElement(ui_core_build_bundle_module.f,{variant:"primary",label:this.state.componentIsAlreadyShared?Object(l10nify_build_bundle_module.a)("Update"):Object(l10nify_build_bundle_module.a)("Share"),disabled:!component.shares.length||!component.name,onClick:this.onShare.bind(this)})),sharing&&react_default.a.createElement(ui_core_build_bundle_module.qb,{variant:"overlay"}))}},{key:"availableTags",get:function(){var _this$state3=this.state,tags=_this$state3.tags,component=_this$state3.component;return(tags=tags||[]).filter(function(tag){var selected=!1;return component.tags.forEach(function(selectedTag){selectedTag.name===tag.name&&(selected=!0)}),!selected})}},{key:"availableShares",get:function(){var component=this.state.component,users=this.state.users||[],groups=this.state.groups||[];return groups.length&&(groups=groups.concat(new build_bundle_module.vc({id:"1",name:Object(l10nify_build_bundle_module.a)("All")}))),users.concat(groups).map(function(item){var shareToType="all";return item instanceof build_bundle_module.uc?shareToType="user":"1"!==item.id&&(shareToType="group"),new build_bundle_module.lc({shareToId:item.id,name:item.name,type:shareToType})}).filter(function(share){var selected=!1;return component.shares.forEach(function(selectedShare){selectedShare.shareToId===share.shareToId&&(selected=!0)}),!selected})}}],[{key:"show",value:function(props){ui_core_build_bundle_module.o.show(react_default.a.createElement(ShareComponentDialog,bundle_module.q.omit(props,["title"])),{title:props.title||Object(l10nify_build_bundle_module.a)("Share Component"),closeOnClickOutside:!1})}}]),ShareComponentDialog}(ui_build_bundle_module.d)),NewProjectDialog_NewProjectDialog=(__webpack_require__(852),function(_AppComponent){function NewProjectDialog(props,context){var _this;Object(classCallCheck.a)(this,NewProjectDialog),_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(NewProjectDialog).call(this,props,context));props.project;return _this.state={name:props.project.name,description:props.project.description,tags:props.project.tags,saving:!1},_this}return Object(inherits.a)(NewProjectDialog,_AppComponent),Object(createClass.a)(NewProjectDialog,null,[{key:"propTypes",get:function(){return{project:ui_core_build_bundle_module.R.object.isRequired,onSuccess:ui_core_build_bundle_module.R.func,onFailure:ui_core_build_bundle_module.R.func,saveLabel:ui_core_build_bundle_module.R.string}}},{key:"defaultProps",get:function(){return{onSuccess:function(){},onFailure:function(){},saveLabel:Object(l10nify_build_bundle_module.a)("Save Project")}}}]),Object(createClass.a)(NewProjectDialog,[{key:"onCancel",value:function(){this.setState({tags:[]}),this._closePopover()}},{key:"onSave",value:function(){var _this2=this,_this$props=this.props,project=_this$props.project,onSuccess=_this$props.onSuccess,onFailure=_this$props.onFailure,_this$state=this.state,name=_this$state.name,description=_this$state.description,tags=_this$state.tags;project.name=name,project.description=description,project.tags=tags,this.setState({saving:!0}),this.app.repo.save(project).then(function(){onSuccess(project),_this2._closePopover()}).catch(function(err){onFailure(project),_this2._closePopover()})}},{key:"checkEnterPressed",value:function(e){e.keyCode===ui_build_bundle_module.H.ENTER&&this.state.name&&this.onSave()}},{key:"_closePopover",value:function(){ui_core_build_bundle_module.P.closeAll()}},{key:"render",value:function(){var _this3=this,_this$props2=this.props,saveLabel=_this$props2.saveLabel,_this$state2=(_this$props2.project,this.state),name=_this$state2.name,description=_this$state2.description,tags=_this$state2.tags,saving=_this$state2.saving;return react_default.a.createElement("div",{className:"anw-NewProjectDialog"},react_default.a.createElement(ui_core_build_bundle_module.u,{label:Object(l10nify_build_bundle_module.a)("Project Name")},react_default.a.createElement(ui_core_build_bundle_module.n,{value:name,onChange:function(e){return _this3.setState({name:e.currentTarget.value})},placeholder:Object(l10nify_build_bundle_module.a)("Project Name"),className:"anw-NewProjectDialog-nameTextField","data-test-id":"NewProjectDialog-project-name-input",autoFocus:!0,onKeyDown:this.checkEnterPressed.bind(this)})),react_default.a.createElement(ui_core_build_bundle_module.u,{label:Object(l10nify_build_bundle_module.a)("Project Description")},react_default.a.createElement(ui_core_build_bundle_module.n,{value:description,onChange:function(e){return _this3.setState({description:e.currentTarget.value})},placeholder:Object(l10nify_build_bundle_module.a)("Project Description"),onKeyDown:this.checkEnterPressed.bind(this)})),react_default.a.createElement(ui_core_build_bundle_module.u,{label:Object(l10nify_build_bundle_module.a)("Tags")},react_default.a.createElement(ui_build_bundle_module.v,{variant:"quiet",value:tags||[],onChange:function(tags){_this3.setState({tags:tags}),_this3.forceUpdate()}})),react_default.a.createElement(ui_core_build_bundle_module.o.Footer,null,react_default.a.createElement(ui_core_build_bundle_module.f,{label:Object(l10nify_build_bundle_module.a)("Cancel"),onClick:this.onCancel.bind(this)}),react_default.a.createElement(ui_core_build_bundle_module.f,{variant:"primary","data-test-id":"NewProjectDialog-save-button",label:saveLabel,disabled:!name,onClick:this.onSave.bind(this)})),saving&&react_default.a.createElement(ui_core_build_bundle_module.qb,{variant:"overlay"}))}}],[{key:"show",value:function(props){var propsTitle=props.title||Object(l10nify_build_bundle_module.a)("New Project");ui_core_build_bundle_module.o.show(react_default.a.createElement(NewProjectDialog,props),{title:propsTitle,closeOnClickOutside:!1})}}]),NewProjectDialog}(ui_build_bundle_module.d));__webpack_require__(853);function LinkToProjectDialog_templateObject(){var data=Object(taggedTemplateLiteral.a)(["Copy and share this link to send others directly to this ",". Users will be required to log in."]);return LinkToProjectDialog_templateObject=function(){return data},data}var LinkToProjectDialog_LinkToProjectDialog=function(_AppComponent){function LinkToProjectDialog(props,context){var _this;return Object(classCallCheck.a)(this,LinkToProjectDialog),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(LinkToProjectDialog).call(this,props,context))).state={weeURL:"",copied:!1},_this}return Object(inherits.a)(LinkToProjectDialog,_AppComponent),Object(createClass.a)(LinkToProjectDialog,null,[{key:"propTypes",get:function(){return{project:ui_core_build_bundle_module.R.object.isRequired}}}]),Object(createClass.a)(LinkToProjectDialog,[{key:"componentDidMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(LinkToProjectDialog.prototype),"componentDidMount",this).call(this),this.state.weeURL||this._initialize()}},{key:"_initialize",value:function(){var _initialize2=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(){var _this$props,project,subPanelId,panelId,queryParams,weeUrlResponse;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _this$props=this.props,project=_this$props.project,subPanelId=_this$props.subPanelId,panelId=_this$props.panelId,queryParams={projectId:project.id},subPanelId&&(queryParams.subPanelId=subPanelId),panelId&&(queryParams.panelId=panelId),_context.next=6,this.app.appService.post("/weeurls",{url:this.app.omnitureUrl.switchspa("workspace",queryParams)});case 6:weeUrlResponse=_context.sent,this.setState({weeURL:weeUrlResponse.data.shortUrl});case 8:case"end":return _context.stop()}},_callee,this)}));return function(){return _initialize2.apply(this,arguments)}}()},{key:"onCopy",value:function(){var inpt=react_dom_default.a.findDOMNode(this).querySelector(".anw-LinkToProjectDialog-input");inpt.select(),document.execCommand("copy"),inpt.blur(),ui_core_build_bundle_module.lb.trackAction(null,"Copy Deep Link"),this.setState({copied:!0})}},{key:"render",value:function(){return react_default.a.createElement("div",{className:"anw-LinkToProjectDialog"},react_default.a.createElement("p",null,Object(l10nify_build_bundle_module.a)(LinkToProjectDialog_templateObject(),this.linkObjectLabel)),react_default.a.createElement("input",{type:"text",className:"coral-Textfield anw-LinkToProjectDialog-input",readOnly:!0,defaultValue:this.state.weeURL}),this.state.copied?react_default.a.createElement(ui_core_build_bundle_module.f,{className:"anw-LinkToProjectDialog-button",variant:"primary",disabled:!0},react_default.a.createElement(ui_core_build_bundle_module.C,{"data-test-id":"link-to-dialog-checkmark-icon",icon:"check",size:"S"})):react_default.a.createElement(ui_core_build_bundle_module.f,{className:"anw-LinkToProjectDialog-button",variant:"primary",onClick:this.onCopy.bind(this)},Object(l10nify_build_bundle_module.a)("Copy")),!this.state.weeURL&&react_default.a.createElement(ui_core_build_bundle_module.qb,{"data-test-id":"link-to-dialog-wait",variant:"overlay"}))}},{key:"linkObjectLabel",get:function(){return this.props.subPanelId?Object(l10nify_build_bundle_module.a)("visualization"):this.props.panelId?Object(l10nify_build_bundle_module.a)("panel"):Object(l10nify_build_bundle_module.a)("project")}}],[{key:"show",value:function(props){ui_core_build_bundle_module.o.show(react_default.a.createElement(LinkToProjectDialog,props),{title:Object(l10nify_build_bundle_module.a)("Share Link")})}}]),LinkToProjectDialog}(ui_build_bundle_module.d),CreateProjectModal=__webpack_require__(777),_100_stacked_graph_option=(__webpack_require__(854),__webpack_require__(855)),_100_stacked_graph_option_default=__webpack_require__.n(_100_stacked_graph_option),access_this_project_faster=__webpack_require__(856),access_this_project_faster_default=__webpack_require__.n(access_this_project_faster),add_dropdown_filters=__webpack_require__(857),add_dropdown_filters_default=__webpack_require__.n(add_dropdown_filters),add_summary_visualizations=__webpack_require__(858),add_summary_visualizations_default=__webpack_require__.n(add_summary_visualizations),add_visual_context_to_data_tables=__webpack_require__(859),add_visual_context_to_data_tables_default=__webpack_require__.n(add_visual_context_to_data_tables),added_control_for_column_percentages=__webpack_require__(860),added_control_for_column_percentages_default=__webpack_require__.n(added_control_for_column_percentages),attribution_iq_in_calculated_metrics=__webpack_require__(861),attribution_iq_in_calculated_metrics_default=__webpack_require__.n(attribution_iq_in_calculated_metrics),attribution_iq_in_freeform_tables=__webpack_require__(862),attribution_iq_in_freeform_tables_default=__webpack_require__.n(attribution_iq_in_freeform_tables),attribution_iq_panel=__webpack_require__(863),attribution_iq_panel_default=__webpack_require__.n(attribution_iq_panel),borrow_work_from_other_projects=__webpack_require__(864),borrow_work_from_other_projects_default=__webpack_require__.n(borrow_work_from_other_projects),bring_your_data_to_life=__webpack_require__(865),bring_your_data_to_life_default=__webpack_require__.n(bring_your_data_to_life),build_freeform_tables_faster=__webpack_require__(866),build_freeform_tables_faster_default=__webpack_require__.n(build_freeform_tables_faster),change_granularity_on_the_fly=__webpack_require__(867),change_granularity_on_the_fly_default=__webpack_require__.n(change_granularity_on_the_fly),convert_ad_hoc_analysis_projects=__webpack_require__(868),convert_ad_hoc_analysis_projects_default=__webpack_require__.n(convert_ad_hoc_analysis_projects),count_items_within_any_dimension=__webpack_require__(869),count_items_within_any_dimension_default=__webpack_require__.n(count_items_within_any_dimension),create_a_simpler_data_view=__webpack_require__(870),create_a_simpler_data_view_default=__webpack_require__.n(create_a_simpler_data_view),create_custom_date_ranges=__webpack_require__(871),create_custom_date_ranges_default=__webpack_require__.n(create_custom_date_ranges),create_in_context_alerts=__webpack_require__(872),create_in_context_alerts_default=__webpack_require__.n(create_in_context_alerts),create_metrics_on_the_fly=__webpack_require__(873),create_metrics_on_the_fly_default=__webpack_require__.n(create_metrics_on_the_fly),create_segments_on_the_fly=__webpack_require__(874),create_segments_on_the_fly_default=__webpack_require__.n(create_segments_on_the_fly),customize_your_color_palette=__webpack_require__(875),customize_your_color_palette_default=__webpack_require__.n(customize_your_color_palette),explore_anomalies_further=__webpack_require__(876),explore_anomalies_further_default=__webpack_require__.n(explore_anomalies_further),explore_why_visitors_fallout=__webpack_require__(877),explore_why_visitors_fallout_default=__webpack_require__.n(explore_why_visitors_fallout),focus_your_freeform_tables=(__webpack_require__(878),__webpack_require__(879)),focus_your_freeform_tables_default=__webpack_require__.n(focus_your_freeform_tables),generate_a_quick_trendline=__webpack_require__(880),generate_a_quick_trendline_default=__webpack_require__.n(generate_a_quick_trendline),how_do_these_segments_compare=__webpack_require__(881),how_do_these_segments_compare_default=__webpack_require__.n(how_do_these_segments_compare),integrate_search_engine_data=__webpack_require__(882),integrate_search_engine_data_default=__webpack_require__.n(integrate_search_engine_data),link_to_a_specific_project=__webpack_require__(883),link_to_a_specific_project_default=__webpack_require__.n(link_to_a_specific_project),link_to_a_specific_visualization=__webpack_require__(884),link_to_a_specific_visualization_default=__webpack_require__.n(link_to_a_specific_visualization),map_changes_in_behavior=__webpack_require__(885),map_changes_in_behavior_default=__webpack_require__.n(map_changes_in_behavior),measure_audio_consumption=__webpack_require__(886),measure_audio_consumption_default=__webpack_require__.n(measure_audio_consumption),measure_progress_to_goal=__webpack_require__(887),measure_progress_to_goal_default=__webpack_require__.n(measure_progress_to_goal),mr_2018_06=__webpack_require__(888),mr_2018_06_default=__webpack_require__.n(mr_2018_06),navigate_workspace_faster=__webpack_require__(889),navigate_workspace_faster_default=__webpack_require__.n(navigate_workspace_faster),put_your_data_in_perspective=__webpack_require__(890),put_your_data_in_perspective_default=__webpack_require__.n(put_your_data_in_perspective),search_components_by_tags=__webpack_require__(891),search_components_by_tags_default=__webpack_require__.n(search_components_by_tags),set_workspace_as_your_landing_page=__webpack_require__(892),set_workspace_as_your_landing_page_default=__webpack_require__.n(set_workspace_as_your_landing_page),simplify_with_column_settings=__webpack_require__(893),simplify_with_column_settings_default=__webpack_require__.n(simplify_with_column_settings),sneak_peek_components=__webpack_require__(894),sneak_peek_components_default=__webpack_require__.n(sneak_peek_components),speed_up_your_breakdowns=__webpack_require__(895),speed_up_your_breakdowns_default=__webpack_require__.n(speed_up_your_breakdowns),submit_srupport_tickets_in_the_ui=__webpack_require__(896),submit_srupport_tickets_in_the_ui_default=__webpack_require__.n(submit_srupport_tickets_in_the_ui),tell_a_data_story_with_text_boxes=__webpack_require__(897),tell_a_data_story_with_text_boxes_default=__webpack_require__.n(tell_a_data_story_with_text_boxes),trend_your_fallout_visualization=__webpack_require__(898),trend_your_fallout_visualization_default=__webpack_require__.n(trend_your_fallout_visualization),unsure_where_to_begin=__webpack_require__(899),unsure_where_to_begin_default=__webpack_require__.n(unsure_where_to_begin),validate_your_implementation=__webpack_require__(900),validate_your_implementation_default=__webpack_require__.n(validate_your_implementation),view_distribution_with_histograms=__webpack_require__(901),view_distribution_with_histograms_default=__webpack_require__.n(view_distribution_with_histograms),view_overlap_with_venn_diagrams=__webpack_require__(902),view_overlap_with_venn_diagrams_default=__webpack_require__.n(view_overlap_with_venn_diagrams),visualize_fallout_across_segments=__webpack_require__(903),visualize_fallout_across_segments_default=__webpack_require__.n(visualize_fallout_across_segments),when_in_doubt_right_click=__webpack_require__(904),when_in_doubt_right_click_default=__webpack_require__.n(when_in_doubt_right_click),debug_workspace=__webpack_require__(905),debug_workspace_default=__webpack_require__.n(debug_workspace),retention_analysis_cohort_table=__webpack_require__(906),retention_analysis_cohort_table_default=__webpack_require__.n(retention_analysis_cohort_table),latency_cohort_table=__webpack_require__(907),latency_cohort_table_default=__webpack_require__.n(latency_cohort_table),churn_analysis_cohort_table=__webpack_require__(908),churn_analysis_cohort_table_default=__webpack_require__.n(churn_analysis_cohort_table),retention_by_any_dimension=__webpack_require__(909),retention_by_any_dimension_default=__webpack_require__.n(retention_by_any_dimension),rolling_calculation_cohort=__webpack_require__(910),rolling_calculation_cohort_default=__webpack_require__.n(rolling_calculation_cohort),view_density=__webpack_require__(911),view_density_default=__webpack_require__.n(view_density),newReleaseTips=[{title:Object(l10nify_build_bundle_module.a)("New Analytics Features"),id:"MR-2019-06",body:Object(l10nify_build_bundle_module.a)("We recently released new & improved features in Adobe Analytics, including: \n * 'Equals Any Of' segment operator \n * Dimension models in segmentation \n * New out-of-the-box component tags \n * Post-processing view in the debugger"),link:"https://www.youtube.com/playlist?list=PL2tCx83mn7GtR_rB9gkr-woyN_zJjbrxl",img:mr_2018_06_default.a}],tips=[{title:Object(l10nify_build_bundle_module.a)("View More Data in a Single Screen"),body:Object(l10nify_build_bundle_module.a)("Change your project's view density under **Project Info & Settings** to see more rows of data in tables & more components in the left rail."),id:"view-density",link:"https://www.youtube.com/watch?v=Qlvu5_RNBzs",img:view_density_default.a},{title:Object(l10nify_build_bundle_module.a)("Calculate Rolling Retention or Churn"),body:Object(l10nify_build_bundle_module.a)("Use Rolling Calculation to analyze period-over-period cohorts to understand how the same users are retained (or churn) over time."),id:"rolling-calculation",link:"https://www.youtube.com/watch?v=-dyDHDk6pAM",img:rolling_calculation_cohort_default.a},{title:Object(l10nify_build_bundle_module.a)("Retention Analysis by Any Dimension"),body:Object(l10nify_build_bundle_module.a)("Cohorts can be defined by dimensions other than time. Try campaign or city to take your retention (or churn) analysis even further."),id:"retention-analysis-any-dimension",link:"https://www.youtube.com/watch?v=pg7qcMdKB6I",img:retention_by_any_dimension_default.a},{title:Object(l10nify_build_bundle_module.a)("Churn Analysis with Cohort Table"),body:Object(l10nify_build_bundle_module.a)("Cohort is equipped with the ability to track churn, so you can analyze how groups of users are falling out over time."),id:"churn-analysis-cohort-table",link:"https://www.youtube.com/watch?v=iukRbPknR-c",img:churn_analysis_cohort_table_default.a},{title:Object(l10nify_build_bundle_module.a)("Latency Analysis with Cohort Tables"),body:Object(l10nify_build_bundle_module.a)("Want to see the impact of a new product launch? Use the Latency Table setting in Cohort to analyze pre/post behavior for a defined cohort."),id:"latency-analysis-cohort",link:"https://www.youtube.com/watch?v=PXUfd06pnD4",img:latency_cohort_table_default.a},{title:Object(l10nify_build_bundle_module.a)("Retention Analysis with Cohort Tables"),body:Object(l10nify_build_bundle_module.a)("Cohort is equipped with the ability to track retention, so you can analyze how groups of users are retained over time."),id:"retention-analysis-cohort",link:"https://www.youtube.com/watch?v=bcWIZR7fXAg",img:retention_analysis_cohort_table_default.a},{title:Object(l10nify_build_bundle_module.a)("Adobe Analytics 2.0 API"),body:Object(l10nify_build_bundle_module.a)("You can debug Analysis Workspace to learn how to easily write Analytics 2.0 API requests."),id:"debug-analysis-workspace",link:"https://www.youtube.com/watch?v=j1kI3peSXhY",img:debug_workspace_default.a},{title:Object(l10nify_build_bundle_module.a)("Measure Audio Consumption"),body:Object(l10nify_build_bundle_module.a)("Connect listeners' streaming audio engagement with their full digital behavior using the Audio Consumption template."),id:"measure-audio-consumption",link:"https://www.youtube.com/watch?v=nHbDVvwRnQw",img:measure_audio_consumption_default.a},{title:Object(l10nify_build_bundle_module.a)("Create Custom Date Ranges"),body:Object(l10nify_build_bundle_module.a)("Create & save meaningful date ranges for your organization using the Date Range builder. E.g. run dates for a specific campaign."),id:"create-custom-date-ranges",link:"https://www.youtube.com/watch?v=PLqa3Q0GDLo",img:create_custom_date_ranges_default.a},{title:Object(l10nify_build_bundle_module.a)("Attribution IQ in Freeform Tables"),body:Object(l10nify_build_bundle_module.a)("You can change the attribution model of a metric by clicking on the settings for that metric and enabling a non-standard attribution model."),id:"attribution-iq-in-freeform-tables",link:"https://www.youtube.com/watch?v=aYbGcQvAN1E",img:attribution_iq_in_freeform_tables_default.a},{title:Object(l10nify_build_bundle_module.a)("Attribution IQ Panel"),body:Object(l10nify_build_bundle_module.a)("The attribution panel is a great starting point for attribution analysis. Find it in the left rail under **Panels.**"),id:"attribution-iq-panel",link:"https://www.youtube.com/watch?v=Yu0hy2klzA0",img:attribution_iq_panel_default.a},{title:Object(l10nify_build_bundle_module.a)("Attribution IQ in Calculated Metrics"),body:Object(l10nify_build_bundle_module.a)("You can apply attribution models in calculated metrics by clicking on the settings for any metric and enabling a non-standard attribution model."),id:"attribution-iq-in-calculated-metrics",link:"https://www.youtube.com/watch?v=XlmV5gfk1h8",img:attribution_iq_in_calculated_metrics_default.a},{title:Object(l10nify_build_bundle_module.a)("Customize Your Color Palette"),body:Object(l10nify_build_bundle_module.a)("Give your project its own look-and-feel or use your brand colors by creating a custom color palette under **Project Info & Settings.**"),id:"customize-your-color-palette",link:"https://www.youtube.com/watch?v=YbhqE_6rIUQ",img:customize_your_color_palette_default.a},{title:Object(l10nify_build_bundle_module.a)("Add Dropdown Filters"),body:Object(l10nify_build_bundle_module.a)("Create an interactive project with dropdown filters that enable users to seamlessly change their data view."),id:"add-dropdown-filters",link:"https://www.youtube.com/watch?v=vpJywtsFVPI",img:add_dropdown_filters_default.a},{title:Object(l10nify_build_bundle_module.a)("Search Components by Tags"),body:Object(l10nify_build_bundle_module.a)("Type # into the component search bar to filter by tags and find the components you need more easily."),id:"search-components-by-tags",link:"https://www.youtube.com/watch?v=v7b9ErxnXWE",img:search_components_by_tags_default.a},{title:Object(l10nify_build_bundle_module.a)("Validate Your Implementation"),body:Object(l10nify_build_bundle_module.a)("Auditor is a free product that lets you scan, understand, and improve your Analytics implementation for cleaner data, and sound insights."),id:"validate-your-implementation",link:"https://theblog.adobe.com/meet-auditor-scan-understand-improve-adobe-implementation/",img:validate_your_implementation_default.a},{title:Object(l10nify_build_bundle_module.a)("Added Control for Column Percentages"),body:Object(l10nify_build_bundle_module.a)("Percentages in freeform tables can be based on the total of a column or row. Under Row Settings, you can choose the view that works best."),id:"added-control-for-column-percentages",link:"https://www.youtube.com/watch?v=n2LbPQlkUX0",img:added_control_for_column_percentages_default.a},{title:Object(l10nify_build_bundle_module.a)("Convert Ad Hoc Analysis Projects"),body:Object(l10nify_build_bundle_module.a)("The Ad Hoc Analysis Project converter allows you to convert projects to Analysis Workspace with the click of a button."),id:"convert-ad-hoc-analysis-projects",link:"https://www.youtube.com/watch?v=Gy1q2RzqoUU",img:convert_ad_hoc_analysis_projects_default.a},{title:Object(l10nify_build_bundle_module.a)("Visualize Fallout Across Segments"),body:Object(l10nify_build_bundle_module.a)("Drag and drop unlimited segments to the Fallout visualization legend to visualize journeys across key visitor groups."),id:"visualize-fallout-across-segments",link:"https://www.youtube.com/watch?v=92WNiQSTsYs",img:visualize_fallout_across_segments_default.a},{title:Object(l10nify_build_bundle_module.a)("Borrow Work from Other Projects"),body:Object(l10nify_build_bundle_module.a)("Right-click on any visualization/panel to copy it, then insert it into a new project. Don't forget, Templates can be a great resource."),id:"borrow-work-from-other-projects",link:"https://www.youtube.com/watch?v=bwwo8v_TC1E",img:borrow_work_from_other_projects_default.a},{title:Object(l10nify_build_bundle_module.a)("View Overlap with Venn Diagrams"),body:Object(l10nify_build_bundle_module.a)("Venn Diagrams allow you to visualize the overlap of 3 segments for a given metric. Unhide the source table to analyze even further."),id:"view-overlap-with-venn-diagrams",link:"https://www.youtube.com/watch?v=M6L8mpcZ-HU",img:view_overlap_with_venn_diagrams_default.a},{title:Object(l10nify_build_bundle_module.a)("View Distribution with Histograms"),body:Object(l10nify_build_bundle_module.a)("Histograms allow you to see the distribution of a metric across visitors, visits, and hits. Unhide the source table to analyze even further."),id:"view-distribution-with-histograms",link:"https://www.youtube.com/watch?v=2aoVeHvJ0bY",img:view_distribution_with_histograms_default.a},{title:Object(l10nify_build_bundle_module.a)("Tell a Data Story with Text Boxes"),body:Object(l10nify_build_bundle_module.a)("Add a text box or description to your panel to provide context about your analysis. Rich text options, including hyperlinks, are available."),id:"tell-a-data-story-with-text-boxes",link:"https://www.youtube.com/watch?v=EmcBOYLQVb0",img:tell_a_data_story_with_text_boxes_default.a},{title:Object(l10nify_build_bundle_module.a)("Access This Project Faster"),body:Object(l10nify_build_bundle_module.a)("Start your analysis more quickly by setting this project as your Analytics landing page (Shift + Ctrl + L)"),id:"access-this-project-faster",link:"https://www.youtube.com/watch?v=BEEUpl1Sw0g",img:access_this_project_faster_default.a},{title:Object(l10nify_build_bundle_module.a)("Speed up Your Breakdowns"),body:Object(l10nify_build_bundle_module.a)("Highlight multiple rows in a freeform table and drag in another dimension to breakdown many items at once."),id:"speed-up-your-breakdowns",link:"https://www.youtube.com/watch?v=3mQ2HN7-lIc",img:speed_up_your_breakdowns_default.a},{title:Object(l10nify_build_bundle_module.a)("When in Doubt, Right-click"),body:Object(l10nify_build_bundle_module.a)("Many contextual actions are available in the right-click menu, such as comparing dates or adding a visualization. Start exploring!"),id:"when-in-doubt-right-click",link:"https://www.youtube.com/watch?v=fiUU5oIdQO4\nhttps://www.youtube.com/watch?v=uOpfBWtLIMs",img:when_in_doubt_right_click_default.a},{title:Object(l10nify_build_bundle_module.a)("Navigate Workspace Faster"),body:Object(l10nify_build_bundle_module.a)("Use keyboard shortcuts to more quickly execute in Analysis Workspace, such as **Ctrl + Z** to undo your last action."),id:"navigate-workspace-faster",link:"https://www.youtube.com/watch?v=DPKwNfABBII",img:navigate_workspace_faster_default.a},{title:Object(l10nify_build_bundle_module.a)("Sneak Peek Components"),body:Object(l10nify_build_bundle_module.a)("Utilize the preview icon to understand a component before using it. Definitions, top items and last 90 trends are available."),id:"sneak-peek-components",link:"https://www.youtube.com/watch?v=HgM-zw1bmF8",img:sneak_peek_components_default.a},{title:Object(l10nify_build_bundle_module.a)("Build Freeform Tables Faster"),body:Object(l10nify_build_bundle_module.a)("Highlight multiple components in the left rail at once and drag them into a table to quickly analyze your data."),id:"build-freeform-tables-faster",link:"https://www.youtube.com/watch?v=lCfFiteIDhc",img:build_freeform_tables_faster_default.a},{title:Object(l10nify_build_bundle_module.a)("Put Your Data in Perspective"),body:Object(l10nify_build_bundle_module.a)("Right-click on any column and select **Compare Time Periods** to quickly compare your data with historical performance."),id:"put-your-data-in-perspective",link:"https://www.youtube.com/watch?v=YfKUaPyzGro",img:put_your_data_in_perspective_default.a},{title:Object(l10nify_build_bundle_module.a)("Create Segments On-the-fly"),body:Object(l10nify_build_bundle_module.a)("The fastest way to create and apply a segment to a project is to drop any component from the left rail directly into the segment drop zone."),id:"create-segments-on-the-fly",link:"https://www.youtube.com/watch?v=UemQ-ugfkz4",img:create_segments_on_the_fly_default.a},{title:Object(l10nify_build_bundle_module.a)("Bring Your Data to Life"),body:Object(l10nify_build_bundle_module.a)("Add in a visualization to your project from the left rail, the right-click menu, or simply click the **Visualize** icon within any row of data. "),id:"bring-your-data-to-life",link:"https://www.youtube.com/watch?v=b1zLEywRa6w",img:bring_your_data_to_life_default.a},{title:Object(l10nify_build_bundle_module.a)("Generate a Quick Trendline"),body:Object(l10nify_build_bundle_module.a)("The easiest way to add a trendline to a project is to click the **Visualize** icon in any Freeform Table row. "),id:"generate-a-quick-trendline",link:"https://www.youtube.com/watch?v=kzlPjsBVYFQ",img:generate_a_quick_trendline_default.a},{title:Object(l10nify_build_bundle_module.a)("Create a Simpler Data View"),body:Object(l10nify_build_bundle_module.a)("Curate a project (or a Virtual Report Suite) before sharing data to a colleague to create a simplified dataset for them to work with."),id:"create-a-simpler-data-view",link:"https://www.youtube.com/watch?v=LJJRskdmlOg",img:create_a_simpler_data_view_default.a},{title:Object(l10nify_build_bundle_module.a)("Link to a Specific Project"),body:Object(l10nify_build_bundle_module.a)("The best way to ensure the same story is being told is to use the same data. Share a link to this project from the **Share** menu (Atl + L)"),id:"link-to-a-specific-project",link:"https://www.youtube.com/watch?v=6IOEewflG2U",img:link_to_a_specific_project_default.a},{title:Object(l10nify_build_bundle_module.a)("Link to a Specific Visualization"),body:Object(l10nify_build_bundle_module.a)("Point your colleague to a specific visualization within a project. Right-click any header and select **Get Link to Visualization/Panel**."),id:"link-to-a-specific-visualization",link:"https://www.youtube.com/watch?v=lvmAdKNfWQw",img:link_to_a_specific_visualization_default.a},{title:Object(l10nify_build_bundle_module.a)("Count Items Within Any Dimension"),body:Object(l10nify_build_bundle_module.a)("Create a calculated metric using the **Approximate Count Distinct** function to get a unique count of items within any dimension. "),id:"count-items-within-any-dimension",link:"https://www.youtube.com/watch?v=80YYjKfHpHw",img:count_items_within_any_dimension_default.a},{title:Object(l10nify_build_bundle_module.a)("Create Metrics On-the-Fly"),body:Object(l10nify_build_bundle_module.a)("Right-click on one or two metric columns to quickly add a new calculated metric to your freeform table."),link:"https://www.youtube.com/watch?v=ybbGlLriyqE",id:"create-metrics-on-the-fly",img:create_metrics_on_the_fly_default.a},{title:Object(l10nify_build_bundle_module.a)("Unsure Where to Begin?"),body:Object(l10nify_build_bundle_module.a)("Start your analysis more quickly by leveraging templates. Click New Project, then choose from pre-built Standard or Custom templates."),link:"https://www.youtube.com/watch?v=wO01PyW6bx",id:"unsure-where-to-begin",img:unsure_where_to_begin_default.a},{title:Object(l10nify_build_bundle_module.a)("Set Workspace as Your Landing Page"),body:Object(l10nify_build_bundle_module.a)("Get into your analysis workflow faster by setting Workspace as your Analytics landing page."),link:"https://www.youtube.com/watch?v=5wpuF2SZdJg",id:"set-workspace-as-your-landing-page",img:set_workspace_as_your_landing_page_default.a},{title:Object(l10nify_build_bundle_module.a)("How Do These Segments Compare?"),body:Object(l10nify_build_bundle_module.a)("Let us do the heavy lifting. Use a Segment Comparison panel to identify the most significant differences between two segments."),link:"https://www.youtube.com/watch?v=fO3PNB93U_w",id:"how-do-these-segments-compare",img:how_do_these_segments_compare_default.a},{title:Object(l10nify_build_bundle_module.a)("Simplify with Column Settings"),body:Object(l10nify_build_bundle_module.a)("Use column settings to simplify your freeform data tables. Percent, Interpret Zero as no value, and Background are a few available options."),link:"https://www.youtube.com/watch?v=1c2F4nqjOdM",id:"simplify-with-column-settings",img:simplify_with_column_settings_default.a},{title:Object(l10nify_build_bundle_module.a)("Add Visual Context to Data Tables"),body:Object(l10nify_build_bundle_module.a)("Data visualization extends beyond graphs. Enable Conditional Formatting in Column Settings to emphasize key metrics in your freeform tables."),link:"https://www.youtube.com/watch?v=1c2F4nqjOdM",id:"add-visual-context-to-data-tables",img:add_visual_context_to_data_tables_default.a},{title:Object(l10nify_build_bundle_module.a)("Add Summary Visualizations"),body:Object(l10nify_build_bundle_module.a)("Emphasize important data points with Summary Number and Summary Change visualizations. Right-click > Visualize to get started."),link:"https://www.youtube.com/watch?v=NDUynIJwTF8",id:"add-summary-visualizations",img:add_summary_visualizations_default.a},{title:Object(l10nify_build_bundle_module.a)("Focus Your Freeform Tables"),body:Object(l10nify_build_bundle_module.a)("Emphasize specific rows in your freeform tables using search filters. Equals, Contains any term, Ends With, and more are available."),link:"https://www.youtube.com/watch?v=QWztwLvfLzI",id:"focus-your-freeform-tables",img:focus_your_freeform_tables_default.a},{title:Object(l10nify_build_bundle_module.a)("100% Stacked Graph Option"),body:Object(l10nify_build_bundle_module.a)("Visualize parts-to-a-whole relationships overtime with the 100% Stacked setting, available for any stacked visualization."),link:"https://www.youtube.com/watch?v=_6hzCR1SCxk",id:"100-stacked-graph-option",img:_100_stacked_graph_option_default.a},{title:Object(l10nify_build_bundle_module.a)("Change Granularity On-the-Fly"),body:Object(l10nify_build_bundle_module.a)("Quickly change a trended graph from Daily to Weekly, or Weekly to Monthly, using the Granularity selector in Visualization Settings."),link:"https://www.youtube.com/watch?v=VtN4ww1FLVg",id:"change-granularity-on-the-fly",img:change_granularity_on_the_fly_default.a},{title:Object(l10nify_build_bundle_module.a)("Map Changes in Behavior"),body:Object(l10nify_build_bundle_module.a)("Use the Positive/Negative Map color theme to visually represent changes in behavior period-over-period."),link:"https://www.youtube.com/watch?v=0saxGk7DYTQ",id:"map-changes-in-behavior",img:map_changes_in_behavior_default.a},{title:Object(l10nify_build_bundle_module.a)("Trend Your Fallout Visualization"),body:Object(l10nify_build_bundle_module.a)("Right-click any Fallout touchpoint to trend the conversion rate for that touchpoint or all touchpoints at once."),link:"https://www.youtube.com/watch?v=92WNiQSTsYs",id:"trend-your-fallout-visualization",img:trend_your_fallout_visualization_default.a},{title:Object(l10nify_build_bundle_module.a)("Explore Why Visitors Fallout"),body:Object(l10nify_build_bundle_module.a)("Right-click any Fallout touchpoint and choose Breakdown fallout to view steps a visitor took instead of continuing to the next touchpoint."),link:"https://www.youtube.com/watch?v=VcrfHSyIoj8",id:"explore-why-visitors-fallout",img:explore_why_visitors_fallout_default.a},{title:Object(l10nify_build_bundle_module.a)("Create In-Context Alerts"),body:Object(l10nify_build_bundle_module.a)("Right-click and select Create alert from selection to stay informed on significant changes to your data."),link:"https://www.youtube.com/watch?v=UVH9xr_2REA",id:"create-in-context-alerts",img:create_in_context_alerts_default.a},{title:Object(l10nify_build_bundle_module.a)("Integrate Search Engine Data"),body:Object(l10nify_build_bundle_module.a)("Leverage Advertising Analytics to bring together search data from Google and Bing with Analytics data for cohesive search analysis."),link:"https://www.youtube.com/watch?v=SyEFcEtVroM",id:"integrate-search-engine-data",img:integrate_search_engine_data_default.a},{title:Object(l10nify_build_bundle_module.a)("Explore Anomalies Further"),body:Object(l10nify_build_bundle_module.a)("Anomaly detection automatically detects differences in your data. Use Contribution Analysis to explore the Why behind each anomaly surfaced. "),link:"https://www.youtube.com/watch?v=MbpeJIADtGk",id:"explore-anomalies-further",img:explore_anomalies_further_default.a},{title:Object(l10nify_build_bundle_module.a)("Measure Progress to Goal"),body:Object(l10nify_build_bundle_module.a)("Use a Bullet Graph to visualize progress toward a goal. Low, Medium, and High goal thresholds can be set."),link:"https://www.youtube.com/watch?v=MYl_uDDyL70",id:"measure-progress-to-goal",img:measure_progress_to_goal_default.a},{title:Object(l10nify_build_bundle_module.a)("Submit Support Tickets in the UI"),body:Object(l10nify_build_bundle_module.a)("Leverage the top-right Help menu to submit product feedback directly in the interface."),link:"https://www.youtube.com/watch?v=jN-sk2jJOos",id:"submit-srupport-tickets-in-the-ui",img:submit_srupport_tickets_in_the_ui_default.a}],timeToWaitBetweenShowingTipsInDays=7,TipOfTheDay_TipOfTheDay=function(_AppComponent){function TipOfTheDay(props,context){var _this;Object(classCallCheck.a)(this,TipOfTheDay),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(TipOfTheDay).call(this,props,context))).state={isOpen:!1};var allTips=[].concat(tips,Object(toConsumableArray.a)(newReleaseTips.map(function(t){return Object(objectSpread.a)({},t,{isNewReleaseTip:!0})})));return _this.tipsById=bundle_module.q.zipObject(allTips.map(function(tip){return tip.id}),allTips),_this.open=_this.open.bind(Object(assertThisInitialized.a)(_this)),_this.close=_this.close.bind(Object(assertThisInitialized.a)(_this)),_this.hideTip=_this.hideTip.bind(Object(assertThisInitialized.a)(_this)),_this.disableTips=_this.disableTips.bind(Object(assertThisInitialized.a)(_this)),_this}return Object(inherits.a)(TipOfTheDay,_AppComponent),Object(createClass.a)(TipOfTheDay,[{key:"componentDidMount",value:function(){var _this2=this;Object(esm_get.a)(Object(getPrototypeOf.a)(TipOfTheDay.prototype),"componentDidMount",this).call(this);try{window.adobeTools.debug.tipOfTheDayFastForward=function(){_this2.setPersistedState({currentTipId:void 0,lastTipClosedDate:Object(bundle_module.I)().subtract(timeToWaitBetweenShowingTipsInDays+1,"d").format()})}}catch(e){console.error("error setting up workspaces tips debug info")}this.observe(this.app.user.uiSettings,"change",function(){_this2.checkForTip(),_this2.setState({})}),this.checkForTip()}},{key:"disableTips",value:function(){TipOfTheDay.disableTips(this.app),this.setState({isOpen:!1}),this.app.addAlert({variant:"success",header:Object(l10nify_build_bundle_module.a)("Tips Disabled"),contents:Object(l10nify_build_bundle_module.a)("Tips can be enabled from the \u201cHelp\u201d menu within Workspace projects.")}),this.track("Tips: Disable Tips click",{fileMenu:!1})}},{key:"hideTip",value:function(e){(this.getTip()||{}).isNewReleaseTip;this.track("Tips: Close tip click"),this.setPersistedState({currentTipId:void 0,lastTipClosedDate:Object(bundle_module.I)().format()}),this.setState({isOpen:!1}),e.stopPropagation()}},{key:"checkForTip",value:function(){var state=this.getPersistedState(),daysSinceLastClose=Object(bundle_module.I)().diff(Object(bundle_module.I)(state.lastTipClosedDate),"days"),seenTipIds=new Set([state.seenTipIds].concat(Object(toConsumableArray.a)(state.seenReleaseTipIds)));if(!newReleaseTips.length||seenTipIds.has(newReleaseTips[0].id)){if(!state.currentTipId&&daysSinceLastClose>=timeToWaitBetweenShowingTipsInDays){var shuffledTipIds=bundle_module.q.shuffle(tips.map(function(tip){return tip.id})),unseenTipIds=shuffledTipIds.filter(function(id){return!seenTipIds.has(id)});if(unseenTipIds.length>0){var nextTipId=unseenTipIds[0];this.updateCurrentTip(nextTipId)}else this.updateCurrentTip(shuffledTipIds[0],!0)}}else{var releaseTipId=newReleaseTips[0].id;this.updateCurrentReleaseTip(releaseTipId)}}},{key:"updateCurrentReleaseTip",value:function(tipId){this.setPersistedState({currentTipId:tipId,seenReleaseTipIds:[].concat(Object(toConsumableArray.a)(this.getPersistedState().seenReleaseTipIds),[tipId])})}},{key:"updateCurrentTip",value:function(tipId){var seenTipIds=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?[tipId]:[].concat(Object(toConsumableArray.a)(this.getPersistedState().seenTipIds),[tipId]);this.setPersistedState({currentTipId:tipId,seenTipIds:seenTipIds})}},{key:"getPersistedState",value:function(){return TipOfTheDay.getState(this.app)}},{key:"setPersistedState",value:function(){var nextState=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};TipOfTheDay.setState(this.app,nextState)}},{key:"track",value:function(text){var additionalParams=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{ui_core_build_bundle_module.lb.trackAction(null,text,this.getTipTrackParams(additionalParams))}catch(e){bundle_module.H.error("There was a trackAction error",e)}return!0}},{key:"getTipTrackParams",value:function(additionalParams){var state=this.getPersistedState(),tip=this.tipsById[state.currentTipId];return tip?Object(objectSpread.a)({tipId:tip.id,tipTitle:tip.title},additionalParams):Object(objectSpread.a)({},additionalParams)}},{key:"open",value:function(){var _this3=this;this.state.isOpen||this.setState({isOpen:!0},function(){_this3.track("Tips: Expand tip")})}},{key:"close",value:function(){var _this4=this;this.state.isOpen&&this.setState({isOpen:!1},function(){_this4.track("Tips: Minimize tip")})}},{key:"navigate",value:function(to){var _this5=this;ui_core_build_bundle_module.sb.openExternalLink(to).then(function(){return _this5.track('Tips: Ok on "leaving this domain"')}).catch(function(){return _this5.track('Tips: Cancel on "leaving this domain"')})}},{key:"getTip",value:function(){var state=this.getPersistedState(),tip=this.tipsById[state.currentTipId],isNewReleaseTip=bundle_module.q.get(tip,"isNewReleaseTip",!1);return this.app.serverRender||state.disabled&&!isNewReleaseTip?null:tip||void 0}},{key:"render",value:function(){var _this6=this,tip=this.getTip();if(this.app.serverRender||!tip)return react_default.a.createElement("noscript",null);var styles={maxHeight:this.state.isOpen?800:0,backgroundColor:"white"};return react_default.a.createElement("div",{className:"TipOfTheDay-container",onMouseOver:this.open,onMouseLeave:this.close},react_default.a.createElement("img",{className:"preload-img",style:{display:"none"},src:tip.img}),react_default.a.createElement("div",{className:"TipOfTheDay-header"},react_default.a.createElement("p",{className:"TipOfTheDay-header-text"},!tip.isNewReleaseTip&&Object(l10nify_build_bundle_module.a)("Tip: "),tip.title),this.state.isOpen&&react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"close",size:"XS",className:"TipOfTheDay-close-icon",onClick:this.hideTip})),react_default.a.createElement("div",{className:"TipOfTheDay-animate-height",style:styles},react_default.a.createElement("img",{onClick:function(){return _this6.track("Tips: Img Click"),_this6.navigate(tip.link),!0},src:tip.img,className:"TipOfTheDay-image",style:{width:"100%"}}),react_default.a.createElement("div",{className:"TipOfTheDay-body"},react_default.a.createElement("h3",{className:"TipOfTheDay-title"},tip.title),react_default.a.createElement("div",{className:"TipOfTheDay-description"},react_default.a.createElement(ui_core_build_bundle_module.J,null,tip.body)),react_default.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},tip.isNewReleaseTip?react_default.a.createElement("span",null):react_default.a.createElement(ui_core_build_bundle_module.kb.Wrap,{tooltipProps:{label:Object(l10nify_build_bundle_module.a)("Disable Tips"),position:"bottom"}},react_default.a.createElement(ui_core_build_bundle_module.f,{className:"TipOfTheDay-disable-tips-button",onClick:this.disableTips,variant:"minimal"},react_default.a.createElement(ui_core_build_bundle_module.C,{size:"S",icon:"viewOff"}))),react_default.a.createElement(ui_core_build_bundle_module.f,{onClick:function(){return _this6.track("Tips: Learn More Click"),_this6.navigate(tip.link),!0},variant:"primary"},Object(l10nify_build_bundle_module.a)("Learn More"))))))}}]),TipOfTheDay}(ui_build_bundle_module.d);function getDefaultPersistedState(){return{lastTipClosedDate:Object(bundle_module.I)().subtract(timeToWaitBetweenShowingTipsInDays+1,"day").format(),seenTipIds:[],seenReleaseTipIds:[],currentTipId:"",disabled:!1}}TipOfTheDay_TipOfTheDay.getDefaultPersistedState=getDefaultPersistedState,TipOfTheDay_TipOfTheDay.enableTips=function(app){var seenReleaseTipIds=TipOfTheDay_TipOfTheDay.getState(app).seenReleaseTipIds;TipOfTheDay_TipOfTheDay.setState(app,Object(objectSpread.a)({},TipOfTheDay_TipOfTheDay.getDefaultPersistedState(),{seenReleaseTipIds:seenReleaseTipIds}))},TipOfTheDay_TipOfTheDay.disableTips=function(app){TipOfTheDay_TipOfTheDay.setState(app,{disabled:!0})},TipOfTheDay_TipOfTheDay.getState=function(app){return Object(objectSpread.a)({},getDefaultPersistedState(),app.user.uiSettings.getAttribute("TIP_OF_THE_DAY_KEY"))},TipOfTheDay_TipOfTheDay.setState=function(app){var state=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},nextState=Object(objectSpread.a)({},TipOfTheDay_TipOfTheDay.getState(app),state);return app.user.uiSettings.setAttribute("TIP_OF_THE_DAY_KEY",nextState),nextState};var views_workspace_TipOfTheDay=TipOfTheDay_TipOfTheDay,WorkspaceController_WorkspaceController=function(){function WorkspaceController(page){Object(classCallCheck.a)(this,WorkspaceController),this.page=page,this.app.on("getProjectLink",this.getProjectLink.bind(this)),this.newProjectOnSuccess=this.newProjectOnSuccess.bind(this),this.newProjectOnFailure=this.newProjectOnFailure.bind(this)}return Object(createClass.a)(WorkspaceController,[{key:"addHotkeys",value:function(hotkeys){return this.page.addHotkeys(hotkeys)}},{key:"removeAllHotkeys",value:function(){return this.page.removeAllHotkeys()}},{key:"newProjectOnSuccess",value:function(originalProject,saveAsTemplate,project,resolve){originalProject.clearAutosavedEntryFromLocalStorage(originalProject.autosaveKey),Object.assign(originalProject,bundle_module.q.pick(project,["name","description","owner","id","shares","tags","favorite","companyTemplate"])),this.app.updateCollectionsAndRelevancy(project),window.location.hash="#/workspace/edit/"+project.id,this.app.addAlert({variant:"success",contents:Object(l10nify_build_bundle_module.a)('Successfully created "%s"!',[originalProject.name]),autoHide:!0,clearOtherAlerts:!0}),originalProject.emit("saved"),saveAsTemplate?this._trackSaveProjectInteractions("save as template",originalProject):this._trackSaveProjectInteractions("save as",originalProject),resolve(originalProject)}},{key:"newProjectOnFailure",value:function(originalProject){this.app.addAlert({variant:"error",contents:Object(l10nify_build_bundle_module.a)('Failed to save "%s"!',[originalProject.name]),autoHide:!0,clearOtherAlerts:!0})}},{key:"createNewProject",value:function(){CreateProjectModal.a.show()}},{key:"confirmSaveIfLocalDevProd",value:function(){var shouldSave=!0;return this.app&&this.app.isLocalDev&&"custom"===this.app.user.environment&&(shouldSave=confirm("You are about to save a project in a production environment.  Are you sure you want to continue? To disable this alert, comment out the code in WorkspaceController.js")),shouldSave}},{key:"saveProject",value:function(project){if(this.confirmSaveIfLocalDevProd())return(project=project||this.view.project).id?this._saveProject():(project.companyTemplate=!1,project.created=null,project.modified=null,this._createProject(project))}},{key:"saveProjectAs",value:function(){var _this=this,originalProject=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.view.project,saveAsTemplate=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise(function(resolve,reject){var project=build_bundle_module.Ub.fromJSON(originalProject.toJSON());saveAsTemplate?(project.name+=Object(l10nify_build_bundle_module.a)(" (Template)"),project.companyTemplate=!0,project.created=null):project.name+=Object(l10nify_build_bundle_module.a)(" (Copy)"),project.id=void 0,project.shares.splice(0),project.favorite=void 0,project.owner=null,project.modified=null,NewProjectDialog_NewProjectDialog.show({title:saveAsTemplate?Object(l10nify_build_bundle_module.a)("Save Project As Template"):Object(l10nify_build_bundle_module.a)("Save Project As"),project:project,saveLabel:saveAsTemplate?Object(l10nify_build_bundle_module.a)("Save Project As Template"):Object(l10nify_build_bundle_module.a)("Save Project As"),onSuccess:function(){_this.newProjectOnSuccess(originalProject,saveAsTemplate,project,resolve)},onFailure:function(){_this.newProjectOnFailure(originalProject)}})})}},{key:"saveProjectAsTemplate",value:function(){var originalProject=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.view.project;return this.saveProjectAs(originalProject,!0)}},{key:"setProjectAsLandingPage",value:function(){var _this2=this;this.app.omnitureService.postSuite("User.SetLanding",null,{params:{project:this.view.project.id}}).then(function(_ref){var data=_ref.data;!0===data||"true"===data||bundle_module.q.isObject(data)&&data.success?_this2.app.addAlert({variant:"success",contents:Object(l10nify_build_bundle_module.a)("Successfully set project as landing page.")}):_this2.app.addAlert({variant:"error",contents:Object(l10nify_build_bundle_module.a)("Unable to change your landing page at this time. Please try again later."),autoHide:!1})})}},{key:"refreshProject",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Refresh"),build_bundle_module.o.RankedRequest.clearCache(),this.view.project.broadcast("project:refresh")}},{key:"downloadProjectAsCSV",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Download");var project=this.view.project;Object(ui_build_bundle_module.hb)(this.app,{filename:project.getFilename(this.app),filetype:"csv",dataString:project.formatCSV({app:this.app})})}},{key:"downloadProjectAsPDF",value:function(){var _this3=this;ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Download PDF"),this._saveInternalProjectIfNeeded().then(function(project){var scheduledProject=build_bundle_module.dc.fromJSON({fileTypes:["pdf"],schedule:{startTime:Object(bundle_module.I)().utc().format("YYYY-MM-DDTHH:mm:ss"),expirationTime:Object(bundle_module.I)().utc().add(1,"years").format("YYYY-MM-DDTHH:mm:ss"),triggerObject:{type:"immediate"}},screenWidth:parseInt(Object(ui_build_bundle_module.mb)(".aw-report-content").width(),10)});scheduledProject.reportSuite=project.reportSuite,scheduledProject.project=project,_this3.app.repo.save(scheduledProject).then(function(savedJob){var numAttempts=0;_this3.app.addAlert({variant:"success",contents:Object(l10nify_build_bundle_module.a)("Your download has been requested. Please wait."),autoHide:!1});var pollForJob=function pollForJob(jobInstanceId){_this3.app.appService.get("/scheduler/jobinstances/".concat(jobInstanceId)).then(function(res){var result=res.data;if(!0===result.jobFailed)_this3.app.addAlert({variant:"error",contents:Object(l10nify_build_bundle_module.a)("An error has occurred with the download process. Please try again later."),autoHide:!1});else if(result.endYmdt){var url=_this3.app.appService.baseURL+"/scheduler/artifacts/pickup/"+jobInstanceId+"/"+result.downloadId+"?artifactType=pdf";_this3.app.addAlert({variant:"success",autoHide:!1,clearOtherAlerts:!0,contents:react_default.a.createElement("span",null,[react_default.a.createElement("span",null,Object(l10nify_build_bundle_module.a)("Your PDF is ready for download.")),react_default.a.createElement("span",null," "),react_default.a.createElement("a",{className:"coral-Link",target:"_blank",href:url},project.name)])}),build_bundle_module.Lc.progress(build_bundle_module.Lc.PDF_DOWNLOAD_READY)}else if(numAttempts>=60){_this3.app.addAlert({variant:"info",autoHide:!1,clearOtherAlerts:!0,contents:react_default.a.createElement("span",null,[react_default.a.createElement("span",null,Object(l10nify_build_bundle_module.a)("The download process is taking a long time. Would you like us to email the project to you instead?")),react_default.a.createElement("span",null," "),react_default.a.createElement("span",{className:"coral-Link",onClick:function(){_this3._sendFile({project:project})}},Object(l10nify_build_bundle_module.a)("Send Now"))])}),build_bundle_module.Lc.progress(build_bundle_module.Lc.PDF_DOWNLOAD_FAILED)}else numAttempts++,setTimeout(function(){pollForJob(jobInstanceId)},5e3)})};setTimeout(function getJobInstance(){_this3.app.appService.get("/scheduler/jobinstances",{params:{jobId:savedJob.id,includeType:"inProgress,successfullyCompleted,failedCompleted"}}).then(function(result){if(result.length&&result[0].instanceId){var jobInstanceId=result[0].instanceId;pollForJob(jobInstanceId)}else setTimeout(getJobInstance,2e3)})},2e3)})})}},{key:"downloadProjectOnServer",value:function(){var filename=this.view.project.name+" - "+this.app.reportSuite.name+" - "+Object(bundle_module.I)().format("ll");new build_bundle_module.cc({app:this.app,reportSuite:this.app.reportSuite}).load(this,filename)}},{key:"showProjectInfo",value:function(){var _this4=this;ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Project Information");var project=this.view.project,customColorSchemes=project.definition.customColorSchemes.slice();customColorSchemes.length||customColorSchemes.push(new build_bundle_module.A({id:"custom_",label:Object(l10nify_build_bundle_module.a)("Custom Palette"),value:[]}));var data={name:project.name,owner:project.owner.name?project.owner.name:Object(l10nify_build_bundle_module.a)("Not Available"),modified:project.modified?Object(bundle_module.I)(project.modified).format("L hh:mm:ss"):Object(l10nify_build_bundle_module.a)("Not Available"),description:project.description||"",tags:project.tags,countRepeatInstances:project.definition.countRepeatInstances,colorScheme:project.colorScheme,customColorSchemes:customColorSchemes,viewDensity:project.definition.viewDensity},shouldSaveProject=project.hasUnsavedChanges,shouldTagProject=!1,propsThatTriggerProjectSave=["name","description","definition.colorScheme","definition.colorSchemeId","definition.countRepeatInstances","definition.viewDensity"];project.on("change",function(e){var propThatChanged=e.property;propsThatTriggerProjectSave.includes(propThatChanged)&&(shouldSaveProject=!0)}),project.tags.on("change",function(e){shouldTagProject=!0});var listenersOff=function(){project.off("change"),project.tags.off("change")};ProjectInfoDialog_ProjectInfoDialog.showInfoModal({project:project,data:data,onAccept:function(){listenersOff(),shouldSaveProject?_this4._saveProject():shouldTagProject&&_this4._tagProject(project)}.bind(this),listenersOff:listenersOff.bind(this)})}},{key:"undo",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Undo"),build_bundle_module.sc.undoChange(this.view.project)}},{key:"redo",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Redo"),build_bundle_module.sc.redoChange(this.view.project)}},{key:"clearAll",value:function(){var _this5=this;ui_core_build_bundle_module.o.confirm(Object(l10nify_build_bundle_module.a)("This action will clear all panels in the current project. Are you sure you want to continue?")).then(function(){_this5.view.emptyCurrentProject(!1,!1)}).catch(function(){})}},{key:"insertNewPanel",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: New Blank Panel");var panel=new build_bundle_module.Rb({name:Object(l10nify_build_bundle_module.a)("Panel")}),panels=this.view.project.currentWorkspace.panels;build_bundle_module.xb.addItemToTopOfContainer(panel,panels),panel.makeNameUnique()}},{key:"insertNewFreeformPanel",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Add Freeform Panel");var panel=build_bundle_module.Rb.createWithFreeformTable({name:Object(l10nify_build_bundle_module.a)("Freeform")}),panels=this.view.project.currentWorkspace.panels;build_bundle_module.xb.addItemToTopOfContainer(panel,panels),panel.makeNameUnique()}},{key:"insertNewSegmentComparisonPanel",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: New Segment Comparison");var panel=build_bundle_module.Rb.createWithAudienceComparisonConfig({name:Object(l10nify_build_bundle_module.a)("Segment Comparison")},this.app),panels=this.view.project.currentWorkspace.panels;build_bundle_module.xb.addItemToTopOfContainer(panel,panels),panel.makeNameUnique()}},{key:"insertNewAttributionPanel",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: New Attribution Panel");var panel=build_bundle_module.Rb.createWithAttributionConfig({name:Object(l10nify_build_bundle_module.a)("Attribution")},this.app),panels=this.view.project.currentWorkspace.panels;build_bundle_module.xb.addItemToTopOfContainer(panel,panels),panel.makeNameUnique()}},{key:"insertNewFreeformTable",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: New Freeform Table"),build_bundle_module.Rb.createSubPanelWithLinkedSourceIfNeeded({workspace:this.view.project.currentWorkspace,vizType:"FreeformReportlet",appContext:{app:this.app,reportSuite:this.app.reportSuite}})}},{key:"insertNewLineChart",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: New Line Chart"),build_bundle_module.Rb.createSubPanelWithLinkedSourceIfNeeded({workspace:this.view.project.currentWorkspace,vizType:"LineReportlet",appContext:{app:this.app,reportSuite:this.app.reportSuite}})}},{key:"insertNewBarChart",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: New Bar Chart"),build_bundle_module.Rb.createSubPanelWithLinkedSourceIfNeeded({workspace:this.view.project.currentWorkspace,vizType:"BarReportlet",appContext:{app:this.app,reportSuite:this.app.reportSuite}})}},{key:"createSegment",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Create Segment"),this.app.inAppEditors.showSegmentBuilder()}},{key:"createMetric",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Create Calc Metric"),this.app.inAppEditors.showCalculatedMetricBuilder()}},{key:"createDateRange",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Create DateRange"),this.app.inAppEditors.showDateRangeBuilder()}},{key:"createAlert",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Create Alert"),this.app.inAppEditors.showAlertBuilder()}},{key:"refreshComponents",value:function(){var _this6=this,promises=["segments","dimensions","dateRanges","metrics","calculatedMetrics","tags"].map(function(collection){return _this6.app.cache.getCollection(collection).refresh()});Promise.all(promises).catch(function(e){_this6.app.addAlert({variant:"error",contents:Object(l10nify_build_bundle_module.a)("There was an error refreshing components.")})})}},{key:"shareProject",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Share"),ShareComponentDialog_ShareComponentDialog.show({title:Object(l10nify_build_bundle_module.a)("Share Project"),component:this.view.project,canSetAsLandingPage:this.app.user.isAdmin,canAutoShareComponents:!0,onSuccess:this._onSaveProject.bind(this)})}},{key:"getProjectLink",value:function(){var params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};params.project=this.view.project;var linkObjectLabel=Object(l10nify_build_bundle_module.a)("project");params.subPanelId&&(linkObjectLabel=Object(l10nify_build_bundle_module.a)("visualization")),params.panelId&&(linkObjectLabel=Object(l10nify_build_bundle_module.a)("panel")),ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Link to Project"),this._promptSave(Object(l10nify_build_bundle_module.a)("You have unsaved changes in your current project. Would you like to save your progress before linking to this %s? If your project is currently shared with others in your organization, they will see the changes you have made when they access this project.",[linkObjectLabel])).then(function(res){res&&LinkToProjectDialog_LinkToProjectDialog.show(params)})}},{key:"sendFileNow",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Send File"),this._sendFile({project:this.view.project,showSchedulingOptions:!1})}},{key:"sendFileOnSchedule",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Send File on Schedule"),this._sendFile({project:this.view.project,showSchedulingOptions:!0})}},{key:"curateProjectData",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Curate"),this.view.project&&(this.view.project.isCurating=!0)}},{key:"openSupportVideos",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Videos");ui_core_build_bundle_module.sb.openExternalLink("https://www.youtube.com/playlist?list=PL2tCx83mn7GuNnQdYGOtlyCu0V5mEZ8sS")}},{key:"viewAllHotkeys",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Hotkeys");var url="https://experiencecloud.adobe.com/resources/help/"+l10nify_build_bundle_module.a.config.currentLocale+"/analytics/analysis-workspace/fa_shortcut_keys.html";window.open(url,"_blank").focus()}},{key:"openHelpDocumentation",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Help Documentation");var url="https://experiencecloud.adobe.com/resources/help/"+l10nify_build_bundle_module.a.config.currentLocale+"/analytics/analysis-workspace/home.html";window.open(url,"_blank").focus()}},{key:"openHelpForum",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Help Forum");window.open("https://forums.adobe.com/community/experience-cloud/analytics-cloud/analytics/analysis-workspace","_blank").focus()}},{key:"_createProject",value:function(project){var _this7=this;return project=project||this.view.project,new Promise(function(resolve,reject){NewProjectDialog_NewProjectDialog.show({title:Object(l10nify_build_bundle_module.a)("Save Project"),project:project,onSuccess:function(newProject){resolve(newProject),_this7._onSaveProject(newProject)},onFailure:function(err){reject(err)}}),_this7._trackSaveProjectInteractions("create new")})}},{key:"saveProjectModel",value:function(){return this.app.repo.save(this.view.project).then(this._onSaveProject.bind(this)).catch(this._onSaveProjectError.bind(this))}},{key:"_saveProject",value:function(){var _this8=this;return this.canSaveProject()?bundle_module.q.get(this,"view.project.companyTemplate")?new Promise(function(resolve,reject){ui_core_build_bundle_module.o.alert(Object(l10nify_build_bundle_module.a)('You are about to update a project that is a custom template in your organization. When someone else creates a project from this custom template, they will see the changes you have made. Select "Save" if you want to update the custom template project for all users. Select "Save As" to create a copy of the custom template with your changes.'),{variant:"warning",title:Object(l10nify_build_bundle_module.a)("Change Template?"),actionButtons:[{label:Object(l10nify_build_bundle_module.a)("Cancel")},{label:Object(l10nify_build_bundle_module.a)("Save As..."),onClick:function(){_this8.saveProjectAsTemplate().then(function(){_this8._trackSaveProjectInteractions("save as template",_this8.view.project),resolve(_this8.view.project)})}},{label:Object(l10nify_build_bundle_module.a)("Save"),onClick:function(){_this8.saveProjectModel().then(function(){_this8._trackSaveProjectInteractions("save"),resolve(_this8.view.project)})}}]})}):bundle_module.q.get(this,"view.project.shares.length")?new Promise(function(resolve,reject){var numShares=_this8.view.project.shares.length,personOrPeople=numShares>1?Object(l10nify_build_bundle_module.a)("people"):Object(l10nify_build_bundle_module.a)("person");ui_core_build_bundle_module.o.alert(Object(l10nify_build_bundle_module.a)('You are about to save a project that is shared with %1$s %2$s in your organization. When they access this project, they will see the changes you have made. Select "Save" if you want to update the project for all users. Select "Save As" to create a copy with your changes.',[numShares,personOrPeople]),{variant:"warning",title:Object(l10nify_build_bundle_module.a)("Change Shared Project?"),actionButtons:[{label:Object(l10nify_build_bundle_module.a)("Cancel")},{label:Object(l10nify_build_bundle_module.a)("Save As..."),onClick:function(){_this8.saveProjectAs().then(function(){resolve(_this8.view.project)})}},{label:Object(l10nify_build_bundle_module.a)("Save"),onClick:function(){_this8.saveProjectModel().then(function(){resolve(_this8.view.project)})}}]}),_this8._trackSaveProjectInteractions("save")}):(this._trackSaveProjectInteractions("save"),this.saveProjectModel()):Promise.resolve(!1)}},{key:"_trackSaveProjectInteractions",value:function(actionType){var project=this.view.project,visualizations=bundle_module.q.flatten(project.definition.workspaces[0].panels.map(function(panel){return panel.subPanels})).filter(function(subPanel){return subPanel.reportlet instanceof build_bundle_module.zc}),freeformSubPanels=bundle_module.q.flatten(project.definition.workspaces[0].panels.map(function(panel){return panel.subPanels})).filter(function(subPanel){return subPanel.reportlet instanceof build_bundle_module.lb}),colCount=bundle_module.q.reduce(freeformSubPanels,function(sum,subPanel){return sum+subPanel.reportlet.freeformTable.columns.length},0),avgNumCols=freeformSubPanels.length?colCount/freeformSubPanels.length:0,numAllShares=bundle_module.q.where(project.shares,{shareToType:"all"}).length,numGroupShares=bundle_module.q.where(project.shares,{shareToType:"group"}).length,numUserShares=bundle_module.q.where(project.shares,{shareToType:"user"}).length;ui_core_build_bundle_module.lb.trackAction(null,"Save Project",{actionType:actionType,numPanels:project.definition.workspaces[0].panels.length,avgNumCols:Math.round(avgNumCols),numTables:freeformSubPanels.length,numCharts:visualizations.length,description:project.description,shares:[numAllShares,numGroupShares,numUserShares].join("|"),projectConvertedFromAHASaved:project.isConvertedFromAHA})}},{key:"_sendFile",value:function(config){(config=Object.assign({project:this.view.project,screenWidth:parseInt(Object(ui_build_bundle_module.mb)(".aw-report-content").width(),10)},config)).project.id||(config.showSchedulingOptions=!1,config.disableSchedulingOptions=!0),config.showSchedulingOptions?ui_build_bundle_module.N.show(config):this._saveInternalProjectIfNeeded().then(function(project){config.project=project,ui_build_bundle_module.N.show(config)})}},{key:"_saveInternalProjectIfNeeded",value:function(){if(!this.view.project.id||this.view.hasUnsavedChanges()){var project=build_bundle_module.Ub.fromJSON(this.view.project.toJSON());return project.id=null,project.internal=!0,project.shares=[],project.tags=[],project.name=project.name||Object(l10nify_build_bundle_module.a)("Project created for send file modal."),this.app.repo.save(project)}return Promise.resolve(this.view.project)}},{key:"_promptSave",value:function(message){var _this9=this;return this.view.project.id?Promise.resolve(!0):new Promise(function(resolve){ui_core_build_bundle_module.o.alert(message,{variant:"warning",title:Object(l10nify_build_bundle_module.a)("Save Progress?"),actionButtons:[{label:Object(l10nify_build_bundle_module.a)("Cancel"),variant:"quiet",onClick:function(){resolve(!1)}},{label:Object(l10nify_build_bundle_module.a)("Save"),onClick:function(){_this9.saveProject().then(function(project){return resolve(!0),project})}}]})})}},{key:"_onSaveProject",value:function(project,alert){this.app.updateCollectionsAndRelevancy(project),!alert&&~location.hash.indexOf(project.id)?alert=Object(l10nify_build_bundle_module.a)('Successfully saved "%s"!',[project.name]):alert||(alert=Object(l10nify_build_bundle_module.a)('Successfully created "%s"!',[project.name])),this.app.addAlert({variant:"success",contents:alert,clearOtherAlerts:!0}),project.emit("saved"),bundle_module.q.get(this,"view.project.id")&&location.hash.includes("#/workspace")&&!~location.hash.indexOf(this.view.project.id)&&(location.hash="#/workspace/edit/"+this.view.project.id)}},{key:"_onSaveProjectError",value:function(err){this.app.addAlert({variant:"error",contents:Object(l10nify_build_bundle_module.a)("Unable to save your project at this time. You may want to refresh your page and try again."),autoHide:!1,clearOtherAlerts:!0}),console.error(err)}},{key:"_getActivePanel",value:function(){var panels=this.view.project.currentWorkspace.panels;return panels.find(function(panel){return panel.selected})||panels[0]}},{key:"_configLoaded",value:function(){if(!this.view.project)return!1;var activePanel=this._getActivePanel();return bundle_module.q.get(activePanel,"config.loaded",!0)}},{key:"_tagProject",value:function(project){var _this10=this;this.app.appService.tagComponents([project]).then(function(){_this10.app.addAlert({variant:"success",contents:Object(l10nify_build_bundle_module.a)("Successfully tagged %s",[project.name]),closable:!0})}).catch(function(e){console.error(e),_this10.app.addAlert({variant:"error",contents:Object(l10nify_build_bundle_module.a)("Unable to tag %s",[project.name])})})}},{key:"canShareProject",value:function(){return Boolean(!this.view.project.companyTemplate||this.routeState.customTemplateId)}},{key:"canSaveProject",value:function(){var project=this.view.project,user=this.app.user;return!!project&&!!(Boolean(!project.id)||user.isAdmin||project.userIsOwner(user))}},{key:"canSaveProjectAs",value:function(){var project=this.view.project;return!!project&&(Boolean(project.id)&&!project.companyTemplate)}},{key:"canSaveProjectAsTemplate",value:function(){return this.app.reportSuite.permissions.canSaveProjectAsTemplate}},{key:"canPerformAnySaveOperation",value:function(){return this.canSaveProject()||this.canSaveProjectAs()||this.canSaveProjectAsTemplate()}},{key:"canCreateSegments",value:function(){return this.app.reportSuite.permissions.segmentCreation}},{key:"canCreateMetrics",value:function(){return this.app.reportSuite.permissions.calculatedMetricCreation}},{key:"canCurateProjectData",value:function(){var project=this.view.project;return!!project&&(this.app.user.isAdmin||project.userIsOwner(this.app.user))}},{key:"destroy",value:function(){}},{key:"isTipOfTheDayDisabled",value:function(){return views_workspace_TipOfTheDay.getState(this.app).disabled}},{key:"enableTipOfTheDay",value:function(){views_workspace_TipOfTheDay.enableTips(this.app),ui_core_build_bundle_module.lb.trackAction(null,"Tips: Enable Tips click")}},{key:"disableTipOfTheDay",value:function(){views_workspace_TipOfTheDay.disableTips(this.app),ui_core_build_bundle_module.lb.trackAction(null,"Tips: Disable Tips click",{fileMenu:!0})}},{key:"routeState",get:function(){return this._routeState},set:function(value){this._routeState=value}},{key:"app",get:function(){return this.page.app}},{key:"view",get:function(){return this.page.view}}]),WorkspaceController}(),ProjectSpecGenerator_ProjectSpecGenerator=(__webpack_require__(912),function(){function ProjectSpecGenerator(){Object(classCallCheck.a)(this,ProjectSpecGenerator)}return Object(createClass.a)(ProjectSpecGenerator,[{key:"showDialog",value:function(project){var code=this.generateCode(project),lines=code.split("\n").length,warnings=this.getWarnings(project);ui_core_build_bundle_module.o.show(react_default.a.createElement("div",{className:"anw-ProjectSpecGeneratorDialog",style:{width:700}},react_default.a.createElement(ui_core_build_bundle_module.f,{icon:"copy",iconSize:"S",label:Object(l10nify_build_bundle_module.a)("Copy to Clipboard"),onClick:this.copyJSON.bind(this,"#anw-ProjectSpecGeneratorDialog-code"),className:"floating-copy-btn"}),warnings.map(function(w){return react_default.a.createElement("div",{style:{color:"red"}},w)}),react_default.a.createElement("div",{className:"coral-Well"},react_default.a.createElement(ui_core_build_bundle_module.ib,{size:"block",rows:lines,value:code,readOnly:!0,wrap:"off",id:"anw-ProjectSpecGeneratorDialog-code",className:"text"}))),{title:Object(l10nify_build_bundle_module.a)("Project Spec Generator")})}},{key:"generateCode",value:function(project){var panel=project.panels[0],panelJson=this.convertToJson(panel),stringifiedPanel=this.stringifyJson(panelJson),cleanedJsonString=this.cleanStringifiedJson(stringifiedPanel);return this.embedJsonInCodeBlock(cleanedJsonString,project.definition.version,panel)}},{key:"getWarnings",value:function(project){var warnings=[];if(project.panels.length>1&&warnings.push("Only one panel is allowed - the first panel in the project will be used"),project.panels[0].subPanels.length>2){throw alert("\nTo keep test cases readible, panels should be as small as possible.\n\nPlease modify this project so that your panel has at most two subPanels. If you really need more than this, you can comment out this error and try again."),new Error}return warnings}},{key:"convertToJson",value:function(model){var customSerializer=this.customSerializer.bind(this);return model.toJSON({customSerializer:customSerializer})}},{key:"stringifyJson",value:function(json){var delimiter=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\t",replacer=this.stringifyReplacer.bind(this,delimiter),stringifiedJson=JSON.stringify(json,replacer,delimiter);return this.removeDoubleEncoding(stringifiedJson)}},{key:"cleanStringifiedJson",value:function(jsonString){var clean=jsonString.replace(/"(\w+)"\s*:/g,"$1:");return clean=clean.replace(/\"(addToCache\([^"]+)+\"/g,"$1")}},{key:"embedJsonInCodeBlock",value:function(stringifiedPanel,schemaVersion,panel){var code="\n\t\t\timport ProjectMockHelper from './../src/mock/ProjectMockHelper';\n\n\n\t\t\tdescribe('Project', () => {\n\t\t\t\tit('should create a fullyLoaded project  ', async () => {\n\t\t\t\t\tconst helper = new ProjectMockHelper();\n\t\t\t\t\tconst project = ".concat("createTestProject","(helper);\n\t\t\t\t\tconst loadedProject = await helper.getFullyLoadedProject(project);\n\t\t\t\t\texpect(loadedProject.currentWorkspace.fullyLoaded).toBe(true);\n\t\t\t\t});\n\t\t\t});\n\n\n\t\t\tfunction ").concat("createTestProject",'(helper) {\n\t\t\t\tconst addToCache = helper.addToCache;\n\t\t\t\treturn helper.createMigratedProjectFromPanel({\n\t\t\t\t\tschemaVersion: "').concat(schemaVersion,'",\n\t\t\t\t\tpanel: \n\t\t\t\t});\n\t\t\t}\n\t\t');code=(code=code.replace(/^\t\t\t/gm,"")).replace(/\n/m,""),stringifiedPanel=(stringifiedPanel=stringifiedPanel.replace(/^\t/gm,"\t\t\t")).replace(/^}/gm,"\t\t}");var seperator="panel:";return code=[(code=code.split(seperator))[0],seperator," "+stringifiedPanel,code[1]].join("")}},{key:"customSerializer",value:function(key,value,model,json,defaultSerializer,options){var property=Array.isArray(model)?null:model._modelDefinition.getProperty(key);if(model instanceof build_bundle_module.nc&&"name"===key){var jsonValue=model.label;return json[key]=jsonValue,jsonValue}if(value instanceof bundle_module.c){var _jsonValue=this.getAddToCacheComponentString(value);return json[key]=_jsonValue,_jsonValue}if("type"===key&&"string"===typeof value){var _jsonValue2=value;return json[key]=_jsonValue2,_jsonValue2}if("parentItemId"===key&&value){var _jsonValue3=this.getMappedParentItemId(value);return json[key]=_jsonValue3,_jsonValue3}if(model instanceof build_bundle_module.zc&&model.lockedSelection&&"lockType"===key){var _jsonValue4=value;return json[key]=_jsonValue4,_jsonValue4}if("asc"===key){var _jsonValue5=value;return json[key]=_jsonValue5,_jsonValue5}if((!property||value!==property.getDefaultValue(model))&&(!Array.isArray(value)||0!==value.length)&&(!(model instanceof build_bundle_module.nc||model instanceof build_bundle_module.Rb)||"position"!==key)&&"swatchColor"!==key&&"columnWidths"!==key&&!(model instanceof build_bundle_module.nc&&model.reportlet instanceof build_bundle_module.lb&&"linkedSourceId"===key)){var jsonVal=defaultSerializer(key,value,json,options),isObject=bundle_module.q.isObject(jsonVal),isEmpty=bundle_module.q.isEmpty(jsonVal),ensureExists=property&&property.ensureExists;if(!(isObject&&isEmpty&&ensureExists))return jsonVal;delete json[key]}}},{key:"getMappedParentItemId",value:function(parentItemId){return this.parentItemIndex=this.parentItemIndex||1,this.parentItemMap=this.parentItemMap||{},this.parentItemMap[parentItemId]||(this.parentItemMap[parentItemId]=String(this.parentItemIndex),this.parentItemIndex++),this.parentItemMap[parentItemId]}},{key:"stringifyReplacer",value:function(delimiter,key,value){var newValue=value;null!==delimiter&&(this.isHashOrArray(value)&&0===this.objectDepth(value)&&(newValue="|||"+this.stringifyJson(value,null)+"|||"));return newValue=this.sortKeysByValueLength(newValue,["name","dimension","dateRange"])}},{key:"sortKeysByValueLength",value:function(json){var priorityKeys=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return bundle_module.q.isObject(json)?Array.isArray(json)?json.sort(function(a,b){return JSON.stringify(a).length-JSON.stringify(b).length}):bundle_module.q.zipObject(bundle_module.q.pairs(json).sort(function(keyValueA,keyValueB){var keyA=keyValueA[0],keyB=keyValueB[0],valueA=keyValueA[1],valueB=keyValueB[1],jsonStringA=JSON.stringify(valueA),jsonStringB=JSON.stringify(valueB),lengthA=jsonStringA.length,lengthB=jsonStringB.length;return(lengthA=priorityKeys.includes(keyA)?0:lengthA)-(lengthB=priorityKeys.includes(keyB)?0:lengthB)})):json}},{key:"removeDoubleEncoding",value:function(stringifiedJson){return stringifiedJson.replace(/"\|\|\|[\[\{].*[\]\}]\|\|\|"/g,function(match){var noPipes=match.replace("|||[","[").replace("]|||","]").replace("}|||","}").replace("|||{","{");return JSON.parse(noPipes)})}},{key:"copyJSON",value:function(selector){var alert={variant:"success",contents:Object(l10nify_build_bundle_module.a)("JSON copied to clipboard.")};try{document.querySelector(selector).select(),document.execCommand("copy"),document.getSelection().removeAllRanges()}catch(err){console.error(err),alert.variant="warning",alert.contents=Object(l10nify_build_bundle_module.a)("Cannot automatically copy JSON to clipboard.")}}},{key:"isHashOrArray",value:function(val){return bundle_module.q.isObject(val)}},{key:"objectDepth",value:function(value){var _this=this;if(!this.isHashOrArray(value))return 0;var values=Array.isArray(value)?value:Object.values(value);if(!values.length)return 0;if(0===values.filter(function(v){return _this.isHashOrArray(v)}).length)return 0;var valueDepths=values.map(function(v){return _this.objectDepth(v)});return 1+bundle_module.q.max(valueDepths)}},{key:"getAddToCacheComponentString",value:function(component){return"addToCache(".concat(component.constructor.name,", '").concat(component.id,"')")}}]),ProjectSpecGenerator}()),WorkspaceGlobalUtilities_WorkspaceGlobalUtilities=function(){function WorkspaceGlobalUtilities(page){Object(classCallCheck.a)(this,WorkspaceGlobalUtilities),this.page=page}return Object(createClass.a)(WorkspaceGlobalUtilities,[{key:"initialize",value:function(){var _this=this;if("undefined"!==typeof window){var logTestProjectReminders=function(){console.log("%c***** Remember to name the reportlets you want to test *****","background: #222; color: #bada55")},app=this.app;window.adobeTools=window.adobeTools||{},window.adobeTools.printCurrentMethodAndArguments=function(currentClassName,args){var method=(new Error).stack.split("\n")[2].trim().split(" ")[1].split(".")[1].trim(),className="";currentClassName&&(className=currentClassName.split(".")[0]+"."),args&&args.length>0?console.log(className+method," ",args):console.log(className+method)},window.adobeTools.debug=app.debugOptions,window.adobeTools.debug.applyLokiParams(),window.adobeTools.debug.on("change",function(){window.localStorage.adobeToolsDebug=JSON.stringify(app.debugOptions.toJSON())}),window.adobeTools.testProjectJSON=function(projectJSON){var currentProjectExpansions=window.adobeTools.currentProject._expansions;return projectJSON||(projectJSON=window.adobeTools.exportProject()),app.repo.hydrate(build_bundle_module.Ub.fromJSON(projectJSON),{waitForCache:["metrics","dimensions","segments","tags"]}).then(function(project){return project._expansions=currentProjectExpansions,_this.view.project=project,project})},window.adobeTools.exportProject=function(asString){return asString?JSON.stringify(_this.project.toJSON(),!0,"\t"):_this.project.toJSON()},window.adobeTools.exportTestProject=function(){logTestProjectReminders();var a=document.createElement("a");a.textContent="download",a.download="PROJECT_".concat(_this.project.id,".js"),a.href="data:application/javascript,"+encodeURIComponent("module.exports = "+JSON.stringify(_this.project,null,"\t")),document.body.appendChild(a),a.click(),a.parentNode.removeChild(a)},window.adobeTools.exportTestProjectData=function(){var projectData={subPanels:{},components:{}};logTestProjectReminders();_this.project.currentWorkspace.panels.forEach(function(panel){panel.subPanels.forEach(function(subPanel){subPanel.reportlet&&"FreeformReportlet"===subPanel.reportlet.type&&function recordRankedData(subPanelName,table){projectData.subPanels[subPanelName]=projectData.subPanels[subPanelName]||{};var rankedKey="ranked::";table.parentTables.concat(table).forEach(function(pt,idx){pt.isTopMostParentTable?rankedKey+="0":rankedKey+=0===idx?pt.parentTable.breakdowns.indexOf(pt):"_"+pt.parentTable.breakdowns.indexOf(pt)});var lastReport=bundle_module.q.omit(table.lastReport,"rows");lastReport.rows=table.lastReport.rows.map(function(row){return{itemId:row.itemId,value:row.value,data:row.data.slice()}}),projectData.subPanels[subPanelName][rankedKey]=lastReport,table.breakdowns.forEach(function(breakdown){return recordRankedData(subPanelName,breakdown)})}(subPanel.name,subPanel.reportlet.freeformTable)})}),projectData.components=bundle_module.q.groupBy(_this.project.getEmbeddedEntities(),function(component){return component.constructor.name});var a=document.createElement("a");a.textContent="download",a.download="PROJECT_".concat(_this.project.id,"_DATA.js"),a.href="data:application/javascript,"+encodeURIComponent("module.exports = "+JSON.stringify(projectData,null,"\t")),document.body.appendChild(a),a.click(),a.parentNode.removeChild(a)},window.adobeTools.exportIndexedEntityCache=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(){var _ref2,_ref2$includedOnlyEmb,includedOnlyEmbeddedEntities,_ref2$fetchTopItems,fetchTopItems,_ref2$download,download,downloadIndexedCache,entities,_entities,_entities2,indexedCache,_args=arguments;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(_ref2=_args.length>0&&void 0!==_args[0]?_args[0]:{},_ref2$includedOnlyEmb=_ref2.includedOnlyEmbeddedEntities,includedOnlyEmbeddedEntities=void 0===_ref2$includedOnlyEmb||_ref2$includedOnlyEmb,_ref2$fetchTopItems=_ref2.fetchTopItems,fetchTopItems=void 0===_ref2$fetchTopItems||_ref2$fetchTopItems,_ref2$download=_ref2.download,download=void 0===_ref2$download||_ref2$download,downloadIndexedCache=function(indexedCache){var a=document.createElement("a");a.textContent="download",a.download="INDEXED_ENTITY_CACHE.js",a.href="data:application/javascript,"+encodeURIComponent("module.exports = "+JSON.stringify(indexedCache,null,"\t")),document.body.appendChild(a),a.click(),a.parentNode.removeChild(a)},includedOnlyEmbeddedEntities?(entities=_this.project.getEmbeddedEntities(),(_entities=entities).push.apply(_entities,Object(toConsumableArray.a)(_this.app.cache.getCollection("dateRanges").items)),(_entities2=entities).push.apply(_entities2,Object(toConsumableArray.a)(bundle_module.w.instance().getGranularities().map(function(g){return build_bundle_module.X.fromJSON(g)}))),entities=bundle_module.q.uniq(entities,function(e){return e.id})):(entities=[],Object.keys(_this.app.cache._collections).forEach(function(key){var _entities3;(_entities3=entities).push.apply(_entities3,Object(toConsumableArray.a)(bundle_module.q.get(_this.app.cache.getCollection(key),"items",[])))})),indexedCache=bundle_module.q.groupBy(entities,function(entity){var group=entity.constructor.name;return"Granularity"===group?"Dimension":group}),!fetchTopItems){_context.next=9;break}return indexedCache.Dimension=indexedCache.Dimension.map(function(d){return d.toJSON()}),console.log("%c***** Fetching Top Items *****","background: #222; color: #bada55"),_context.next=9,Promise.all(indexedCache.Dimension.filter(function(d){return!d.id.includes("variables/daterange")}).map(function(dimension){return new Promise(function(resolve){_this.app.axle.getTopItems({dimension:dimension.id}).then(function(data){dimension.topItems=data.rows.map(function(row){return row.label}),resolve()}).catch(function(err){console.log("%c***** Unable to Fetch Top Items for ".concat(dimension.id," *****"),"background: #222; color: #bada55"),resolve()})})}));case 9:download&&(console.log("%c***** Remember to replace the INDEXED_ENTITY_CACHE inside analytics-ui/src/model/specs/json *****","background: #222; color: #bada55"),downloadIndexedCache(indexedCache));case 10:case"end":return _context.stop()}},_callee)})),window.adobeTools.getReportlet=function(){var panelIndex=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,subPanelIndex=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return window.adobeTools.currentProject.panels[panelIndex].subPanels[subPanelIndex].reportlet},window.adobeTools.importProject=function(projectJSON,keepProjectId){return keepProjectId||delete projectJSON.id,window.adobeTools.testProjectJSON(projectJSON)},window.adobeTools.reloadProjectUsingCurrentState=function(){build_bundle_module.o.RankedRequest.clearCache();var projectJSON=window.adobeTools.exportProject();return window.adobeTools.testProjectJSON(projectJSON)},window.adobeTools.importProjectIntoCurrentProject=function(projectJSON){var currentProject=window.adobeTools.currentProject;return projectJSON.id=currentProject.id,projectJSON.name=currentProject.name,projectJSON.owner=currentProject.owner.toJSON(),window.adobeTools.testProjectJSON(projectJSON)},window.adobeTools.viewProjectMigrations=function(){var currentProject=window.adobeTools.currentProject;if(currentProject){var lastVersion=parseInt(build_bundle_module.Wb.currentVersion,10)-1;return app.appService.get("/projects",{params:{includeType:"all,shared,internal",includeDeleted:"true",expansion:"internal",size:6e3}}).then(function(result){var likeProjects=result.filter(function(p){return~p.name.indexOf(currentProject.id+"--"+lastVersion)});return likeProjects.length?likeProjects.forEach(function(p){return console.log("\n"+p.id)}):console.log("No migrations found"),likeProjects})}return Promise.resolve([])},window.adobeTools.restoreFromMigration=function(migrationId){var autoSave=arguments.length>1&&void 0!==arguments[1]&&arguments[1],currentProjectJSON=window.adobeTools.currentProject.toJSON();return app.appService.get("/projects/".concat(migrationId),{params:{expansion:"definition"}}).then(function(result){currentProjectJSON.definition=result.data.definition,window.adobeTools.importProject(currentProjectJSON,!0).then(function(project){autoSave?app.repo.save(project).then(function(res){app.addAlert({variant:"success",contents:"Successfully migrated project from migrationId: "+migrationId})}):app.repo.save(project).then(function(res){app.addAlert({variant:"success",contents:'Successfully imported the old migration. Select "Save" from the menu to make it permanent..'})})})})},window.adobeTools.restoreFromLastMigration=function(){var autoSave=arguments.length>0&&void 0!==arguments[0]&&arguments[0];window.adobeTools.viewProjectMigrations().then(function(likeProjects){likeProjects.length&&window.adobeTools.restoreFromMigration(likeProjects[likeProjects.length-1].id,autoSave)})},window.adobeTools.generateTestCaseFromProject=function(){var currentProject=window.adobeTools.currentProject;(new ProjectSpecGenerator_ProjectSpecGenerator).showDialog(currentProject)},window.adobeTools.loadAndRestoreFromLastMigration=function(projectId){var autoSave=arguments.length>1&&void 0!==arguments[1]&&arguments[1];~window.location.hash.indexOf(projectId)?window.adobeTools.restoreFromLastMigration(autoSave):(window.location.hash="/project/".concat(projectId),setTimeout(function(){var watchProject=_this.view.on("change:project",function(e){e.newValue&&(watchProject(),e.newValue.currentWorkspace.panels.length?console.log("no need to restore the project it already has panels."):window.adobeTools.restoreFromLastMigration(autoSave))})},0))},window.adobeTools.showHagrids=function(){var project=window.adobeTools.currentProject;project&&bundle_module.q.get(window,"rankedHagridsByEntityId."+project.id)?ui_core_build_bundle_module.o.show(react_default.a.createElement("div",null,react_default.a.createElement("div",null,window.rankedHagridsByEntityId[project.id].map(function(id){return react_default.a.createElement("div",null,id)})),react_default.a.createElement(ui_core_build_bundle_module.o.Footer,null,react_default.a.createElement(ui_core_build_bundle_module.f,{variant:"primary","data-dismiss":"modal"},Object(l10nify_build_bundle_module.a)("OK")))),{title:"Ranked Hagrids"}):ui_core_build_bundle_module.o.alert("There are no Hagrids for this project.")},window.adobeTools.bulkDownload=build_bundle_module.eb.bulkDownloadUtil,window.adobeTools.downloadCSV=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee3(){var token,headers,workspaceServerUrl,config,project,workspaceServer,response,dataUrl,waitForDone;return regenerator_default.a.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return waitForDone=function(url){var axios=new bundle_module.i({});return new Promise(function(resolve,reject){var finishCheckInterval,retries=Math.round(12);function _checkIfFinished(){return(_checkIfFinished=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee2(){var finishedResult;return regenerator_default.a.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return retries--,console.log("Polling..."),_context2.prev=2,_context2.next=5,axios.get(url);case 5:finishedResult=_context2.sent,_context2.next=14;break;case 8:return _context2.prev=8,_context2.t0=_context2.catch(2),console.log("The job was most likely cancelled.",_context2.t0),clearInterval(finishCheckInterval),resolve(""),_context2.abrupt("return");case 14:if("error"!==finishedResult.data.status){_context2.next=18;break}return clearInterval(finishCheckInterval),resolve("There was an error: ".concat(finishedResult.data.reason)),_context2.abrupt("return");case 18:if("done"!==finishedResult.data.status){_context2.next=22;break}return clearInterval(finishCheckInterval),resolve(finishedResult.data.url),_context2.abrupt("return");case 22:retries<=0&&(clearInterval(finishCheckInterval),reject());case 23:case"end":return _context2.stop()}},_callee2,null,[[2,8]])}))).apply(this,arguments)}finishCheckInterval=setInterval(function(){return _checkIfFinished.apply(this,arguments)},5e3)})},token=(token=app.appService.token).includes("Bearer")?token:"Bearer "+token,headers={Accept:"application/json",Authorization:token,"Accept-Language":app.user.locale.code},app.company.id&&app.user.id?(headers["x-proxy-company-id"]=app.company.id,headers["x-proxy-userid"]=app.user.id):(headers["x-proxy-company"]=app.company.name,headers["x-proxy-username"]=app.user.username),((workspaceServerUrl=app.workspaceServerUrl||"").includes("WORKSPACE_SERVER_ENDPOINT")||""===workspaceServerUrl)&&(workspaceServerUrl="http://localhost:8080"),config={baseURL:workspaceServerUrl,headers:headers},project=window.adobeTools.currentProject,workspaceServer=new bundle_module.i(config),_context3.prev=10,_context3.next=13,workspaceServer.post("/downloads",{projectId:project.id,subPanelId:project.panels[0].subPanels[0].id,rsid:project.rsid,company:app.company.name});case 13:return response=_context3.sent,console.log(JSON.stringify(response.data,null,"\t")),_context3.next=17,waitForDone(response.data.url);case 17:dataUrl=_context3.sent,console.log("CSV URL: ",dataUrl),_context3.next=25;break;case 21:throw _context3.prev=21,_context3.t0=_context3.catch(10),console.log("Are you sure the backend server is running?".red),_context3.t0;case 25:case"end":return _context3.stop()}},_callee3,null,[[10,21]])})),Object.defineProperty(window.adobeTools,"currentProject",{get:function(){return _this.project},configurable:!0})}}},{key:"destroy",value:function(){delete window.adobeTools.printCurrentMethodAndArguments,delete window.adobeTools.debug,delete window.adobeTools.exportProject,delete window.adobeTools.exportTestProject,delete window.adobeTools.exportTestProjectData,delete window.adobeTools.exportIndexedEntityCache,delete window.adobeTools.getReportlet,delete window.adobeTools.importProject,delete window.adobeTools.reloadProjectUsingCurrentState,delete window.adobeTools.importProjectIntoCurrentProject,delete window.adobeTools.viewProjectMigrations,delete window.adobeTools.restoreFromMigration,delete window.adobeTools.restoreFromLastMigration,delete window.adobeTools.generateTestCaseFromProject,delete window.adobeTools.loadAndRestoreFromLastMigration,delete window.adobeTools.showHagrids,delete window.adobeTools.bulkDownload,delete window.adobeTools.downloadCSV,delete window.adobeTools.currentProject}},{key:"app",get:function(){return this.page.app}},{key:"view",get:function(){return this.page.view}},{key:"project",get:function(){return this.page.view.project}}]),WorkspaceGlobalUtilities}(),workspace_panelTypes={BLANK_PANEL:"blankPanel",FREEFORM_PANEL:"freeformPanel",SEGMENT_COMPARISON_PANEL:"segmentComparisonPanel",ATTRIBUTION_PANEL:"attributionPanel"},launchInLocalDev=__webpack_require__(913),local_dev_launchInLocalDev=__webpack_require__.n(launchInLocalDev).a,DebugPanel_DebugPanel=(__webpack_require__(916),function(_ProjectComponent){function DebugPanel(props,context){var _this;return Object(classCallCheck.a)(this,DebugPanel),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(DebugPanel).call(this,props,context))).state={autoRefresh:!1},_this}return Object(inherits.a)(DebugPanel,_ProjectComponent),Object(createClass.a)(DebugPanel,[{key:"componentDidMount",value:function(){var _this2=this;Object(esm_get.a)(Object(getPrototypeOf.a)(DebugPanel.prototype),"componentDidMount",this).call(this),this.refreshInterval=setInterval(function(){_this2.state.autoRefresh&&_this2.forceUpdate()},500)}},{key:"componentWillUnmount",value:function(){clearInterval(this.refreshInterval)}},{key:"showDerivedDataSource",value:function(subPanel){var panel=subPanel.parent,reportlet=subPanel.reportlet,derivedDataSource=reportlet.derivedDataSource;reportlet.unlockSelection(),subPanel.linkedSource=derivedDataSource,reportlet.updateDerivedDataSource(this.appContext),panel.subPanels.push(derivedDataSource)}},{key:"getDerivedDataSourceLink",value:function(subPanel){var _this3=this;if(!subPanel.reportlet.derivedDataSource)return"No";var derivedType=subPanel.reportlet.derivedDataSource.reportlet._derivedTypeForDebug;return react_default.a.createElement("span",null,"Yes (",react_default.a.createElement(ui_core_build_bundle_module.F,{onClick:function(e){_this3.showDerivedDataSource(subPanel)}},derivedType),")")}},{key:"render",value:function(){var _this4=this;if(!this.state.project)return react_default.a.createElement(ui_core_build_bundle_module.qb,{size:"L",centered:!0});var panels=this.state.project.definition.workspaces[0].panels;return react_default.a.createElement("div",{className:"an-DebugPanel-container"},react_default.a.createElement("div",{className:"an-DebugPanel-topActions"},react_default.a.createElement(ui_core_build_bundle_module.f,{label:"Refresh Rail",onClick:function(){_this4.forceUpdate()}}),react_default.a.createElement("br",null),react_default.a.createElement("br",null),react_default.a.createElement(ui_core_build_bundle_module.F,{label:"Load Non-minified JS",onClick:function(){window.adobeTools.updateURLForDebugTools("loki[debug]=1")}}),react_default.a.createElement("br",null),react_default.a.createElement(ui_core_build_bundle_module.F,{label:"Show L10n",onClick:function(){window.adobeTools.showL10n()}}),react_default.a.createElement("br",null),react_default.a.createElement(ui_core_build_bundle_module.F,{label:"Show Print Preview",onClick:function(){window.adobeTools.updateURLForDebugTools("featureEnabled[serverRenderPreview]=1&featureEnabled[serverRenderDebug]=1")}}),react_default.a.createElement("br",null),react_default.a.createElement(ui_core_build_bundle_module.F,{label:"Test Fully Loaded",onClick:function(){window.adobeTools.updateURLForDebugTools("featureEnabled[serverRenderDebug]=1")}}),react_default.a.createElement("br",null),react_default.a.createElement(ui_core_build_bundle_module.F,{label:"Enable Undo Debugger",onClick:function(){window.adobeTools.updateURLForDebugTools("featureEnabled[undoDebugger]=1")}}),react_default.a.createElement("br",null),react_default.a.createElement(ui_core_build_bundle_module.F,{label:"Show Maps",onClick:function(){window.adobeTools.updateURLForDebugTools("featureEnabled[map]=1")}}),react_default.a.createElement("br",null),react_default.a.createElement(ui_core_build_bundle_module.F,{label:"Display Ranked Global IDs (Hagrids)",onClick:function(){return window.adobeTools.showHagrids()}}),react_default.a.createElement("br",null),react_default.a.createElement(ui_core_build_bundle_module.F,{label:"Launch in Local Dev",onClick:function(){return local_dev_launchInLocalDev()}}),react_default.a.createElement("br",null),react_default.a.createElement(ui_core_build_bundle_module.F,{label:"Generate Test Case from Project",onClick:function(){return window.adobeTools.generateTestCaseFromProject()}}),react_default.a.createElement("br",null),react_default.a.createElement(ui_core_build_bundle_module.k,{"data-test-id":"debug-oberon-xml",label:"Debug Oberon XML",checked:!!this.debugOptions.includeOberonXml,onChange:function(){_this4.debugOptions.includeOberonXml=!_this4.debugOptions.includeOberonXml,window.location.reload()}}),react_default.a.createElement(ui_core_build_bundle_module.k,{"data-test-id":"debug-platform-predictive-objects",label:"Debug Platform Predictive Objects",checked:!!this.debugOptions.includePlatformPredictiveObjects,onChange:function(){_this4.debugOptions.includePlatformPredictiveObjects=!_this4.debugOptions.includePlatformPredictiveObjects,window.location.reload()}}),react_default.a.createElement(ui_core_build_bundle_module.k,{"data-test-id":"load-prevaricated-data",label:"Load Prevaricated Data",checked:!!this.debugOptions.loadPrevaricatedData,onChange:function(){_this4.debugOptions.loadPrevaricatedData=!_this4.debugOptions.loadPrevaricatedData,window.location.reload()}}),react_default.a.createElement(ui_core_build_bundle_module.k,{"data-test-id":"show-viz-options",label:"Show Viz Options",checked:!!window.adobeTools.showVizOptions,onChange:function(){window.adobeTools.showVizOptions=!window.adobeTools.showVizOptions,_this4.forceUpdate()}}),react_default.a.createElement(ui_core_build_bundle_module.k,{"data-test-id":"auto-refresh-rail",label:"Auto Refresh Rail",checked:this.state.autoRefresh,onChange:function(){_this4.state.autoRefresh=!_this4.state.autoRefresh,_this4.forceUpdate()}})),panels.map(function(panel){return react_default.a.createElement("div",{key:panel.id},react_default.a.createElement(ui_core_build_bundle_module.A,{className:"an-DebugPanel-panel"},"Panel: ",panel.name," ",panel.fullyLoaded?"(Fully Loaded)":"(Not Fully Loaded)"),panel.subPanels.map(function(subPanel){return react_default.a.createElement("div",{className:"an-DebugPanel-subPanel",key:subPanel.id},react_default.a.createElement(ui_core_build_bundle_module.B,{className:"an-DebugPanel-subPanelTitle"},subPanel.label),"ID: ",subPanel.id,react_default.a.createElement("br",null),"Get Data Count: ",subPanel.reportlet.getDataFromProviderCount,react_default.a.createElement("br",null),"Render Count: ",subPanel.reportlet.renderCount,react_default.a.createElement("br",null),"Viz Render Count: ",subPanel.reportlet.vizRenderCount,react_default.a.createElement("br",null),"LinkedSourceId: ",subPanel.linkedSourceId,react_default.a.createElement("br",null),"DerivedDataSource: ",_this4.getDerivedDataSourceLink(subPanel),react_default.a.createElement("br",null),"SubPanel Fully Loaded: ",subPanel.fullyLoaded?"Yes":"No",react_default.a.createElement("br",null),"Reportlet Fully Loaded: ",subPanel.reportlet.fullyLoaded?"Yes":"No",react_default.a.createElement("br",null),"Reportlet Fully Loaded Without Anomalies: ",subPanel.reportlet.fullyLoadedWithoutAnomalies?"Yes":"No",react_default.a.createElement("br",null))}))}))}},{key:"debugOptions",get:function(){return this.app.debugOptions}}]),DebugPanel}(ProjectComponent_ProjectComponent)),node_modules_axios=__webpack_require__(771),axios_default=__webpack_require__.n(node_modules_axios);function downloadPDFLocally(_x){return _downloadPDFLocally.apply(this,arguments)}function _downloadPDFLocally(){return(_downloadPDFLocally=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(app){var useLocalHost,projectId,today,input,params,result,_args=arguments;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(useLocalHost=_args.length>1&&void 0!==_args[1]&&_args[1],projectId=window.adobeTools.currentProject.id){_context.next=5;break}return console.log("Downloading PDFs locally only works with saved projects. Try again."),_context.abrupt("return");case 5:return window.document.location.href.split("/workspace")[0]+"/",today=new Date,input={AFTER_RESIZE_SETTLE_TIME_IN_MILLISECONDS:5e3,accessToken:"XXXXXX",timeoutInMinutes:12,renderTypes:["pdf","html","csv"],admin:app.user.isAdmin,isAdmin:app.user.isAdmin,projectId:projectId,width:parseInt(Object(ui_build_bundle_module.mb)(".aw-report-content").width(),10),currentDateOverride:today.toISOString(),company:app.company.name,username:app.user.username,analyticsServiceUrl:app.settings.appService.url,rsid:app.reportSuite.rsid,csvDelimiter:app.user.csvDelimiter,numberLocalization:{currencyCode:app.reportSuite.currency,thousandsSeparator:app.reportSuite.numberLocalization.thousandsSeparator,decimalSeparator:app.reportSuite.numberLocalization.decimalSeparator},locale:{code:l10nify_build_bundle_module.a.config.currentLocale,title:l10nify_build_bundle_module.a.config.currentLocaleShorthand},omnitureUrl:useLocalHost?document.location.origin:app.settings.omnitureUrl.endpoints.baseUrl,isDemoTest:app.settings.demoMode},params={reportRendererConfig:input,environment:app.user.environment,showElectron:!0},console.log("Fetching data from: ".concat(input.analyticsServiceUrl,"\nFetchingUI code from: ").concat(input.omnitureUrl)),_context.next=12,axios_default()({url:"http://localhost:8080/localdev/local-pdf",method:"POST",data:params,headers:{"Content-Type":"application/json; charset=utf-8"}});case 12:"SUCCESS"===(result=_context.sent).data.result?document.location="http://localhost:8080/localdev/latest-pdf-report":alert(JSON.stringify(result.data,null,2));case 14:case"end":return _context.stop()}},_callee)}))).apply(this,arguments)}function FileMenuService_templateObject2(){var data=Object(taggedTemplateLiteral.a)([""," o"]);return FileMenuService_templateObject2=function(){return data},data}function FileMenuService_templateObject(){var data=Object(taggedTemplateLiteral.a)(["shift "," o"]);return FileMenuService_templateObject=function(){return data},data}var disabledProjectMessage=Object(l10nify_build_bundle_module.a)("Project needs to be saved first"),disabledProjectTemplateMessage=Object(l10nify_build_bundle_module.a)("Not applicable for templates"),FileMenuService_FileMenuService=function(){function FileMenuService(controller){var _this=this;Object(classCallCheck.a)(this,FileMenuService),this.controller=controller,this.flattenedMenuOptions=[],this.getMenu().forEach(function(subMenu){subMenu.groups.forEach(function(group){group.items&&group.items.forEach(function(item){item.subMenu=subMenu.name,_this.flattenedMenuOptions.push(item)})})}),this.controller.addHotkeys(bundle_module.q.compact(this.flattenedMenuOptions.map(function(menuOption){return menuOption.hotkey?new build_bundle_module.yb({id:menuOption.id,action:menuOption.action,keyCode:menuOption.hotkey.keyCode,letter:menuOption.hotkey.letter,modifiers:menuOption.hotkey.modifiers,isDisabled:function(){return menuOption.isDisabled},isHidden:function(){return menuOption.isHidden}}):null})))}return Object(createClass.a)(FileMenuService,[{key:"getMenu",value:function(){return[this._getProjectSubMenu(this.controller),this._getEditSubMenu(this.controller),this._getInsertSubMenu(this.controller),this._getComponentsSubMenu(this.controller),this._getShareSubMenu(this.controller),this._getHelpSubMenu(this.controller)]}},{key:"_getProjectSubMenu",value:function(controller){var isSafari=dom_util_build_bundle_module.a.isSafari();return{id:"project",name:Object(l10nify_build_bundle_module.a)("Project"),groups:[{items:[{id:"new",name:Object(l10nify_build_bundle_module.a)("New"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("shift %s p",[Object(ui_build_bundle_module.fb)()]),hotkey:{letter:"p",modifiers:["ctrlKey","shiftKey"]},action:function(){return controller.createNewProject()},isDisabled:!1,disabledMessage:disabledProjectMessage},{id:"open",name:Object(l10nify_build_bundle_module.a)("Open..."),keyboardShortcut:isSafari?Object(l10nify_build_bundle_module.a)(FileMenuService_templateObject(),Object(ui_build_bundle_module.fb)()):Object(l10nify_build_bundle_module.a)(FileMenuService_templateObject2(),Object(ui_build_bundle_module.fb)()),hotkey:{letter:"o",modifiers:isSafari?["ctrlKey","shiftKey"]:["ctrlKey"]},action:function(){return controller.openProjectsList()},isHidden:!1,isDisabled:!1,disabledMessage:null}]},{items:[{id:"save",name:Object(l10nify_build_bundle_module.a)("Save"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("%s s",[Object(ui_build_bundle_module.fb)()]),hotkey:{letter:"s",modifiers:["ctrlKey"]},action:function(){return controller.saveProject()},get isHidden(){return!controller.canSaveProject()},get isDisabled(){return build_bundle_module.db.isActive("prototypeMode")},disabledMessage:null},{id:"saveAs",name:Object(l10nify_build_bundle_module.a)("Save As..."),keyboardShortcut:Object(l10nify_build_bundle_module.a)("shift %s s",[Object(ui_build_bundle_module.fb)()]),hotkey:{letter:"s",modifiers:["ctrlKey","shiftKey"]},action:function(){return controller.saveProjectAs()},isHidden:!1,get isDisabled(){return!controller.canSaveProjectAs()||build_bundle_module.db.isActive("prototypeMode")},get disabledMessage(){return bundle_module.q.get(controller,"view.project.id")?disabledProjectTemplateMessage:disabledProjectMessage}},{id:"saveAsTemplate",name:Object(l10nify_build_bundle_module.a)("Save As Template..."),keyboardShortcut:Object(l10nify_build_bundle_module.a)("alt t"),hotkey:{letter:"t",modifiers:["altKey"]},action:function(){return controller.saveProjectAsTemplate()},get isDisabled(){return!controller.canSaveProjectAsTemplate()||build_bundle_module.db.isActive("prototypeMode")},get isHidden(){return!controller.canSaveProjectAsTemplate()}}]},{items:[{id:"setAsLandingPage",name:Object(l10nify_build_bundle_module.a)("Set As Landing Page"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("shift %s l",[Object(ui_build_bundle_module.fb)()]),hotkey:{letter:"l",modifiers:["shiftKey","ctrlKey"]},action:function(){return controller.setProjectAsLandingPage()},isHidden:!1,get isDisabled(){return!bundle_module.q.get(controller,"view.project.id")||build_bundle_module.db.isActive("prototypeMode")},disabledMessage:disabledProjectMessage}]},{items:[{id:"refreshProject",name:Object(l10nify_build_bundle_module.a)("Refresh Project"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("alt r"),hotkey:{letter:"r",modifiers:["altKey"]},action:function(){return controller.refreshProject()},isHidden:!1,isDisabled:!1,disabledMessage:null}]},{items:[{id:"downloadCSV",name:Object(l10nify_build_bundle_module.a)("Download CSV"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("shift %s v",[Object(ui_build_bundle_module.fb)()]),hotkey:{letter:"v",modifiers:["shiftKey","ctrlKey"]},action:function(){return controller.downloadProjectAsCSV()},isHidden:!1,get isDisabled(){return build_bundle_module.db.isActive("prototypeMode")},disabledMessage:null},{id:"downloadPDF",name:Object(l10nify_build_bundle_module.a)("Download PDF"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("shift %s b",[Object(ui_build_bundle_module.fb)()]),hotkey:{letter:"b",modifiers:["shiftKey","ctrlKey"]},action:function(){return controller.downloadProjectAsPDF()},isHidden:!1,get isDisabled(){return build_bundle_module.db.isActive("prototypeMode")},disabledMessage:null},{id:"downloadPDFInLocalDev",name:Object(l10nify_build_bundle_module.a)("Download PDF (locally using current environment for ui code)"),action:function(){return downloadPDFLocally(controller.app)},isHidden:!controller.app.isLocalDev,get isDisabled(){return build_bundle_module.db.isActive("prototypeMode")},disabledMessage:null},{id:"downloadPDFInLocalDev2",name:Object(l10nify_build_bundle_module.a)("Download PDF (locally using localhost for ui code)"),action:function(){return downloadPDFLocally(controller.app,!0)},isHidden:!controller.app.isLocalDev,get isDisabled(){return build_bundle_module.db.isActive("prototypeMode")},disabledMessage:null}]},{items:[{id:"projectInfo",name:Object(l10nify_build_bundle_module.a)("Project Info & Settings"),action:function(){return controller.showProjectInfo()},get isHidden(){return!controller.canSaveProject()},get isDisabled(){return build_bundle_module.db.isActive("prototypeMode")},disabledMessage:null}]}]}}},{key:"_getEditSubMenu",value:function(controller){return{id:"edit",name:Object(l10nify_build_bundle_module.a)("Edit"),groups:[{items:[{id:"undo",name:Object(l10nify_build_bundle_module.a)("Undo"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("%s z",[Object(ui_build_bundle_module.fb)()]),hotkey:{letter:"z",modifiers:["ctrlKey"]},action:function(){return controller.undo()},isHidden:!1,isDisabled:!1,disabledMessage:null},{id:"redo",name:Object(l10nify_build_bundle_module.a)("Redo"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("%s shift z",[Object(ui_build_bundle_module.fb)()]),hotkey:{letter:"z",modifiers:["ctrlKey","shiftKey"]},action:function(){return controller.redo()},isHidden:!1,isDisabled:!1,disabledMessage:null}]},{items:[{id:"clearAll",name:Object(l10nify_build_bundle_module.a)("Clear All"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("alt w"),hotkey:{letter:"w",modifiers:["altKey"]},action:function(){return controller.clearAll()},isHidden:!1,isDisabled:!1,disabledMessage:null}]}]}}},{key:"_getInsertSubMenu",value:function(controller){return{id:"insert",name:Object(l10nify_build_bundle_module.a)("Insert"),groups:[{name:Object(l10nify_build_bundle_module.a)("Panels"),items:[{id:"newPanel",name:Object(l10nify_build_bundle_module.a)("New Blank Panel"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("alt b"),hotkey:{letter:"b",modifiers:["altKey"]},action:function(){return controller.insertNewPanel()},isHidden:!1,isDisabled:!1,disabledMessage:null},{id:"newFreeformPanel",name:Object(l10nify_build_bundle_module.a)("New Freeform"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("alt a"),hotkey:{letter:"a",modifiers:["altKey"]},action:function(){return controller.insertNewFreeformPanel()},isHidden:!1,isDisabled:!1,disabledMessage:null},{id:"newSegmentComparisonPanel",name:Object(l10nify_build_bundle_module.a)("New Segment Comparison"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("alt c"),hotkey:{letter:"c",modifiers:["altKey"]},action:function(){return controller.insertNewSegmentComparisonPanel()},get isHidden(){return!ui_build_bundle_module.x.SegmentComparison.hasAccess(controller.app)},isDisabled:!1,disabledMessage:null},{id:"newAttributionPanel",name:Object(l10nify_build_bundle_module.a)("New Attribution"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("alt e"),hotkey:{letter:"e",modifiers:["altKey"]},action:function(){return controller.insertNewAttributionPanel()},isHidden:!controller.app.hasAccessToFeature("attributionPanel"),isDisabled:!1,disabledMessage:null}]},{name:Object(l10nify_build_bundle_module.a)("Visualizations"),items:[{id:"newFreeFormTable",name:Object(l10nify_build_bundle_module.a)("New Freeform Table"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("alt 1"),hotkey:{letter:"1",modifiers:["altKey"]},action:function(){return controller.insertNewFreeformTable()},isHidden:!1,get isDisabled(){return!controller._configLoaded()},disabledMessage:null},{id:"newLineChart",name:Object(l10nify_build_bundle_module.a)("New Line"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("alt 2"),hotkey:{letter:"2",modifiers:["altKey"]},action:function(){return controller.insertNewLineChart()},isHidden:!1,get isDisabled(){return!controller._configLoaded()},disabledMessage:null},{id:"newBarChart",name:Object(l10nify_build_bundle_module.a)("New Bar"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("alt 3"),hotkey:{letter:"3",modifiers:["altKey"]},action:function(){return controller.insertNewBarChart()},isHidden:!1,get isDisabled(){return!controller._configLoaded()},disabledMessage:null}]}]}}},{key:"_getComponentsSubMenu",value:function(controller){return{id:"components",name:Object(l10nify_build_bundle_module.a)("Components"),groups:[{items:[{id:"newSegment",name:Object(l10nify_build_bundle_module.a)("New Segment"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("shift %s e",[Object(ui_build_bundle_module.fb)()]),hotkey:{letter:"e",modifiers:["ctrlKey","shiftKey"]},action:function(){return controller.createSegment()},get isHidden(){return!controller.canCreateSegments()},isDisabled:!1,disabledMessage:null},{id:"newMetric",name:Object(l10nify_build_bundle_module.a)("New Metric"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("shift %s c",[Object(ui_build_bundle_module.fb)()]),hotkey:{letter:"c",modifiers:["ctrlKey","shiftKey"]},action:function(){return controller.createMetric()},get isHidden(){return!controller.canCreateMetrics()},isDisabled:!1,disabledMessage:null},{id:"newDateRange",name:Object(l10nify_build_bundle_module.a)("New Date Range"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("shift %s d",[Object(ui_build_bundle_module.fb)()]),hotkey:{letter:"d",modifiers:["ctrlKey","shiftKey"]},action:function(){return controller.createDateRange()},isHidden:!1,isDisabled:!1,disabledMessage:null},{id:"newAlert",name:Object(l10nify_build_bundle_module.a)("New Alert"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("shift %s a",[Object(ui_build_bundle_module.fb)()]),hotkey:{letter:"a",modifiers:["ctrlKey","shiftKey"]},action:function(){return controller.createAlert()},isHidden:!1,isDisabled:!1,disabledMessage:null}]},{items:[{id:"refreshComponents",name:Object(l10nify_build_bundle_module.a)("Refresh Components"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("alt shift r"),hotkey:{letter:"r",modifiers:["shiftKey","altKey"]},action:function(){return controller.refreshComponents()},isHidden:!1,isDisabled:!1,disabledMessage:null}]}]}}},{key:"_getShareSubMenu",value:function(controller){return{id:"share",name:Object(l10nify_build_bundle_module.a)("Share"),groups:[{items:[{id:"shareProject",name:Object(l10nify_build_bundle_module.a)("Share Project"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("%s g",[Object(ui_build_bundle_module.fb)()]),hotkey:{letter:"g",modifiers:["ctrlKey"]},action:function(){return controller.shareProject()},get isHidden(){return!controller.canSaveProject()},get isDisabled(){return!controller.canShareProject()||build_bundle_module.db.isActive("prototypeMode")},disabledMessage:disabledProjectTemplateMessage},{id:"getProjectLink",name:Object(l10nify_build_bundle_module.a)("Get Project Link"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("alt l"),hotkey:{letter:"l",modifiers:["altKey"]},action:function(){return controller.getProjectLink()},get isHidden(){var project=controller.view?controller.view.project:null;return!Boolean(project&&project.id)&&!controller.canSaveProject()},get isDisabled(){return build_bundle_module.db.isActive("prototypeMode")}},{id:"sendFileNow",name:Object(l10nify_build_bundle_module.a)("Send File Now"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("alt s"),hotkey:{letter:"s",modifiers:["altKey"]},action:function(){return controller.sendFileNow()},isHidden:!1,get isDisabled(){return build_bundle_module.db.isActive("prototypeMode")}},{id:"sendFileOnSchedule",name:Object(l10nify_build_bundle_module.a)("Send File on Schedule"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("shift alt s"),hotkey:{letter:"s",modifiers:["shiftKey","altKey"]},action:function(){return controller.sendFileOnSchedule()},isHidden:!1,get isDisabled(){return!bundle_module.q.get(controller,"view.project.id")||build_bundle_module.db.isActive("prototypeMode")},disabledMessage:disabledProjectMessage}]},{items:[{id:"curateProjectData",name:Object(l10nify_build_bundle_module.a)("Curate Project Data"),keyboardShortcut:Object(l10nify_build_bundle_module.a)("shift %s g",[Object(ui_build_bundle_module.fb)()]),hotkey:{letter:"g",modifiers:["ctrlKey","shiftKey"]},action:function(){return controller.curateProjectData()},isDisabled:!1,get isHidden(){return!controller.canCurateProjectData()||build_bundle_module.db.isActive("prototypeMode")}}]}]}}},{key:"_getHelpSubMenu",value:function(controller){return{id:"help",name:Object(l10nify_build_bundle_module.a)("Help"),groups:[{items:[{id:"search",name:Object(l10nify_build_bundle_module.a)("Search"),hideFromSearch:!0}]},{id:"searchResults",name:Object(l10nify_build_bundle_module.a)("Menu Items"),items:[]},{id:"helpItems",items:[{id:"videos",name:Object(l10nify_build_bundle_module.a)("Videos"),action:function(){return controller.openSupportVideos()},isHidden:!1,isDisabled:!1},{id:"helpDocumentation",name:Object(l10nify_build_bundle_module.a)("Help Documentation"),action:function(){return controller.openHelpDocumentation()},isHidden:!1,isDisabled:!1},{id:"helpForum",name:Object(l10nify_build_bundle_module.a)("Help Forum"),action:function(){return controller.openHelpForum()},isHidden:!1,isDisabled:!1},{id:"hotkeys",name:Object(l10nify_build_bundle_module.a)("Hotkeys"),action:function(){return controller.viewAllHotkeys()},isHidden:!1,isDisabled:!1},{id:"disableTipOfTheDay",name:Object(l10nify_build_bundle_module.a)("Disable Tips"),action:function(){controller.disableTipOfTheDay()},get isHidden(){return controller.isTipOfTheDayDisabled()},isDisabled:!1},{id:"enabledTipOfTheDay",name:Object(l10nify_build_bundle_module.a)("Enable Tips"),action:function(){controller.enableTipOfTheDay()},get isHidden(){return!controller.isTipOfTheDayDisabled()},isDisabled:!1}]}]}}}]),FileMenuService}(),WorkspaceHeader_WorkspaceHeader=(__webpack_require__(917),function(_ProjectComponent){function WorkspaceHeader(props,context){var _this;return Object(classCallCheck.a)(this,WorkspaceHeader),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(WorkspaceHeader).call(this,props,context))).menu=new FileMenuService_FileMenuService(_this.props.controller).getMenu(),_this}return Object(inherits.a)(WorkspaceHeader,_ProjectComponent),Object(createClass.a)(WorkspaceHeader,[{key:"componentDidMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(WorkspaceHeader.prototype),"componentDidMount",this).call(this),this.observe(this.app.user.uiSettings,"change")}},{key:"projectListeners",value:function(){return Object.assign({"change:favorite":this._debouncedChangeHandler.bind(this),"panelConfig:change":this._debouncedChangeHandler.bind(this),"change:selectedItem":this._debouncedChangeHandler.bind(this),saved:this._debouncedChangeHandler.bind(this)},Object(esm_get.a)(Object(getPrototypeOf.a)(WorkspaceHeader.prototype),"projectListeners",this).call(this))}},{key:"onFavoriteClick",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Favorite"),this.project&&(this.project.favorite?(this.app.appService.unFavoriteComponents([this.project]),this.project.favorite=!1):(this.project.favorite=!0,this.app.appService.favoriteComponents([this.project])))}},{key:"reportSuiteChange",value:function(reportSuite){this.project&&(this.project.reportSuite=reportSuite)}},{key:"onProjectNameChange",value:function(newName){newName?this.project.name=newName:(this.project.name=this.project.id?Object(l10nify_build_bundle_module.a)("Project"):Object(l10nify_build_bundle_module.a)("New Project"),this._debouncedChangeHandler())}},{key:"render",value:function(){return this.loading?null:react_default.a.createElement("div",{className:"an-workspace-header"},react_default.a.createElement("div",{className:"left-container"},react_default.a.createElement("div",{className:"top"},react_default.a.createElement("div",{className:"project-name-container"},react_default.a.createElement(ui_core_build_bundle_module.l,{className:"an-workspace-title",value:this.project.name,placeholder:Object(l10nify_build_bundle_module.a)("Project"),onChange:this.onProjectNameChange.bind(this)})),this.isSavedProject?react_default.a.createElement("span",{className:"an-WorkspaceHeader-iconContainer"},react_default.a.createElement(ui_core_build_bundle_module.C,{className:"favorite-icon endor-ActionButton-icon",size:"S",onClick:this.onFavoriteClick.bind(this),icon:this.project.favorite?"starFill":"starStroke"}),this.project.companyTemplate&&!this.props.customTemplateId&&react_default.a.createElement(ui_core_build_bundle_module.C,{className:"an-WorkspaceHeader-templateFileIcon",size:"S","data-tooltip":Object(l10nify_build_bundle_module.a)("Editing Template"),icon:"fileTemplate"})):null,react_default.a.createElement(WorkspaceHeader_UnsavedChangesLabel,{project:this.project}),react_default.a.createElement("div",{className:"an-DownloadingStatus"},react_default.a.createElement(ui_core_build_bundle_module.qb,null),Object(l10nify_build_bundle_module.a)("Downloading..."))),react_default.a.createElement(ui_core_build_bundle_module.r,{menu:this.menu})),react_default.a.createElement("div",{className:"right-container"},react_default.a.createElement("div",{className:"workspace-icon-menu"},react_default.a.createElement("span",{className:"workspace-report-suite-selector coral--dark"},react_default.a.createElement(ui_build_bundle_module.S,{variant:"app",onChange:this.reportSuiteChange.bind(this),placeholder:Object(l10nify_build_bundle_module.a)("Unknown Report Suite"),allowVrsInlineEdit:!0})))))}},{key:"loading",get:function(){return!this.project}},{key:"isSavedProject",get:function(){return this.project&&this.project.id}}]),WorkspaceHeader}(ProjectComponent_ProjectComponent)),WorkspaceHeader_UnsavedChangesLabel=function(_Component){function UnsavedChangesLabel(props,context){var _this2;return Object(classCallCheck.a)(this,UnsavedChangesLabel),_this2=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(UnsavedChangesLabel).call(this,props,context)),props.project&&_this2.observeProject(props.project),_this2.state={undoInProgress:!1,redoInProgress:!1},_this2}return Object(inherits.a)(UnsavedChangesLabel,_Component),Object(createClass.a)(UnsavedChangesLabel,[{key:"observeProject",value:function(project){var _this3=this;this.observe(project),this.setUndoInProgress=function(){_this3.setState({undoInProgress:!0})},this.setRedoInProgress=function(){_this3.setState({redoInProgress:!0})},this.setUndoRedoComplete=bundle_module.q.debounce(function(){_this3.setState({undoInProgress:!1,redoInProgress:!1})},750),project.on("undoInProgress",this.setUndoInProgress),project.on("redoInProgress",this.setRedoInProgress),project.on("undoRedoComplete",this.setUndoRedoComplete)}},{key:"unObserveProject",value:function(project){this._unObserve(),project.off("undoInProgress",this.setUndoInProgress),project.off("redoInProgress",this.setRedoInProgress),project.off("undoRedoComplete",this.setUndoRedoComplete)}},{key:"componentWillReceiveProps",value:function(nextProps){nextProps.project&&(this.unObserveProject(nextProps.project),this.observeProject(nextProps.project),this.setState({}))}},{key:"render",value:function(){var unsavedChangesDiv=function(text){return react_default.a.createElement("div",{className:"project-unsaved-changes","data-title":!0},text)};return this.state.undoInProgress?unsavedChangesDiv(Object(l10nify_build_bundle_module.a)("Undoing...")):this.state.redoInProgress?unsavedChangesDiv(Object(l10nify_build_bundle_module.a)("Redoing...")):this.props.project.isSaving?unsavedChangesDiv(Object(l10nify_build_bundle_module.a)("Saving...")):this.hasUnsavedChanges?unsavedChangesDiv(Object(l10nify_build_bundle_module.a)("There are unsaved changes")):null}},{key:"hasUnsavedChanges",get:function(){return bundle_module.q.get(this,"props.project.hasUnsavedChanges")}},{key:"undoStack",get:function(){return build_bundle_module.sc.getUndoStack(this.props.project)}}]),UnsavedChangesLabel}(react_essence_build_bundle_module.a),WorkspaceScrollTo_WorkspaceScrollTo=function(){function WorkspaceScrollTo(){Object(classCallCheck.a)(this,WorkspaceScrollTo)}return Object(createClass.a)(WorkspaceScrollTo,null,[{key:"scrollToSubPanel",value:function(id){var flash=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],selector='div[data-sub-panel-id="'.concat(id,'"]');return this._workspaceScrollTo(selector,"subPanel",flash)}},{key:"scrollToPanel",value:function(id){var flash=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],selector='div[data-panel-id="'.concat(id,'"]');return this._workspaceScrollTo(selector,"panel",flash)}},{key:"scrollToTop",value:function(){Object(ui_build_bundle_module.mb)(".an-ViewLayout-scrollContent").animate({scrollTop:0},250,function(){})}},{key:"_workspaceScrollTo",value:function(){var _workspaceScrollTo2=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(selector){var type,flash,element,_args=arguments;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return type=_args.length>1&&void 0!==_args[1]?_args[1]:"subPanel",flash=!(_args.length>2&&void 0!==_args[2])||_args[2],_context.prev=2,_context.next=5,this._pollForElement(selector);case 5:return element=_context.sent,_context.next=8,this._waitForComponentToBePositionedByGridStack(element);case 8:return _context.next=10,this._scrollIntoView(element);case 10:if(!flash){_context.next=13;break}return _context.next=13,this._flash(element,type);case 13:return _context.abrupt("return",!0);case 16:_context.prev=16,_context.t0=_context.catch(2);case 19:case"end":return _context.stop()}},_callee,this,[[2,16]])}));return function(_x){return _workspaceScrollTo2.apply(this,arguments)}}()},{key:"_pollForElement",value:function(selector){return new Promise(function(resolve,reject){var counter=0;!function poll(){if(counter>15)return reject(new Error("element not found"));var element=Object(ui_build_bundle_module.mb)(selector);if(element.length>0)return resolve(element);counter++,setTimeout(poll,100)}()})}},{key:"_flash",value:function(panelNode,type){return new Promise(function(resolve,reject){panelNode.addClass("an-Panel-flashAnimation"),setTimeout(function(){return panelNode.removeClass("an-Panel-flashAnimation"),resolve()},500)})}},{key:"_scrollIntoView",value:function(panelNode){return new Promise(function(resolve,reject){var scrollContainer=Object(ui_build_bundle_module.mb)(".an-ViewLayout-scrollContent");scrollContainer.animate({scrollTop:panelNode.offset().top-scrollContainer.offset().top+scrollContainer.scrollTop()-100},250,function(){return resolve()})})}},{key:"_waitForComponentToBePositionedByGridStack",value:function(jqueryNode){return new Promise(function(resolve,reject){var hasScrolled=!1,domNode=jqueryNode.get(0),initailTop=parseInt(jqueryNode.css("top"),10);if(initailTop>0)return resolve();var observer=new MutationObserver(function(mutations){mutations.forEach(function(m){if(parseInt(jqueryNode.css("top"),10)!==initailTop&&!hasScrolled)return hasScrolled=!0,observer.disconnect(),resolve()})});setTimeout(function(){if(!hasScrolled)return hasScrolled=!0,observer.disconnect(),resolve()},750),observer.observe(domNode,{attributes:!0,attributeFilter:["style"]})})}}]),WorkspaceScrollTo}(),PanelSubPanelDuplicator=new(function(){function Duplicator(){Object(classCallCheck.a)(this,Duplicator)}return Object(createClass.a)(Duplicator,[{key:"duplicatePanel",value:function(){var _duplicatePanel=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(app,panelToDuplicate){var newPanelJSON;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return newPanelJSON=panelToDuplicate.toJSON(),_context.abrupt("return",this.addPanel(app,panelToDuplicate,newPanelJSON));case 2:case"end":return _context.stop()}},_callee,this)}));return function(_x,_x2){return _duplicatePanel.apply(this,arguments)}}()},{key:"duplicateSubPanel",value:function(){var _duplicateSubPanel=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee2(app,subPanelToDuplicate){var newSubPanelJSON,linkedSourceJSON;return regenerator_default.a.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return newSubPanelJSON=subPanelToDuplicate.toJSON(),linkedSourceJSON=subPanelToDuplicate.linkedSource?subPanelToDuplicate.linkedSource.toJSON():null,_context2.abrupt("return",this.addSubPanel(app,subPanelToDuplicate,newSubPanelJSON,linkedSourceJSON,!1));case 3:case"end":return _context2.stop()}},_callee2,this)}));return function(_x3,_x4){return _duplicateSubPanel.apply(this,arguments)}}()},{key:"addPanel",value:function(){var _addPanel=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee3(app,anchorPanel,panelToAddJson){var idMapping,newPanel,panels,_args3=arguments;return regenerator_default.a.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _args3.length>3&&void 0!==_args3[3]&&_args3[3],panelToAddJson.id=guid_build_bundle_module.a.create(),idMapping={},panelToAddJson.subPanels.forEach(function(subPanel){idMapping[subPanel.id]=guid_build_bundle_module.a.create()}),panelToAddJson.subPanels.forEach(function(subPanel){subPanel.id=idMapping[subPanel.id],subPanel.linkedSourceId&&(subPanel.linkedSourceId=idMapping[subPanel.linkedSourceId])}),newPanel=build_bundle_module.Rb.fromJSON(panelToAddJson),_context3.next=8,app.repo.hydrate(newPanel);case 8:return panels=anchorPanel.parent.panels,build_bundle_module.xb.addItemBelowAnchor(newPanel,anchorPanel,panels),newPanel.name=build_bundle_module.Sb.getNameWithoutAppendedNumber(newPanel.name),makeNameUnique(newPanel),WorkspaceScrollTo_WorkspaceScrollTo.scrollToPanel(newPanel.id),_context3.abrupt("return",newPanel);case 14:case"end":return _context3.stop()}},_callee3)}));return function(_x5,_x6,_x7){return _addPanel.apply(this,arguments)}}()},{key:"addSubPanel",value:function(){var _addSubPanel=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee4(app,anchorComponent,subPanelToAddJson,linkedSourceToAddJson){var duplicateLinkedSource,isCopyPaste,subPanelToAdd,linkedSourceToAdd,parentPanel,strategy,_args4=arguments;return regenerator_default.a.wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(duplicateLinkedSource=!(_args4.length>4&&void 0!==_args4[4])||_args4[4],isCopyPaste=_args4.length>5&&void 0!==_args4[5]&&_args4[5],subPanelToAdd=ensureSubPanelInstance(subPanelToAddJson),linkedSourceToAdd=ensureSubPanelInstance(linkedSourceToAddJson),parentPanel=getParentPanelFromAnchorComponent(anchorComponent),subPanelToAdd.id=guid_build_bundle_module.a.create(),subPanelToAdd.parent=parentPanel,subPanelToAdd.swatchColor=null,strategy=bundle_module.q.get(anchorComponent,"linkedSourceStrategies.selfDuplication"),!(linkedSourceToAdd&&duplicateLinkedSource||!duplicateLinkedSource&&"attached"===strategy)){_context4.next=12;break}return _context4.next=12,this._handleLinkedSource(app,parentPanel,subPanelToAdd,linkedSourceToAdd);case 12:return isCopyPaste||this._handleLockedSelection(anchorComponent,subPanelToAdd),_context4.next=15,app.repo.hydrate(subPanelToAdd,{ignoreIfMissing:!0});case 15:makeNameUnique(subPanelToAdd),anchorComponent instanceof build_bundle_module.Rb?(build_bundle_module.xb.addItemToTopOfContainer(subPanelToAdd,anchorComponent.subPanels),WorkspaceScrollTo_WorkspaceScrollTo.scrollToSubPanel(subPanelToAdd.id)):anchorComponent.addSibling(subPanelToAdd,"after",!0),subPanelToAdd.selected=!1,bundle_module.q.set(subPanelToAdd,"reportlet.statusLabel",bundle_module.q.get(anchorComponent,"reportlet.statusLabel"));case 19:case"end":return _context4.stop()}},_callee4,this)}));return function(_x8,_x9,_x10,_x11){return _addSubPanel.apply(this,arguments)}}()},{key:"_handleLinkedSource",value:function(){var _handleLinkedSource2=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee5(app,parentPanel,subPanelToAdd,linkedSourceToAdd){return regenerator_default.a.wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return linkedSourceToAdd.id=guid_build_bundle_module.a.create(),linkedSourceToAdd.parent=parentPanel,linkedSourceToAdd.swatchColor=null,bundle_module.q.get(linkedSourceToAdd,"reportlet.freeformTable.rows")&&linkedSourceToAdd.reportlet.freeformTable.rows.map(function(row){return row.parent=linkedSourceToAdd.reportlet.freeformTable}),_context5.next=6,app.repo.hydrate(linkedSourceToAdd,{ignoreIfMissing:!0});case 6:return linkedSourceToAdd.visible=!1,parentPanel.subPanels.push(linkedSourceToAdd),makeNameUnique(linkedSourceToAdd),subPanelToAdd.linkedSourceId=linkedSourceToAdd.id,_context5.abrupt("return",linkedSourceToAdd);case 11:case"end":return _context5.stop()}},_callee5)}));return function(_x12,_x13,_x14,_x15){return _handleLinkedSource2.apply(this,arguments)}}()},{key:"_handleLockedSelection",value:function(anchorComponent,subPanelToAdd){subPanelToAdd.reportlet.isSelectionLocked&&subPanelToAdd.linkedSource&&anchorComponent.reportlet.updateLockedSelectionAfterCopy(subPanelToAdd.reportlet)}}]),Duplicator}());function getParentPanelFromAnchorComponent(anchorComponent){return anchorComponent instanceof build_bundle_module.Rb?anchorComponent:anchorComponent.parent}function makeNameUnique(panel){panel.name=build_bundle_module.Sb.getNameWithoutAppendedNumber(panel.name),panel instanceof build_bundle_module.nc&&(panel.visualizationIndex=0),panel.makeNameUnique({updateVisualizationIndex:!0})}function ensureSubPanelInstance(obj){return obj instanceof build_bundle_module.nc.GenericSubPanel?obj:obj?build_bundle_module.nc.GenericSubPanel.fromJSON(obj):obj}var defineProperty=__webpack_require__(140),PanelSubPanelCopyPaste=new(function(){function CopyPasteUtil(){Object(classCallCheck.a)(this,CopyPasteUtil)}return Object(createClass.a)(CopyPasteUtil,[{key:"copy",value:function(component,app){var componentType=component instanceof build_bundle_module.Rb?"panel":"subPanel",objectToStringify={type:componentType,component:component.toJSON(),linkedComponent:component.linkedSource?component.linkedSource.toJSON():null};this._setUserClipboard(app.omnitureUrl.ssSession,objectToStringify),ui_core_build_bundle_module.lb.trackAction(null,"Panel/Viz Copy-Paste: Copy "+("panel"===componentType?"panel":"viz"))}},{key:"getCurrentClipboardItem",value:function(app){if(this._hasAccessToLocalStorage()){var storageString=this.localStorage.getItem("PANEL_SUBPANEL_COPY_PASTE")||"{}",storage=JSON.parse(storageString);return bundle_module.q.get(storage,app.omnitureUrl.ssSession)}}},{key:"paste",value:function(componentToPasteNextTo,app){var pasteData=this.getCurrentClipboardItem(app);return"panel"===pasteData.type?(ui_core_build_bundle_module.lb.trackAction(null,"Panel/Viz Copy-Paste: Paste panel"),PanelSubPanelDuplicator.addPanel(app,componentToPasteNextTo,pasteData.component,!0)):"subPanel"===pasteData.type?(ui_core_build_bundle_module.lb.trackAction(null,"Panel/Viz Copy-Paste: Paste viz"),PanelSubPanelDuplicator.addSubPanel(app,componentToPasteNextTo,pasteData.component,pasteData.linkedComponent,!0,!0)):void 0}},{key:"_hasAccessToLocalStorage",value:function(){return"undefined"!==typeof window&&window.localStorage}},{key:"_setUserClipboard",value:function(id,objectToStringify){JSON.parse(localStorage.getItem("PANEL_SUBPANEL_COPY_PASTE"));var updatedStorage=Object(defineProperty.a)({},id,objectToStringify);this.localStorage.setItem("PANEL_SUBPANEL_COPY_PASTE",JSON.stringify(updatedStorage))}},{key:"localStorage",get:function(){return window.localStorage}}]),CopyPasteUtil}());__webpack_require__(918);function DataSourceItem(props){var truncate={};return props.truncate&&(truncate={"data-title":!0}),react_default.a.createElement("div",{className:"data-source-select-item"},react_default.a.createElement("div",{className:"data-source-select-item-swatch",style:{background:props.swatchColor}}),react_default.a.createElement("div",Object.assign({className:"data-source-select-item-name"},truncate),props.label))}var workspace_DataSourceSettings={Consumer:function(_AppComponent){function DataSourceConsumerSettings(props,context){var _this;return Object(classCallCheck.a)(this,DataSourceConsumerSettings),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(DataSourceConsumerSettings).call(this,props,context))).dataSourceService=new build_bundle_module.O(_this.appContext),_this}return Object(inherits.a)(DataSourceConsumerSettings,_AppComponent),Object(createClass.a)(DataSourceConsumerSettings,[{key:"componentDidMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(DataSourceConsumerSettings.prototype),"componentDidMount",this).call(this);var subPanel=this.props.subPanel;this.observe(subPanel),this.observe(subPanel.linkedSource)}},{key:"canLockOnSelectedItems",value:function(){return this.linkedSource&&this.linkedSource.reportlet.canLockOnSelectedItems()}},{key:"onToggleLock",value:function(value){var reportlet=this.subPanel.reportlet,trackText="";reportlet.isSelectionLocked?(reportlet.unlockSelection(),trackText="Unlock"):(this.canLockOnSelectedItems()||(reportlet.lockType="positions"),reportlet.lockSelection(),trackText="Lock"),ui_core_build_bundle_module.lb.trackAction(null,"Manage Data Source:".concat(trackText," Selection")),value&&this.trackLockType(reportlet.lockType),this.props.onToggleLock(),reportlet.updateDerivedDataSource(this.appContext)}},{key:"onToggleDataSourceVisible",value:function(value){var trackText=value?"Show":"Hide";ui_core_build_bundle_module.lb.trackAction(null,"Manage Data Source:".concat(trackText," Data Source"));var linkedSource=this.subPanel.linkedSource;value&&build_bundle_module.xb.repositionBelowAnchor(linkedSource,this.subPanel,this.subPanels),linkedSource.visible=value,this.forceUpdate()}},{key:"onChangeSource",value:function(){var _onChangeSource=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(_ref){var value,reportlet;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return value=_ref.value,ui_core_build_bundle_module.lb.trackAction(null,"Manage Data Source:Change Data Source"),reportlet=this.subPanel.reportlet,this.subPanel.linkedSourceId=value,reportlet.unlockSelection(),_context.next=7,reportlet.updateDerivedDataSource(this.appContext);case 7:this.subPanel.linkedSource.isHiddenOrCollapsed&&this.subPanel.linkedSource.load(this.appContext,{queryOptionOverrides:{refreshLoadedBreakdowns:!0}}),reportlet.emit("reportlet:render");case 9:case"end":return _context.stop()}},_callee,this)}));return function(_x){return _onChangeSource.apply(this,arguments)}}()},{key:"trackLockType",value:function(type){var tractText="positions"===type?"Positions":"Items";ui_core_build_bundle_module.lb.trackAction(null,"Manage Data Source:Lock Selected ".concat(tractText))}},{key:"onChangeLockType",value:function(_ref2){var value=_ref2.value,reportlet=this.subPanel.reportlet;reportlet.lockType=value,this.trackLockType(value),reportlet.updateDerivedDataSource(this.appContext)}},{key:"showDerivedDataSource",value:function(){this.subPanel.parent;var subPanel=this.subPanel,reportlet=subPanel.reportlet,derivedDataSource=reportlet.derivedDataSource;reportlet.unlockSelection(),subPanel.linkedSource=derivedDataSource,reportlet.updateDerivedDataSource(this.appContext),build_bundle_module.xb.addItemBelowAnchor(derivedDataSource,subPanel,this.subPanels),derivedDataSource.makeNameUnique()}},{key:"onShowDerivedDataSource",value:function(){var _this2=this,dialogMessage=Object(l10nify_build_bundle_module.a)("You are about to generate a new data source for your current visualization, separating it from the original data source. Would you like proceed?"),dialogTitle=Object(l10nify_build_bundle_module.a)("Proceed with Show Table?");ui_core_build_bundle_module.o.confirm(dialogMessage,{title:dialogTitle}).then(function(){_this2.showDerivedDataSource()}).catch(function(err){})}},{key:"renderLockTypeSelect",value:function(){var _this3=this,_ref3$disabled=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).disabled,disabled=void 0!==_ref3$disabled&&_ref3$disabled,_this$subPanel=this.subPanel,reportlet=_this$subPanel.reportlet,linkedSource=_this$subPanel.linkedSource,selectedLockType=!this.isSelectionLocked&&!this.canLockOnSelectedItems()?"positions":reportlet.lockType;return linkedSource.reportlet instanceof build_bundle_module.lb?react_default.a.createElement(ui_core_build_bundle_module.W,{value:selectedLockType,className:"data-source-lock-type",options:this.lockTypeOptions,size:"block",clearable:!1,searchable:!1,disabled:disabled,onChange:function(e){return _this3.onChangeLockType(e)}}):null}},{key:"lockedSelectedItemsOptionShouldBeDisabled",value:function(){return(!this.reportlet.isSelectionLocked||"items"!==this.reportlet.lockType)&&(this.reportlet.isSelectionLocked&&"positions"===this.reportlet.lockType?!this.reportlet.lockedSelection.selectionIsValidForLockedItems():!this.canLockOnSelectedItems())}},{key:"render",value:function(){var _this4=this,_this$subPanel2=this.subPanel,linkedSource=_this$subPanel2.linkedSource,reportlet=_this$subPanel2.reportlet,sourceType=reportlet.linkedSource.reportlet.type;return react_default.a.createElement("div",{className:"data-source-settings"},reportlet.hideDataSourceSelector?null:react_default.a.createElement(ui_core_build_bundle_module.W,{className:"data-source-select",value:this.subPanel.linkedSourceId,options:this.selectOptions,valueRenderer:function(option){return react_default.a.cloneElement(option.label,{truncate:!0})},size:"block",clearable:!1,searchable:!1,onChange:function(e){return _this4.onChangeSource(e)}}),react_default.a.createElement(ui_core_build_bundle_module.k,{checked:linkedSource.visible,onChange:function(e){return _this4.onToggleDataSourceVisible(e.target.checked)},label:Object(l10nify_build_bundle_module.a)("Show Data Source"),"data-test-id":"show-data-source-consumer"}),react_default.a.createElement("br",null),react_default.a.createElement(ui_core_build_bundle_module.k,{className:"data-source-settings--lockSelectionCheckbox",checked:reportlet.isSelectionLocked,onChange:function(e){return _this4.onToggleLock(e.target.checked)},disabled:this.lockCheckBoxShouldBeDisabled,label:"CohortReportlet"===sourceType?Object(l10nify_build_bundle_module.a)("Lock Selected Positions"):Object(l10nify_build_bundle_module.a)("Lock Selection"),"data-test-id":"data-source-settings-".concat("CohortReportlet"===sourceType?"lock-selected-positions":"lock-selection")}),react_default.a.createElement(ui_core_build_bundle_module.C.Help,{className:"data-source-settings-helpIcon"}),react_default.a.createElement(ui_core_build_bundle_module.kb,{className:"data-source-tooltip",position:"right",hoverable:!0},Object(l10nify_build_bundle_module.a)("Enable this setting to lock the visualization to either the table positions or the exact items selected in the data source.")," ",react_default.a.createElement(ui_core_build_bundle_module.F,{href:"https://experiencecloud.adobe.com/resources/help/".concat(l10nify_build_bundle_module.a.config.currentLocale,"/analytics/analysis-workspace/t_sync_visualization.html"),target:"_blank"},Object(l10nify_build_bundle_module.a)("Learn More"))),react_default.a.createElement("br",null),this.renderLockTypeSelect({disabled:!reportlet.isSelectionLocked}),this.derivedDataSourceMessage)}},{key:"linkedSource",get:function(){return bundle_module.q.get(this,"subPanel.linkedSource")}},{key:"subPanel",get:function(){return this.props.subPanel}},{key:"subPanels",get:function(){var parentPanel=this.props.subPanel.parent;return parentPanel?parentPanel.subPanels:null}},{key:"reportlet",get:function(){return this.subPanel.reportlet}},{key:"lockTypeOptions",get:function(){return[{value:"positions",label:Object(l10nify_build_bundle_module.a)("Selected Positions")},{value:"items",disabled:this.lockedSelectedItemsOptionShouldBeDisabled(),label:Object(l10nify_build_bundle_module.a)("Selected Items")}]}},{key:"selectOptions",get:function(){return this.props.subPanel.parent.subPanels.filter(function(subPanel){return subPanel.isDataSource}).map(function(subPanel){return{value:subPanel.id,label:react_default.a.createElement(DataSourceItem,{swatchColor:subPanel.getSwatchColor(),label:subPanel.name||subPanel.defaultName,truncate:!1})}})}},{key:"isSelectionLocked",get:function(){return this.subPanel.reportlet.isSelectionLocked}},{key:"derivedDataSourceMessage",get:function(){var message,_this5=this,reportlet=this.subPanel.reportlet;return this.subPanel.reportlet.derivedDataSource&&(this.dataSourceService.reportletNeedsTrendedSource(reportlet)?message=Object(l10nify_build_bundle_module.a)("This visualization requires trended data. A table was automatically generated to fit this format."):this.dataSourceService.reportletNeedsVennSource(reportlet)?message=Object(l10nify_build_bundle_module.a)("This visualization requires venn data. A table was automatically generated to fit this format."):this.dataSourceService.reportletNeedsLockedSelectionSource(reportlet)&&(message=Object(l10nify_build_bundle_module.a)("This visualization is locked to data that may no longer be visible in the connected data table. To generate a new table with the source data for this visualization, click here: "))),message?react_default.a.createElement("div",{className:"data-source-derived-message"},"*"," ",message," ",react_default.a.createElement(ui_core_build_bundle_module.F,{onClick:function(e){return _this5.onShowDerivedDataSource()}},Object(l10nify_build_bundle_module.a)("Show table")),react_default.a.createElement(ui_core_build_bundle_module.C.Help,null),react_default.a.createElement(ui_core_build_bundle_module.kb,{position:"right"},Object(l10nify_build_bundle_module.a)('Clicking "Show table" will generate a new data source for your current visualization, separating it from the original data source.'))):null}},{key:"lockCheckBoxShouldBeDisabled",get:function(){var linkedSource=this.reportlet.linkedSource;return!this.reportlet.isSelectionLocked&&!(!linkedSource||linkedSource.reportlet.hasSelectedData())}}],[{key:"propTypes",get:function(){return{subPanel:ui_core_build_bundle_module.R.object.isRequired,onToggleLock:ui_core_build_bundle_module.R.func}}},{key:"defaultProps",get:function(){return{onToggleLock:function(){}}}}]),DataSourceConsumerSettings}(ui_build_bundle_module.d),Provider:function(_AppComponent2){function DataSourceProviderSettings(){var _getPrototypeOf2,_this6;Object(classCallCheck.a)(this,DataSourceProviderSettings);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this6=Object(possibleConstructorReturn.a)(this,(_getPrototypeOf2=Object(getPrototypeOf.a)(DataSourceProviderSettings)).call.apply(_getPrototypeOf2,[this].concat(args)))).indexedVisualizations=bundle_module.q.indexBy(build_bundle_module.Nc,"vizType"),_this6}return Object(inherits.a)(DataSourceProviderSettings,_AppComponent2),Object(createClass.a)(DataSourceProviderSettings,[{key:"onToggleDataSourceVisible",value:function(nextVisible){this.props.subPanel.visible=nextVisible}},{key:"getIconForViz",value:function(viz){return react_default.a.createElement(ui_core_build_bundle_module.C,{className:"an-DataSourceProviderSettings-linked-source-icon",size:"XS",color:viz.getSwatchColor(),icon:this.indexedVisualizations[viz.visualizationType].icon})}},{key:"getSelector",value:function(source){return'div[data-sub-panel-id="'.concat(source.id,'"]')}},{key:"onClick",value:function(source){WorkspaceScrollTo_WorkspaceScrollTo.scrollToSubPanel(source.id),ui_core_build_bundle_module.lb.trackAction(null,"Manage Data Source: Clicked Linked Visualization")}},{key:"onMouseEnter",value:function(source){Object(ui_build_bundle_module.mb)(this.getSelector(source)).addClass("is-selected")}},{key:"onMouseLeave",value:function(source){Object(ui_build_bundle_module.mb)(this.getSelector(source)).removeClass("is-selected")}},{key:"render",value:function(){var _this7=this,subPanel=this.props.subPanel,linkedVisualizations=subPanel.getAllLinkedBySubPanelsThatDependOnThisSubPanel();return react_default.a.createElement("div",{className:"data-source-settings"},react_default.a.createElement("h3",{className:"an-DataSourceProviderSettings-linked-source-label"},react_default.a.createElement("b",null,Object(l10nify_build_bundle_module.a)("Linked Visualizations"))),react_default.a.createElement("ul",{className:"an-DataSourceProviderSettings-linked-sources-list"},linkedVisualizations.map(function(source){return react_default.a.createElement("li",{key:source.id,onMouseEnter:_this7.onMouseEnter.bind(_this7,source),onMouseLeave:_this7.onMouseLeave.bind(_this7,source),onClick:_this7.onClick.bind(_this7,source),className:"an-DataSourceProviderSettings-linked-sources-list-item"},_this7.getIconForViz(source),react_default.a.createElement("label",{className:"an-DataSourceProviderSettings-linked-source-label"},source.label))})),0===linkedVisualizations.length?react_default.a.createElement("span",{className:"an-DataSourceProviderSettings-linked-source-label an-DataSourceProviderSettings-linked-sources-list-item an-DataSourceProviderSettings-linked-sources-list-item-none"},react_default.a.createElement("i",null,Object(l10nify_build_bundle_module.a)("None"))):null,react_default.a.createElement("hr",{className:"an-DataSourceProviderSettings-divider"}),react_default.a.createElement(ui_core_build_bundle_module.k,{checked:subPanel.visible,onChange:function(e){return _this7.onToggleDataSourceVisible(e.target.checked)},disabled:0===linkedVisualizations.length,label:Object(l10nify_build_bundle_module.a)("Show Data Source"),"data-test-id":"show-data-source-provider"}))}}]),DataSourceProviderSettings}(ui_build_bundle_module.d)},Reportlet_Reportlet=function(_AppComponent){function Reportlet(props,context){var _this;return Object(classCallCheck.a)(this,Reportlet),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(Reportlet).call(this,props,context)))._onReportSuiteChange=_this._onReportSuiteChange.bind(Object(assertThisInitialized.a)(_this)),_this.onCopy=_this.onCopy.bind(Object(assertThisInitialized.a)(_this)),_this.app.on("change:reportSuite",_this._onReportSuiteChange),_this._setupBroadcastListeners(),_this.observe(_this.app,ui_build_bundle_module.f.DEFINITION_UPDATED,function(entity){bundle_module.q.some(_this.reportlet.getEmbeddedModels(bundle_module.c),{id:entity.id})&&_this.onEmbeddedEntityDefinitionChange({entity:entity})}),_this}return Object(inherits.a)(Reportlet,_AppComponent),Object(createClass.a)(Reportlet,null,[{key:"propTypes",get:function(){return{reportlet:ui_core_build_bundle_module.R.shape({name:ui_core_build_bundle_module.R.string}).isRequired,loadDataOnMount:ui_core_build_bundle_module.R.bool}}},{key:"defaultProps",get:function(){return{loadDataOnMount:!1}}}]),Object(createClass.a)(Reportlet,[{key:"_setupBroadcastListeners",value:function(){this.observe(this.reportlet,"reportlet:render"),this.observe(this.reportlet,"reportlet:load",this.loadData.bind(this)),this.observe(this.reportlet,"reportlet:updateDerivedDataSource",this.updateDerivedDataSource.bind(this)),this.observe(this.reportlet,"project:change",this.loadData.bind(this)),this.observe(this.reportlet,"project:refresh",this.loadData.bind(this)),this.observe(this.reportlet,"panel:change",this.loadData.bind(this)),this.observe(this.reportlet,"project:render")}},{key:"componentWillMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(Reportlet.prototype),"componentWillMount",this).call(this),this.props.loadDataOnMount&&this.loadData()}},{key:"componentDidMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(Reportlet.prototype),"componentDidMount",this).call(this),this.$el=Object(ui_build_bundle_module.mb)(react_dom_default.a.findDOMNode(this)),Object(ui_build_bundle_module.mb)(window.document).on("copy",this.onCopy)}},{key:"componentWillUnmount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(Reportlet.prototype),"componentWillUnmount",this).call(this),this.app.off("change:reportSuite",this._onReportSuiteChange),Object(ui_build_bundle_module.mb)(window.document).off("copy",this.onCopy)}},{key:"_onReportSuiteChange",value:function(e){this.reportlet.clearAllAlerts()}},{key:"loadData",value:function(){return this.reportlet.load(this.appContext)}},{key:"updateDerivedDataSource",value:function(){this.reportlet.updateDerivedDataSource(this.appContext)}},{key:"onCopy",value:function(event){if(event.target.closest(".an-AlertList"))setTimeout(function(){window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},200);else if(($tgt=Object(ui_build_bundle_module.mb)(event.target)).is("input,textarea,button,li")||$tgt.get(0).isContentEditable||!this.$el.is(":focus"))console.log("COPY DEBUG:",Array.from(Object(ui_build_bundle_module.mb)(":focus")));else{var clipboardText=this._getClipboardDataOnCopy();clipboardText&&(ui_build_bundle_module.i.setData(clipboardText,event),event.preventDefault(),this.app.addAlert({variant:"success",contents:Object(l10nify_build_bundle_module.a)("Data copied to clipboard.")}),ui_core_build_bundle_module.lb.trackAction(null,"Ctrl+c: Copy to Clipboard"))}var $tgt}},{key:"_getClipboardDataOnCopy",value:function(){return this.reportlet.canCopyToClipboard()&&0!==bundle_module.q.get(this,"reportlet.selectedCells.length",0)?this.reportlet.formatForClipboard(this.app):null}},{key:"onEmbeddedEntityDefinitionChange",value:function(_ref){_ref.entity;this.loadData()}},{key:"_render",value:function(){return react_default.a.createElement("div",null,"The _render method should be overriden by your reportlet")}},{key:"render",value:function(){var inlineConfigComponent=this.constructor.InlineConfig;return react_default.a.createElement("div",{className:classnames_default()("an-Reportlet","an-".concat(this.constructor.name)),tabIndex:"0"},react_default.a.createElement(ui_core_build_bundle_module.c,{style:{top:inlineConfigComponent?"22px":0},alerts:this.reportlet.alerts,animate:!1}),inlineConfigComponent&&!this.showLoadingIcon&&react_default.a.createElement(Reportlet_InlineConfigWrapper,{subPanel:this.props.subPanel,inlineConfigComponent:inlineConfigComponent}),this._render(),react_default.a.createElement(ui_core_build_bundle_module.qb,{variant:"overlay",show:this.showLoadingIcon}))}},{key:"reportlet",get:function(){return this.props.reportlet}},{key:"showLoadingIcon",get:function(){return!1}}],[{key:"additionalSubPanelClasses",get:function(){return[]}}]),Reportlet}(ui_build_bundle_module.d),Reportlet_InlineConfigWrapper=function(_React$Component){function InlineConfigWrapper(){return Object(classCallCheck.a)(this,InlineConfigWrapper),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(InlineConfigWrapper).apply(this,arguments))}return Object(inherits.a)(InlineConfigWrapper,_React$Component),Object(createClass.a)(InlineConfigWrapper,[{key:"toggleInlineConfig",value:function(){this.reportlet.expandInlineConfig=!this.reportlet.expandInlineConfig,this.updateInlineContentsPosition(),this.forceUpdate()}},{key:"componentDidUpdate",value:function(){this.updateInlineContentsPosition()}},{key:"componentDidMount",value:function(){this.updateInlineContentsPosition()}},{key:"updateInlineContentsPosition",value:function(){this.reportlet.expandInlineConfig?Object(ui_build_bundle_module.mb)(this.inlineConfigContents).slideDown("fast"):Object(ui_build_bundle_module.mb)(this.inlineConfigContents).slideUp("fast")}},{key:"render",value:function(){var _this2=this,InlineConfigComponent=this.props.inlineConfigComponent,headerLabel=InlineConfigComponent.getInlineConfigHeader&&InlineConfigComponent.getInlineConfigHeader(this.reportlet);return react_default.a.createElement("div",null,react_default.a.createElement(InlineConfigHeader,{className:"an-SubPanelInlineConfig-headerHiddenPlaceholder",label:headerLabel}),react_default.a.createElement("div",{className:classnames_default()("an-SubPanelInlineConfig",{"an-SubPanelInlineConfig-expanded":this.reportlet.expandInlineConfig})},react_default.a.createElement(InlineConfigHeader,{label:headerLabel,onClick:this.toggleInlineConfig.bind(this)}),react_default.a.createElement("div",{className:"an-SubPanelInlineConfig-contents",ref:function(node){return _this2.inlineConfigContents=node}},react_default.a.createElement(InlineConfigComponent,{subPanel:this.props.subPanel,reportlet:this.reportlet}))))}},{key:"reportlet",get:function(){return this.props.subPanel.reportlet}}]),InlineConfigWrapper}(react_default.a.Component);function InlineConfigHeader(props){return react_default.a.createElement("div",{className:classnames_default()("an-SubPanelInlineConfig-header ",props.className)},react_default.a.createElement("div",{className:"an-SubPanelInlineConfig-headerLabel","data-title":!0},props.label),react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"wrench",size:"XS",className:"an-SubPanelInlineConfig-expandIcon",onClick:props.onClick}))}var VirtualReportlet_VirtualReportlet=function(_Reportlet){function VirtualReportlet(){return Object(classCallCheck.a)(this,VirtualReportlet),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(VirtualReportlet).apply(this,arguments))}return Object(inherits.a)(VirtualReportlet,_Reportlet),Object(createClass.a)(VirtualReportlet,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){var style={backgroundColor:"#f1f1f1",height:this.props.heightInPixels+"px"};return react_default.a.createElement("div",{className:"an-virtual-reportlet"},react_default.a.createElement("div",{style:style}))}}],[{key:"propTypes",get:function(){return{heightInPixels:ui_core_build_bundle_module.R.number.isRequired}}}]),VirtualReportlet}(Reportlet_Reportlet);function buildDebugMenu(_x,_x2){return _buildDebugMenu.apply(this,arguments)}function _buildDebugMenu(){return(_buildDebugMenu=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(app,contextId){var historyEntries,results,contextEntries,indexedRequests,menuItems;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return historyEntries=build_bundle_module.Yb.getHistory({contextId:contextId}),_context.next=3,Promise.all(historyEntries.map(function(entry){return entry.promise}));case 3:return results=_context.sent,contextEntries=historyEntries.map(function(entry,index){return Object(objectSpread.a)({request:results[index]},bundle_module.q.omit(entry,["promise","result"]))}),indexedRequests=requestsIndexedByName(contextEntries),menuItems=bundle_module.q.map(indexedRequests,function(requests,label){return{label:label,items:bundle_module.q.map(requests,function(requestObject,index){return{label:"".concat(index+1,". ").concat(requestObject.requestTime.format("hh:mm:ss A")),onClick:function(){return showRequestInfo(app,requestObject)}}})}}),_context.abrupt("return",menuItems);case 8:case"end":return _context.stop()}},_callee)}))).apply(this,arguments)}function requestsIndexedByName(contextEntries){var indexedRequests={};return contextEntries.forEach(function(entry){indexedRequests[entry.contextName]=indexedRequests[entry.contextName]||[],indexedRequests[entry.contextName].push(entry)}),indexedRequests}function showRequestInfo(app,requestObject){app.showFullScreenModal({title:Object(l10nify_build_bundle_module.a)("Oberon XML"),view:{id:"oberon-debug-xml",name:Object(l10nify_build_bundle_module.a)("Oberon XML"),component:react_default.a.lazy(function(){return __webpack_require__.e(27).then(__webpack_require__.bind(null,1221))})},hideSaveAs:!0,hideSave:!0,params:Object(objectSpread.a)({},requestObject)})}var currentSelectionModel,$currentElement,recompose=__webpack_require__(919),FreeformReportletComponentDragProxy_FreeformReportletComponentDragProxy=(__webpack_require__(951),function(_Component){function FreeformReportletComponentDragProxy(){return Object(classCallCheck.a)(this,FreeformReportletComponentDragProxy),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(FreeformReportletComponentDragProxy).apply(this,arguments))}return Object(inherits.a)(FreeformReportletComponentDragProxy,_Component),Object(createClass.a)(FreeformReportletComponentDragProxy,[{key:"render",value:function(){var props=this.props;return react_default.a.createElement("div",{className:"freeform-component-drag-proxy"},react_default.a.createElement(ui_build_bundle_module.F,{item:props.component}))}}]),FreeformReportletComponentDragProxy}(react.Component)),DROP_LEFT="left",DROP_RIGHT="right",DROP_ABOVE="above",DROP_BELOW="below",DROP_REPLACE="replace",MAX_HORIZONTAL_REGION_INDENT=100,MAX_VERTICAL_REGION_INDENT=50,ADD_CLASS="add-icon",REPLACE_CLASS="replace-icon",FILTER_BY_CLASS="filter-by-icon",WARNING_CLASS="drop-indicator-warning",DEFAULT_CLASS="dropzone-guides",metricRequired=Object(l10nify_build_bundle_module.a)("Metric needed"),onlyOneMetricIsValid=Object(l10nify_build_bundle_module.a)("Metric overlap");var workspace_selectionService={update:function(selectionModel,element){selectionModel!==currentSelectionModel&&($currentElement&&($currentElement=null),currentSelectionModel&&(currentSelectionModel.selected=!1,currentSelectionModel=null),function(element,selectionModel){currentSelectionModel=selectionModel,($currentElement=element)&&selectionModel&&selectionModel.displayOutline&&(selectionModel.selected=!0)}(element,selectionModel))},current:function(){if(!arguments.length)return currentSelectionModel;this.update(arguments.length<=0?void 0:arguments[0])}};function freeformGetCellAndRowFromElement(elm,reportlet){var rowModel,cellModel,cellId=Object(ui_build_bundle_module.mb)(elm).closest("td").attr("data-cell-id");if(cellId){var cell=bundle_module.q.find(bundle_module.q.flatten(bundle_module.q.pluck(reportlet.rows,"cells")),{id:cellId});cell&&(cellModel=cell,rowModel=cell.parent)}return{cell:cellModel,row:rowModel}}var freeformReportletContentDragDrop_ADD_CLASS="add-icon",freeformReportletContentDragDrop_REPLACE_CLASS="replace-icon",BREAKDOWN_CLASS="breakdown-icon",freeformReportletContentDragDrop_WARNING_CLASS="drop-indicator-warning",freeformReportletContentDragDrop_DEFAULT_CLASS="generic-drop-indicator dropzone-guides",freeformReportletContentDragDrop_metricRequired=Object(l10nify_build_bundle_module.a)("Metric needed"),freeformReportletContentDragDrop_onlyOneMetricIsValid=Object(l10nify_build_bundle_module.a)("Metric overlap");function convertColumnWidths(columnWidths,remainingWidthAfterRemovingBreakdowns){var scale=remainingWidthAfterRemovingBreakdowns/columnWidths.reduce(function(acc,width){return acc+width});return columnWidths.map(function(width){return width*scale})}function generateColumnWidths(oldColumnWidths,columnCount,dataColumnCount,forceUniformWidths,UNIFORM_WIDTH){if(forceUniformWidths)return Array(dataColumnCount).fill(UNIFORM_WIDTH);var columnWidths=Object(toConsumableArray.a)(oldColumnWidths),removingDataColumns=1!==columnWidths.length&&columnWidths.length>dataColumnCount,addingDataColumns=columnWidths.length<dataColumnCount;if(removingDataColumns)columnWidths=columnWidths.slice(0,dataColumnCount);else if(addingDataColumns){var averageColumnWidth=bundle_module.q.sum(columnWidths)/columnWidths.length,newWidths=Array(dataColumnCount-columnWidths.length).fill(averageColumnWidth);columnWidths=columnWidths.concat(newWidths)}return columnWidths.map(function(width){return Math.max(width,.1)})}var freeformUtilities={areColumnsProperlySized:function(freeformTable){return!freeformTable||freeformTable.parent.resizeableColumnCount.length-freeformTable.deepestBreakdownDepth===freeformTable.columnWidths.length},generateColumnWidths:generateColumnWidths,convertColumnWidths:convertColumnWidths,getColumnWidths:function(freeformTable){var forceUniformWidths=arguments.length>1&&void 0!==arguments[1]&&arguments[1],columnCount=freeformTable.parent.resizeableColumnCount.length,breakdownCount=freeformTable.deepestBreakdownDepth,dataColumnCount=columnCount-breakdownCount,remainingWidthAfterRemovingBreakdowns=100-3*breakdownCount,UNIFORM_WIDTH=remainingWidthAfterRemovingBreakdowns/columnCount;return{columnWidths:convertColumnWidths(generateColumnWidths(freeformTable.columnWidths,0,dataColumnCount,forceUniformWidths,UNIFORM_WIDTH),remainingWidthAfterRemovingBreakdowns),remainingWidthAfterRemovingBreakdowns:remainingWidthAfterRemovingBreakdowns,breakdownCount:breakdownCount,BREAKDOWN_WIDTH_PERCENTAGE:3}}};var freeformReportletSelection_SelectedCellCache=function(){function SelectedCellCache(){var selectedCells=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(classCallCheck.a)(this,SelectedCellCache),this.cellsById=bundle_module.q.indexBy(selectedCells,"id")}return Object(createClass.a)(SelectedCellCache,[{key:"addCell",value:function(cell){this.cellsById[cell.id]=cell}},{key:"getSelectedCells",value:function(){return bundle_module.q.pick(this.cellsById,function(cell){return cell.selected})}}]),SelectedCellCache}(),OPERATOR_SYMBOL={divide:"/",add:"+",subtract:"-",multiply:"x",mean:Object(l10nify_build_bundle_module.a)("Mean"),median:Object(l10nify_build_bundle_module.a)("Median"),"col-max":Object(l10nify_build_bundle_module.a)("Column Max"),"col-min":Object(l10nify_build_bundle_module.a)("Column Min"),"col-sum":Object(l10nify_build_bundle_module.a)("Column Sum")};function createCalculatedMetric(_x,_x2,_x3,_x4,_x5,_x6){return _createCalculatedMetric.apply(this,arguments)}function _createCalculatedMetric(){return(_createCalculatedMetric=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(columns,operator,openInBuilder,reportlet,app,customPrecision){var calcMetric,filters,isMultipleMetricOperation,metrics,metricsWithMetaData,containsSameFilters,includeFiltersInDefinition,useOuterFilterContainer,segments,metricDefinitions,items,_items,calcMetricEntity;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return ui_core_build_bundle_module.lb.trackAction(null,"Right Click: Create metric from selection",{operation:openInBuilder?"Open in Calculated Metric Builder":operator}),reportlet.columnTree.loadingComponents=!0,calcMetric=new build_bundle_module.r,filters=[],isMultipleMetricOperation=columns.length>1,metrics=[],metricsWithMetaData=[],columns.forEach(function(col){var metricNode=col.metricNodes[0];filters.push(col.metricFilterNodes),metrics.push(metricNode.component);var metaDataComponent=build_bundle_module.H.fromColumnNode(metricNode);metricsWithMetaData.push(metaDataComponent)}),containsSameFilters=areFiltersIdentical(filters),includeFiltersInDefinition=openInBuilder||!containsSameFilters||!allMetricsAreLeafNodes(columns),useOuterFilterContainer=openInBuilder&&isMultipleMetricOperation&&containsSameFilters,_context.next=13,convertAllFiltersIntoSegments(filters,includeFiltersInDefinition,app);case 13:return segments=_context.sent,_context.next=16,convertAllMetricsIntoRefs(app,metricsWithMetaData,segments,useOuterFilterContainer);case 16:if(1===(metricDefinitions=_context.sent).length?(items=createSingularMetricDefinitionItems(app,metricDefinitions[0],operator),calcMetric.definition.items.push(items)):(_items=createMultipleMetricDefinitionItems(metricDefinitions,operator),useOuterFilterContainer?calcMetric.definition.items.push(build_bundle_module.r.expression({items:_items,segments:segments[0]})):calcMetric.definition.items=_items),(calcMetricEntity=build_bundle_module.r.fromJSON(calcMetric)).rsid=app.reportSuite.rsid,calcMetricEntity.definition=calcMetric.definition,calcMetricEntity.owner=new build_bundle_module.Pb({id:parseFloat(app.user.id)}),calcMetricEntity.precision=void 0===customPrecision?bundle_module.q.max(bundle_module.q.pluck(metrics,"precision")):customPrecision,calcMetricEntity.type="percentChange"===operator?"percent":"decimal",calcMetricEntity.name=getCalculatedMetricName(metricDefinitions,operator,metrics,useOuterFilterContainer&&openInBuilder,segments),!openInBuilder){_context.next=30;break}app.inAppEditors.showCalculatedMetricBuilder({componentWithDefinition:calcMetricEntity}),reportlet.columnTree.loadingComponents=!1,_context.next=33;break;case 30:return _context.next=32,saveCalculatedMetricAndAddColumn(calcMetricEntity,columns,isMultipleMetricOperation,containsSameFilters,operator,app);case 32:reportlet.columnTree.loadingComponents=!1;case 33:case"end":return _context.stop()}},_callee)}))).apply(this,arguments)}function saveCalculatedMetricAndAddColumn(_x7,_x8,_x9,_x10,_x11,_x12){return _saveCalculatedMetricAndAddColumn.apply(this,arguments)}function _saveCalculatedMetricAndAddColumn(){return(_saveCalculatedMetricAndAddColumn=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee2(calcMetricEntity,columns,isMultipleMetricOperation,containsSameFilters,operator,app){var savedCalcMetric,calcMetricColumn,rightMostLeafNode,topRightMostLeafNode,shouldInsertNextToRightMostLeafNode;return regenerator_default.a.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return calcMetricEntity.internal=!0,calcMetricEntity.modified=new Date,_context2.next=4,app.repo.save(calcMetricEntity);case 4:savedCalcMetric=_context2.sent,(calcMetricColumn=new build_bundle_module.fb({component:savedCalcMetric})).tableCellDisplay=build_bundle_module.qb.fromJSON(bundle_module.q.last(columns).tableCellDisplay.toJSON()),"percentChange"===operator&&(calcMetricColumn.tableCellDisplay.type.backgroundType="conditionalFormatting"),rightMostLeafNode=bundle_module.q.last(columns),topRightMostLeafNode=bundle_module.q.last(rightMostLeafNode.selfAndParents),shouldInsertNextToRightMostLeafNode=(!isMultipleMetricOperation||containsSameFilters)&&allMetricsAreLeafNodes(columns),(shouldInsertNextToRightMostLeafNode?rightMostLeafNode:topRightMostLeafNode).addSiblingNode(calcMetricColumn,"right");case 13:case"end":return _context2.stop()}},_callee2)}))).apply(this,arguments)}function convertAllFiltersIntoSegments(filters,includeFiltersInDefinition,app){var newSegmentRequests=includeFiltersInDefinition?filters.map(function(filterArray){return function(nodes,app){var components=bundle_module.q.pluck(nodes,"component"),segments=components.filter(function(component){return component instanceof build_bundle_module.ec}),dateRanges=components.filter(function(component){return component instanceof build_bundle_module.S}),_dimensionItemPromises=components.filter(function(component){return component instanceof build_bundle_module.Y}).map(function(item,i){return build_bundle_module.ec.fromComponents([item],app,{internal:!0,save:!0})}),_dateRangePromises=dateRanges.map(function(item,i){return build_bundle_module.ec.fromComponents([item],app,{internal:!0,save:!0})});return Promise.all([].concat(Object(toConsumableArray.a)(_dimensionItemPromises),Object(toConsumableArray.a)(_dateRangePromises))).then(function(convertedSegments){var allSegments=segments.concat(convertedSegments);return allSegments.map(function(seg){return build_bundle_module.r.segmentRef({component:seg})})})}(filterArray,app)}):[];return Promise.all(newSegmentRequests)}function convertAllMetricsIntoRefs(app,metricsWithMetaData,segments,useOuterFilterContainer){var metricDefinitionRequests=metricsWithMetaData.map(function(metric,i){return getMetricDefinition(app,metric,segments[i])});return useOuterFilterContainer&&(metricDefinitionRequests=metricsWithMetaData.map(function(metric,i){return getMetricDefinition(app,metric)})),Promise.all(metricDefinitionRequests)}function areFiltersIdentical(filters){if(bundle_module.q.all(filters,function(filter){return!filter.length}))return!1;var filterIds=filters.map(function(filterArray){return filterArray.map(function(filter){return filter.id})}),intersection=filterIds.reduce(function(a,b){return bundle_module.q.intersection(a,b)});return bundle_module.q.every(filterIds,function(filterArray){return bundle_module.q.isEqual(filterArray,intersection)})}function createMultipleMetricDefinitionItems(metricDefinitions,operator){var items=[];if("percentChange"===operator){var firstMetricDefinition=metricDefinitions[0],innerExpressionItems=[metricDefinitions[1],build_bundle_module.r.operator({operation:"subtract"}),firstMetricDefinition];items.push(build_bundle_module.r.expression({items:innerExpressionItems}),build_bundle_module.r.operator({operation:"divide"}),firstMetricDefinition.copy())}else metricDefinitions.forEach(function(metric,i){0===i?items.push(metric):items.push(build_bundle_module.r.operator({operation:operator}),metric)});return items}function createSingularMetricDefinitionItems(app,cmMetric1,operator){if(operator){var fn=build_bundle_module.ub.fromJSON({func:operator});return app.repo.hydrateSync(fn),fn.parameters[0].value.items.push(cmMetric1),fn.parameters[1]&&(fn.parameters[1].value.items=[new build_bundle_module.q({value:!0})]),new build_bundle_module.bb({items:[fn]})}return cmMetric1}function allMetricsAreLeafNodes(columns){var columnIds=bundle_module.q.pluck(columns,"id"),selectedLeafMetricColumns=columns[0].parent.parentReportlet.cachedLeafNodes.filter(function(leafNode){return build_bundle_module.Hb.isMetricLike(leafNode.component)&&leafNode.selected});return bundle_module.q.every(columnIds,function(id){return bundle_module.q.pluck(selectedLeafMetricColumns,"id").includes(id)})}function getCalculatedMetricName(cmExpressions,operator,originalMetrics,includeOuterFilterContainerInName){var segments=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(1===cmExpressions.length)return(operator?OPERATOR_SYMBOL[operator]+" ":"")+originalMetrics[0].name;var nameLabel=(cmExpressions=cmExpressions.map(function(exp,i){if(exp instanceof build_bundle_module.bb){var metricName=originalMetrics[i]instanceof build_bundle_module.r||!exp.items.length?originalMetrics[i].name:exp.items[0].name,segmentNames=bundle_module.q.pluck(exp.segments,"name").join(", ");return segmentNames.length?segmentNames+" "+metricName:metricName}return exp.name})).join(" "+OPERATOR_SYMBOL[operator]+" ");return"percentChange"===operator&&(nameLabel=Object(l10nify_build_bundle_module.a)("Percent Change")+" ("+cmExpressions.join(", ")+")"),includeOuterFilterContainerInName?bundle_module.q.pluck(segments[0],"name").join(", ")+" ("+nameLabel+")":nameLabel}function getMetricDefinition(app,metricWithMetaData){var metricDefinition,segments=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],attribution=metricWithMetaData.attribution,metric=metricWithMetaData.component;if(metric instanceof build_bundle_module.r)return app.repo.get(build_bundle_module.r,metric.id,{params:{expansion:"definition"}}).then(function(fullMetric){var _metricDefinition$seg;(metricDefinition=fullMetric.definition,segments)&&(metricDefinition.segments?(_metricDefinition$seg=metricDefinition.segments).push.apply(_metricDefinition$seg,Object(toConsumableArray.a)(segments)):metricDefinition.segments=segments);return metricDefinition});var metricRef=build_bundle_module.r.metricRef({component:metric,attribution:attribution});return metricDefinition=segments.length?build_bundle_module.r.expression({items:[metricRef],segments:segments,attribution:attribution}):metricRef,Promise.resolve(metricDefinition)}var FreeformCellDataSpoofer_FreeformCellDataSpoofer=function(_AppComponent){function FreeformCellDataSpoofer(props,context){var _this;return Object(classCallCheck.a)(this,FreeformCellDataSpoofer),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(FreeformCellDataSpoofer).call(this,props,context))).onSubmit=_this.onSubmit.bind(Object(assertThisInitialized.a)(_this)),_this.onCancel=_this.onCancel.bind(Object(assertThisInitialized.a)(_this)),_this.onKeyDown=_this.onKeyDown.bind(Object(assertThisInitialized.a)(_this)),_this.freeformModelUtil=new build_bundle_module.kb(_this.appContext),_this}return Object(inherits.a)(FreeformCellDataSpoofer,_AppComponent),Object(createClass.a)(FreeformCellDataSpoofer,[{key:"getDefaultValue",value:function(){var _this2=this,_this$props=this.props,cell=_this$props.cell,initialValue=_this$props.reportlet[cell.selected?"selectedRows":"rows"].filter(function(row){return!(row instanceof build_bundle_module.ib)}).map(function(row){return{cells:row.cells.map(function(c){return _this2._getCellValues(c)})}});return JSON.stringify(initialValue,!0,"\t")}},{key:"_getCellValues",value:function(cell){var cellValues;if(cell instanceof build_bundle_module.gb||cell instanceof build_bundle_module.hb){if(cellValues=bundle_module.q.pick(cell,["value"]),bundle_module.q.defaults(cellValues,{value:0}),cell.parentTable&&cell.parentTable.dimension&&cell.parentTable.dimension.isTime){var anomalyValues=bundle_module.q.pick(cell,["expectedValue","upperConfidenceBound","upperConfidenceBoundPercent","lowerConfidenceBound","lowerConfidenceBoundPercent","expectedValue","expectedPercentValue","isAnomaly"]);bundle_module.q.defaults(anomalyValues,{upperConfidenceBound:0,upperConfidenceBoundPercent:0,lowerConfidenceBound:0,expectedValue:0,expectedPercentValue:0,isAnomaly:!1}),cellValues=Object(objectSpread.a)({},cellValues,anomalyValues)}}else cellValues=bundle_module.q.pick(cell,"name");return cellValues}},{key:"onSubmit",value:function(){var _this3=this,_this$props2=this.props,cell=_this$props2.cell,reportlet=_this$props2.reportlet,newValue=JSON.parse(this.textArea.value),rows=reportlet[cell.selected?"selectedRows":"rows"].filter(function(row){return!(row instanceof build_bundle_module.ib)}),summaryRows=reportlet.rows.filter(function(row){return row instanceof build_bundle_module.ob}),columnTotals={};rows.forEach(function(row,rowIndex){row.cells.forEach(function(cellModel,cellIndex){var cellJSON=newValue[rowIndex].cells[cellIndex];if(cellModel.parent instanceof build_bundle_module.ob&&cellModel instanceof build_bundle_module.gb&&cellJSON.value)_this3.freeformModelUtil.updateCell(cell.parentTable,cellModel,cellJSON),reportlet.rows.forEach(function(r){var c=r.cells[cellIndex];c instanceof build_bundle_module.gb&&_this3.freeformModelUtil.updateCell(cell.parentTable,c,{total:cellJSON.value})});else if(cellModel instanceof build_bundle_module.gb){var totalDiff=cellJSON.value-cellModel.value;totalDiff&&(columnTotals[cellModel.parentTable.id]=columnTotals[cellModel.parentTable.id]||{},columnTotals[cellModel.parentTable.id][cellIndex]=columnTotals[cellModel.parentTable.id][cellIndex]||0,columnTotals[cellModel.parentTable.id][cellIndex]+=totalDiff),_this3.freeformModelUtil.updateCell(cell.parentTable,cellModel,cellJSON)}else Object.assign(cellModel,cellJSON),cellJSON.name&&(cellModel.parent.name=cellJSON.name,cellModel.value instanceof Date?cellModel.value=Object(bundle_module.I)(cellJSON.name).toDate():cellModel.value=cellJSON.name,cellModel.emitPropertyChange("name",{newValue:cellJSON.name}))})}),summaryRows.forEach(function(summaryRow){if(columnTotals[summaryRow.parent.id]){var updatedCellsByIndex=columnTotals[summaryRow.parent.id];Object.keys(updatedCellsByIndex).forEach(function(cellIndex){var summaryCell=summaryRow.cells[cellIndex],updatedTotal=summaryCell.value+updatedCellsByIndex[cellIndex];_this3.freeformModelUtil.updateCell(summaryCell.parentTable,summaryCell,{value:updatedTotal}),summaryRow.parent.directRows.forEach(function(row){var c=row.cells[cellIndex];c instanceof build_bundle_module.gb&&_this3.freeformModelUtil.updateCell(cell.parentTable,c,{total:updatedTotal})})})}}),reportlet.emitRender(),ui_core_build_bundle_module.P.closeAll()}},{key:"onKeyDown",value:function(e){(e.ctrlKey||e.metaKey)&&e.keyCode===ui_build_bundle_module.H.ENTER&&this.onSubmit()}},{key:"onCancel",value:function(){ui_core_build_bundle_module.P.closeAll()}},{key:"render",value:function(){var _this4=this;this.props.cell;return react_default.a.createElement("div",{className:"an-FreeformCellDataSpoofer"},react_default.a.createElement("textarea",{defaultValue:this.getDefaultValue(),ref:function(node){return _this4.textArea=node},style:{minWidth:"550px",minHeight:"250px"},onKeyDown:this.onKeyDown}),react_default.a.createElement(ui_core_build_bundle_module.o.Footer,null,react_default.a.createElement(ui_core_build_bundle_module.f,{variant:"quiet",onClick:this.onCancel},Object(l10nify_build_bundle_module.a)("Cancel")),react_default.a.createElement(ui_core_build_bundle_module.f,{variant:"primary",onClick:this.onSubmit},Object(l10nify_build_bundle_module.a)("Submit"))))}}],[{key:"show",value:function(target,cell,reportlet){ui_core_build_bundle_module.P.show({target:target,closeOnClickOutside:!1,dialog:{header:Object(l10nify_build_bundle_module.a)("Spoof Freeform Data"),closeable:!0},getComponent:function(){return react_default.a.createElement(FreeformCellDataSpoofer,{cell:cell,reportlet:reportlet})}})}}]),FreeformCellDataSpoofer}(ui_build_bundle_module.d),AttributionSettingsDialog=__webpack_require__(714);function addContributionAnalysisPanelFromFreeformCell(_x,_x2){return _addContributionAnalysisPanelFromFreeformCell.apply(this,arguments)}function _addContributionAnalysisPanelFromFreeformCell(){return(_addContributionAnalysisPanelFromFreeformCell=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(cell,appContext){var reportlet,subPanel,dimensionItem,components,metricIndex,metaDataComponent,cm,reportletDateRange,dateRanges,newPanelDateRange,panelData,panel,panels;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(reportlet=cell.parentTable.parentReportlet,subPanel=reportlet.parent){_context.next=4;break}return _context.abrupt("return");case 4:if(dimensionItem=cell.component,components=cell.components,!cell.column.dataSettings.attribution){_context.next=13;break}return metricIndex=components.findIndex(function(comp){return comp instanceof build_bundle_module.Hb}),metaDataComponent=new build_bundle_module.H({component:components[metricIndex],dataSettings:cell.column.dataSettings}),_context.next=11,build_bundle_module.r.convertAttributionMetric(metaDataComponent,appContext.app,!0);case 11:cm=_context.sent,components[metricIndex]=cm;case 13:return reportletDateRange=new build_bundle_module.S({definition:reportlet.getExternalParams().dateRange}),dateRanges=components.filter(function(component){return component instanceof build_bundle_module.S}),newPanelDateRange=dateRanges.length?dateRanges[0]:reportletDateRange,panelData={dateRange:newPanelDateRange,segmentGroups:subPanel.parentPanel.segmentGroups,name:Object(l10nify_build_bundle_module.a)("Contribution Analysis")},panel=build_bundle_module.Rb.createWithContributionAnalysisConfig({flattenedComponents:components,dimensionItem:dimensionItem,selectedAnomalyDate:dimensionItem.getRange(appContext.reportSuite).start.toDate(),actualValue:cell.value,expectedValue:cell.expectedValue},panelData),panels=subPanel.parentWorkspace.panels,build_bundle_module.xb.addItemAboveAnchor(panel,subPanel.parentPanel,panels),panel.makeNameUnique(),_context.abrupt("return",panel);case 22:case"end":return _context.stop()}},_callee)}))).apply(this,arguments)}var isIEOrEdge=dom_util_build_bundle_module.a.isIEOrEdge;var FreeformHeaderExpand_FreeformHeaderExpand=function(_React$Component){function FreeformHeaderExpand(){return Object(classCallCheck.a)(this,FreeformHeaderExpand),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(FreeformHeaderExpand).apply(this,arguments))}return Object(inherits.a)(FreeformHeaderExpand,_React$Component),Object(createClass.a)(FreeformHeaderExpand,[{key:"componentDidMount",value:function(){Object(ui_build_bundle_module.mb)(react_dom_default.a.findDOMNode(this)).anFreeformReportletShowTruncatedContent({selector:".js-show-truncated-content",container:".js-freeform-table-column-tree",hasPopovers:!0,onShow:function($el){var $columnHeader=$el.closest(".column-header");if($el.addClass("show-icons"),$el.hasClass("js-content-has-text-wrapping")){$el.parent().css({height:$columnHeader.height()}),$el.css({position:"absolute"});var $label=$el.find(".column-header-label-container");$label.css({width:$label[0].getBoundingClientRect().width,"min-width":$label[0].getBoundingClientRect().width})}$el.find(".column-header-actions").css({width:"auto"})},onHide:function($el){$el.closest(".column-header");$el.removeClass("show-icons"),$el.parent().css({height:""}),$el.css({position:"",width:""}),$el.find(".column-header-label-container").css({width:"","min-width":""}),$el.find(".column-header-actions").css({width:0})}})}},{key:"render",value:function(){return react_default.a.createElement("div",{className:"column-header-height-container"},react_default.a.createElement("div",{className:classnames_default()("column-header-container","js-show-truncated-content",{"js-content-has-text-wrapping":this.props.shouldWrapText})},react_default.a.createElement("div",{className:"column-header-label-container freeform-column-header-drag-handle"},this.props.children),react_default.a.createElement("div",{className:"column-header-actions js-not-selectable"},this.props.actions)))}}],[{key:"defaultProps",get:function(){return{shouldWrapText:!1}}}]),FreeformHeaderExpand}(react_default.a.Component),freeform_DataCellDataLabel=function(_ref){var showNumber=_ref.showNumber,showPercent=_ref.showPercent,numberLabel=_ref.numberLabel,percentLabel=_ref.percentLabel;return showNumber?react_default.a.createElement("div",{className:"an-FreeformTable-cell-dataLabel","data-title":!0},react_default.a.createElement("span",{className:"an-FreeformTable-cell-leftSide an-FreeformTable-cell-numberLabel"},numberLabel),react_default.a.createElement("span",{className:"an-FreeformTable-cell-dividerForTooltip"},"\xa0\xa0\xa0\xa0"),showPercent&&react_default.a.createElement("span",{className:"an-FreeformTable-cell-rightSide an-FreeformTable-cell-percentageLabel an-FreeformTable-cell-percentageLabelNeedsMinWidth"},percentLabel)):react_default.a.createElement("div",{className:"an-FreeformTable-cell-dataLabel","data-title":!0},showPercent&&react_default.a.createElement("span",{className:"an-FreeformTable-cell-leftSide an-FreeformTable-cell-percentageLabel"},percentLabel))},FreeformReportletColumnSettings_FreeformReportletColumnSettings=(__webpack_require__(952),function(_AppComponent){function FreeformReportletColumnSettings(props,context){var _this;return Object(classCallCheck.a)(this,FreeformReportletColumnSettings),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(FreeformReportletColumnSettings).call(this,props,context))).freeformModelUtil=new build_bundle_module.kb(_this.appContext),_this._onPrimaryColumnDisplaySettingsChange=_this._onPrimaryColumnDisplaySettingsChange.bind(Object(assertThisInitialized.a)(_this)),_this._onPrimaryColumnDataSettingsChange=_this._onPrimaryColumnDataSettingsChange.bind(Object(assertThisInitialized.a)(_this)),_this.state={},_this}return Object(inherits.a)(FreeformReportletColumnSettings,_AppComponent),Object(createClass.a)(FreeformReportletColumnSettings,null,[{key:"propTypes",get:function(){return{column:ui_core_build_bundle_module.R.object.isRequired,columns:ui_core_build_bundle_module.R.arrayOf(ui_core_build_bundle_module.R.object).isRequired,freeformTable:ui_core_build_bundle_module.R.object.isRequired,isComputed:ui_core_build_bundle_module.R.bool.isRequired}}}]),Object(createClass.a)(FreeformReportletColumnSettings,[{key:"cache",value:function(){return["attributionTemplates"]}},{key:"componentWillMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(FreeformReportletColumnSettings.prototype),"componentWillMount",this).call(this),this.observe(this.props.columns,"change"),this.registerOff(this.primaryColumn.tableCellDisplay.on("change",this._onPrimaryColumnDisplaySettingsChange)),this.registerOff(this.primaryColumn.dataSettings.on("change",this._onPrimaryColumnDataSettingsChange))}},{key:"_onPrimaryColumnDisplaySettingsChange",value:function(_ref){var _this2=this,newValue=_ref.newValue,property=_ref.property;this.props.columns.forEach(function(col){col.id!==_this2.primaryColumn.id&&bundle_module.q.set(col.tableCellDisplay,property,newValue)})}},{key:"_onPrimaryColumnDataSettingsChange",value:function(_ref2){var _this3=this,newValue=_ref2.newValue,property=_ref2.property;this.props.columns.forEach(function(col){col.id!==_this3.primaryColumn.id&&col.component instanceof build_bundle_module.Hb&&col.component.allocation&&(newValue?bundle_module.q.set(col.dataSettings,property,newValue.copy()):bundle_module.q.set(col.dataSettings,property,newValue))})}},{key:"onCheckboxChange",value:function(type,e){var settings=this.primaryColumn.tableCellDisplay,checked=e.target.checked;settings.type._modelDefinition.getProperty(type)&&(settings.type[type]=checked),"background"===type&&this.props.isComputed&&(settings.type.backgroundType="conditionalFormatting")}},{key:"onAttributionCheckboxChange",value:function(_ref3){var target=_ref3.target,dataSettings=this.props.column.dataSettings;target.checked?this.showAttributionSettingsDialog(dataSettings.attribution):dataSettings.attribution=null}},{key:"onApplyAttribution",value:function(attribution){var freeformTable=this.props.freeformTable,breakdownDefaultAttributions=freeformTable.getDefaultBreakdownAttributions(this.app.cache);this.props.columns.forEach(function(col){var isUpdate=Boolean(col.attribution);col.dataSettings.attribution=attribution.copy(),isUpdate?freeformTable.updateAttribution(col,attribution):freeformTable.recursivelyUpdateAttribution(col,attribution,breakdownDefaultAttributions)})}},{key:"showAttributionSettingsDialog",value:function(selectedAttribution){AttributionSettingsDialog.a.show({selectedAttribution:selectedAttribution,reportSuite:this.props.reportSuite,applySettings:this.onApplyAttribution.bind(this)})}},{key:"onRadioButtonChange",value:function(type){this.primaryColumn.tableCellDisplay.type.backgroundType=type}},{key:"getCheckedState",value:function(type){return this.primaryColumn.tableCellDisplay.type[type]||this.primaryColumn.dataSettings[type]}},{key:"editingSingleColumnLeafNode",value:function(){return 1===this.props.columns.length&&this.props.columns[0].isLeafNode}},{key:"tableOrBreakdownsHaveMixedTypeMetricRows",value:function(){return this.props.freeformTable.allFlattenedCurrentBreakdowns.some(function(t){return t.hasMixedTypeMetricRows()})}},{key:"render",value:function(){var _this4=this,props=this.props,hasAnomalyDetectionPermission=ui_build_bundle_module.x.AnomalyDetectionWorkspace.hasAccess(this.app),settings=this.primaryColumn.tableCellDisplay,backgroundType=settings.type.backgroundType,parentReportletSupportsAnomalies=props.freeformTable.parentReportlet.supportsAnomalies,anomalyCheckedState=!!parentReportletSupportsAnomalies&&this.getCheckedState("anomaly"),hasAttributionPermission=this.app.hasAccessToFeature("attributionInFreeform");return react_default.a.createElement("div",{className:"an-FreeformReportletSettings columnSettingsPopover columnSettings_"+props.columnId},!this.editingSingleColumnLeafNode()&&react_default.a.createElement("div",{className:"an-FreeformReportletColumnSettings-infoText"},Object(l10nify_build_bundle_module.a)("Changes will apply to selected columns and sub-columns")),react_default.a.createElement("div",{className:"an-FreeformReportletSettings-sectionHeader"},Object(l10nify_build_bundle_module.a)("Display In Table Cells")),react_default.a.createElement(ui_core_build_bundle_module.k,{size:"block",label:Object(l10nify_build_bundle_module.a)("Number"),onChange:this.onCheckboxChange.bind(this,"number"),checked:this.getCheckedState("number"),className:"an-FreeformReportletSettings-numberCheckbox","data-test-id":"column-settings-number-checkbox"}),react_default.a.createElement(ui_core_build_bundle_module.k,{size:"block",label:Object(l10nify_build_bundle_module.a)("Percent"),onChange:this.onCheckboxChange.bind(this,"percent"),checked:this.getCheckedState("percent"),disabled:props.isComputed||this.tableOrBreakdownsHaveMixedTypeMetricRows(),"data-test-id":"column-settings-percent-checkbox"}),hasAnomalyDetectionPermission?react_default.a.createElement(ui_core_build_bundle_module.k,{size:"block",label:Object(l10nify_build_bundle_module.a)("Anomalies"),onChange:this.onCheckboxChange.bind(this,"anomaly"),checked:anomalyCheckedState,disabled:!parentReportletSupportsAnomalies,"data-test-id":"column-settings-anomalies-checkbox"}):null,react_default.a.createElement(ui_core_build_bundle_module.k,{size:"block",label:Object(l10nify_build_bundle_module.a)("Wrap Header Text"),onChange:this.onCheckboxChange.bind(this,"wrapHeaderText"),checked:this.getCheckedState("wrapHeaderText"),"data-test-id":"column-settings-wrap-text-checkbox"}),react_default.a.createElement(ui_core_build_bundle_module.k,{size:"block",label:Object(l10nify_build_bundle_module.a)("Interpret zero as no value"),onChange:this.onCheckboxChange.bind(this,"interpretZeroAsNoValue"),checked:this.getCheckedState("interpretZeroAsNoValue"),"data-test-id":"column-settings-zero-interpret-checkbox"}),react_default.a.createElement(ui_core_build_bundle_module.k,{size:"block",label:Object(l10nify_build_bundle_module.a)("Background"),onChange:this.onCheckboxChange.bind(this,"background"),checked:this.getCheckedState("background"),className:"an-FreeformReportletSettings-backgroundCheckbox","data-test-id":"column-settings-background-checkbox"}),react_default.a.createElement(ui_core_build_bundle_module.S.Group,{className:"an-FreeformReporletSettings-background",vertical:!0,onSelect:function(value){return _this4.onRadioButtonChange(value)},selectedValue:this.primaryColumn.tableCellDisplay.type.backgroundType,disabled:!settings.type.background},react_default.a.createElement(ui_core_build_bundle_module.S,{label:Object(l10nify_build_bundle_module.a)("Bar Graph"),value:"bar",disabled:props.isComputed,className:"an-FreeformReportletSettings-bargraphRadio","data-test-id":"column-settings-bar-graph-radio"}),react_default.a.createElement(ui_core_build_bundle_module.S,{label:Object(l10nify_build_bundle_module.a)("Conditional Formatting"),value:"conditionalFormatting",onChange:function(){ui_core_build_bundle_module.lb.trackAction(null,"Conditional Formatting in Pivot Table",{})},className:"an-FreeformReportletSettings-conditionalFormattingRadio","data-test-id":"column-settings-conditional-formatting-radio"})),"conditionalFormatting"!==backgroundType?null:react_default.a.createElement(FreeformReportletColumnSettings_ConditionalFormattingSettings,{disabled:!settings.type.background,primaryColumn:this.primaryColumn,columns:this.props.columns,freeformTable:this.props.freeformTable,isComputed:this.props.isComputed}),react_default.a.createElement("br",null),react_default.a.createElement("div",{className:"an-FreeformReportletSettings-sectionHeader"},Object(l10nify_build_bundle_module.a)("Table Cell Preview")),react_default.a.createElement("div",{className:"an-FreeformTable-cell an-DataProvider-cell",style:{backgroundColor:settings.type.background&&"conditionalFormatting"===backgroundType?"rgb(179, 218, 138)":null}},react_default.a.createElement("div",{"data-test-id":"freeform-cell-container",className:"an-FreeformTable-cell-container an-DataProvider-cell-container"},"bar"===backgroundType?react_default.a.createElement("div",{className:"an-FreeformTable-inlineBarChart",style:{width:"60%"}}):null,hasAnomalyDetectionPermission&&anomalyCheckedState&&"bar"===backgroundType?react_default.a.createElement("div",{className:"an-FreeformTable-inlineBarChartExpected",style:{width:"55%"}}):null,react_default.a.createElement(freeform_DataCellDataLabel,{showNumber:settings.type.number,showPercent:settings.type.percent,numberLabel:this.format(344235),percentLabel:this.format(.68,{type:"percent",precision:1})}),hasAnomalyDetectionPermission&&anomalyCheckedState?react_default.a.createElement(ui_core_build_bundle_module.m,{variant:"inspect",forceShow:!0}):null)),hasAttributionPermission&&this.renderAttributionSettings())}},{key:"renderAttributionSettings",value:function(){var _this5=this,column=this.props.column;if(build_bundle_module.Hb.isMetricLike(column.component)&&this.state.attributionTemplates){var dataSettings=column.dataSettings,selectedAttribution=dataSettings.attribution,metricSupportsAttribution=column.component instanceof build_bundle_module.Hb&&column.component.allocation,metricIsCalcMetric=column.component instanceof build_bundle_module.r,tooltipText=this.attributionTooltipText;return react_default.a.createElement("div",null,react_default.a.createElement("br",null),react_default.a.createElement("div",{className:"an-FreeformReportletSettings-sectionHeader"},Object(l10nify_build_bundle_module.a)("Data Settings")),react_default.a.createElement("div",{className:"an-FreeformReportletSettings-attributionCheckboxContainer"},react_default.a.createElement(ui_core_build_bundle_module.k,{size:"block",label:Object(l10nify_build_bundle_module.a)("Use non-default attribution model"),disabled:!metricSupportsAttribution,onChange:this.onAttributionCheckboxChange.bind(this),checked:dataSettings.useNonDefaultAttribution,className:"an-FreeformReportletSettings-attributionCheckbox","data-test-id":"column-settings-attribution-checkbox"}),react_default.a.createElement(ui_core_build_bundle_module.C.Help,{className:classnames_default()("an-FreeformReportletSettings-attributionHelpIcon",{"is-disabled":!metricSupportsAttribution}),style:{paddingLeft:0}}),react_default.a.createElement(ui_core_build_bundle_module.kb,{position:"right",hoverable:!0},tooltipText,metricSupportsAttribution&&react_default.a.createElement(ui_core_build_bundle_module.F,{label:Object(l10nify_build_bundle_module.a)("Learn More."),target:"_blank",href:"https://experiencecloud.adobe.com/resources/help/".concat(l10nify_build_bundle_module.a.config.currentLocale,"/analytics/analysis-workspace/attribution.html")}),metricIsCalcMetric&&react_default.a.createElement(ui_core_build_bundle_module.F,{label:Object(l10nify_build_bundle_module.a)("calculated metric builder."),onClick:function(){return _this5.app.inAppEditors.showCalculatedMetricBuilder({id:column.component.id})}}))),selectedAttribution&&react_default.a.createElement("div",{className:"an-FreeformReportletSettings-detailText"},react_default.a.createElement("span",null,column.attribution.getLabel(!1,this.props.reportSuite)),react_default.a.createElement(ui_core_build_bundle_module.F,{label:Object(l10nify_build_bundle_module.a)("Edit"),onClick:function(){return _this5.showAttributionSettingsDialog(selectedAttribution)},className:"an-FreeformReportletSettings-attributionEditLink"})))}return null}},{key:"primaryColumn",get:function(){return this.props.column.getPrimaryColumn()}},{key:"attributionTooltipText",get:function(){var column=this.props.column,metricSupportsAttribution=column.component instanceof build_bundle_module.Hb&&column.component.allocation,metricIsCalcMetric=column.component instanceof build_bundle_module.r,tooltipText=metricSupportsAttribution?Object(l10nify_build_bundle_module.a)("Enable a non-default attribution model for the selected column(s). "):Object(l10nify_build_bundle_module.a)("Non-default attribution models are unavailable for this metric. ");return metricIsCalcMetric&&(tooltipText=Object(l10nify_build_bundle_module.a)("Non-default attribution models can be set in the ")),tooltipText}}],[{key:"show",value:function(){var opts=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return bundle_module.q.defaults(opts,{onClose:function(){},isComputed:!1}),ui_core_build_bundle_module.P.show({ref:"FreeformReportletColumnSettings",target:opts.target,isModal:!1,dialog:{header:Object(l10nify_build_bundle_module.a)("Column Settings"),padded:!0},getComponent:function(){return react_default.a.createElement(FreeformReportletColumnSettings,opts)},closeOnClickOutside:!0,onClose:opts.onClose})}}]),FreeformReportletColumnSettings}(ui_build_bundle_module.d)),FreeformReportletColumnSettings_ConditionalFormattingSettings=function(_AppComponent2){function ConditionalFormattingSettings(props,context){var _this6;return Object(classCallCheck.a)(this,ConditionalFormattingSettings),(_this6=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(ConditionalFormattingSettings).call(this,props,context))).freeformModelUtil=new build_bundle_module.kb(_this6.appContext),_this6.state=_this6.getConditionalFormattingLimits(),_this6.setConditionalFormattingLimitsDebounced=bundle_module.q.debounce(_this6.setConditionalFormattingLimits.bind(Object(assertThisInitialized.a)(_this6)),100),_this6}return Object(inherits.a)(ConditionalFormattingSettings,_AppComponent2),Object(createClass.a)(ConditionalFormattingSettings,[{key:"componentWillMount",value:function(){var _this7=this;Object(esm_get.a)(Object(getPrototypeOf.a)(ConditionalFormattingSettings.prototype),"componentWillMount",this).call(this),this.observe(this.props.columns,"change"),this.observe(this.props.columns,"undoRedoComplete",function(){_this7.setState(_this7.getConditionalFormattingLimits())})}},{key:"setLimitValue",value:function(limitValue,limitType){this.setState(Object(defineProperty.a)({},limitType,limitValue)),this.setConditionalFormattingLimitsDebounced(limitValue,limitType)}},{key:"setConditionalFormattingLimits",value:function(limitValue,limitType){var columns=this.props.columns;limitValue=parseFloat(limitValue),Number.isNaN(Number(limitValue))||columns.forEach(function(column){return column.tableCellDisplay.conditionalFormattingOpts[limitType]=limitValue})}},{key:"getConditionalFormattingLimits",value:function(){return this.conditionalFormattingOpts.autoGenerate?this.getConditionalFormattingDefaults():this.getUserDefinedConditionalFormattingLimits()}},{key:"getColumnMax",value:function(){var props=this.props,column=this.primaryColumn;return bundle_module.q.round(this.freeformModelUtil.getColumnMaxUsingTable(column,props.freeformTable),2)}},{key:"getColumnMidpoint",value:function(){var props=this.props,column=this.primaryColumn;return bundle_module.q.round(this.freeformModelUtil.getColumnMidpointUsingTable(column,props.freeformTable),2)}},{key:"getColumnMin",value:function(){var props=this.props,column=this.primaryColumn;return bundle_module.q.round(this.freeformModelUtil.getColumnMinUsingTable(column,props.freeformTable),2)}},{key:"getConditionalFormattingDefaults",value:function(){return{selectedColumn:this.primaryColumn,upperLimit:this.getColumnMax(),midpoint:this.getColumnMidpoint(),lowerLimit:this.getColumnMin()}}},{key:"getUserDefinedConditionalFormattingLimits",value:function(){return{upperLimit:this.conditionalFormattingOpts.upperLimit,midpoint:this.conditionalFormattingOpts.midpoint,lowerLimit:this.conditionalFormattingOpts.lowerLimit}}},{key:"handleAutoGenerateChange",value:function(value,e){e.target.checked&&(this.setState(this.getConditionalFormattingDefaults()),"autoGenerate"===value?this.primaryColumn.tableCellDisplay.conditionalFormattingOpts.setAutogenerate(!0):"custom"===value&&this.primaryColumn.tableCellDisplay.conditionalFormattingOpts.setAutogenerate(!1,this.getConditionalFormattingDefaults()))}},{key:"handleUsePercentsLimitChange",value:function(e){this.conditionalFormattingOpts.usePercentLimits=e.target.checked,this.conditionalFormattingOpts.autoGenerate&&this.setState(this.getConditionalFormattingDefaults())}},{key:"render",value:function(){var _this8=this,settings=this.primaryColumn.tableCellDisplay,disabled=this.props.disabled;return react_default.a.createElement("div",{className:"conditionalFormattingOptionsContainer"},react_default.a.createElement(ui_core_build_bundle_module.k,{disabled:disabled,size:"block",label:Object(l10nify_build_bundle_module.a)("Use Percent Limits"),onChange:this.handleUsePercentsLimitChange.bind(this),checked:settings.conditionalFormattingOpts.usePercentLimits,className:"an-ConditionalFormattingSettings-percentLimitsCB","data-test-id":"column-settings-conditional-formatting-percent-limits-checkbox"},"\xa0\xa0",react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"helpCircle",size:"XS","data-tooltip-immediate":Object(l10nify_build_bundle_module.a)('"Use Percent Limits" allows you to specify limits based on the percentage values for each metric.  This works for metrics that are solely percentage based (like Bounce Rate) as well as metrics that have a count and a percentage (like Page Views).'),className:"conditionalFormatting-usePercentInfo"})),react_default.a.createElement(ui_core_build_bundle_module.S.Group,{vertical:!0,disabled:disabled,selectedValue:settings.conditionalFormattingOpts.autoGenerate?"autoGenerate":"custom"},react_default.a.createElement(ui_core_build_bundle_module.S,{label:Object(l10nify_build_bundle_module.a)("Auto-generated"),value:"autoGenerate",onChange:this.handleAutoGenerateChange.bind(this,"autoGenerate"),checked:settings.conditionalFormattingOpts.autoGenerate,"data-test-id":"column-settings-conditional-formatting-auto-generate-radio"},"\xa0\xa0",react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"helpCircle",size:"XS","data-tooltip-immediate":Object(l10nify_build_bundle_module.a)('Select "Auto-generated" to have the limits for conditional formatting automatically generated.  The upper limit will be the largest value in this column, the lower limit will be the lowest, and the midpoint will be the average of the upper and lower limits.')})),react_default.a.createElement(ui_core_build_bundle_module.S,{label:Object(l10nify_build_bundle_module.a)("Custom"),value:"custom",onChange:this.handleAutoGenerateChange.bind(this,"custom"),checked:!settings.conditionalFormattingOpts.autoGenerate,"data-test-id":"column-settings-conditional-formatting-custom-radio"},"\xa0\xa0",react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"helpCircle",size:"XS","data-tooltip-immediate":Object(l10nify_build_bundle_module.a)('Select "Custom" to manually assign the limits for conditional formatting.  This gives you the flexibility to assign when a column value becomes good, average, or poor. Conditional formatting will not apply to breakdown rows when "Custom" is selected.')}))),react_default.a.createElement(FormLine,{label:Object(l10nify_build_bundle_module.a)("Upper Limit"),settings:settings,value:this.state.upperLimit,onChange:function(e){_this8.setLimitValue(e.target.value,"upperLimit")},className:"conditionalFormatting-upperLimit",dataTestId:"column-settings-conditional-formatting-upper-limit-textfield"}),settings.conditionalFormattingOpts.usePercentLimits?react_default.a.createElement("span",{className:"conditionalFormatting-percentSign"},"%"):null,react_default.a.createElement(FormLine,{label:Object(l10nify_build_bundle_module.a)("Midpoint"),settings:settings,value:this.state.midpoint,onChange:function(e){_this8.setLimitValue(e.target.value,"midpoint")},className:"conditionalFormatting-midpoint",dataTestId:"column-settings-conditional-formatting-midpoint-textfield"}),settings.conditionalFormattingOpts.usePercentLimits?react_default.a.createElement("span",{className:"conditionalFormatting-percentSign"},"%"):null,react_default.a.createElement(FormLine,{label:Object(l10nify_build_bundle_module.a)("Lower Limit"),settings:settings,value:this.state.lowerLimit,onChange:function(e){_this8.setLimitValue(e.target.value,"lowerLimit")},className:"conditionalFormatting-lowerLimit",dataTestId:"column-settings-conditional-formatting-lower-limit-textfield"}),settings.conditionalFormattingOpts.usePercentLimits?react_default.a.createElement("span",{className:"conditionalFormatting-percentSign"},"%"):null)}},{key:"primaryColumn",get:function(){return this.props.primaryColumn}},{key:"conditionalFormattingOpts",get:function(){return this.primaryColumn.tableCellDisplay.conditionalFormattingOpts}}]),ConditionalFormattingSettings}(ui_build_bundle_module.d);function FormLine(props){return react_default.a.createElement("div",{className:classnames_default()("col-settings-form-line",props.className)},react_default.a.createElement("div",{className:"coral-Form-fieldlabel col-settings-text-label","data-title":!0},props.label),react_default.a.createElement(ui_core_build_bundle_module.jb,{value:props.value,size:"S",onChange:props.onChange,className:"coral-Form-field col-settings-text",type:"number",step:"any",disabled:props.settings.conditionalFormattingOpts.autoGenerate,"data-test-id":props.dataTestId}))}function getStyle(widths,index){return widths.length>index?{width:widths[index]}:{}}function ColGroup(props){var widths=[];return props.getColumnWidths&&(widths=props.getColumnWidths()),react_default.a.createElement("colgroup",null,bundle_module.q.range(0,props.size).map(function(o,i){return react_default.a.createElement("col",{key:i,className:classnames_default()("col-".concat(i),{"breakdown-cell-column":i<props.breakdownDepth}),"data-col-id":i,style:getStyle(widths,i)})}))}__webpack_require__(953);var ReportSuiteContext=__webpack_require__(65),FreeformReportletHeader_FreeformReportletHeader=function(props){var reportlet=props.reportlet,app=props.appContext.app,isSingleRow=!reportlet.columnTree.rows||reportlet.columnTree.rows.length<=1,tableClassName=classnames_default()("an-FreeformReportlet-columnContainer h-100 js-freeform-table-column-tree",{"is-single-row":isSingleRow});return react_default.a.createElement("div",{className:"an-FreeformReportletHeader js-sticky-header"},react_default.a.createElement("table",{className:tableClassName},react_default.a.createElement(ColGroup,{getColumnWidths:props.getColumnWidths,size:reportlet.resizeableColumnCount.length,breakdownDepth:reportlet.freeformTable.deepestBreakdownDepth}),react_default.a.createElement("tbody",{className:"h-100"},reportlet.columnTree.rows.length?reportlet.columnTree.rows.map(function(row,rowIndex){return react_default.a.createElement("tr",{key:row.id,className:"an-FreeformReportletHeader-columnRow h-100"},0===rowIndex?react_default.a.createElement(FreeformReportletHeader_PivotCell,{colSpan:reportlet.freeformTable.topMostParentTable.deepestBreakdownDepth+1}):null,row.cells.slice(1).map(function(cell){return react_default.a.createElement(FreeformReportletHeader_TableHeaderCell,Object.assign({key:cell.id},props,{cell:cell,app:app}))}))}):react_default.a.createElement(FreeformReportletHeader_InitialStateRow,props))),react_default.a.createElement("div",{className:"an-backdrop js-header-draggable-backdrop"}))},FreeformReportletHeader_PivotCell=function(props){return react_default.a.createElement("td",{className:classnames_default()("pivot-cell","js-pivot-cell"),colSpan:props.colSpan,rowSpan:props.rowSpan||100})},FreeformReportletHeader_TableHeaderCell=function(props){var cell=props.cell,topItemPosition=cell.column.topItemPosition,reportSuite=(new build_bundle_module.kb(props.appContext),Object(react.useContext)(ReportSuiteContext.b).reportSuite);function shouldShowWarning(){var itemId=cell.column.itemId,c=cell.column.component;return!itemId&&c.shouldShowWarning&&c.shouldShowWarning(props.app)}function getSelectedColumnsAndChildren(selectedNodes){return bundle_module.q.uniq(bundle_module.q.flatten(selectedNodes.map(function(node){return node.allNodesInTree})),"id")}var shouldWrapText=function(){var column;return cell&&cell.column&&cell.column.getPrimaryColumn&&(column=cell.column.getPrimaryColumn()),bundle_module.q.get(column,"tableCellDisplay.type.wrapHeaderText",!1)}(),cellDisplayName=cell.column.component.currentlyUnavailable?Object(l10nify_build_bundle_module.a)("(Unavailable)"):cell.column.name,loadingComponents=props.reportlet.columnTree.loadingComponents;loadingComponents&&cell.column.topItemPosition&&(cellDisplayName=cell.column.component.dimension.name);var displayLockIcon=cell.component instanceof build_bundle_module.Y&&!cell.column.topItemPosition,freeformHeaderActions=react_default.a.createElement("div",{className:classnames_default()("d-flex",{"is-showing-warning-button":shouldShowWarning()})},displayLockIcon&&react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"lockOn",size:"XS",className:"js-not-selectable an-FreeformReportletHeader-lock","data-tooltip":Object(l10nify_build_bundle_module.a)("This dimension item is static and will not change with time."),"data-point-from":"right"}),shouldShowWarning()&&react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"alert",size:"XS",className:"column-header-warning-button js-not-selectable js-freeform-popover-trigger",onClick:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};cell.column.tableCellDisplay.showActionIcons=!0;var headerNode=Object(ui_build_bundle_module.mb)(e.target).closest(".js-column-header");headerNode.addClass("show"),ui_build_bundle_module.q.show({event:e,component:cell.column.component,app:props.app,onClose:function(){headerNode.removeClass("show"),cell.column.tableCellDisplay.showActionIcons=!1}})}}),react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"infoCircle",size:"XS",className:"js-not-selectable js-preview-icon js-freeform-popover-trigger",onClick:function(e){var previewParams={closestContainerSelector:".js-column-header",topItemPosition:topItemPosition,app:props.app,metaData:cell.column.dataSettings};if(topItemPosition){var component=cell.column.component,sameDimensionHeaders=cell.column.parentReportlet.cachedDynamicColumnHeaders.filter(function(col){return col.component.dimension.id===cell.component.dimension.id}),largestTopItemPosition=Math.max.apply(Math,Object(toConsumableArray.a)(sameDimensionHeaders.map(function(header){return header.topItemPosition})));previewParams.customComponentLabel=component.name+" ("+topItemPosition+Object(l10nify_build_bundle_module.a)(" of ")+largestTopItemPosition+")"}ui_build_bundle_module.M.show(cell.column.component,e,previewParams)},"data-point-from":"right"}),react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"gear",size:"XS",className:"column-header-settings-button js-not-selectable js-freeform-popover-trigger",onClick:function(){var target=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).target,isComputed=bundle_module.q.get(cell,"class.computedComponent"),columns=cell.column.selected?getSelectedColumnsAndChildren(props.reportlet.columnTree.selectedNodes):getSelectedColumnsAndChildren([cell.column]);Object(ui_build_bundle_module.mb)(target).closest(".js-column-header").addClass("show"),cell.column.tableCellDisplay.showActionIcons=!0,FreeformReportletColumnSettings_FreeformReportletColumnSettings.show({target:target,column:cell.column,columns:new essence_build_bundle_module.d(columns,{observeItems:!0}),freeformTable:props.reportlet.freeformTable,isComputed:isComputed,reportSuite:reportSuite,onClose:function(){ui_core_build_bundle_module.lb.trackAction(null,"Column Settings Change",{selection:JSON.stringify(cell.column.tableCellDisplay.type)}),Object(ui_build_bundle_module.mb)(target).closest(".js-column-header"),Object(ui_build_bundle_module.mb)(target).closest(".js-column-header").removeClass("show"),cell.column.tableCellDisplay.showActionIcons=!1}})}}),react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"close",size:"XS",className:"column-header-delete-button js-not-selectable",onClick:function(){var topMostTable=props.reportlet.freeformTable,breakdownDefaultAttributions=topMostTable.getDefaultBreakdownAttributions(props.app.cache),column=cell.column;if(column.dataSettings.attribution){column.dataSettings.attribution=null,topMostTable.removeColumnAttributionSetting(column);var attributionNode=column.getAttributionColumnInTree();attributionNode&&topMostTable.recursivelyUpdateAttribution(column,attributionNode.attribution,breakdownDefaultAttributions)}column.remove(!1)}}));return react_default.a.createElement("td",{colSpan:cell.column.colspan,rowSpan:cell.column.rowspan,"data-column-id":cell.column.id,"data-cell-id":cell.id,className:classnames_default()("column-header js-column-header h-100 js-selectable js-selectable-drag-start","cell_".concat(cell.id),cell.class,{show:cell.column.tableCellDisplay.showActionIcons,"column-header-wrap-text":shouldWrapText})},react_default.a.createElement(FreeformHeaderExpand_FreeformHeaderExpand,{actions:freeformHeaderActions,shouldWrapText:shouldWrapText},react_default.a.createElement("span",null,react_default.a.createElement("div",{className:classnames_default()("column-header-label",{"an-FreeformReportletHeader-loadingComponents":loadingComponents&&topItemPosition})},cellDisplayName),cell.column.subLabel(reportSuite)&&react_default.a.createElement("div",{className:classnames_default()("column-header-sublabel")},cell.column.subLabel(reportSuite)))))},FreeformReportletHeader_InitialStateRow=function(props){var reportlet=props.reportlet;return react_default.a.createElement("tr",{className:"an-FreeformReportletHeader-columnRow"},react_default.a.createElement("td",{className:"pivot-cell js-pivot-cell",colSpan:reportlet.freeformTable.topMostParentTable.deepestBreakdownDepth+1,style:props.pivotNodeStyle}),react_default.a.createElement("td",{className:"empty-drop-target"},react_default.a.createElement("div",{className:"an-FreeformReportletHeader-emptyDropContainer"},react_default.a.createElement(ui_core_build_bundle_module.J,null,Object(l10nify_build_bundle_module.a)("Drop a **Metric** Here (or any other component)")))))},shouldShowPercent=function(cell,displayBlankCell){return!(!cell.column||!cell.column.showCellPercent||""===cell.percentLabel||displayBlankCell||!cell.metricIsPercentOnly&&cell.hasMixedTypeMetricRows)},FreeformCell_LabelCell=function(_React$Component){function LabelCell(){return Object(classCallCheck.a)(this,LabelCell),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(LabelCell).apply(this,arguments))}return Object(inherits.a)(LabelCell,_React$Component),Object(createClass.a)(LabelCell,[{key:"onPreviewClick",value:function(e,cell){ui_build_bundle_module.M.show(cell.component,e,{closestContainerSelector:".an-FreeformTable-cell",app:this.props.appContext.app}),ui_core_build_bundle_module.lb.trackAction(null,"Row Actions: Preview")}},{key:"onRemoveClick",value:function(e,row,reportlet){bundle_module.q.contains(row.parent.selectedRows,row)?bundle_module.q.invoke(reportlet.freeformTable.selectedRowsExcludingBreakdowns,"remove"):row.parent.removeStaticRow(row),ui_core_build_bundle_module.lb.trackAction(null,"Row Actions: Delete")}},{key:"generateMagicViz",value:function(e,row,reportlet,appContext){var subPanel=reportlet.parent,freeformModelUtil=new build_bundle_module.kb(appContext);if(row){var newVisualization;switch(bundle_module.q.contains(reportlet.selectedCells,row.cells[0])||freeformModelUtil.selectCell(reportlet,row.cells[0]),bundle_module.q.get(row,"component.constructor")){case build_bundle_module.Y:case build_bundle_module.Hb:case build_bundle_module.r:case build_bundle_module.S:newVisualization=build_bundle_module.vb.create("LineReportlet");break;case build_bundle_module.ec:newVisualization=reportlet.freeformTable.selectedRows.length<=3?build_bundle_module.vb.create("VennReportlet"):build_bundle_module.vb.create("BarReportlet")}newVisualization&&(newVisualization.visualizationIndex=subPanel.parent.nextVisualizationIndexByType(newVisualization.visualizationType),subPanel.addSibling(newVisualization),newVisualization.linkedSource=subPanel,"LineReportlet"===newVisualization.reportlet.type&&(newVisualization.reportlet.useRowBasedPercentages=!0)),ui_core_build_bundle_module.lb.trackAction(null,"Row Actions: Magic Viz")}}},{key:"render",value:function(){var _this=this,_this$props=this.props,row=_this$props.row,cell=_this$props.cell,reportlet=_this$props.reportlet,appContext=_this$props.appContext;return react_default.a.createElement("td",{key:cell._key,className:classnames_default()("an-FreeformTable-cell","an-FreeformTable-labelCell","an-DataProvider-cell","js-selectable","js-selectable-drag-start","js-draggable-item",{"an-FreeformTable-cell-dropTarget":!row.containsBreakdown}),colSpan:cell.colspan,"data-cell-id":cell.id,"data-column-id":bundle_module.q.get(cell,"column.id",null)},react_default.a.createElement("div",{"data-test-id":"freeform-cell-container",className:classnames_default()("an-FreeformTable-cell-container","an-DataProvider-cell-container","cell_".concat(cell.id),"component-swatch component-swatch-"+bundle_module.q.get(cell,"component.itemType",""),{"is-selected":cell.selected})},react_default.a.createElement("div",{className:"an-FreeformTable-cell-labelContainer"},react_default.a.createElement("div",{className:"an-FreeformTable-cell-label"},react_default.a.createElement(RowNumber,{row:row}),react_default.a.createElement("span",{className:"an-FreeformTable-cell-name","data-title":!0},row.parent.hasMixedTypeStaticRows?cell.namePrefix+": ":"",cell.name)),react_default.a.createElement("div",{className:"an-FreeformTable-topCornerCell-actionsContainer js-not-selectable"},cell.previewEnabled?react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"infoCircle",className:"an-FreeformTable-labelCell-previewIcon",size:"XS","data-tooltip":Object(l10nify_build_bundle_module.a)("Preview"),onClick:function(e){return _this.onPreviewClick(e,cell)}}):null,row instanceof build_bundle_module.nb&&cell.component instanceof build_bundle_module.Y&&react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"lockOn",size:"XS",className:"pivot-cell-viz-button an-FreeformTable-topCornerCell-actionButton an-FreeformTable-rowLockIcon","data-tooltip":Object(l10nify_build_bundle_module.a)("This dimension item is static and will not change with time.")}),react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"graphBarVerticalAdd",size:"XS",className:"pivot-cell-viz-button an-FreeformTable-topCornerCell-actionButton","data-tooltip":Object(l10nify_build_bundle_module.a)("Visualize"),onClick:function(e){return _this.generateMagicViz(e,row,reportlet,appContext)}}),row instanceof build_bundle_module.nb?react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"close",size:"XS",className:"pivot-cell-delete-button an-FreeformTable-topCornerCell-actionButton","data-tooltip":Object(l10nify_build_bundle_module.a)("Delete"),onClick:function(e){return _this.onRemoveClick(e,row,reportlet)}}):null)),react_default.a.createElement(ui_core_build_bundle_module.m,{variant:bundle_module.q.get(cell,"message.type"),label:bundle_module.q.get(cell,"message.text")})))}}]),LabelCell}(react_default.a.Component),RowNumber=Object(react_essence_build_bundle_module.b)(function(_ref){var row=_ref.row;return react_default.a.createElement("span",{className:"an-FreeformTable-rowNum"},row.rowNum,".")},{prop:"row",event:"change:rowNum"}),FreeformCell_AnomalyTriangle=function(_ref2){var cell=_ref2.cell,appContext=_ref2.appContext,hasContributionAnalysisPermission=_ref2.hasContributionAnalysisPermission;var aboveOrBelow=cell.expectedValue>cell.value?Object(l10nify_build_bundle_module.a)("below"):Object(l10nify_build_bundle_module.a)("above");return react_default.a.createElement("span",null,react_default.a.createElement(ui_core_build_bundle_module.m,{variant:"inspect",forceShow:!0}),react_default.a.createElement(ui_core_build_bundle_module.kb,{hoverable:!0},react_default.a.createElement("div",{className:"an-FreeformTable-anomalyTooltip"},react_default.a.createElement("div",{className:"an-FreeformTable-anomalyDetectedHeading"},Object(l10nify_build_bundle_module.a)("Anomaly Detected")),react_default.a.createElement("div",null,Object(l10nify_build_bundle_module.a)("%1$s %2$s expected",[function(){var percentage=Math.abs(cell.expectedValue-cell.value)/cell.expectedValue;return percentage="Infinity"===percentage?Object(l10nify_build_bundle_module.a)("Infinity")+"%":appContext.app.format(percentage,{type:"percent"})}(),aboveOrBelow])),function(){var DAY=bundle_module.w.DAY;return bundle_module.q.get(cell,"component.dimension.id")===DAY&&hasContributionAnalysisPermission}()?react_default.a.createElement("div",{className:"an-FreeformTable-analyzeAnomalyContainer"},react_default.a.createElement(ui_core_build_bundle_module.lb,{action:"Run Contribution Analysis from 'Analyze' link (table)"},react_default.a.createElement(ui_core_build_bundle_module.F,{onClick:function(){addContributionAnalysisPanelFromFreeformCell(cell,appContext)},className:"an-FreeformTable-analyzeAnomalyLink"},react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"search",className:"an-FreeformTable-analyzeAnomalyIcon",size:"XS"})," ",Object(l10nify_build_bundle_module.a)("Analyze")))):null)))};function getConditionalFormattingForCell(cell,appContext){cell.freeformModelUtil=cell.freeformModelUtil||new build_bundle_module.kb(appContext);var domain,upperLimit,midpoint,lowerLimit,freeformModelUtil=cell.freeformModelUtil,usePercentLimits=cell.column.tableCellDisplay.conditionalFormattingOpts.usePercentLimits,autoGenerateLimits=cell.column.tableCellDisplay.conditionalFormattingOpts.autoGenerate,value=usePercentLimits?100*cell.percentValue:cell.value;if(autoGenerateLimits?(upperLimit=freeformModelUtil.getColumnMaxUsingCell(cell.column,cell),midpoint=freeformModelUtil.getColumnMidpointUsingCell(cell.column,cell),lowerLimit=freeformModelUtil.getColumnMinUsingCell(cell.column,cell)):(upperLimit=cell.column.upperLimit,midpoint=cell.column.midpoint,lowerLimit=cell.column.lowerLimit),!(cell.parentTable.currentBreakdownDepth>0)||autoGenerateLimits)return domain=cell.column.component.polarity===build_bundle_module.Qb.NEGATIVE?[upperLimit,midpoint,lowerLimit]:[lowerLimit,midpoint,upperLimit],bundle_module.v.scale.linear().domain(domain).range(["rgb(250, 125, 115)","rgb(250, 215, 130)","rgb(179, 218, 138)"]).clamp(!0)(value)}var ObservedLabelCell=Object(react_essence_build_bundle_module.b)(FreeformCell_LabelCell,{prop:"reportlet",event:build_bundle_module.lb.COLUMN_SETTINGS_CHANGED,shouldUpdate:function(e,props){return react_essence_build_bundle_module.b.BASIC_VALIDATOR(e)&&e.item.id===props.cell.columnId},debounce:0},{prop:"cell",event:"change",debounce:0},{prop:"hasMixedTypeStaticRows"},{prop:"row",event:"change",shouldUpdate:function(e){return e.property.startsWith("dataSettings")}}),ObservedDataCell=Object(react_essence_build_bundle_module.b)(function(props){var cell=props.cell,index=(props.row,props.index),appContext=props.appContext,reportlet=props.reportlet,hasAnomalyDetectionPermission=props.hasAnomalyDetectionPermission,hasContributionAnalysisPermission=props.hasContributionAnalysisPermission,displayBlankCell=bundle_module.q.get(cell,"column.interpretZeroAsNoValue")&&(0===cell.value||Number.isNaN(Number(cell.value))),showNumber=0!==index&&cell.column&&cell.column.showCellNumber&&!cell.metricIsPercentOnly,showConditionalFormatting=bundle_module.q.get(cell,"column.showCellConditionalFormatting")&&!displayBlankCell,conditionalFormattingProps=showConditionalFormatting?{style:{backgroundColor:getConditionalFormattingForCell(cell,appContext)}}:{};return react_default.a.createElement("td",{key:cell._key,className:classnames_default()("an-FreeformTable-cell an-DataProvider-cell js-selectable js-selectable-drag-start js-draggable-item"),"data-cell-id":cell.id,"data-column-id":bundle_module.q.get(cell,"column.id",null)},react_default.a.createElement("div",Object.assign({},conditionalFormattingProps,{"data-test-id":"freeform-data-cell-container",className:classnames_default()("an-FreeformTable-cell-container","an-DataProvider-cell-container","cell_".concat(cell.id),"viewDensity-".concat(cell.viewDensity),{"is-selected":cell.selected,"uses-date-compare":cell.actualDateItemId},{"has-conditional-formatting":showConditionalFormatting})}),cell.actualDateItemId&&react_default.a.createElement("div",{className:"an-FreeformTable-cell-actualDate"},bundle_module.w.instance().formatYYYMMDDHH(cell.actualDateItemId)),cell.percentTotal&&cell.column.showCellBar?react_default.a.createElement("div",{className:"an-FreeformTable-inlineBarChart js-cell-bar",style:{width:cell.percentTotal}}):null,cell.expectedValue&&cell.column.showCellBar&&cell.column.showCellAnomalies?react_default.a.createElement("div",{className:"an-FreeformTable-inlineBarChartExpected js-cell-bar",style:{width:cell.expectedPercentTotal}}):null,react_default.a.createElement(freeform_DataCellDataLabel,{showNumber:showNumber&&!displayBlankCell,showPercent:shouldShowPercent(cell,displayBlankCell),numberLabel:cell.name,percentLabel:cell.percentLabel}),hasAnomalyDetectionPermission&&cell.column&&cell.column.showCellAnomalies&&cell.isAnomaly?react_default.a.createElement(FreeformCell_AnomalyTriangle,{cell:cell,appContext:appContext,hasContributionAnalysisPermission:hasContributionAnalysisPermission}):null,reportlet.freeformTable&&reportlet.freeformTable.loadingReport&&react_default.a.createElement(ui_core_build_bundle_module.m,{variant:bundle_module.q.get(cell,"message.type","warning"),label:bundle_module.q.get(cell,"message.text",Object(l10nify_build_bundle_module.a)("Retrieving data..."))}),reportlet.freeformTable&&!reportlet.freeformTable.loadingReport&&cell.message&&cell.message.text&&react_default.a.createElement(ui_core_build_bundle_module.m,{variant:bundle_module.q.get(cell,"message.type"),label:bundle_module.q.get(cell,"message.text")})))},{prop:"reportlet",event:build_bundle_module.lb.COLUMN_SETTINGS_CHANGED,shouldUpdate:function(e,props){return react_essence_build_bundle_module.b.BASIC_VALIDATOR(e)&&e.item.id===props.cell.columnId},debounce:0},{prop:"cell",event:"change",debounce:0},{prop:"freeformTable",event:"change:loadingReport"},{prop:"hasMixedTypeStaticRows"},{prop:"reportlet",event:"project:render"});ObservedLabelCell.displayName="ObservedLabelCell",ObservedDataCell.displayName="ObservedDataCell";__webpack_require__(954);var workspace_freeform_FreeformBreakdownCell=function(_ref){var breakdownLabel,breakdownHeight,row=_ref.row,cellDepth=_ref.cellDepth;if(row.isLastBreakdownRow){var currentBreakdown=row.getParentBreakdowns()[cellDepth];breakdownLabel=row===currentBreakdown.rows[currentBreakdown.rows.length-1]?currentBreakdown.parent.component.name:"",breakdownHeight=currentBreakdown.height}var innerDivStyle={bottom:"4px",left:"4px",height:breakdownHeight-4-2+"px",width:"calc(100% - ".concat(4,"px)")};return react_default.a.createElement("td",{className:"freeform-sideways-breakdown-cell","data-breakdown-level":cellDepth,"data-tooltip":breakdownLabel},breakdownLabel&&react_default.a.createElement("div",{className:"freeform-sideways-breakdown-cell-outer ".concat(row.heightClass)},react_default.a.createElement("div",{style:innerDivStyle,className:"freeform-sideways-breakdown-cell-inner"},breakdownLabel)))},ObservedFreeformRow=Object(react_essence_build_bundle_module.b)(function(){var _ref=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},row=_ref.row,reportlet=_ref.reportlet,appContext=_ref.appContext,freeformTable=_ref.freeformTable,_ref$hasAnomalyDetect=_ref.hasAnomalyDetectionPermission,hasAnomalyDetectionPermission=void 0===_ref$hasAnomalyDetect||_ref$hasAnomalyDetect,hasContributionAnalysisPermission=_ref.hasContributionAnalysisPermission,trClassNames=classnames_default()("an-FreeformTable-row an-FreeformTable-rowData breakdown-level-".concat(row.parentBreakdownDepth),row.heightClass,{"is-collapsed":row.isCollapsed,"is-breakdown":row.isBreakdownRow,"is-last-breakdown":row.isLastBreakdownRow&&!row.isCollapsed});return react_default.a.createElement("tr",{className:trClassNames,"data-table-id":row.parent.uniqueId,"data-row-id":row.id},row.isBreakdownRow&&bundle_module.q.times(row.parentBreakdownDepth,function(i){return react_default.a.createElement(workspace_freeform_FreeformBreakdownCell,{row:row,cellDepth:i+1,key:i})}),1===row.cells.length?[react_default.a.createElement(ObservedLabelCell,Object.assign({cell:row.cells[0],index:0},{row:row,reportlet:reportlet,appContext:appContext,hasAnomalyDetectionPermission:hasAnomalyDetectionPermission,hasContributionAnalysisPermission:hasContributionAnalysisPermission},{key:"LabelCell"})),react_default.a.createElement("td",{className:"an-FreeformTable-cell an-DataProvider-cell an-FreeformTable-placeholderCell",key:"placeholderCell"},react_default.a.createElement("div",{"data-test-id":"freeform-cell-container",className:"an-FreeformTable-cell-container an-DataProvider-cell-container"},react_default.a.createElement(ui_core_build_bundle_module.m,{variant:row.placeholderCell.message.type,label:row.placeholderCell.message.text})))]:row.cells.map(function(cell,index){var CellComponent=0===index?ObservedLabelCell:ObservedDataCell;return react_default.a.createElement(CellComponent,Object.assign({hasMixedTypeStaticRows:freeformTable&&freeformTable.hasMixedTypeStaticRows},{cell:cell,row:row,index:index,reportlet:reportlet,appContext:appContext,hasAnomalyDetectionPermission:hasAnomalyDetectionPermission,hasContributionAnalysisPermission:hasContributionAnalysisPermission,freeformTable:freeformTable},{key:cell.id}))}))},"row"),pageSizeOptions=(__webpack_require__(955),build_bundle_module.pb.pageSizePresets.map(function(pageSize){var str=String(pageSize);return{value:str,label:str}})),pageOptions=bundle_module.q.map(bundle_module.q.range(0,500),function(o){return{value:o+"",label:1+o+""}}),Pagination_Pagination=function(_AppComponent){function Pagination(props,context){var _this;return Object(classCallCheck.a)(this,Pagination),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(Pagination).call(this,props,context))).params=props?props.params:null,_this.decreasePage=_this.decreasePage.bind(Object(assertThisInitialized.a)(_this)),_this}return Object(inherits.a)(Pagination,_AppComponent),Object(createClass.a)(Pagination,[{key:"triggerChange",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Pagination",bundle_module.q.pick(this.params,"viewBy","currentPage")),this.params.emit("paginationChanged")}},{key:"componentDidMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(Pagination.prototype),"componentDidMount",this).call(this),this.el=react_dom_default.a.findDOMNode(this)}},{key:"decreasePage",value:function(){this.params.currentPage=this.params.currentPage-1,this.triggerChange()}},{key:"increasePage",value:function(){this.params.currentPage=this.params.currentPage+1,this.triggerChange()}},{key:"onChangePage",value:function(item){this.params.currentPage=+item.value,this.triggerChange()}},{key:"onChangeRows",value:function(item){this.params.currentPage=0,this.params.viewBy=+item.value,this.triggerChange()}},{key:"render",value:function(){var _this2=this,pageOpts=(this.props,pageOptions.slice(0,this.params.totalPages)),currentPage=this.params.totalPages>1?react_default.a.createElement(ui_core_build_bundle_module.W.Inline,{className:"ad-Pagination-page",value:this.params.currentPage+"",options:pageOpts,onChange:function(item){return _this2.onChangePage(item)}}):react_default.a.createElement("span",{className:"ad-Paginagion-exactlyOnePage"}," 1 ");return react_default.a.createElement("div",{className:"ad-Pagination js-not-selectable"},react_default.a.createElement("span",{className:"ad-Pagination-pageGroup"},Object(l10nify_build_bundle_module.a)("Page: "),react_default.a.createElement(ui_core_build_bundle_module.C,{show:this.params.currentPage>0,icon:"chevronLeft",size:"XS",className:"ad-Pagination-decreasePage",onClick:this.decreasePage}),currentPage,"/",this.format(this.params.totalPages),react_default.a.createElement(ui_core_build_bundle_module.C,{show:this.params.currentPage<this.params.totalPages-1,icon:"chevronRight",size:"XS",className:"ad-Pagination-increasePage",onClick:function(){return _this2.increasePage()}})),react_default.a.createElement("span",{className:"ad-Pagination-pageSizeGroup"},Object(l10nify_build_bundle_module.a)("Rows: "),react_default.a.createElement(ui_core_build_bundle_module.W.Inline,{className:"ad-Pagination-rowSize",menuContainerClassName:"ad-Pagination-selectMenu",value:this.params.viewBy+"",options:pageSizeOptions,onChange:function(item){return _this2.onChangeRows(item)}}),"\xa0"))}}]),Pagination}(ui_build_bundle_module.d),FreeformReportletSettings_FreeformReportletSettings=function(_AppComponent){function FreeformReportletSettings(){var _getPrototypeOf2,_this;Object(classCallCheck.a)(this,FreeformReportletSettings);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=Object(possibleConstructorReturn.a)(this,(_getPrototypeOf2=Object(getPrototypeOf.a)(FreeformReportletSettings)).call.apply(_getPrototypeOf2,[this].concat(args)))).freeformModelUtil=new build_bundle_module.kb(_this.appContext),_this}return Object(inherits.a)(FreeformReportletSettings,_AppComponent),Object(createClass.a)(FreeformReportletSettings,[{key:"componentDidMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(FreeformReportletSettings.prototype),"componentDidMount",this).call(this),this.observe(this.props.table)}},{key:"onDateShiftChange",value:function(){this.props.table.topMostParentTable.loadAllReports()}},{key:"render",value:function(){var _this2=this,table=this.props.table;return react_default.a.createElement("div",{className:"an-FreeformReportletSettings an-FreeformTable-settingsPopover"},react_default.a.createElement(ui_core_build_bundle_module.o.Header,{label:Object(l10nify_build_bundle_module.a)("Row Settings")}),react_default.a.createElement("div",{className:"ad-Popover-content1 an-FreeformTable-settingsContent u-coral-padding"},react_default.a.createElement("div",null,react_default.a.createElement("div",{className:"ad-Popover-section1"},build_bundle_module.db.isActive("massiveDownload")?react_default.a.createElement(FreeformReportletSettings_MassiveDownloadSettings,{table:table}):null,react_default.a.createElement("div",{className:"an-FreeformReportletSettings-section"},react_default.a.createElement("div",{className:"an-FreeformReportletSettings-sectionHeader","data-title":!0},Object(l10nify_build_bundle_module.a)("Date Comparisons")),react_default.a.createElement(ui_core_build_bundle_module.k,{size:"block",label:Object(l10nify_build_bundle_module.a)("Align dates from each column to all start on the same row (applies to entire table)."),checked:table.alignDatesForTimeDimensionInTopTable,onChange:function(e){table.alignDatesForTimeDimensionInTopTable=e.target.checked,_this2.onDateShiftChange()},className:"an-FreeformReportletSettings-dateCompareCheckbox","data-test-id":"freeform-row-head-date-comparisons"})),table.staticRows.length?react_default.a.createElement(FreeformReportletSettings_StaticRowSettings,{table:table}):null,table.staticRows.length?null:react_default.a.createElement(FreeformReportletSettings_ColumnPercentagesSettings,{table:table}),react_default.a.createElement("div",{className:"an-FreeformReportletSettings-section"},react_default.a.createElement("div",{className:"an-FreeformReportletSettings-sectionHeader","data-title":!0},Object(l10nify_build_bundle_module.a)("Breakdowns")),react_default.a.createElement(ui_core_build_bundle_module.k,{size:"block",className:"an-FreeformReportletSettings-breakdownByPositionCheckbox",label:Object(l10nify_build_bundle_module.a)("Breakdown by position"),checked:table.settings.breakdownByPosition,onChange:function(e){return _this2.freeformModelUtil.setBreakdownByPosition(table,e.target.checked)},"data-test-id":"freeform-row-head-breakdown-by-position"}))))))}}],[{key:"show",value:function(){var opts=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};bundle_module.q.defaults(opts,{onClose:function(){}}),ui_core_build_bundle_module.P.show({ref:"FreeformReportletSettings",target:opts.target,isModal:!1,dialog:{padded:!1},getComponent:function(){return react_default.a.createElement(FreeformReportletSettings,opts)},closeOnClickOutside:!0,onClose:opts.onClose})}}]),FreeformReportletSettings}(ui_build_bundle_module.d),FreeformReportletSettings_MassiveDownloadSettings=function(_ref){var table=_ref.table;if(!build_bundle_module.db.isActive("massiveDownload"))return null;var downloadRowsOpts=[{value:"-2",label:Object(l10nify_build_bundle_module.a)("Do not change.")},{value:"-1",label:Object(l10nify_build_bundle_module.a)("All rows (this may be very large)")},{value:"custom",label:Object(l10nify_build_bundle_module.a)("Custom number of rows")}],downloadRowsSelectValue=(bundle_module.q.contains([-1,-2],table.downloadSettings.csvRows)?table.downloadSettings.csvRows:"custom")+"";return react_default.a.createElement("div",{className:"an-FreeformReportletSettings-section"},react_default.a.createElement("div",{className:"an-PivotTableSettings-sectionHeader","data-title":!0},Object(l10nify_build_bundle_module.a)("Download Options")),react_default.a.createElement(ui_core_build_bundle_module.u,{label:Object(l10nify_build_bundle_module.a)("Number of rows for CSV")},react_default.a.createElement(ui_core_build_bundle_module.W,{options:downloadRowsOpts,searchable:!1,clearable:!1,size:"block",value:downloadRowsSelectValue,onChange:function(val){"custom"===val.value?-1!==table.downloadSettings.csvRows&&-2!==table.downloadSettings.csvRows||(table.downloadSettings.csvRows=table.pagination.viewBy):table.downloadSettings.csvRows=+val.value},className:"an-MassiveDownloadSettings-numCsvRows"})),table.downloadSettings.csvRows>=0&&react_default.a.createElement("div",{style:{marginBottom:"20px"}},react_default.a.createElement(ui_core_build_bundle_module.jb,{placeholder:Object(l10nify_build_bundle_module.a)("Rows"),size:"block",type:"number",value:table.downloadSettings.csvRows,onChange:function(e){table.downloadSettings.csvRows=+e.target.value}})))},FreeformReportletSettings_StaticRowSettings=function(props){var table=props.table,isTotalsTypeDisabled=!table.canUseTotalsType("allVisits"),onTotalsTypeChange=function(){table.allFlattenedBreakdowns.forEach(function(breakdown){bundle_module.q.get(breakdown,"staticRows.length")&&!build_bundle_module.Hb.isMetricLike(breakdown.staticRows[0].component)&&(breakdown.settings.totalsType=props.table.settings.totalsType)}),table.loadAllReports()},selectedValue=table.settings.useColumnSumTotals?"columnSum":"allVisits";return react_default.a.createElement("div",{className:"an-FreeformReportletSettings-section"},react_default.a.createElement("div",{className:"an-FreeformReportletSettings-sectionHeader column-totals-header","data-title":!0},Object(l10nify_build_bundle_module.a)("Column Totals")),react_default.a.createElement(ui_core_build_bundle_module.S.Group,{className:"column-totals-radio-group",vertical:!0,disabled:isTotalsTypeDisabled,selectedValue:selectedValue},react_default.a.createElement(ui_core_build_bundle_module.S,{label:Object(l10nify_build_bundle_module.a)("Calculate totals by summing the values currently in each column."),value:"columnSum",className:"an-StaticRowSettings-useColumnSumTotals",onChange:function(){table.settings.totalsType="columnSum",ui_core_build_bundle_module.lb.trackAction(null,"Column Sum Totals - Pivot Table Settings"),onTotalsTypeChange()},"data-test-id":"freeform-static-row-use-column-sum-totals"}),react_default.a.createElement(ui_core_build_bundle_module.S,{className:"an-StaticRowSettings-useAllVisitsTotals",label:Object(l10nify_build_bundle_module.a)("Calculate totals based on all rows for each metric."),value:"allVisits",onChange:function(){table.settings.totalsType="allVisits",ui_core_build_bundle_module.lb.trackAction(null,"All Visits Totals - Pivot Table Settings"),onTotalsTypeChange()},"data-test-id":"freeform-static-row-use-all-visits-totals"})))},FreeformReportletSettings_ColumnPercentagesSettings=function(props){var table=props.table,onColumnPercentagesChange=function(e){ui_core_build_bundle_module.lb.trackAction(null,"Column Percentages - Pivot Table Settings"),table.settings.rowBasedPercentages="rowPercentages"===e.target.value,table.loadAllReports()},selectedValue=table.settings.rowBasedPercentages?"rowPercentages":"columnPercentages";return react_default.a.createElement("div",{className:"an-FreeformReportletSettings-section"},react_default.a.createElement("div",{className:"an-FreeformReportletSettings-sectionHeader","data-title":!0},Object(l10nify_build_bundle_module.a)("Column Percentages")),react_default.a.createElement(ui_core_build_bundle_module.S.Group,{className:"an-FreeformReportletSettings-columnPercentagesRadioGroup",vertical:!0,selectedValue:selectedValue},react_default.a.createElement(ui_core_build_bundle_module.S,{label:Object(l10nify_build_bundle_module.a)("Calculate percentages by column."),value:"columnPercentages",className:"an-FreeformReportletSettings-columnPercentages",onChange:onColumnPercentagesChange,"data-test-id":"freeform-row-settings-column-percentages"}),react_default.a.createElement(ui_core_build_bundle_module.S,{label:Object(l10nify_build_bundle_module.a)("Calculate percentages by row."),value:"rowPercentages",className:"an-FreeformReportletSettings-rowPercentages",onChange:onColumnPercentagesChange,"data-test-id":"freeform-row-settings-row-percentages"})))};__webpack_require__(956);function FreeformSummaryRow_templateObject(){var data=Object(taggedTemplateLiteral.a)(["(Edit)"]);return FreeformSummaryRow_templateObject=function(){return data},data}var sharedCellClassNames=["an-FreeformTable-cell","an-DataProvider-cell","js-selectable","js-selectable-drag-start","js-draggable-item"];function shouldRenderAttributionLabel(totalsCell,freeformTable){return!!totalsCell.column&&(!!totalsCell.closestMetric&&(!!freeformTable.getAttribution(totalsCell.column)&&(!freeformTable.isTopMostParentTable||freeformTable.hasCrossTab(totalsCell.column))))}var FreeformSummaryRow_AttributionModelLabel=function(props){var reportSuite=Object(react.useContext)(ReportSuiteContext.b).reportSuite,attribution=props.attribution,onApplyAttribution=props.onApplyAttribution,attributionLabel=attribution.getLabel(!0,reportSuite);return react_default.a.createElement("div",{className:"attribution-model-label"},react_default.a.createElement("div",{className:classnames_default()("attribution-model-label-text"),"data-title":!0},attributionLabel),react_default.a.createElement(ui_core_build_bundle_module.F,{className:classnames_default()("attribution-model-edit"),onClick:function(){return AttributionSettingsDialog.a.show({reportSuite:reportSuite,selectedAttribution:attribution,applySettings:onApplyAttribution})},label:Object(l10nify_build_bundle_module.a)(FreeformSummaryRow_templateObject())}))},ObservedFreeformSummaryRow=Object(react_essence_build_bundle_module.b)(function(_ref){var row=_ref.row,reportlet=_ref.reportlet,appContext=_ref.appContext,freeformTable=_ref.freeformTable;freeformTable=freeformTable||row.parent||{};var hasAttributionInFreeformPermission=appContext&&appContext.app.hasAccessToFeature("attributionInFreeform"),rowHasAttributionLabel=row.cells.some(function(cell){return shouldRenderAttributionLabel(cell,freeformTable)})&&hasAttributionInFreeformPermission;return react_default.a.createElement("tr",{className:classnames_default()("an-FreeformTable-row an-FreeformTable-rowSummary breakdown-level-".concat(row.parentBreakdownDepth),"".concat(row.heightClass),{"is-collapsed":row.isCollapsed,"is-breakdown":row.isBreakdownRow,"row-has-attribution-label":rowHasAttributionLabel}),"data-table-id":freeformTable.uniqueId,"data-row-id":row.id},row.isBreakdownRow&&bundle_module.q.times(row.parentBreakdownDepth,function(i){return react_default.a.createElement(workspace_freeform_FreeformBreakdownCell,{row:row,cellDepth:i+1,key:i})}),1===row.cells.length?[react_default.a.createElement(ObservedControlCell,Object.assign({cell:row.cells[0],index:0},{row:row,reportlet:reportlet,appContext:appContext,freeformTable:freeformTable},{key:"controlCell"})),react_default.a.createElement("td",{className:"an-FreeformTable-cell an-DataProvider-cell an-FreeformTable-placeholderCell",key:"placeholderCell"},react_default.a.createElement("div",{className:"an-FreeformTable-cell-container an-DataProvider-cell-container"},react_default.a.createElement(ui_core_build_bundle_module.m,{variant:row.placeholderCell.message.type,label:row.placeholderCell.message.text})))]:row.cells.map(function(cell,index){var CellComponent=0===index?ObservedControlCell:ObservedTotalsCell,attributionSetting=cell.column?freeformTable.getAttributionSetting(cell.column):null;return react_default.a.createElement(CellComponent,Object.assign({cell:cell,attributionSetting:attributionSetting,row:row,index:index,reportlet:reportlet,appContext:appContext,freeformTable:freeformTable},{key:cell._key}))}))},"row"),ObservedControlCell=Object(react_essence_build_bundle_module.b)(function(props){var cell=props.cell,row=props.row,reportlet=props.reportlet,appContext=props.appContext,freeformTable=props.freeformTable,showActionIcons=bundle_module.q.get(row,"showActionIcons",!1),isLabelColumnSortable=bundle_module.q.get(row,"isLabelColumnSortable",!1),isLabelColumnSearchable=bundle_module.q.get(row,"isLabelColumnSearchable",!1),description=bundle_module.q.get(row,"description",""),totalPages=bundle_module.q.get(freeformTable,"pagination.totalPages",0),collapsed=bundle_module.q.get(freeformTable,"collapsed",!1),loadingReport=bundle_module.q.get(freeformTable,"loadingReport",!1);return react_default.a.createElement("td",{className:classnames_default.a.apply(void 0,sharedCellClassNames.concat(["an-FreeformTable-labelCell","an-FreeformTable-cell-dropTarget"])),colSpan:cell.colspan,"data-cell-id":cell.id},react_default.a.createElement("div",{className:classnames_default()("an-FreeformTable-cell-container","an-DataProvider-cell-container","cell_".concat(cell.id),{"is-selected":cell.selected})},react_default.a.createElement("div",{className:classnames_default()("an-FreeformTable-cellTitleContainer js-show-truncated-content",showActionIcons?"show":"")},react_default.a.createElement("div",{className:"an-FreeformTable-cellTitleLabelContainer"},react_default.a.createElement("div",{className:"an-FreeformTable-cell-label","data-title":!0},react_default.a.createElement("span",{className:"an-FreeformTable-cell-name"},cell.name," "),isLabelColumnSortable?react_default.a.createElement(ObservedSort,{freeformTable:freeformTable,reportlet:reportlet,appContext:appContext}):null,isLabelColumnSearchable?react_default.a.createElement(ui_build_bundle_module.V,{className:"FreeformReportlet-an-SearchFilter-override",search:row.parent.search}):null),react_default.a.createElement("div",{className:"an-FreeformTable-cell-description overflow-truncate"},totalPages>0?react_default.a.createElement(Pagination_Pagination,{params:freeformTable.pagination}):null,react_default.a.createElement("span",{className:"an-FreeformTable-cell-descriptionLabel"},loadingReport?Object(l10nify_build_bundle_module.a)("Retrieving data..."):description))),react_default.a.createElement("div",{className:"an-FreeformTable-cellTitleActions js-not-selectable"},freeformTable.dimension&&react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"infoCircle",size:"XS",className:"js-not-selectable pivot-cell-info-button js-freeform-popover-trigger",onClick:function(e){var target=e.target;Object(ui_build_bundle_module.mb)(target).closest(".js-show-truncated-content").addClass("show"),freeformTable.summaryRow.showActionIcons=!0,ui_build_bundle_module.M.show(freeformTable.dimension,e,{closestContainerSelector:".an-FreeformTable-labelCell",app:appContext?appContext.app:null,onClose:function(){freeformTable.summaryRow.showActionIcons=!1,Object(ui_build_bundle_module.mb)(target).closest(".js-show-truncated-content").removeClass("show")}})},"data-point-from":"right"}),react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"gear",size:"XS",onClick:function(e){var target=e.target;Object(ui_build_bundle_module.mb)(target).closest(".js-show-truncated-content").addClass("show"),freeformTable.summaryRow.showActionIcons=!0,FreeformReportletSettings_FreeformReportletSettings.show({target:target,table:freeformTable,onClose:function(){freeformTable.summaryRow.showActionIcons=!1,Object(ui_build_bundle_module.mb)(target).closest(".js-show-truncated-content").removeClass("show")}})},className:"js-not-selectable pivot-cell-settings-button js-freeform-popover-trigger"}),react_default.a.createElement(ui_core_build_bundle_module.C,{icon:collapsed?"accordionLeft":"accordionDown",size:"XS",className:"js-not-selectable pivot-cell-collapse-button",onClick:function(){freeformTable.collapsed=!freeformTable.collapsed,ui_core_build_bundle_module.lb.trackAction(null,"Breakdown Collapse/Expand")}}),react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"close",size:"XS",className:"js-not-selectable pivot-cell-delete-button",onClick:function(){row.removeBreakdown(),reportlet.updateLinkedByDerivedDataSources(appContext)}}))),react_default.a.createElement(ui_core_build_bundle_module.m,{variant:bundle_module.q.get(cell,"message.type"),label:bundle_module.q.get(cell,"message.text")})))},"cell",{prop:"freeformTable",event:"change:loadingReport"},{prop:"freeformTable",event:"change:collapsed"}),ObservedSparkLine=Object(react_essence_build_bundle_module.b)(function(_ref3){var trendLine=_ref3.trendLine,displayTrendLine=bundle_module.q.get(trendLine,"data.length",0)>0,sparkLineProps=displayTrendLine?{adModel:trendLine.data,animate:!1,leftlabel:trendLine.startLabel,rightlabel:trendLine.endLabel}:null;return react_default.a.createElement("div",{className:"an-FreeformTable-sparkLineContainer"},displayTrendLine?react_default.a.createElement(ui_core_build_bundle_module.cb,sparkLineProps):react_default.a.createElement("div",{className:"an-FreeformTable-sparkLine"}))},"trendLine",{prop:"reportlet",event:build_bundle_module.lb.COLUMN_SETTINGS_CHANGED},{prop:"reportlet",event:"columnResized"},{prop:"reportlet",event:"updateSparkLines"}),ObservedSort=Object(react_essence_build_bundle_module.b)(function(_ref4){var appContext=_ref4.appContext,freeformTable=_ref4.freeformTable,reportlet=_ref4.reportlet,columnId=_ref4.columnId,isLabelCell=!columnId,defaultToAsc=isLabelCell&&bundle_module.q.get(freeformTable,"dimension.isTime"),active=!columnId&&freeformTable.labelColumnSort||columnId&&columnId===freeformTable.sortedColumnId||!1;return react_default.a.createElement(ui_core_build_bundle_module.C,{"data-test-id":"sort-arrow",icon:!active&&defaultToAsc||active&&freeformTable.sortAscending?"arrowUp":"arrowDown",className:classnames_default()("ad-Sort","ad-Sort--arrowOnRight","js-not-selectable",{"ad-Sort--inactive":!active}),onClick:function(){new build_bundle_module.kb(appContext).toggleSort(freeformTable,columnId,isLabelCell),bundle_module.q.get(freeformTable,"staticRows.length")&&reportlet.updateLinkedByDerivedDataSources(appContext),ui_core_build_bundle_module.lb.trackAction(null,"Sort",{direction:freeformTable.sortAscending?"asc":"desc"})}})},{prop:"freeformTable",event:"change:sort.asc"},{prop:"freeformTable",event:"change:sort.columnId"},{prop:"freeformTable",event:"change:sort.labelColumn"}),ObservedTotalsCell=Object(react_essence_build_bundle_module.b)(function(_ref2){var cell=_ref2.cell,attributionSetting=_ref2.attributionSetting,freeformTable=_ref2.freeformTable,reportlet=_ref2.reportlet,appContext=_ref2.appContext,mixedMetrics=freeformTable.hasMixedTypeMetricRows(),canTotal=bundle_module.q.get(cell,"column.component.canTotal",!0),hideTotal=!bundle_module.q.get(cell,"column.showCellNumber",!0)||!canTotal||mixedMetrics,hidePercent=!bundle_module.q.get(cell,"column.showCellPercent",!0)||!cell.percentLabel||mixedMetrics,closestMetric=cell.closestMetric;closestMetric&&"percent"!==closestMetric.type&&(hidePercent=!0);var hasAttributionInFreeformPermission=appContext.app.hasAccessToFeature("attributionInFreeform"),renderAttributionLabel=shouldRenderAttributionLabel(cell,freeformTable);return react_default.a.createElement("td",{className:classnames_default.a.apply(void 0,sharedCellClassNames),"data-cell-id":cell.id,"data-column-id":cell.columnId},react_default.a.createElement("div",{className:classnames_default()("an-FreeformTable-cell-container","an-DataProvider-cell-container","cell_".concat(cell.id),{"is-selected":cell.selected},{"cell-has-attribution-label":renderAttributionLabel})},renderAttributionLabel&&hasAttributionInFreeformPermission?react_default.a.createElement(FreeformSummaryRow_AttributionModelLabel,{attribution:attributionSetting.dataSettings.attribution,onApplyAttribution:function(attribution){return freeformTable.updateAttribution(cell.column,attribution)}}):null,react_default.a.createElement("div",{className:"an-FreeformTable-cell-data-container"},react_default.a.createElement("div",{className:"an-FreeformTable-cell-dataLabel","data-title":!0},react_default.a.createElement(ObservedSort,{freeformTable:freeformTable,reportlet:reportlet,columnId:cell.columnId,appContext:appContext}),react_default.a.createElement(freeform_DataCellDataLabel,{showNumber:!hideTotal,numberLabel:cell.name,percentLabel:cell.percentLabel,showPercent:!hidePercent})),mixedMetrics?null:react_default.a.createElement(ObservedSparkLine,{trendLine:cell.trendLine,reportlet:reportlet}),react_default.a.createElement(ui_core_build_bundle_module.m,{variant:bundle_module.q.get(cell,"message.type"),label:bundle_module.q.get(cell,"message.text")}))))},{prop:"reportlet",event:build_bundle_module.lb.COLUMN_SETTINGS_CHANGED,shouldUpdate:function(e,props){return react_essence_build_bundle_module.b.BASIC_VALIDATOR(e)&&e.item.id===props.cell.columnId},debounce:0},{prop:"cell",event:"change"},{prop:"attributionSetting"}),VirtualizedFreeformTable_VirtualizedFreeformTable=(__webpack_require__(957),function(_React$Component){function VirtualizedFreeformTable(){return Object(classCallCheck.a)(this,VirtualizedFreeformTable),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(VirtualizedFreeformTable).apply(this,arguments))}return Object(inherits.a)(VirtualizedFreeformTable,_React$Component),Object(createClass.a)(VirtualizedFreeformTable,[{key:"createVirtualRowsCache",value:function(){var cache={rows:[]},accumulatedHeight=0;this.reportlet.freeformTable.rows.forEach(function(row,index){var height=row.height,topEdgePosition=accumulatedHeight,bottomEdgePosition=accumulatedHeight+height;cache.rows.push({row:row,index:index,height:height,topEdgePosition:topEdgePosition,bottomEdgePosition:bottomEdgePosition}),accumulatedHeight+=height});var rowsLength=cache.rows.length;return rowsLength&&(cache.totalHeight=accumulatedHeight,cache.averageHeight=cache.totalHeight/rowsLength),cache.findRowAboveViewport=this.findClosestInSortedArrayWithoutGoingOver.bind(this,cache.rows,"bottomEdgePosition"),cache.findRowBelowViewport=this.findClosestInSortedArrayWithoutGoingUnder.bind(this,cache.rows,"topEdgePosition"),cache}},{key:"findClosestInSortedArrayWithoutGoingOver",value:function(array,property,valueToFind){for(var closest,low=0,high=array.length-1;low<=high;){var mid=Math.floor((low+high)/2),midElement=array[mid];if(midElement[property]<valueToFind)low=mid+1,closest=midElement;else{if(!(midElement[property]>valueToFind))return midElement;high=mid-1}}return closest}},{key:"findClosestInSortedArrayWithoutGoingUnder",value:function(array,property,valueToFind){for(var closest,low=0,high=array.length-1;low<=high;){var mid=Math.floor((low+high)/2),midElement=array[mid];if(midElement[property]<valueToFind)low=mid+1;else{if(!(midElement[property]>valueToFind))return midElement;closest=midElement,high=mid-1}}return closest}},{key:"render",value:function(){var props=this.props,reportlet=props.reportlet,tableClassNames=props.tableClassNames,rowCache=this.createVirtualRowsCache(),resizeableColumnCountLen=reportlet.resizeableColumnCount.length,colGroupProps={getColumnWidths:props.getColumnWidths,size:resizeableColumnCountLen,breakdownDepth:reportlet.freeformTable.deepestBreakdownDepth},style={};return bundle_module.q.forIn(build_bundle_module.mb.getAllHeights(this.viewDensity),function(value,key){return style["--".concat(key)]=value+"px"}),react_default.a.createElement("table",{style:style,className:tableClassNames},react_default.a.createElement(ColGroup,colGroupProps),react_default.a.createElement(VirtualizedFreeformTable_VirtualizedTBody,Object.assign({rowCache:rowCache,maxColspan:resizeableColumnCountLen},props)))}},{key:"reportlet",get:function(){return this.props.reportlet}},{key:"viewDensity",get:function(){return this.reportlet.viewDensity}}]),VirtualizedFreeformTable}(react_default.a.Component)),VirtualizedFreeformTable_VirtualizedTBody=function(_React$Component2){function VirtualizedTBody(props,context){var _this;return Object(classCallCheck.a)(this,VirtualizedTBody),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(VirtualizedTBody).call(this,props,context))).onScrollChange=_this.onScrollChange.bind(Object(assertThisInitialized.a)(_this)),_this.state={},_this.offFunctions=[],_this}return Object(inherits.a)(VirtualizedTBody,_React$Component2),Object(createClass.a)(VirtualizedTBody,[{key:"componentDidMount",value:function(){this.el=react_dom_default.a.findDOMNode(this),this.props.disableVirtualization||this.setUpEventListeners(),this.calculateBBoxTop()}},{key:"componentDidUpdate",value:function(prevProps){prevProps.disableVirtualization!==this.props.disableVirtualization&&(this.props.disableVirtualization?this.unregisterEventListeners():this.setUpEventListeners(),this.calculateBBoxTop())}},{key:"componentWillUnmount",value:function(){this.unregisterEventListeners()}},{key:"setUpEventListeners",value:function(){this.listenForScrollEvents(),this.listenForGridstackChange()}},{key:"unregisterEventListeners",value:function(){this.offFunctions.forEach(function(f){return f()})}},{key:"listenForScrollEvents",value:function(){var node=document.querySelector(this.props.scrollableContainerSelector);this.offFunctions.push(ui_core_build_bundle_module.rb.on(node,"scroll",this.onScrollChange))}},{key:"listenForGridstackChange",value:function(){var _this2=this;document.body.addEventListener("an-Grid-refresh-complete",this.onScrollChange),this.offFunctions.push(function(){return document.body.removeEventListener("an-Grid-refresh-complete",_this2.onScrollChange)})}},{key:"calculateBBoxTop",value:function(){var top=this.el.getBoundingClientRect().top;this.setState({top:top})}},{key:"onScrollChange",value:function(){this.calculateBBoxTop()}},{key:"render",value:function(){var rowsToRender,_this$props=this.props,rowCache=_this$props.rowCache,overscanRowCount=_this$props.overscanRowCount,top=this.state.top,propsToForward=bundle_module.q.pick(this.props,["appContext","reportlet","hasAnomalyDetectionPermission","hasContributionAnalysisPermission"]),topTRheight=0,bottomTRheight=0,overscanAmountInPixels=overscanRowCount*rowCache.averageHeight;if(this.props.disableVirtualization)rowsToRender=rowCache.rows;else if(void 0===top)rowsToRender=[];else{var totalHeight=rowCache.totalHeight,topRowPositionToFind=-1*top,bottomRowPositionToFind=topRowPositionToFind+(window.innerHeight||document.documentElement.clientHeight);topRowPositionToFind-=overscanAmountInPixels,bottomRowPositionToFind+=overscanAmountInPixels;var topRow=rowCache.findRowAboveViewport(topRowPositionToFind),bottomRow=rowCache.findRowBelowViewport(bottomRowPositionToFind),startRenderIndex=topRow?topRow.index+1:0,endRenderIndex=bottomRow?bottomRow.index:rowCache.rows.length;if(rowsToRender=rowCache.rows.slice(startRenderIndex,endRenderIndex),topRow){var adjustment=topRowPositionToFind-topRow.bottomEdgePosition;topTRheight=Math.max(topRowPositionToFind,0),topTRheight-=adjustment}if(bottomRow){var _adjustment=bottomRow.topEdgePosition-bottomRowPositionToFind;bottomTRheight=Math.max(totalHeight-bottomRowPositionToFind,0),bottomTRheight-=_adjustment}}return react_default.a.createElement("tbody",null,topTRheight>0&&react_default.a.createElement("tr",{style:{height:topTRheight},className:"virtualized-freeform-area"},react_default.a.createElement("td",{colSpan:this.props.maxColspan})),rowsToRender.map(function(row,i){var freeformRow=row.row,RowComponent=freeformRow.isSummaryRow?ObservedFreeformSummaryRow:ObservedFreeformRow,hasMixedTypeStaticRows=freeformRow&&freeformRow.parent&&freeformRow.parent.hasMixedTypeStaticRows,rowProps=Object(objectSpread.a)({row:freeformRow,freeformTable:freeformRow.parent,hasMixedTypeStaticRows:hasMixedTypeStaticRows,key:freeformRow._key},propsToForward);return react_default.a.createElement(RowComponent,rowProps)}),bottomTRheight>0&&react_default.a.createElement("tr",{style:{height:bottomTRheight},className:"virtualized-freeform-area"},react_default.a.createElement("td",{colSpan:this.props.maxColspan})))}}]),VirtualizedTBody}(react_default.a.Component),blank_freeform=(__webpack_require__(958),__webpack_require__(959)),blank_freeform_default=__webpack_require__.n(blank_freeform),FreeformReportletContents_FreeformReportletContents=function(props){var reportlet=props.reportlet,appContext=props.appContext,tableClassNames=classnames_default()("an-FreeformTable","js-freeform-table-drop-target","js-freeform-table-content-table",{"an-FreeformTable-initialState":0===reportlet.freeformTable.rows.length}),virtualizedFreeformTableProps=Object(objectSpread.a)({tableClassNames:tableClassNames},props);return react_default.a.createElement("div",null,0===reportlet.freeformTable.rows.length?react_default.a.createElement("table",{className:tableClassNames},react_default.a.createElement("tbody",null,react_default.a.createElement(FreeformReportletContents_InitialStateRow,{reportlet:reportlet,serverRender:appContext.app.serverRender}))):react_default.a.createElement(VirtualizedFreeformTable_VirtualizedFreeformTable,virtualizedFreeformTableProps))},FreeformReportletContents_InitialStateRow=function(_ref){var reportlet=_ref.reportlet,serverRender=_ref.serverRender,isReportletConfigured=reportlet.freeformTable.staticRows.length||reportlet.freeformTable.dimension;return react_default.a.createElement("tr",{className:"an-FreeformTable-rowInitialState"},react_default.a.createElement("td",{className:"an-FreeformTable-cell an-FreeformTable-cell-dropTarget js-an-FreeformTable-cell-initialState an-DataProvider-cell"},react_default.a.createElement("div",{className:"an-FreeformTable-cell-container an-DataProvider-cell-container"},isReportletConfigured?null:react_default.a.createElement("div",{"data-test-id":"test-freeformtable-initial-state-row",className:"an-FreeformTable-initialStateContent"},serverRender?react_default.a.createElement("div",{className:"an-FreeformTable-placeholderImg",style:{height:"170px"}}):react_default.a.createElement("img",{className:"an-FreeformTable-initialStateImg",src:blank_freeform_default.a}),react_default.a.createElement("div",{className:"an-FreeformTable-initialStateLabel"},react_default.a.createElement(ui_core_build_bundle_module.J,null,Object(l10nify_build_bundle_module.a)("Drop a **Dimension** Here (or any other component)")))))))};ui_build_bundle_module.mb.fn.anFreeformReportletShowTruncatedContent=function(params){var $expandedEl,$parentEl=this;function onHide($el){$el.hasClass("has-active-popover")||params.onHide($el)}function collapseElement($el){$el.hasClass("has-active-popover")||($el.css("width","100%"),setTimeout(function(){$el.removeClass("show-truncated-content"),$parentEl.removeClass("show-truncated-content"),onHide($el)},130),params.hasPopovers&&$el.$openPopover&&ui_core_build_bundle_module.P.close($el.$openPopover.get(0)),$el.is($expandedEl)&&($expandedEl=null),params.onCollapse($el))}function expandElement(){var $el=Object(ui_build_bundle_module.mb)(this);if(!$el.hasClass("show-truncated-content"))if(params.onShow($el),params.hasPopovers&&function(){var $elWithAttachedPopover,checkPopoverClosedRequestId;if("undefined"===typeof window||!window.requestAnimationFrame)return;function onShowPopover(e){var $el=Object(ui_build_bundle_module.mb)(e.target).closest(".js-show-truncated-content");if($elWithAttachedPopover&&$el&&$elWithAttachedPopover.get(0)!==$el.get(0)&&onHidePopover(),$elWithAttachedPopover=$el){var target=e.target;$elWithAttachedPopover.addClass("has-active-popover");checkPopoverClosedRequestId=window.requestAnimationFrame(function checkPopoverIsClosed(){if(!target.classList.contains("is-active"))return void onHidePopover();checkPopoverClosedRequestId=window.requestAnimationFrame(checkPopoverIsClosed)})}}function onHidePopover(e){window.cancelAnimationFrame(checkPopoverClosedRequestId),$elWithAttachedPopover&&($elWithAttachedPopover.removeClass("has-active-popover"),$elWithAttachedPopover.hasClass("show-truncated-content")?collapseElement($elWithAttachedPopover):params.onHide($elWithAttachedPopover))}$parentEl.on("click",".js-freeform-popover-trigger",onShowPopover),$parentEl.on("destroy",function onDestroyIfPopover(){$parentEl.off("click",".js-freeform-popover-trigger",onShowPopover);$parentEl.off("destroy",onDestroyIfPopover)})}(),$el.isTruncated()&&params.shouldExpand($el)){var $container=$el.closest(params.container);if(0!==$container.length){var elScrollWidth=$el[0].scrollWidth,cssUpdates={width:elScrollWidth,right:"inherit",left:0};$el.offset().left+elScrollWidth>$container.offset().left+$container.outerWidth()&&ui_build_bundle_module.mb.extend(cssUpdates,{right:0,left:"inherit"}),$el.addClass("show-truncated-content").css(cssUpdates).one("mouseleave",function(){return collapseElement($el)}),$parentEl.addClass("show-truncated-content"),!params.expandMultiple&&$expandedEl&&collapseElement($expandedEl),$expandedEl=$el,params.onExpand($el)}}else $el.one("mouseleave",function(){$el.hasClass("has-active-popover")||onHide($el)})}params=ui_build_bundle_module.mb.extend({},{selector:"",hoverSelector:params.hoverSelector||params.selector||"",container:"body",shouldExpand:function($el){return!0},onShow:function($el){},onExpand:function($el){},onCollapse:function($el){},onHide:function($el){},hasPopovers:!1,expandMultiple:!1},params),$parentEl.on("mouseenter",params.hoverSelector,expandElement),$parentEl.on("destroy",function onDestroy(){$parentEl.off("mouseenter",params.hoverSelector,expandElement);$parentEl.off("destroy",onDestroy)})};__webpack_require__(960);var FreeformReportlet_FreeformReportlet=function(_Reportlet){function FreeformReportlet(props,context){var _this;return Object(classCallCheck.a)(this,FreeformReportlet),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(FreeformReportlet).call(this,props,context))).freeformModelUtil=new build_bundle_module.kb(_this.appContext),_this._headerKey=bundle_module.q.uniqueId("__freeformHeader__"),_this._contentsKey=bundle_module.q.uniqueId("__freeformContents__"),_this.observe(_this.app.user.uiSettings,"change:DISMISSED_WARNINGS"),_this.registerOff(_this.reportlet.on(build_bundle_module.lb.COLUMN_NODES_CHANGED,function(e){e&&e.changedNodes&&_this.updateTableFromChangedColumns(e.changedNodes)})),_this.registerOff(_this.reportlet.columnTree.on("undoRedoComplete",_this.onUndoRedoColumnTree.bind(Object(assertThisInitialized.a)(_this)))),_this}return Object(inherits.a)(FreeformReportlet,_Reportlet),Object(createClass.a)(FreeformReportlet,[{key:"componentDidMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(FreeformReportlet.prototype),"componentDidMount",this).call(this),this.$el=Object(ui_build_bundle_module.mb)(react_dom_default.a.findDOMNode(this))}},{key:"componentWillMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(FreeformReportlet.prototype),"componentWillMount",this).call(this),this.freeformModelUtil.combineHeaderAndContentRows(this.props.reportlet)}},{key:"componentWillUpdate",value:function(){this.freeformModelUtil.combineHeaderAndContentRows(this.props.reportlet)}},{key:"updateTableFromChangedColumns",value:function(changedNodes){this.freeformModelUtil.updateTableFromChangedColumns(this.reportlet.freeformTable,{changedColumns:bundle_module.q.flatten(changedNodes.map(function(changedNode){return changedNode.isLeafNode?[changedNode]:changedNode.traverseTreeAndRetrieveLeafNodes()})),columns:this.reportlet.cachedLeafNodes}),this.loadData({queryOptionOverrides:{refreshLoadedBreakdowns:!0}}),this.setState({})}},{key:"onUndoRedoColumnTree",value:function(){this.reportlet.columnTree.visitAllNodesInTree(function(node,parentNode){return node.parent=parentNode})}},{key:"onEmbeddedEntityDefinitionChange",value:function(){this.loadData({freeformTable:this.props.reportlet.freeformTable},{queryOptionOverrides:{refreshLoadedBreakdowns:!0}})}},{key:"loadData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},opts=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},reportlet=this.props.reportlet;return opts.onProgress=opts.onProgress||function(progress){"FREEFORM_TABLE:ANOMALIES_LOADED"!==progress.status&&"FREEFORM_TABLE:ANOMALIES_NONE"!==progress.status||ui_core_build_bundle_module.lb.trackAction(null,"Anomaly Detection request complete",{anomalyCount:progress.freeformTable.parent.anomalyCount}),"FREEFORM_TABLE:ANOMALIES_FAILED"===progress.status&&ui_core_build_bundle_module.lb.trackAction(null,"Anomaly Detection request complete",{anomalyCount:null})},reportlet.load(this.appContext,Object.assign(e,opts))}},{key:"freeformRowVirtualizationIsEnabled",value:function(){return!this.app.serverRender&&(!!this.reportlet.getExternalParams().panelAutoSize&&(!!bundle_module.q.get(this,"reportlet.parent.position.autoSize",!1)&&!!dom_util_build_bundle_module.a.isChrome()))}},{key:"_render",value:function(){var appContext=this.appContext,reportlet=this.reportlet,contentsProps={reportlet:reportlet,appContext:appContext,hasAnomalyDetectionPermission:this.app.hasAccessToFeature("anomalyDetectionWorkspace"),hasContributionAnalysisPermission:ui_build_bundle_module.x.ContributionAnalysis.hasAccess(this.app),getColumnWidths:this.props.getColumnWidths,scrollableContainerSelector:".an-ViewLayout-scrollContent",disableVirtualization:!this.freeformRowVirtualizationIsEnabled(),overscanRowCount:50};return this.freeformModelUtil.combineHeaderAndContentRows(reportlet),react_default.a.createElement(react.Fragment,null,react_default.a.createElement("div",{className:"an-FreeformReportlet-headContents js-sticky-header-container",key:this._headerKey},react_default.a.createElement(FreeformReportletHeader_FreeformReportletHeader,{getColumnWidths:this.props.getColumnWidths,reportlet:reportlet,appContext:this.appContext})),react_default.a.createElement("div",{className:"an-FreeformReportlet-contents js-freeform-table-contents",key:this._contentsKey},react_default.a.createElement(FreeformReportletContents_FreeformReportletContents,contentsProps),react_default.a.createElement("div",{className:"an-FreeformTable-loadingLightBox",style:{display:reportlet.freeformTable.displayLoadingIcon?null:"none"}},react_default.a.createElement(ui_core_build_bundle_module.qb,{size:"L",centered:!0,show:reportlet.freeformTable.displayLoadingIcon,key:"waitIcon"}))))}},{key:"reportlet",get:function(){return this.props.reportlet}}]),FreeformReportlet}(Reportlet_Reportlet),FreeformReportletEnhancedWithDynamicBehaviors=Object(recompose.compose)(ui_build_bundle_module.eb,function(ComposedComponent){return function(_AppComponent){function _class(){return Object(classCallCheck.a)(this,_class),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(_class).apply(this,arguments))}return Object(inherits.a)(_class,_AppComponent),Object(createClass.a)(_class,[{key:"componentDidMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(_class.prototype),"componentDidMount",this).call(this);var domNode=react_dom_default.a.findDOMNode(this),parentNode=Object(ui_build_bundle_module.mb)(domNode).parent();this.$el=parentNode.find(".an-FreeformReportletHeader"),this.$columnTree=this.$el.find(".js-freeform-table-column-tree"),this.$localDraggableBackdrop=this.$el.find(".js-header-draggable-backdrop"),this.freeformModelUtil=new build_bundle_module.kb(this.appContext),this.dragDataIsTree=!1,this.isMoveOperation=!1,this.dropTargets=[],this.dropTargetsUnderCursor=void 0,this.dropIndicators=Object(ui_build_bundle_module.mb)('<div class="column-tree-drop-indicator" />'),this.isMoveOperation=!1,this.elementCache=new react_drag_drop_build_bundle_module.h,this.initDraggable(),this.initDropTarget()}},{key:"initDraggable",value:function(){this.columnTree,this.$el.adDraggable({selector:".js-column-header",dragStartThreshold:5,dragProxyOpacity:.7,dragData:this.getDragData.bind(this),dragMetaData:this.getDragMetaData.bind(this),disableDrag:this.disableDrag.bind(this),customDragProxy:this.getCustomDragProxy.bind(this),dragProxyDimensions:{width:200,height:42}})}},{key:"getDragData",value:function($targetElement){var column=bundle_module.q.find(this.columnTree.allNodesInTree,{id:$targetElement.data("column-id")});return this._dragOriginatedFromColumnTree=!0,column?this.getSelectedComponents(column):null}},{key:"getDragMetaData",value:function($targetElement){var column=bundle_module.q.find(this.columnTree.allNodesInTree,{id:$targetElement.data("column-id")});return{componentsWithMetaData:this.getSelectedColumnNodes(column).map(function(n){return build_bundle_module.H.fromColumnNode(n)}),columnTree:column}}},{key:"getSelectedColumnNodes",value:function(column){return column.isTree||column.selected?column.parentTree.selectedNodes:[column]}},{key:"getSelectedComponents",value:function(column){return this.getSelectedColumnNodes(column).map(function(n){return n.component})}},{key:"disableDrag",value:function(event){return!(!event.altKey&&!event.shiftKey)}},{key:"getCustomDragProxy",value:function(targetElement){var column=bundle_module.q.find(this.columnTree.allNodesInTree,{id:targetElement.getAttribute("data-column-id")}),component=column.component,subLabel=column.subLabel(this.app.reportSuite),div=document.createElement("div"),reactNode=react_default.a.createElement(FreeformReportletComponentDragProxy_FreeformReportletComponentDragProxy,{component:component,subLabel:subLabel});return react_dom_default.a.render(reactNode,div),div.firstChild}},{key:"initDropTarget",value:function(){this.$el.adDropTarget({behavior:{findTarget:"vertical-stack",draggableBackdrop:!1},targets:".js-freeform-table-column-tree",onStart:this.dropTargetStart.bind(this),onEnd:this.dropTargetEnd.bind(this),onEnter:this.dropTargetEnter.bind(this),onOver:this.dropTargetOver.bind(this),onLeave:this.dropTargetLeave.bind(this),disabled:this.dropTargetIsDisabled.bind(this),onDrop:this.dropTargetDrop.bind(this),onClearCache:this.dropTargetClearCache.bind(this),supportedComponentTypes:ui_build_bundle_module.l.defaultComponentTypes.concat([build_bundle_module.I])})}},{key:"dropTargetClearCache",value:function(e){this.elementCache.clearCache()}},{key:"dropTargetStart",value:function(e){e.dragMetaData=e.dragMetaData||{},this.dragDataIsTree=Boolean(e.dragMetaData.columnTree),this.$columnTree.addClass("is-dragging"),this.$localDraggableBackdrop.addClass("is-visible"),this.elementCache.clearCache()}},{key:"dropTargetEnd",value:function(e){this._dragOriginatedFromColumnTree=!1,this.isMoveOperation=!1,this.dragDataIsTree=!1,this.$columnTree.removeClass("is-dragging"),this.$localDraggableBackdrop.removeClass("is-visible"),this.dropTargets.splice(0),this.elementCache.clearCache()}},{key:"dropTargetEnter",value:function(e){this.generateDropTargets(),this.displayDropIndicator(e)}},{key:"dropTargetOver",value:function(e){e.setDragCursor(e.ctrlKey||e.metaKey?"copy":"move"),this.displayDropIndicator(e)}},{key:"dropTargetLeave",value:function(e){this.hideDropIndicator()}},{key:"dropTargetIsDisabled",value:function(dragData){return!(bundle_module.q.isArray(dragData)?dragData:[dragData]).find(function(component){return ui_build_bundle_module.l.defaultComponentTypes.find(function(type){return component instanceof type})})}},{key:"dropTargetDrop",value:function(e){var _this=this;e.dragMetaData=e.dragMetaData||{},(e.forceDrop||Object(ui_build_bundle_module.mb)(".column-tree-drop-indicator, .generic-drop-indicator").length)&&(this.isMoveOperation=this._dragOriginatedFromColumnTree&&!(e.ctrlKey||e.metaKey),ui_build_bundle_module.ib.trackDropComponents(e.dragData,"FreeformColumnHeader",!0),this.addDefaultComponentIfNeeded(e.dragData),this.applyComponents(e,this.dragDataIsTree).then(function(){_this.setTableCellDisplaySettings()}),this.hideDropIndicator(),this.freeformModelUtil.unSelectAll(this.reportlet))}},{key:"applyComponents",value:function(e,isTree){var components=e.dragData,_e$dragMetaData=e.dragMetaData,componentsWithMetaData=_e$dragMetaData.componentsWithMetaData,columnTree=_e$dragMetaData.columnTree;return isTree?Promise.resolve(this.applyComponentTreeAtGlobalPt(columnTree,e.globalPt)):this.applyComponentsAtGlobalPt(components,componentsWithMetaData,e.globalPt)}},{key:"applyComponentsAtGlobalPt",value:function(){var _applyComponentsAtGlobalPt=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(components,componentsWithMetaData,globalPt){var columnTree,dz,dropRegion,explodedResults,_this2=this;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return(columnTree=this.columnTree).suppressChangeEvents=!0,dz=this.findDropTargetUnderCursor(globalPt),this.dropTargetsUnderCursor=this.findDropTargetsFromGlobalPoint(globalPt,dz),dropRegion=dz?dz.getDropRegionFromLocalPt(dz.element.globalToLocal(globalPt)):null,_context.next=7,this.explodeDimensionComponents(components,componentsWithMetaData);case 7:explodedResults=_context.sent,this.dropTargetsUnderCursor.length?this.dropTargetsUnderCursor.forEach(function(dropTargetUnderCursor){_this2.applyComponentsToNodeAt({components:explodedResults.components,componentsWithMetaData:explodedResults.componentsWithMetaData,relativeNode:dropTargetUnderCursor.model,location:dropRegion.location,dimensionsWereExploded:explodedResults.dimensionsWereExploded})}):this.applyComponentsToNodeAt({components:explodedResults.components,componentsWithMetaData:explodedResults.componentsWithMetaData,relativeNode:columnTree,location:DROP_BELOW,dimensionsWereExploded:explodedResults.dimensionsWereExploded}),columnTree.suppressChangeEvents=!1;case 10:case"end":return _context.stop()}},_callee,this)}));return function(_x,_x2,_x3){return _applyComponentsAtGlobalPt.apply(this,arguments)}}()},{key:"addDefaultComponentIfNeeded",value:function(components){this.columnTree.nodes.length||this.reportlet.freeformTable.dimension||0!==this.reportlet.freeformTable.staticRows.length||(bundle_module.q.filter(components,function(component){return build_bundle_module.Hb.isMetricLike(component)}).length===components.length?this.freeformModelUtil.setupDefaultDimensionForMetricReport(this.reportlet):this.freeformModelUtil.setupDefaultMetricForSegmentReport(this.reportlet))}},{key:"setTableCellDisplaySettings",value:function(){this.reportlet.cachedLeafNodes.forEach(function(column){"percent"===bundle_module.q.get(column,"metricNodes[0].component.type")&&(column.tableCellDisplay.conditionalFormattingOpts.usePercentLimits=!0)})}},{key:"explodeDimensionComponents",value:function(){var _explodeDimensionComponents=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee2(components,componentsWithMetaData){var topItemsForDimensions,_this3=this;return regenerator_default.a.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(!bundle_module.q.filter(components,function(component){return component instanceof build_bundle_module.X}).length){_context2.next=11;break}return this.reportlet.columnTree.loadingComponents=!0,_context2.next=4,this.app.axle.getTopItemsForDimensions(components,this.reportlet.getExternalParams());case 4:return(topItemsForDimensions=_context2.sent).forEach(function(queryResult){var component=queryResult.component;ui_core_build_bundle_module.lb.trackAction(null,"Exploded Dimension Components",{componentType:component.componentType,componentId:component.id,componentName:component.name})}),this.reportlet.columnTree.loadingComponents=!1,bundle_module.q.pluck(topItemsForDimensions,"index").forEach(function(replaceIndex,idx){bundle_module.q.get(topItemsForDimensions[idx],"data.rows.length")||_this3.app.addAlert({variant:"warning",header:Object(l10nify_build_bundle_module.a)("No Items Found. "),contents:Object(l10nify_build_bundle_module.a)("Unable to find any values for one or more dimensions."),autoHide:!0}),Array.prototype.splice.apply(components,[replaceIndex,1].concat(topItemsForDimensions[idx].data.rows))}),_context2.abrupt("return",{components:components,componentsWithMetaData:components.map(function(c){return new build_bundle_module.H({component:c})}),dimensionsWereExploded:!0});case 11:return _context2.abrupt("return",{components:components,componentsWithMetaData:componentsWithMetaData,dimensionsWereExploded:!1});case 12:case"end":return _context2.stop()}},_callee2,this)}));return function(_x4,_x5){return _explodeDimensionComponents.apply(this,arguments)}}()},{key:"applyComponentsToNodeAt",value:function(){var _ref=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},components=_ref.components,_ref$componentsWithMe=_ref.componentsWithMetaData,componentsWithMetaData=void 0===_ref$componentsWithMe?[]:_ref$componentsWithMe,relativeNode=_ref.relativeNode,location=_ref.location,dimensionsWereExploded=_ref.dimensionsWereExploded,newNodes=[];switch(components.forEach(function(component,i){var componentWithMetaData=componentsWithMetaData[i],topItemPosition=dimensionsWereExploded?i+1:void 0,node=new build_bundle_module.fb({component:component,topItemPosition:topItemPosition});componentWithMetaData&&(node.dataSettings=componentWithMetaData.dataSettings),newNodes.push(node)}),location){case DROP_LEFT:this.addSiblingsToNode(relativeNode,newNodes,"left");break;case DROP_RIGHT:this.addSiblingsToNode(relativeNode,newNodes,"right");break;case DROP_ABOVE:this.addParentsToNode(relativeNode,newNodes);break;case DROP_BELOW:this.addChildrenToNode(relativeNode,newNodes);break;case DROP_REPLACE:this.replaceNode(relativeNode,newNodes)}}},{key:"applyAttribution",value:function(nodes){var topMostTable=this.reportlet.freeformTable,breakdownDefaultAttributions=topMostTable.getDefaultBreakdownAttributions(this.app.cache);nodes.forEach(function(node){var attribution=node.getAttributionInTree();attribution&&topMostTable.recursivelyUpdateAttribution(node,attribution,breakdownDefaultAttributions)})}},{key:"addParentsToNode",value:function(node,parentNodes){var siblings=bundle_module.q.map(parentNodes.slice(1),function(sibling){return sibling.addNode(node.copy())});siblings.length&&node.addSiblingNodes(siblings,"right");var siblingNode=node.index>0?node.parent.nodes[node.index-1]:null;siblingNode&&siblingNode.component.id===parentNodes[0].component.id&&siblingNode.attribution===parentNodes[0].attribution?(node.remove(),siblingNode.addNode(node)):node.addParentNode(parentNodes[0])}},{key:"addSiblingsToNode",value:function(node,siblingNodes,location){node.addSiblingNodes(siblingNodes,location);var leafNodesToApplyAttribution=node.parent.traverseTreeAndRetrieveLeafNodes();this.applyAttribution(leafNodesToApplyAttribution)}},{key:"replaceNode",value:function(node,newNodes){var topMostTable=this.reportlet.freeformTable;node.attribution&&(node.dataSettings.attribution=null,topMostTable.removeColumnAttributionSetting(node)),newNodes.forEach(function(newNode,nodeIndex){nodeIndex===newNodes.length-1?(node.replace(newNode),node=newNode):(node.nodes.forEach(function(n){newNode.nodes.push(n.copy())}),node.addSiblingNode(newNode))});var leafNodesToApplyAttribution=node.parent.traverseTreeAndRetrieveLeafNodes();this.applyAttribution(leafNodesToApplyAttribution)}},{key:"addChildrenToNode",value:function(node,childNodes){node.nodes.length&&(childNodes.forEach(function(childNode,idx){if(0===idx)childNode.addNodes(node.nodes);else{for(var clonedNodesArray=[],i=0;i<node.nodes.length;i++)clonedNodesArray.push(node.nodes[i].copy());childNode.addNodes(clonedNodesArray)}}),node.nodes.splice(0)),node.addNodes(childNodes),this.reportlet.freeformTable.removeColumnAttributionSetting(node);var leafNodesToApplyAttribution=node.traverseTreeAndRetrieveLeafNodes();this.applyAttribution(leafNodesToApplyAttribution)}},{key:"applyComponentTreeAtGlobalPt",value:function(originalTree,globalPt){var dz=this.findDropTargetUnderCursor(globalPt);if(!this.isMoveOperation||dz.element.attr("data-column-id")!==originalTree.id){var dropRegion=dz?dz.getDropRegionFromLocalPt(dz.element.globalToLocal(globalPt)):null,dropLocation=dropRegion?dropRegion.location:DROP_BELOW,relativeNode=dz?dz.model:this.columnTree;this.applyComponentTreeToNodeAt(originalTree,relativeNode,dropLocation)}}},{key:"applyComponentTreeToNodeAt",value:function(originalTree,relativeNode,location){var _this4=this;this.columnTree.suppressChangeEvents=!0;var componentTree=this.createNewTreeFromExistingTree(originalTree);switch(this.isMoveOperation&&(originalTree.selected?originalTree.parentTree.selectedNodes:[originalTree]).forEach(function(node){_this4.reportlet.freeformTable.removeColumnAttributionSetting(node),node.parent.removeIntermediateNode(node)}),location){case DROP_LEFT:case DROP_RIGHT:this.addTreeAsSibling(relativeNode,componentTree,location);break;case DROP_ABOVE:case DROP_BELOW:this.addTreeAsParentOrChild(relativeNode,componentTree,location);break;case DROP_REPLACE:this.replaceNodeWithTree(relativeNode,componentTree)}this.columnTree.suppressChangeEvents=!1}},{key:"createNewTreeFromExistingTree",value:function(originalTree){var componentTree=originalTree.selected?originalTree.parentTree.getSelectedTree(this._dragOriginatedFromColumnTree&&this.isMoveOperation):new build_bundle_module.fb;if(!componentTree.nodes.length){var columnTreeNode=originalTree.copy();columnTreeNode.nodes.splice(0),this._dragOriginatedFromColumnTree&&this.isMoveOperation&&(columnTreeNode.id=originalTree.id),componentTree.nodes.push(columnTreeNode)}return componentTree.nodes.forEach(function(node){node.topItemPosition=void 0}),componentTree}},{key:"addTreeAsSibling",value:function(relativeNode,tree){var location=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left";relativeNode.addSiblingNodes(tree.nodes,location);var leafNodesToApplyAttribution=tree.traverseTreeAndRetrieveLeafNodes();this.applyAttribution(leafNodesToApplyAttribution)}},{key:"addTreeAsParentOrChild",value:function(relativeNode,tree){var position=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"below",leftMostLeafNode=tree.traverseTreeAndRetrieveLeafNodes()[0],newIntermediateNodes=bundle_module.q.filter(leftMostLeafNode.parents.reverse().concat(leftMostLeafNode),{isTree:!1}),newSiblingNodes=tree.nodes.slice().splice(1);leftMostLeafNode.remove(),relativeNode[position===DROP_BELOW?"addIntermediateNodes":"addParentNodes"](newIntermediateNodes),newSiblingNodes.length&&newIntermediateNodes[0].addSiblingNodes(newSiblingNodes,"right");var leafNodesToApplyAttribution=newIntermediateNodes[0].traverseTreeAndRetrieveLeafNodes();this.applyAttribution(leafNodesToApplyAttribution)}},{key:"replaceNodeWithTree",value:function(relativeNode,tree){var leftMostLeafNode=tree.traverseTreeAndRetrieveLeafNodes()[0],newIntermediateNodes=bundle_module.q.filter(leftMostLeafNode.parents.reverse(),{isTree:!1}),newSiblingNodes=tree.nodes.slice().splice(1);leftMostLeafNode.remove(),relativeNode.addParentNodes(newIntermediateNodes);var topMostTable=this.reportlet.freeformTable;relativeNode.attribution&&(relativeNode.dataSettings.attribution=null,topMostTable.removeColumnAttributionSetting(relativeNode)),relativeNode.replace(leftMostLeafNode),newSiblingNodes.length&&(newIntermediateNodes.length?newIntermediateNodes[0].addSiblingNodes(newSiblingNodes,"right"):leftMostLeafNode.addSiblingNodes(newSiblingNodes,"right"));var leafNodesToApplyAttribution=leftMostLeafNode.parent.traverseTreeAndRetrieveLeafNodes();relativeNode.isLeafNode||this.reportlet.freeformTable.removeColumnAttributionSetting(leftMostLeafNode),this.applyAttribution(leafNodesToApplyAttribution)}},{key:"generateDropTargets",value:function(){var _this5=this;if(!this.dropTargets.length){var i,dropTarget,leftSiblingModel,rightSiblingModel,getDropTarget=function(cell){var headerElement=_this5.$el.find("[data-column-id="+cell.column.id+"]"),elementWidth=headerElement.outerWidth(),elementHeight=headerElement.outerHeight(),verticalPxIndent=Math.min(MAX_VERTICAL_REGION_INDENT,elementHeight/3),horizontalPxIndent=Math.min(MAX_HORIZONTAL_REGION_INDENT,elementWidth/3),regions=[{location:DROP_LEFT,polygon:_this5.getDropLeftPolygon(elementHeight,verticalPxIndent,horizontalPxIndent)},{location:DROP_RIGHT,polygon:_this5.getDropRightPolygon(elementWidth,elementHeight,verticalPxIndent,horizontalPxIndent)},{location:DROP_ABOVE,polygon:_this5.getDropAbovePolygon(elementWidth,verticalPxIndent,horizontalPxIndent)},{location:DROP_BELOW,polygon:_this5.getDropBelowPolygon(elementWidth,elementHeight,verticalPxIndent,horizontalPxIndent)},{location:DROP_REPLACE,polygon:_this5.getDropOnPolygon(elementWidth,elementHeight,verticalPxIndent,horizontalPxIndent)}];return{element:headerElement,model:cell.column,selected:cell.selected,getDropRegionFromLocalPt:function(localPt){for(var _i=0;_i<regions.length;_i++){var region=regions[_i];if(react_drag_drop_build_bundle_module.j.isPointInPolygon(localPt,region.polygon))return region}return regions[4]}}},getDropTargetFromModel=function(dropTargetModel){for(var _i2=0;_i2<_this5.dropTargets.length;_i2++)if(dropTargetModel===_this5.dropTargets[_i2].model)return _this5.dropTargets[_i2]},headerCells=this.columnTree.allCells;for(i=0;i<headerCells.length;i++)headerCells[i].column&&this.dropTargets.push(getDropTarget(headerCells[i]));for(i=0;i<this.dropTargets.length;i++)leftSiblingModel=(dropTarget=this.dropTargets[i]).model.firstSibling("left"),rightSiblingModel=dropTarget.model.firstSibling("right"),dropTarget.leftSibling=getDropTargetFromModel(leftSiblingModel),dropTarget.rightSibling=getDropTargetFromModel(rightSiblingModel)}}},{key:"getDropLeftPolygon",value:function(elementHeight,verticalPxIndent,horizontalPxIndent){return[{x:0,y:0},{x:horizontalPxIndent,y:verticalPxIndent},{x:horizontalPxIndent,y:elementHeight-verticalPxIndent},{x:0,y:elementHeight},{x:0,y:0}]}},{key:"getDropRightPolygon",value:function(elementWidth,elementHeight,verticalPxIndent,horizontalPxIndent){return[{x:elementWidth,y:0},{x:elementWidth,y:elementHeight},{x:elementWidth-horizontalPxIndent,y:elementHeight-verticalPxIndent},{x:elementWidth-horizontalPxIndent,y:verticalPxIndent},{x:elementWidth,y:0}]}},{key:"getDropAbovePolygon",value:function(elementWidth,verticalPxIndent,horizontalPxIndent){return[{x:0,y:0},{x:elementWidth,y:0},{x:elementWidth-horizontalPxIndent,y:verticalPxIndent},{x:horizontalPxIndent,y:verticalPxIndent},{x:0,y:0}]}},{key:"getDropBelowPolygon",value:function(elementWidth,elementHeight,verticalPxIndent,horizontalPxIndent){return[{x:0,y:elementHeight},{x:horizontalPxIndent,y:elementHeight-verticalPxIndent},{x:elementWidth-horizontalPxIndent,y:elementHeight-verticalPxIndent},{x:elementWidth,y:elementHeight},{x:0,y:elementHeight}]}},{key:"getDropOnPolygon",value:function(elementWidth,elementHeight,verticalPxIndent,horizontalPxIndent){return[{x:horizontalPxIndent,y:verticalPxIndent},{x:elementWidth-horizontalPxIndent,y:verticalPxIndent},{x:elementWidth-horizontalPxIndent,y:elementHeight-verticalPxIndent},{x:horizontalPxIndent,y:elementHeight-verticalPxIndent},{x:horizontalPxIndent,y:verticalPxIndent}]}},{key:"findDropTargetUnderCursor",value:function(globalPt){var i,dropTarget;for(i=0;i<this.dropTargets.length;i++)if((dropTarget=this.dropTargets[i]).element.length&&react_drag_drop_build_bundle_module.i.elementContainsGlobalPt(dropTarget.element.get(0),globalPt))return dropTarget;return null}},{key:"findDropTargetsFromGlobalPoint",value:function(globalPt,dropTargetUnderCursor){var dropTargetsFromGlobalPoint;return(dropTargetUnderCursor=dropTargetUnderCursor||this.findDropTargetUnderCursor(globalPt))&&dropTargetUnderCursor.selected?dropTargetsFromGlobalPoint=bundle_module.q.filter(this.dropTargets,{selected:!0}):dropTargetUnderCursor&&(dropTargetsFromGlobalPoint=[dropTargetUnderCursor]),dropTargetsFromGlobalPoint||[]}},{key:"displayDropIndicator",value:function(e){var _this6=this,globalPt=e.globalPt;this.hideDropIndicator();var dropTargetUnderCursor=this.findDropTargetUnderCursor(globalPt);if(dropTargetUnderCursor){var allDropTargetsFromGlobalPt=this.dragDataIsTree?[dropTargetUnderCursor]:this.findDropTargetsFromGlobalPoint(globalPt,dropTargetUnderCursor),dropRegion=dropTargetUnderCursor.getDropRegionFromLocalPt(react_drag_drop_build_bundle_module.i.globalPtToLocalPt(dropTargetUnderCursor.element.get(0),globalPt));this.dropTargetsUnderCursor=allDropTargetsFromGlobalPt,this.initDropIndicators(),allDropTargetsFromGlobalPt.forEach(function(dropTarget,idx){_this6.getDropIndicatorState(dropRegion.location,dropTarget,e.dragData,idx),build_bundle_module.db.isActive("dropzoneGuides")&&_this6.setDropIndicatorGuide(idx)}),this.dropIndicators.parent().length||this.dropIndicators.appendTo("body")}else{var emptyCellDropTarget={element:this.$columnTree.find(".empty-drop-target")};!this.columnTree.rows.length&&react_drag_drop_build_bundle_module.i.elementContainsGlobalPt(emptyCellDropTarget.element.get(0),globalPt)?(this.dropTargetsUnderCursor=[emptyCellDropTarget],this.initDropIndicators(),this.displayReplaceDropIndicator(emptyCellDropTarget,0),build_bundle_module.db.isActive("dropzoneGuides")&&(this.indicator={text:Object(l10nify_build_bundle_module.a)("Add"),iconClass:ADD_CLASS,defaultClass:DEFAULT_CLASS},this.setDropIndicatorGuide(0)),this.dropIndicators.appendTo("body")):this.hideDropIndicator()}}},{key:"initDropIndicators",value:function(){this.dropIndicators.length>this.dropTargetsUnderCursor.length&&(this.dropIndicators.remove(),this.dropIndicators=Object(ui_build_bundle_module.mb)("<div/>").appendTo("body"));for(var i=1;i<this.dropTargetsUnderCursor.length;i++)this.dropIndicators=this.dropIndicators.add(Object(ui_build_bundle_module.mb)("<div/>").appendTo("body"))}},{key:"hideDropIndicator",value:function(){this.dropIndicators.remove()}},{key:"getDropIndicatorState",value:function(dropLocation,dropTarget,dragData,idx){build_bundle_module.db.isActive("dropzoneGuides")&&(this.contentHasMetric=this.reportlet.freeformTable.hasMetricStaticRows(),this.indicator={text:"",warningText:"",iconClass:"",warningClass:"",defaultClass:DEFAULT_CLASS,extraClass:""});var dragDataContainsMetric=this.dragDataContainsMetric(dragData);switch(dropLocation){case DROP_LEFT:this.displayLeftDropIndicator(dropTarget,idx),build_bundle_module.db.isActive("dropzoneGuides")&&(this.checkRightLeftDropForMetric(dragData,dropTarget,idx),this.indicator.text=Object(l10nify_build_bundle_module.a)("Add"),this.indicator.iconClass="".concat(ADD_CLASS,"-left"));break;case DROP_RIGHT:this.displayRightDropIndicator(dropTarget,idx),build_bundle_module.db.isActive("dropzoneGuides")&&(this.checkRightLeftDropForMetric(dragData,dropTarget,idx),this.indicator.text=Object(l10nify_build_bundle_module.a)("Add"),this.indicator.iconClass="".concat(ADD_CLASS,"-right"));break;case DROP_ABOVE:this.displayAboveDropIndicator(dropTarget,idx),build_bundle_module.db.isActive("dropzoneGuides")&&(this.checkAboveBelowDropForMetric(dragData,dropTarget.model,idx),dragDataContainsMetric?(this.indicator.text=Object(l10nify_build_bundle_module.a)("Add"),this.indicator.iconClass="".concat(ADD_CLASS,"-above-below")):(this.indicator.text=Object(l10nify_build_bundle_module.a)("Filter By"),this.indicator.iconClass=FILTER_BY_CLASS));break;case DROP_BELOW:this.displayBelowDropIndicator(dropTarget,idx),build_bundle_module.db.isActive("dropzoneGuides")&&(this.checkAboveBelowDropForMetric(dragData,dropTarget.model,idx),dragDataContainsMetric?(this.indicator.text=Object(l10nify_build_bundle_module.a)("Add"),this.indicator.iconClass="".concat(ADD_CLASS,"-above-below")):(this.indicator.text=Object(l10nify_build_bundle_module.a)("Filter By"),this.indicator.iconClass=FILTER_BY_CLASS));break;case DROP_REPLACE:this.displayReplaceDropIndicator(dropTarget,idx),build_bundle_module.db.isActive("dropzoneGuides")&&(this.checkReplaceDropForMetric(dragData,dropTarget),dropTarget.model?(this.indicator.text=Object(l10nify_build_bundle_module.a)("Replace"),this.indicator.iconClass=REPLACE_CLASS):(this.indicator.text=Object(l10nify_build_bundle_module.a)("Add"),this.indicator.iconClass=ADD_CLASS));break;default:this.hideDropIndicator()}}},{key:"setDropIndicatorGuide",value:function(idx){this.dropIndicators.get(idx).setAttribute("data-warning",this.indicator.warningText),this.dropIndicators.get(idx).setAttribute("data-text",this.indicator.text),this.dropIndicators.get(idx).className+=" ".concat(this.indicator.defaultClass," ").concat(this.indicator.iconClass," ").concat(this.indicator.extraClass," ").concat(this.indicator.warningClass)}},{key:"dragDataContainsMetric",value:function(dragData){return dragData instanceof Array&&dragData.some(function(item){return build_bundle_module.Hb.isMetricLike(item)})}},{key:"checkAboveBelowDropForMetric",value:function(dragData,target,idx){var dragDataContainsMetric=this.dragDataContainsMetric(dragData);dragDataContainsMetric&&this.contentHasMetric||dragDataContainsMetric&&build_bundle_module.Hb.isMetricLike(target.component)||dragDataContainsMetric&&(this.findMetricAboveDrop(target)||this.findMetricBelowDrop(target))?this.displayDropIndicatorWarning(onlyOneMetricIsValid):dragDataContainsMetric||this.findMetricAboveDrop(target)||this.findMetricBelowDrop(target)||this.contentHasMetric||this.displayDropIndicatorWarning(metricRequired)}},{key:"checkReplaceDropForMetric",value:function(dragData,target){var dragDataContainsMetric=this.dragDataContainsMetric(dragData);this.contentHasMetric||(dragDataContainsMetric||!build_bundle_module.Hb.isMetricLike(target.model.component))&&(dragDataContainsMetric||build_bundle_module.Hb.isMetricLike(target.model.component)||this.findMetricAboveDrop(target)||this.findMetricBelowDrop(target.model))?(dragDataContainsMetric&&!build_bundle_module.Hb.isMetricLike(target.model.component)&&(this.findMetricAboveDrop(target)||this.findMetricBelowDrop(target.model))||dragDataContainsMetric&&this.contentHasMetric)&&this.displayDropIndicatorWarning(onlyOneMetricIsValid):this.displayDropIndicatorWarning(metricRequired)}},{key:"findMetricAboveDrop",value:function(target){target.model&&(target=target.model);for(var selfAndParents=[target].concat(target.parents),i=0;i<selfAndParents.length;i++)if(selfAndParents[i]&&build_bundle_module.Hb.isMetricLike(selfAndParents[i].component))return!0;return!1}},{key:"findMetricBelowDrop",value:function(target){for(var allNodesInTree=target.allNodesInTree,i=0;i<allNodesInTree.length;i++)if(build_bundle_module.Hb.isMetricLike(allNodesInTree[i].component))return!0;return!1}},{key:"checkRightLeftDropForMetric",value:function(dragData,dropTarget,idx){var dragDataContainsMetric=this.dragDataContainsMetric(dragData);dragDataContainsMetric&&(this.contentHasMetric||dropTarget.model.parent.component&&this.findMetricAboveDrop(dropTarget.model.parent))?this.displayDropIndicatorWarning(onlyOneMetricIsValid):dragDataContainsMetric||this.contentHasMetric||(!dropTarget.model.parent.component||this.findMetricAboveDrop(dropTarget.model.parent))&&dropTarget.model.parent.component||this.displayDropIndicatorWarning(metricRequired)}},{key:"displayDropIndicatorWarning",value:function(error){this.indicator.warningClass=WARNING_CLASS,this.indicator.warningText=Object(l10nify_build_bundle_module.a)("".concat(error))}},{key:"displayLeftDropIndicator",value:function(dropTargetUnderCursor,idx){var dropTargetOffset=dropTargetUnderCursor.element.offset();Object(ui_build_bundle_module.mb)(this.dropIndicators[idx]).removeClass().addClass("column-tree-drop-indicator drop-indicator-left").css({left:dropTargetOffset.left+"px",top:dropTargetOffset.top+"px",width:"3px",height:this.getVerticalDropIndicatorHeight(dropTargetUnderCursor,dropTargetUnderCursor.leftSibling)+"px"})}},{key:"displayRightDropIndicator",value:function(dropTargetUnderCursor,idx){var dropTargetOffset=dropTargetUnderCursor.element.offset();Object(ui_build_bundle_module.mb)(this.dropIndicators[idx]).removeClass().addClass("column-tree-drop-indicator drop-indicator-right").css({left:dropTargetOffset.left+dropTargetUnderCursor.element.outerWidth()-3+"px",top:dropTargetOffset.top+"px",width:"3px",height:this.getVerticalDropIndicatorHeight(dropTargetUnderCursor,dropTargetUnderCursor.rightSibling)+"px"})}},{key:"displayAboveDropIndicator",value:function(dropTargetUnderCursor,idx){var dropTargetOffset=dropTargetUnderCursor.element.offset();Object(ui_build_bundle_module.mb)(this.dropIndicators[idx]).removeClass().addClass("column-tree-drop-indicator drop-indicator-above").css({left:dropTargetOffset.left+"px",top:dropTargetOffset.top+"px",width:dropTargetUnderCursor.element.outerWidth()+"px",height:"3px"})}},{key:"displayBelowDropIndicator",value:function(dropTargetUnderCursor,idx){var dropTargetOffset=dropTargetUnderCursor.element.offset();Object(ui_build_bundle_module.mb)(this.dropIndicators[idx]).removeClass().addClass("column-tree-drop-indicator drop-indicator-below").css({left:dropTargetOffset.left+"px",top:dropTargetOffset.top+dropTargetUnderCursor.element.outerHeight()-3+"px",width:dropTargetUnderCursor.element.outerWidth()+"px",height:"3px"})}},{key:"displayReplaceDropIndicator",value:function(dropTargetUnderCursor,idx){var dropTargetOffset=dropTargetUnderCursor.element.offset();Object(ui_build_bundle_module.mb)(this.dropIndicators[idx]).removeClass().addClass("column-tree-drop-indicator drop-indicator-replace").css({left:dropTargetOffset.left+"px",top:dropTargetOffset.top+"px",width:dropTargetUnderCursor.element.outerWidth()+"px",height:dropTargetUnderCursor.element.outerHeight()+"px"})}},{key:"getVerticalDropIndicatorHeight",value:function(dropTargetUnderCursor,dropTargetSibling){var maxY,dropTargetOffset=dropTargetUnderCursor.element.offset(),dropIndicatorHeight=dropTargetUnderCursor.element.outerHeight();if(dropTargetSibling){var siblingElement=dropTargetSibling.element,siblingElementOffset=siblingElement.offset();maxY=Math.max(dropTargetOffset.top+dropIndicatorHeight,siblingElementOffset.top+siblingElement.outerHeight())}else{var elementOffset=this.$el.offset();maxY=Math.max(dropTargetOffset.top+dropIndicatorHeight,elementOffset.top+this.$el.outerHeight())}return maxY-dropTargetOffset.top}},{key:"render",value:function(){return react_default.a.createElement(ComposedComponent,this.props,this.props.children)}},{key:"reportlet",get:function(){return this.props.reportlet}},{key:"columnTree",get:function(){return this.props.reportlet.columnTree}}]),_class}(ui_build_bundle_module.d)},function(ComposedComponent){return function(_AppComponent){function _class(props,context){var _this;return Object(classCallCheck.a)(this,_class),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(_class).call(this,props,context))).newStaticRows=[],_this.elementCache=new react_drag_drop_build_bundle_module.h,_this}return Object(inherits.a)(_class,_AppComponent),Object(createClass.a)(_class,[{key:"componentDidMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(_class.prototype),"componentDidMount",this).call(this);var domNode=react_dom_default.a.findDOMNode(this);this.$el=Object(ui_build_bundle_module.mb)(domNode.querySelector(".js-freeform-table-contents")),this.dropIndicator=Object(ui_build_bundle_module.mb)(document.createElement("div")).addClass("generic-drop-indicator"),this.freeformModelUtil=new build_bundle_module.kb(this.appContext),this.dropTargets=[],this.lastDropTarget=null,this.initDraggable(),this.initDropTarget()}},{key:"componentDidUpdate",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(_class.prototype),"componentDidUpdate",this).call(this),this.flashNewStaticRows()}},{key:"getComponentWithMetaDataForCell",value:function(cell){return cell.component?cell.componentWithMetaData:bundle_module.q.get(cell,"parent.isSummaryRow")&&bundle_module.q.get(cell,"parentTable.dimension")?new build_bundle_module.H({component:cell.parentTable.dimension}):null}},{key:"getComponentsWithMetaDataForDragDrop",value:function(targetElement){var _this2=this,cell=freeformGetCellAndRowFromElement(targetElement,this.reportlet).cell;if(cell.selected){var selectedComponentsWithMetaData=this.freeformTable.selectedCells.map(function(c){return _this2.getComponentWithMetaDataForCell(c)}),componentsWithMetaData=selectedComponentsWithMetaData.length>1?selectedComponentsWithMetaData:this.getComponentWithMetaDataForCell(cell);return bundle_module.q.uniq(bundle_module.q.flatten(componentsWithMetaData),"component.id")}return bundle_module.q.flatten([this.getComponentWithMetaDataForCell(cell)])}},{key:"getDragData",value:function(targetElement){return this.getComponentsWithMetaDataForDragDrop(targetElement).map(function(cr){return cr.component})}},{key:"getDragMetaData",value:function(targetElement){return{componentsWithMetaData:this.getComponentsWithMetaDataForDragDrop(targetElement)}}},{key:"initDraggable",value:function(){var _this3=this;this.$el.adDraggable({selector:".js-draggable-item",disableDrag:function(event){return!event.ctrlKey&&!event.metaKey},dragStartThreshold:5,dragProxyOpacity:.7,dragData:this.getDragData.bind(this),dragMetaData:this.getDragMetaData.bind(this),customDragProxy:function(targetElement){var cell=freeformGetCellAndRowFromElement(targetElement,_this3.reportlet).cell,component=_this3.getComponentWithMetaDataForCell(cell).component,div=document.createElement("div"),reactNode=react_default.a.createElement(FreeformReportletComponentDragProxy_FreeformReportletComponentDragProxy,{component:component});return react_dom_default.a.render(reactNode,div),div.firstChild},dragProxyDimensions:{width:200,height:42}})}},{key:"initDropTarget",value:function(){var _this4=this;this.$el.adDropTarget({behavior:{findTarget:"vertical-stack",draggableBackdrop:!1},targets:".js-freeform-table-drop-target",disabled:function(dragData){return!(bundle_module.q.isArray(dragData)?dragData:[dragData]).find(function(component){return ui_build_bundle_module.l.defaultComponentTypes.find(function(type){return component instanceof type})})},onStart:function(){_this4.elementCache.clearCache(),_this4.$el.addClass("is-dragging")},onEnd:function(){_this4.$el.removeClass("is-dragging"),_this4.elementCache.clearCache()},onClearCache:function(){_this4.dropTargets.splice(0),_this4.elementCache.clearCache()},onEnter:function(e){_this4.generateDropTargets(),_this4.showDropIndicator(e.globalPt)},onOver:function(e){_this4.dropTargets.length||_this4.generateDropTargets(),build_bundle_module.db.isActive("dropzoneGuides")&&_this4.findDropTargetUnderCursor(e.globalPt)&&(_this4.getDropIndicatorState(e),_this4.setDropIndicatorGuide()),_this4.showDropIndicator(e.globalPt)},onLeave:function(){_this4.hideDropIndicator()},onDrop:function(e){e.dragMetaData=e.dragMetaData||{};var componentsWithMetaData=e.dragMetaData.componentsWithMetaData,currentDropTarget=_this4.findDropTargetUnderCursor(e.globalPt);if(currentDropTarget&&!_this4.freeformTable.rows.length)0===_this4.reportlet.cachedLeafNodes.length&&(build_bundle_module.Hb.isMetricLike(e.dragData[0])?_this4.freeformModelUtil.setupDefaultSegmentForReport(_this4.reportlet):_this4.freeformModelUtil.setupDefaultMetricForReport(_this4.reportlet)),_this4.freeformModelUtil.applyComponents({freeformTable:_this4.freeformTable,components:e.dragData,opts:{componentsWithMetaData:componentsWithMetaData}});else if(currentDropTarget){var row=freeformGetCellAndRowFromElement(currentDropTarget,_this4.reportlet).row;if(row.isSummaryRow){if(!(e.dragData[0].constructor instanceof build_bundle_module.X))var callOff=row.parentReportlet.on("reportlet:render",function(){callOff(),_this4.goToStaticRowPage(e.dragData,row.parent)});_this4.freeformModelUtil.applyComponents({freeformTable:row.parent,components:e.dragData,opts:{componentsWithMetaData:componentsWithMetaData}})}else _this4.freeformModelUtil.breakdownRowFromComponents(row.parent,row,e.dragData),e.dragData.forEach(function(component){return ui_core_build_bundle_module.lb.trackAction(null,"Breakdown",{sourceRowName:row.name,sourceRowId:row.parent&&row.parent.dimension&&row.parent.dimension.id||row.component.id,breakdownBy:component.id})})}_this4.hideDropIndicator(),_this4.updateGlobalSelection(),ui_build_bundle_module.ib.trackDropComponents(e.dragData,"FreeformContents")}})}},{key:"generateDropTargets",value:function(){this.dropTargets.splice(0);var self=this;this.$el.find(".an-FreeformTable-cell-dropTarget").each(function(){var $cellDropTarget=Object(ui_build_bundle_module.mb)(this);Object(ui_build_bundle_module.lb)($cellDropTarget,$cellDropTarget.closest(".an-FreeformReportlet"))&&Object(ui_build_bundle_module.lb)($cellDropTarget,$cellDropTarget.closest(".an-panel-contents"))&&self.dropTargets.push($cellDropTarget)})}},{key:"getDropIndicatorState",value:function(e){var currentDropTarget=this.findDropTargetUnderCursor(e.globalPt),elementOffset=currentDropTarget.offset(),cell=freeformGetCellAndRowFromElement(currentDropTarget,this.reportlet).cell;this.indicator={text:"",warningText:"",iconClass:"",warningClass:"",defaultClass:freeformReportletContentDragDrop_DEFAULT_CLASS,extraClass:"",left:elementOffset.left,top:elementOffset.top,width:currentDropTarget.outerWidth(),height:currentDropTarget.outerHeight()},currentDropTarget&&!this.freeformTable.rows.length?(this.indicator.text=Object(l10nify_build_bundle_module.a)("Add"),this.indicator.iconClass=freeformReportletContentDragDrop_ADD_CLASS,this.reportlet.cachedLeafNodes.length&&this.checkForMetrics(e.dragData[0],cell)):currentDropTarget&&(cell.isSummaryCell?cell.parentTable.staticRows.length>0&&(cell.parentTable.staticRows[0].component.componentType===e.dragData[0].componentType||build_bundle_module.Hb.isMetricLike(cell.parentTable.staticRows[0].component)&&build_bundle_module.Hb.isMetricLike(e.dragData[0]))?(this.indicator.text=Object(l10nify_build_bundle_module.a)("Add"),this.indicator.iconClass=freeformReportletContentDragDrop_ADD_CLASS):(this.indicator.text=Object(l10nify_build_bundle_module.a)("Replace"),this.indicator.iconClass=freeformReportletContentDragDrop_REPLACE_CLASS,this.checkForMetrics(e.dragData[0],cell)):(this.indicator.text=Object(l10nify_build_bundle_module.a)("Breakdown"),this.indicator.iconClass=BREAKDOWN_CLASS,this.checkForMetrics(e.dragData[0],cell)))}},{key:"setDropIndicatorGuide",value:function(){this.dropIndicator.removeClass().attr("data-text",this.indicator.text).attr("data-warning",this.indicator.warningText).addClass("".concat(this.indicator.defaultClass," ").concat(this.indicator.iconClass," ").concat(this.indicator.extraClass," ").concat(this.indicator.warningClass)).css({left:this.indicator.left,top:this.indicator.top,width:this.indicator.width,height:this.indicator.height})}},{key:"checkForMetrics",value:function(dragData,cell){build_bundle_module.Hb.isMetricLike(dragData)?(this.checkColumnsForMetrics()||this.checkRowsForMetrics())&&this.displayDropIndicatorWarning(freeformReportletContentDragDrop_onlyOneMetricIsValid):(!this.checkColumnsForMetrics()&&!this.checkRowsForMetrics()||!this.checkColumnsForMetrics()&&this.checkRowsForMetrics()&&cell.isSummaryCell&&build_bundle_module.Hb.isMetricLike(cell.component))&&this.displayDropIndicatorWarning(freeformReportletContentDragDrop_metricRequired)}},{key:"checkColumnsForMetrics",value:function(){for(var columns=Object(toConsumableArray.a)(this.reportlet.cachedLeafNodes),i=0;i<columns.length;i++)if(columns[i].hasExactlyOneMetric)return!0;return!1}},{key:"checkRowsForMetrics",value:function(){return this.reportlet.freeformTable.hasMetricStaticRows()}},{key:"showDropIndicator",value:function(globalPt){var currentDropTarget=this.findDropTargetUnderCursor(globalPt);if(currentDropTarget&&currentDropTarget!==this.lastDropTarget){var elementOffset=currentDropTarget.offset();this.dropIndicator.css({left:elementOffset.left,top:elementOffset.top,width:currentDropTarget.outerWidth(),height:currentDropTarget.outerHeight()}),this.dropIndicator.parent().length||this.dropIndicator.appendTo("body"),this.lastDropTarget=currentDropTarget}else currentDropTarget||this.hideDropIndicator()}},{key:"hideDropIndicator",value:function(){this.dropIndicator.parent().length&&this.dropIndicator.remove(),this.lastDropTarget=null}},{key:"displayDropIndicatorWarning",value:function(error){this.indicator.warningText="".concat(Object(l10nify_build_bundle_module.a)(error)),this.indicator.warningClass=freeformReportletContentDragDrop_WARNING_CLASS}},{key:"findDropTargetUnderCursor",value:function(globalPt){for(var i=0;i<this.dropTargets.length;i++)if(react_drag_drop_build_bundle_module.i.elementContainsGlobalPt(this.dropTargets[i].get(0),globalPt))return this.dropTargets[i];return null}},{key:"updateGlobalSelection",value:function(){this.subPanel.selected||workspace_selectionService.update(this.subPanel,this.$el.parentsUntil(".js-an-sub-panel"))}},{key:"goToStaticRowPage",value:function(components,freeformTable){var _this5=this;build_bundle_module.sc.runAndIgnoreAllChanges(function(){var allStaticRows=freeformTable.staticRows,newRowComponentIds=bundle_module.q.pluck(components,"id"),idKey="item"===components[0].itemType?"itemId":"componentId",newStaticRows=bundle_module.q.uniq(allStaticRows,idKey).filter(function(row){return bundle_module.q.contains(newRowComponentIds,row[idKey])});newStaticRows.length&&freeformTable.goToStaticRowPage(newStaticRows[0]),_this5.newStaticRows=newStaticRows})}},{key:"flashNewStaticRows",value:function(){if(this.newStaticRows){var newStaticRowIds=bundle_module.q.pluck(this.newStaticRows,"id");this.$el.find(".an-FreeformTable-row").filter(function(){return bundle_module.q.contains(newStaticRowIds,Object(ui_build_bundle_module.mb)(this).data("data-row-id"))}).addClass("new-static-row"),this.newStaticRows=void 0}}},{key:"render",value:function(){return react_default.a.createElement(ComposedComponent,this.props,this.props.children)}},{key:"reportlet",get:function(){return this.props.reportlet}},{key:"subPanel",get:function(){return this.props.subPanel}},{key:"freeformTable",get:function(){return this.reportlet.freeformTable}}]),_class}(ui_build_bundle_module.d)},function(ComposedComponent){return function(_AppComponent){function _class(){return Object(classCallCheck.a)(this,_class),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(_class).apply(this,arguments))}return Object(inherits.a)(_class,_AppComponent),Object(createClass.a)(_class,[{key:"componentDidMount",value:function(){var _this=this;Object(esm_get.a)(Object(getPrototypeOf.a)(_class.prototype),"componentDidMount",this).call(this),this.freeformModelUtil=new build_bundle_module.kb(this.appContext),this.isIE=dom_util_build_bundle_module.a.isIEOrEdge,this.ieVersion=dom_util_build_bundle_module.a.ieVersion(),this.newActiveRow=void 0,this.activeCellRowIndex=void 0,this.$el=Object(ui_build_bundle_module.mb)(react_dom_default.a.findDOMNode(this)),this.$parentEl=this.$el.parent(),this.$el.attr("tabindex",0),this.$parentEl.on("click",".js-selectable",function(e){return _this.onSelectableItemClick(e)}),this.$parentEl.on("dblclick",".js-selectable",function(e){return _this.onSelectableItemDoubleClick(e)}),this.$parentEl.on("dblclick",".js-pivot-cell",function(e){return _this.onDoubleClickPivotCell(e)}),this.$parentEl.on("mousedown",".js-selectable-drag-start",function(e){return _this.onSelectableItemDragStart(e)}),this.$parentEl.on("keydown",function(e){return _this.onKeyDown(e)}),this.registerOff(this.reportlet.on("change:selection",function(e){_this.selectCellsWithJQuery(_this.reportlet,{cellsToSelect:e.cellsToSelect}),_this.reportlet.updateLinkedByDerivedDataSourcesForSelectionChange(_this.appContext)})),this.registerOff(this.reportlet.on("change:isSelecting",function(e){e.newValue||_this.setState({})})),this.applySelectionOnUndoRedoComplete()}},{key:"applySelectionOnUndoRedoComplete",value:function(){var _this2=this;this.registerOff(this.reportlet.on("undoRedoComplete",function(events){events.map(function(e){return Object(bundle_module.B)(e)}).some(function(e){return"selectionCoordinates"===e.property})&&_this2.selectCellsWithJQuery(_this2.reportlet)}))}},{key:"componentWillUnmount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(_class.prototype),"componentWillUnmount",this).call(this),this.$parentEl.off(),this.$el=void 0,this.$parentEl=void 0,this.freeformModelUtil=void 0,this.newActiveRow=void 0,this.activeCellRowIndex=void 0}},{key:"selectCellsWithJQuery",value:function(reportlet){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var cellsToSelect=bundle_module.q.indexBy(reportlet.selectedCells,"id");this.$parentEl.find(".is-selected").toggleClass("is-selected",!1);var elsToUpdate=[];this.$parentEl.find(".js-selectable").each(function(){var id=this.getAttribute("data-cell-id");if(cellsToSelect[id]&&elsToUpdate.push(this),elsToUpdate.length===cellsToSelect.size)return!1}),Object(ui_build_bundle_module.mb)(elsToUpdate).find(".an-FreeformTable-cell-container").toggleClass("is-selected",!0),Object(ui_build_bundle_module.mb)(elsToUpdate).filter(".js-column-header").toggleClass("is-selected",!0)}},{key:"onSelectableItemClick",value:function(event){var $tgt=Object(ui_build_bundle_module.mb)(event.target);if(!this.isBlacklistedForSelection($tgt)){var activeCell,anchorCell,cell=freeformGetCellAndRowFromElement(event.currentTarget,this.reportlet).cell;if(!cell)return;event.shiftKey?(anchorCell=this.reportlet.anchorCell||cell,activeCell=$tgt.hasClass("an-FreeformTable-rowNum")?cell.parent.cells[cell.parent.cells.length-1]:cell,this.freeformModelUtil.selectRange(this.reportlet,{anchorCell:anchorCell,activeCell:activeCell})):event.ctrlKey||event.metaKey?!cell.selected&&$tgt.hasClass("an-FreeformTable-rowNum")?this.freeformModelUtil.selectRow(this.reportlet,cell.parent,{deselectOthers:!1}):cell.selected?this.freeformModelUtil.unSelectCell(this.reportlet,cell,{deselectOthers:!1}):this.freeformModelUtil.selectCell(this.reportlet,cell,{deselectOthers:!1}):!cell.selected&&$tgt.hasClass("an-FreeformTable-rowNum")?this.freeformModelUtil.selectRow(this.reportlet,cell.parent):cell.selected?this.freeformModelUtil.unSelectCell(this.reportlet,cell):this.freeformModelUtil.selectCell(this.reportlet,cell,{deselectOthers:!0})}}},{key:"onSelectableItemDoubleClick",value:function(event){var $tgt=Object(ui_build_bundle_module.mb)(event.target),deselectOthers=!(event.ctrlKey||event.metaKey);if(!this.isBlacklistedForSelection($tgt)){var cell=freeformGetCellAndRowFromElement(event.currentTarget,this.reportlet).cell;if(!cell)return;if(cell.isSummaryLabelCell)this.freeformModelUtil.selectAllInTable(this.reportlet,cell.parentTable);else if(cell.isDataLabelCell)this.freeformModelUtil.selectRow(this.reportlet,cell.parent,{deselectOthers:deselectOthers});else if(cell.parent.isSummaryRow)this.freeformModelUtil.selectColumnInTable(this.reportlet,cell.parentTable,cell.index);else if(cell.parent.isHeaderRow){var startIdx=cell.index,endIdx=cell.index+cell.column.colspan-1,rowIdx=this.reportlet.rows.indexOf(cell.parent);endIdx>startIdx?this.freeformModelUtil.selectContiguousColumns(this.reportlet,startIdx,endIdx,rowIdx,{deselectOthers:deselectOthers}):this.freeformModelUtil.selectColumn(this.reportlet,startIdx,rowIdx,{deselectOthers:deselectOthers})}}}},{key:"onDoubleClickPivotCell",value:function(){this.freeformModelUtil.selectAll(this.reportlet)}},{key:"onSelectableItemDragStart",value:function(event){var _this3=this;if(this.props.dragManager.disabled){var originPt,currentCell,selectedCellCache,emitSelectionChange,debouncedEmitSelectionChange,dragging=!1,onMouseMove=function(event){_this3.isIE&&_this3.ieVersion<10&&event.preventDefault();var freeformModelUtilOpts={deselectOthers:!(event.ctrlKey||event.metaKey),selectedCellCache:selectedCellCache,emitSelectionEvent:!1,onSelectionChange:function(){var cellsToSelect=selectedCellCache.getSelectedCells();_this3.selectCellsWithJQuery(_this3.reportlet,{cellsToSelect:cellsToSelect})}};dragging?(currentCell=freeformGetCellAndRowFromElement(event.currentTarget,_this3.reportlet).cell)!==_this3.reportlet.activeCell&&(_this3.freeformModelUtil.selectRange(_this3.reportlet,Object(objectSpread.a)({},freeformModelUtilOpts,{anchorCell:_this3.reportlet.anchorCell||currentCell,activeCell:currentCell})),debouncedEmitSelectionChange()):getDistanceBetweenPoints(originPt,{x:event.clientX,y:event.clientY})>5&&(dragging=!0,_this3.reportlet.isSelecting=!0,currentCell=freeformGetCellAndRowFromElement(event.currentTarget,_this3.reportlet).cell,_this3.freeformModelUtil.selectRange(_this3.reportlet,Object(objectSpread.a)({},freeformModelUtilOpts,{anchorCell:currentCell,activeCell:currentCell})),debouncedEmitSelectionChange())},getDistanceBetweenPoints=function(pt1,pt2){var xs=pt2.x-pt1.x,ys=pt2.y-pt1.y;return Math.sqrt(xs*xs+ys*ys)};event.shiftKey&&this.isIE&&event.preventDefault(),this.isBlacklistedForSelection(Object(ui_build_bundle_module.mb)(event.target))||event.shiftKey||(selectedCellCache=new freeformReportletSelection_SelectedCellCache(this.reportlet.selectedCells),this.reportlet.parent.startBatchingEvents(),emitSelectionChange=function(){return _this3.freeformModelUtil._emitSelectionChange(_this3.reportlet,{cellsToSelect:selectedCellCache.getSelectedCells()})},debouncedEmitSelectionChange=bundle_module.q.debounce(emitSelectionChange,300),originPt={x:event.clientX,y:event.clientY},Object(ui_build_bundle_module.mb)(window.document).on("mouseup",function onMouseUp(){dragging=!1,originPt=null,Object(ui_build_bundle_module.mb)(window.document).off("mouseup",onMouseUp),_this3.$parentEl.off("mousemove",".js-selectable",onMouseMove),_this3.reportlet.isSelecting=!1,debouncedEmitSelectionChange.cancel(),emitSelectionChange(),selectedCellCache=null,_this3.reportlet.parent&&_this3.reportlet.parent.runBatchedHandlers()}),this.$parentEl.on("mousemove",".js-selectable",onMouseMove))}}},{key:"onKeyDown",value:function(event){if(!this.isInput(Object(ui_build_bundle_module.mb)(event.target))&&this.reportlet.anchorCell&&this.reportlet.activeCell){var anchorCell,activeCell,deselectOthers=!(event.ctrlKey||event.metaKey);switch(event.keyCode){case ui_build_bundle_module.H.LEFT:var leftSibling=this.reportlet.activeCell.sibling("left");leftSibling&&(activeCell=leftSibling,anchorCell=event.shiftKey?this.reportlet.anchorCell:activeCell,this.freeformModelUtil.selectRange(this.reportlet,{anchorCell:anchorCell,activeCell:activeCell,deselectOthers:deselectOthers})),event.preventDefault();break;case ui_build_bundle_module.H.UP:this.activeCellRowIndex=this.reportlet.rows.indexOf(this.reportlet.activeCell.parent),this.activeCellRowIndex>0&&(this.newActiveRow=this.reportlet.rows[this.activeCellRowIndex-1],activeCell=this.newActiveRow.getCellAt(this.reportlet.activeCell.index),(anchorCell=event.shiftKey?this.reportlet.anchorCell:activeCell)&&activeCell&&this.freeformModelUtil.selectRange(this.reportlet,{anchorCell:anchorCell,activeCell:activeCell,deselectOthers:deselectOthers}),event.preventDefault());break;case ui_build_bundle_module.H.RIGHT:var rightSibling=this.reportlet.activeCell.sibling();rightSibling&&(activeCell=rightSibling,anchorCell=event.shiftKey?this.reportlet.anchorCell:activeCell,this.freeformModelUtil.selectRange(this.reportlet,{anchorCell:anchorCell,activeCell:activeCell,deselectOthers:deselectOthers})),event.preventDefault();break;case ui_build_bundle_module.H.DOWN:this.activeCellRowIndex=this.reportlet.rows.indexOf(this.reportlet.activeCell.parent),this.activeCellRowIndex+=this.reportlet.activeCell.rowspan-1,this.activeCellRowIndex<this.reportlet.rows.length-1&&(this.newActiveRow=this.reportlet.rows[this.activeCellRowIndex+1],activeCell=this.newActiveRow.getCellAt(this.reportlet.activeCell.index),anchorCell=event.shiftKey?this.reportlet.anchorCell:activeCell,this.freeformModelUtil.selectRange(this.reportlet,{anchorCell:anchorCell,activeCell:activeCell,deselectOthers:deselectOthers}),event.preventDefault())}}}},{key:"isInput",value:function($tgt){return $tgt.is("input,textarea,button,li")||$tgt.get(0).isContentEditable}},{key:"isBlacklistedForSelection",value:function($tgt){return $tgt.add($tgt.closest(".js-selectable, .js-not-selectable")).is(".js-not-selectable")}},{key:"render",value:function(){return react_default.a.createElement(ComposedComponent,this.props,this.props.children)}},{key:"reportlet",get:function(){return this.props.reportlet}}]),_class}(ui_build_bundle_module.d)},function(ComposedComponent){return function(_AppComponent){function _class(props,context){var _this;return Object(classCallCheck.a)(this,_class),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(_class).call(this,props,context))).onContextMenu=_this.onContextMenu.bind(Object(assertThisInitialized.a)(_this)),_this}return Object(inherits.a)(_class,_AppComponent),Object(createClass.a)(_class,[{key:"cache",value:function(){return["attributionTemplates"]}},{key:"componentDidMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(_class.prototype),"componentDidMount",this).call(this),this.$el=Object(ui_build_bundle_module.mb)(react_dom_default.a.findDOMNode(this)),this.$parentEl=this.$el.parent(),this.freeformMiscUtilities=new build_bundle_module.jb,this.freeformModelUtil=new build_bundle_module.kb(this.appContext),this.currentRowModel=void 0,this.currentCellModel=void 0,this.$parentEl.on("contextmenu",".an-FreeformTable-cell:not(.js-an-FreeformTable-cell-initialState), .js-column-header",this.onContextMenu)}},{key:"componentWillUnmount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(_class.prototype),"componentWillUnmount",this).call(this),this.$parentEl.off("contextmenu",".an-FreeformTable-cell:not(.js-an-FreeformTable-cell-initialState), .js-column-header",this.onContextMenu),this.$el=void 0,this.parentEl=void 0,this.freeformMiscUtilities=void 0,this.freeformModelUtil=void 0,this.currentRowModel=void 0,this.currentCellModel=void 0}},{key:"onContextMenu",value:function(e){if(!e.altKey){e.preventDefault(),this.onShowMenu(e.currentTarget);var items=this.rowContextMenuItems;0!==items.length&&(ui_core_build_bundle_module.P.closeAll(),ui_core_build_bundle_module.ab.show({target:e.currentTarget,items:items,onClick:this.onItemClick.bind(this),showSearchBar:!0}))}}},{key:"deleteBreakdown",value:function(){this.currentRowModel.removeBreakdown(),ui_core_build_bundle_module.lb.trackAction(null,"Right Click: Delete Breakdown")}},{key:"addDeltaColumn",value:function(){var cellModel=this.currentCellModel,metric=cellModel.closestMetric,deltaMetricView=metric.metricViews.find(function(mv){return mv.isDelta}),deltaNode=new build_bundle_module.fb({component:deltaMetricView}),metricNode=new build_bundle_module.fb({component:metric}),deltaColumn=deltaNode.addNode(metricNode);cellModel.column.addSiblingNode(deltaColumn,"right"),metricNode.tableCellDisplay=cellModel.column.tableCellDisplay.copy(),metricNode.tableCellDisplay.type.interpretZeroAsNoValue=!0,ui_core_build_bundle_module.lb.trackAction(null,"Right Click: Add Delta Column")}},{key:"createAlertFromSelection",value:function(){var _createAlertFromSelection=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(){var alert;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,this.freeformModelUtil.createAlertFromSelection(this.reportlet);case 2:alert=_context.sent,ui_build_bundle_module.x.AnomalyDetectionAlerts.hasAccess(this.app)||alert.definition.rules.forEach(function(rule){rule.triggers.forEach(function(trigger){trigger.triggerCriteria.type="high"})}),this.app.inAppEditors.showAlertBuilder({alert:alert,trackAction:"Right Click: Create Alert From Selection"});case 5:case"end":return _context.stop()}},_callee,this)}));return function(){return _createAlertFromSelection.apply(this,arguments)}}()},{key:"logLastRequest",value:function(){var row=this.currentRowModel;console.log(JSON.stringify(row.parent.lastRankedRequest,null,2))}},{key:"deleteAllBreakdowns",value:function(){this.reportlet.freeformTable.resetBreakdowns(!0),ui_core_build_bundle_module.lb.trackAction(null,"Right Click: Delete All Breakdowns")}},{key:"collapseAllBreakdowns",value:function(){bundle_module.q.each(this.reportlet.freeformTable.breakdowns,function(breakdown){breakdown.collapsed=!0}),ui_core_build_bundle_module.lb.trackAction(null,"Right Click: Collapse All Breakdowns")}},{key:"expandAllBreakdowns",value:function(){this.reportlet.freeformTable.collapsed=!1,this.reportlet.freeformTable.breakdowns.forEach(function(breakdown){return breakdown.collapsed=!1}),ui_core_build_bundle_module.lb.trackAction(null,"Right Click: Expand All Breakdowns")}},{key:"deleteStaticRow",value:function(){1===this.currentRowModel.parent.staticRows.length?this.currentRowModel.removeBreakdown():this.currentRowModel.remove(),ui_core_build_bundle_module.lb.trackAction(null,"Right Click: Delete Static Row")}},{key:"deleteSelectedStaticRows",value:function(){bundle_module.q.invoke(this.reportlet.freeformTable.selectedRowsExcludingBreakdowns,"remove"),ui_core_build_bundle_module.lb.trackAction(null,"Right Click: Delete Selected Static Rows")}},{key:"deleteSelectedColumnNodes",value:function(){var topMostTable=this.reportlet.freeformTable,breakdownDefaultAttributions=topMostTable.getDefaultBreakdownAttributions(this.app.cache);this.reportlet.columnTree.selectedNodes.forEach(function(node){if(node.dataSettings.attribution){node.dataSettings.attribution=null,topMostTable.removeColumnAttributionSetting(node);var attributionNode=node.getAttributionColumnInTree();attributionNode&&topMostTable.recursivelyUpdateAttribution(node,attributionNode.attribution,breakdownDefaultAttributions)}}),bundle_module.q.invoke(this.reportlet.columnTree.selectedNodes,"remove",!1),ui_core_build_bundle_module.lb.trackAction(null,"Right Click: Delete Selected Column Tree Nodes")}},{key:"downloadAsCSV",value:function(){var result=this.reportlet.format("csv",{app:this.app});Object(ui_build_bundle_module.hb)(this.app,{filename:this.subPanel.label,filetype:"csv",dataString:result}),ui_core_build_bundle_module.lb.trackAction(null,"Right Click: Download as CSV")}},{key:"downloadAsCSVMassive",value:function(){var _downloadAsCSVMassive=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee2(){var reportletService,result;return regenerator_default.a.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return reportletService=new build_bundle_module.cc(this.appContext),_context2.next=3,reportletService.load(this.subPanel);case 3:result=_context2.sent,console.log("Reportlet Service Result",result);case 5:case"end":return _context2.stop()}},_callee2,this)}));return function(){return _downloadAsCSVMassive.apply(this,arguments)}}()},{key:"displayOnlySelectedRows",value:function(){this.reportlet.freeformTable.displayOnlySelectedRows(),ui_core_build_bundle_module.lb.trackAction(null,"Right Click: Display only selected rows")}},{key:"displayAllRows",value:function(){this.freeformModelUtil.displayAllRows(this.reportlet.freeformTable),ui_core_build_bundle_module.lb.trackAction(null,"Right Click: Display all rows")}},{key:"trendSelection",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Auto Trend");var newVisualization=build_bundle_module.vb.create("LineReportlet");this.subPanel.addSibling(newVisualization),newVisualization.linkedSource=this.subPanel,bundle_module.q.set(newVisualization,"reportlet.useRowBasedPercentages",!0)}},{key:"createSegmentFromSelection",value:function(){var _createSegmentFromSelection=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee3(){var selectedCells,components,segment;return regenerator_default.a.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return ui_core_build_bundle_module.lb.trackAction(null,"Create Segment From Selection"),selectedCells=this.reportlet.selectedCells,components=bundle_module.q.compact(bundle_module.q.uniq(selectedCells.map(function(cell){return cell.component}))),_context3.next=5,build_bundle_module.ec.fromComponents(components,this.appContext.app);case 5:segment=_context3.sent,this.app.inAppEditors.showSegmentBuilder({segment:segment});case 7:case"end":return _context3.stop()}},_callee3,this)}));return function(){return _createSegmentFromSelection.apply(this,arguments)}}()},{key:"runInSegmentComparison",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Compare segments");var panel=build_bundle_module.Rb.createWithAudienceComparisonConfig({name:Object(l10nify_build_bundle_module.a)("Segment Comparison Panel"),segmentGroups:this.subPanel.parentPanel.segmentGroups},this.app),panels=this.subPanel.parentWorkspace.panels;build_bundle_module.xb.addItemAboveAnchor(panel,this.subPanel.parent,panels),WorkspaceScrollTo_WorkspaceScrollTo.scrollToPanel(panel.id),panel.makeNameUnique(),panel.config.addSegmentsFromSelectedCells(this.reportlet.selectedCells,this.app)}},{key:"resetColumnWidths",value:function(){build_bundle_module.sc.temporarilySuspendIgnore(this.reportlet.freeformTable,"columnWidths"),this.$el.find(".an-FreeformTable").resizableColumns("resetColumnWidths"),ui_core_build_bundle_module.lb.trackAction(null,"Right Click: Reset column widths")}},{key:"editComponents",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Edit Component"),this.currentCellModel.component.edit(this.app)}},{key:"runContributionAnalysis",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Run Contribution Analysis from right-click (table)"),addContributionAnalysisPanelFromFreeformCell(this.reportlet.selectedCells[0]instanceof build_bundle_module.gb?this.reportlet.selectedCells[0]:this.reportlet.selectedCells[1],this.appContext)}},{key:"getSelectedMetricCells",value:function(){return this.reportlet.selectedCells.filter(function(cell){return cell.component instanceof build_bundle_module.Hb&&(cell.isHeaderCell||cell.parent instanceof build_bundle_module.nb)})}},{key:"getSelectedAttributionEnabledCells",value:function(){return this.reportlet.selectedCells.filter(function(cell){if(cell.isHeaderCell||cell.isLabelCell){var component=cell.component;return component instanceof build_bundle_module.Hb&&component.allocation}return cell.isSummaryCell?cell.column.getAttributionColumnInTree():null})}},{key:"modifyAttributionModel",value:function(){var _this2=this;if(ui_core_build_bundle_module.lb.trackAction(null,"Right Click: Modify Attribution Model"),this.state.attributionTemplates){var selectedCells=this.getSelectedAttributionEnabledCells(),selectedAttribution=selectedCells[0].dataSettings.attribution;AttributionSettingsDialog.a.show({selectedAttribution:selectedAttribution,reportSuite:this.reportSuite,applySettings:function(model){return _this2.onApplyAttribution(selectedCells,model)}})}}},{key:"onApplyAttribution",value:function(cells,attribution){var topMostTable=this.reportlet.freeformTable,breakdownDefaultAttributions=topMostTable.getDefaultBreakdownAttributions(this.app.cache);cells.forEach(function(cell){var column=cell.column,isUpdate=Boolean(column.attribution);column.dataSettings.attribution=attribution.copy(),cell.isHeaderCell?isUpdate?topMostTable.updateAttribution(column,attribution):topMostTable.recursivelyUpdateAttribution(column,attribution,breakdownDefaultAttributions):cell.parentTable.updateAttribution(column,attribution)})}},{key:"copyToClipboard",value:function(){var clipboardText=this.reportlet.formatForClipboard(this.app);clipboardText&&(ui_build_bundle_module.i.setData(clipboardText),this.app.addAlert({variant:"success",contents:Object(l10nify_build_bundle_module.a)("Data copied to clipboard.")}),ui_core_build_bundle_module.lb.trackAction(null,"Right-click: Copy to Clipboard"))}},{key:"makeItemStatic",value:function(){this.reportlet.selectedCells.forEach(function(cell){cell instanceof build_bundle_module.hb&&(cell.column.topItemPosition=void 0)}),ui_core_build_bundle_module.lb.trackAction(null,"Right-click: Make Item Static")}},{key:"addComparativeAttributionModel",value:function(cellModel){var _this3=this;this.state.attributionTemplates&&(ui_core_build_bundle_module.lb.trackAction(null,"Right Click: Compare Attribution Models"),AttributionSettingsDialog.a.show({header:Object(l10nify_build_bundle_module.a)("Compare Attribution Models"),reportSuite:this.reportSuite,selectedAttribution:null,applySettings:function(model){return _this3.onComparativeAttributionChosen(cellModel,model)}}))}},{key:"rightClickCreateCalculatedMetric",value:function(){createCalculatedMetric.apply(void 0,arguments)}},{key:"onComparativeAttributionChosen",value:function(selectedCell,attribution){var column=selectedCell.column,comparisonColumn=new build_bundle_module.fb({component:selectedCell.component});comparisonColumn.tableCellDisplay=build_bundle_module.qb.fromJSON(column.tableCellDisplay.toJSON()),comparisonColumn.dataSettings=build_bundle_module.rb.fromJSON(column.dataSettings.toJSON()),comparisonColumn.dataSettings.attribution=attribution.copy(),column.addSiblingNode(comparisonColumn,"right");var leafNode=comparisonColumn.traverseTreeAndRetrieveLeafNodes()[0];leafNode||(leafNode=comparisonColumn);var topMostTable=this.reportlet.freeformTable,breakdownDefaultAttributions=topMostTable.getDefaultBreakdownAttributions(this.app.cache);column.getAttributionInTree()&&this.reportlet.freeformTable.breakdowns.length?this.reportlet.freeformTable.breakdowns.length&&(leafNode.dataSettings.attribution=attribution.copy(),topMostTable.copyColumnAttribution(column,leafNode),topMostTable.updateAttribution(leafNode,attribution)):(leafNode.dataSettings.attribution=attribution.copy(),topMostTable.recursivelyUpdateAttribution(leafNode,attribution,breakdownDefaultAttributions)),this.rightClickCreateCalculatedMetric([column,comparisonColumn],"percentChange",!1,this.reportlet,this.app,2)}},{key:"spoofData",value:function(target){FreeformCellDataSpoofer_FreeformCellDataSpoofer.show(target,this.currentCellModel,this.reportlet)}},{key:"getAllContextMenuItems",value:function(){var self=this;return{makeItemStatic:{label:Object(l10nify_build_bundle_module.a)("Make Item Static"),onClick:this.makeItemStatic.bind(this)},copyToClipboard:{label:Object(l10nify_build_bundle_module.a)("Copy to Clipboard"),onClick:this.copyToClipboard.bind(this)},deleteBreakdownOption:{label:Object(l10nify_build_bundle_module.a)("Delete"),onClick:this.deleteBreakdown.bind(this)},alertOption:{label:Object(l10nify_build_bundle_module.a)("Create alert from selection"),onClick:this.createAlertFromSelection.bind(this)},showLastRequestOption:{label:Object(l10nify_build_bundle_module.a)("DEV: Log last request"),onClick:this.logLastRequest.bind(this)},breakdownOption:{label:Object(l10nify_build_bundle_module.a)("Breakdown"),get items(){var isSupportedComponent=self.subPanel.isSupportedComponent.bind(self.reportlet);return bundle_module.q.filter([{label:Object(l10nify_build_bundle_module.a)("Dimensions"),dataKey:"dimensions",items:bundle_module.q.filter(self.app.cache.getCollection("dimensions").items,isSupportedComponent),sort:"asc"},{label:Object(l10nify_build_bundle_module.a)("Metrics"),dataKey:"combinedMetrics",items:bundle_module.q.filter(self.app.cache.getCollection("combinedMetrics").items,isSupportedComponent),sort:"asc"},{label:Object(l10nify_build_bundle_module.a)("Segments"),dataKey:"segments",items:bundle_module.q.filter(self.app.cache.getCollection("segments").items,isSupportedComponent),sort:"asc"},{label:Object(l10nify_build_bundle_module.a)("Time"),dataKey:"dateRanges",items:bundle_module.q.filter(self.app.cache.getCollection("dateRanges").items,isSupportedComponent)}],function(group){return group.items.length})}},removeBreakdownsOption:{label:Object(l10nify_build_bundle_module.a)("Delete all breakdowns"),onClick:this.deleteAllBreakdowns.bind(this)},collapseBreakdownsOption:{label:Object(l10nify_build_bundle_module.a)("Collapse All Breakdowns"),onClick:this.collapseAllBreakdowns.bind(this)},expandBreakdownsOption:{label:Object(l10nify_build_bundle_module.a)("Expand All Breakdowns"),onClick:this.expandAllBreakdowns.bind(this)},deleteStaticRowOption:{label:Object(l10nify_build_bundle_module.a)("Delete"),onClick:this.deleteStaticRow.bind(this)},deleteSelectedStaticRowsOption:{label:Object(l10nify_build_bundle_module.a)("Delete selected"),onClick:this.deleteSelectedStaticRows.bind(this)},deleteSelectedNodesOption:{label:Object(l10nify_build_bundle_module.a)("Delete Selected"),onClick:this.deleteSelectedColumnNodes.bind(this)},exportToCSVOption:{label:Object(l10nify_build_bundle_module.a)("Download as CSV"),onClick:this.downloadAsCSV.bind(this)},exportToCSVOptionMassiveDownload:{label:Object(l10nify_build_bundle_module.a)("Download as CSV"),onClick:this.downloadAsCSVMassive.bind(this)},displayOnlySelectedRowsOption:{label:Object(l10nify_build_bundle_module.a)("Display only selected rows"),onClick:this.displayOnlySelectedRows.bind(this)},displayAllRowsOption:{label:Object(l10nify_build_bundle_module.a)("Display all rows"),onClick:this.displayAllRows.bind(this)},chartOption:{label:Object(l10nify_build_bundle_module.a)("Visualize"),items:bundle_module.q.map(bundle_module.q.reject(build_bundle_module.Nc.contextMenuCharts,function(chart){return chart.isReconfigurable}),function(item){var i=item.copy();return i.snapShot="none",i})},autoTrendOption:{label:Object(l10nify_build_bundle_module.a)("Trend selection"),onClick:this.trendSelection.bind(this)},resetColumnWidthsOption:{label:Object(l10nify_build_bundle_module.a)("Reset column widths"),onClick:this.resetColumnWidths.bind(this)},editComponentOption:{label:Object(l10nify_build_bundle_module.a)("Edit Component"),onClick:this.editComponents.bind(this)}}}},{key:"isTimeComparisonEnabled",value:function(cell){if(cell.isLabelCell)return!1;var freeformTable=this.reportlet.freeformTable,rowComponents=cell.parent.selfAndParentComponents||[];if(!rowComponents.length&&freeformTable.staticRows.length?rowComponents=this.reportlet.freeformTable.staticRows.map(function(row){return row.component}):!rowComponents.length&&freeformTable.dimension&&(rowComponents=[freeformTable.dimension]),rowComponents.filter(function(comp){return comp instanceof build_bundle_module.Y&&"time"===bundle_module.q.get(comp,"dimension.type")||comp instanceof build_bundle_module.X&&"time"===comp.type||!!build_bundle_module.Hb.isMetricLike(comp)||comp instanceof build_bundle_module.S}).length>0)return!1;var col=cell.column;if(!col.isLeafNode&&col.selfAndChildNodesAreSingleColumn)col=col.traverseTreeAndRetrieveLeafNodes()[0];else if(!col.isLeafNode)return!1;return!(col.selfAndParentComponents.filter(function(comp){return comp instanceof build_bundle_module.Y&&"time"===bundle_module.q.get(comp,"dimension.type")}).length>0)&&1===col.metricNodes.length}},{key:"areRowsValidForCreateCM",value:function(cell){var freeformTable=cell.parent.parentReportlet.freeformTable,staticRows=freeformTable.staticRows,hasMixedTypeStaticRows=freeformTable.hasMixedTypeStaticRows,containsSegmentRows=staticRows.length&&staticRows[0].component instanceof build_bundle_module.ec,containsDateRows=staticRows.length&&staticRows[0].component instanceof build_bundle_module.S;return!hasMixedTypeStaticRows&&!containsSegmentRows&&!containsDateRows}},{key:"isCreateCalculatedMetricEnabled",value:function(cell){return this.getSelectedMetricHeaderColumnsForCreateCM(cell).length&&this.areRowsValidForCreateCM(cell)}},{key:"addCompareDateColumn",value:function(){var _addCompareDateColumn=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee4(comparisonRange,col){var dateCompareComponent,nonDateRangeColumns,comparisonDateColumn,topNodeWithNestedNodes,leafNodes;return regenerator_default.a.wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return dateCompareComponent=new build_bundle_module.S({name:" ",definition:comparisonRange,internal:!0}),_context4.next=3,this.app.repo.save(dateCompareComponent);case 3:(nonDateRangeColumns=col.selfAndParents.filter(function(col){return!(col.component instanceof build_bundle_module.S)})).reverse(),comparisonDateColumn=new build_bundle_module.fb({component:dateCompareComponent}),nonDateRangeColumns.length>0&&(topNodeWithNestedNodes=build_bundle_module.fb.convertComponentArrayToNestedNodes(nonDateRangeColumns.map(function(col){return col.component})),comparisonDateColumn.addNode(topNodeWithNestedNodes)),(leafNodes=comparisonDateColumn.traverseTreeAndRetrieveLeafNodes()).length>0&&(leafNodes[0].tableCellDisplay=col.tableCellDisplay.copy(),leafNodes[0].dataSettings=col.dataSettings.copy()),bundle_module.q.last(col.selfAndParents).addSiblingNode(comparisonDateColumn,"left"),leafNodes[0]&&leafNodes[0].getAttributionInTree()&&this.reportlet.freeformTable.copyColumnAttribution(col,leafNodes[0]);case 12:case"end":return _context4.stop()}},_callee4,this)}));return function(_x,_x2){return _addCompareDateColumn.apply(this,arguments)}}()},{key:"getFiltersBelowMetric",value:function(metricNode){return metricNode.allNodesInTree.filter(function(node){return node.isFilter&&!(node.component instanceof build_bundle_module.S)})}},{key:"getCompareOptions",value:function(cellModel){var _this4=this,isPart2=arguments.length>1&&void 0!==arguments[1]&&arguments[1],col=cellModel.column;if(!col.isLeafNode&&col.selfAndChildNodesAreSingleColumn)col=col.traverseTreeAndRetrieveLeafNodes()[0];else if(!col)return;var app=this.app,panel=this.subPanel.parent,closestDateRange=col&&col.closestDateRange?col.closestDateRange:panel.dateRange,currentDateRangeString=closestDateRange.definition,currentDateRange=this.dateService.getRangeFromRangeString(currentDateRangeString),isFixedDateRange=this.dateService.isFormulaFixedDate(currentDateRangeString);isFixedDateRange&&(currentDateRangeString=this.dateService.getBestGuessFormulaForRange(currentDateRange),currentDateRange=this.dateService.getRangeFromRangeString(currentDateRangeString));var formulaLastYear,rangeParts=currentDateRangeString.split("/"),rangeType=this.dateService.getBestGuessRangeTypeForRange(currentDateRange),rangeShortHand="minute"===rangeType?"i":rangeType.slice(0,1),numRanges=this.dateService.getTimeDiff(currentDateRange.start,currentDateRange.end,"variables/daterange".concat(rangeType)),priorFormula=rangeParts[0]+"-"+numRanges+rangeShortHand+"/"+rangeParts[1]+"-"+numRanges+rangeShortHand;formulaLastYear="week"===rangeType?rangeParts[0]+"-52w/"+rangeParts[1]+"-52w":rangeParts[0]+"-12m/"+rangeParts[1]+"-12m",isFixedDateRange&&(priorFormula=this.dateService.getFixedRangeStringFromRangeString(priorFormula),formulaLastYear=this.dateService.getFixedRangeStringFromRangeString(formulaLastYear));var options=[],onClickOption=function(item){var doCompare=function(val){var subAction={prior:"Prior Time Period",priorRangeLastYear:"Prior Range Last Year",custom:"Custom Range"}[item.id];ui_core_build_bundle_module.lb.trackAction(null,"Compare Time Periods: "+subAction,{dateRange:val}),isPart2?_this4.addCompareDateColumn(val,col):function(comparisonRange){var metricNodes=col.metricNodes,metric=metricNodes[0].component,comparisonComponentGenerator=new build_bundle_module.D(app);_this4.reportlet.columnTree.loadingComponents=!0;var metricWithMetaData=build_bundle_module.H.fromColumnNode(metricNodes[0]);comparisonComponentGenerator.generate(metricWithMetaData,closestDateRange,comparisonRange).then(function(result){_this4.reportlet.columnTree.loadingComponents=!1;var comparisonColumn=new build_bundle_module.fb({component:result.percentChangeMetric});comparisonColumn.tableCellDisplay.type.backgroundType="conditionalFormatting",comparisonColumn.tableCellDisplay.type.background=!0,comparisonColumn.tableCellDisplay.conditionalFormattingOpts.usePercentLimits=!0,comparisonColumn.tableCellDisplay.conditionalFormattingOpts.autoGenerate=!1,comparisonColumn.upperLimit=1,comparisonColumn.midpoint=0,comparisonColumn.lowerLimit=-1;var dateComparisonColumn=new build_bundle_module.fb({component:result.comparisonDate}).addNode(new build_bundle_module.fb({component:metric})),dateComparisonColumnLeafNode=dateComparisonColumn.traverseTreeAndRetrieveLeafNodes()[0];dateComparisonColumnLeafNode.tableCellDisplay=col.tableCellDisplay.copy(),dateComparisonColumnLeafNode.dataSettings=col.dataSettings.copy();var existingColumn=metricNodes[0]||cellModel.column.allNodesInTree.find(function(node){return build_bundle_module.Hb.isMetricLike(node.component)});if(col.selfAndParents.filter(function(col){return col.component instanceof build_bundle_module.S}).length>0){var parentFilterComponents=col.selfAndParentComponents.filter(function(comp){return!(comp instanceof build_bundle_module.S||build_bundle_module.Hb.isMetricLike(comp))});_this4.reportlet.columnTree.addNodeAt(dateComparisonColumn,existingColumn.index),_this4.reportlet.columnTree.addNode(comparisonColumn);var leafNode=dateComparisonColumn.traverseTreeAndRetrieveLeafNodes()[0];leafNode.getAttributionInTree()&&_this4.reportlet.freeformTable.copyColumnAttribution(col,leafNode),parentFilterComponents.forEach(function(comp){dateComparisonColumn.addParentNode(new build_bundle_module.fb({component:comp})),comparisonColumn.addParentNode(new build_bundle_module.fb({component:comp}))})}else{var parentNodesToAdd=[];_this4.getFiltersBelowMetric(metricNodes[0]).forEach(function(filterNode){existingColumn.removeNode(filterNode),filterNode.nodes=[],parentNodesToAdd.push(filterNode)}),existingColumn.addParentNodes(parentNodesToAdd),existingColumn.addSiblingNode(comparisonColumn,"right"),existingColumn.addSiblingNode(dateComparisonColumn,"left");var _leafNode=dateComparisonColumn.traverseTreeAndRetrieveLeafNodes()[0];_leafNode.getAttributionInTree()&&_this4.reportlet.freeformTable.copyColumnAttribution(col,_leafNode)}}).catch(function(err){_this4.reportlet.columnTree.loadingComponents=!1,_this4.app.addAlert({variant:"error",contents:Object(l10nify_build_bundle_module.a)("Failed to create the necessary components to run a comparison.")})})}(val)};item.value?doCompare(item.value):ui_core_build_bundle_module.o.show(react_default.a.createElement(ui_build_bundle_module.g,{onChange:doCompare,calendarOnly:!0}),{title:Object(l10nify_build_bundle_module.a)("Select Comparison Range")})};switch(rangeType){case"year":options.push({id:"prior",label:numRanges>1?Object(l10nify_build_bundle_module.a)("Prior %s years to this date range",[numRanges.toFixed(0)]):Object(l10nify_build_bundle_module.a)("Prior year to this date range"),value:priorFormula,onClick:onClickOption});break;case"quarter":options.push({id:"prior",label:numRanges>1?Object(l10nify_build_bundle_module.a)("Prior %s quarters to this date range",[numRanges.toFixed(0)]):Object(l10nify_build_bundle_module.a)("Prior quarter to this date range"),value:priorFormula,onClick:onClickOption},{id:"priorRangeLastYear",label:numRanges>1?Object(l10nify_build_bundle_module.a)("These %s quarters last year to this date range",[numRanges.toFixed(0)]):Object(l10nify_build_bundle_module.a)("This quarter last year to this date range"),value:formulaLastYear,onClick:onClickOption});break;case"month":options.push({id:"prior",label:numRanges>1?Object(l10nify_build_bundle_module.a)("Prior %s months to this date range",[numRanges.toFixed(0)]):Object(l10nify_build_bundle_module.a)("Prior month to this date range"),value:priorFormula,onClick:onClickOption},{id:"priorRangeLastYear",label:numRanges>1?Object(l10nify_build_bundle_module.a)("These %s months last year to this date range",[numRanges.toFixed(0)]):Object(l10nify_build_bundle_module.a)("This month last year to this date range"),value:formulaLastYear,onClick:onClickOption});break;case"week":options.push({id:"prior",label:numRanges>1?Object(l10nify_build_bundle_module.a)("Prior %s weeks to this date range",[numRanges.toFixed(0)]):Object(l10nify_build_bundle_module.a)("Prior week to this date range"),value:priorFormula,onClick:onClickOption},{id:"priorRangeLastYear",label:numRanges>1?Object(l10nify_build_bundle_module.a)("These %s weeks last year to this date range",[numRanges.toFixed(0)]):Object(l10nify_build_bundle_module.a)("This week last year to this date range"),value:formulaLastYear,onClick:onClickOption});break;default:options.push({id:"prior",label:Object(l10nify_build_bundle_module.a)("Prior %s days to this date range",[numRanges]),value:priorFormula,onClick:onClickOption})}return options.push({id:"custom",label:Object(l10nify_build_bundle_module.a)("Custom date range to this date range"),onClick:onClickOption}),{label:isPart2?Object(l10nify_build_bundle_module.a)("Add time period column"):Object(l10nify_build_bundle_module.a)("Compare time periods"),items:options}}},{key:"addComparativeAttributionModelOption",value:function(cellModel){return{label:Object(l10nify_build_bundle_module.a)("Compare Attribution Models"),onClick:this.addComparativeAttributionModel.bind(this,cellModel)}}},{key:"getSelectedMetricHeaderColumnsForCreateCM",value:function(cellModel){var leafNodes=cellModel.parent.parentReportlet.cachedLeafNodes;return leafNodes.filter(function(leafNode){return(node=leafNode,node.metricNodes.filter(function(node){return node.selected})).length;var node}).slice(0,2)}},{key:"getCreateCalculatedMetricOptions",value:function(cellModel){var _this5=this,columns=this.getSelectedMetricHeaderColumnsForCreateCM(cellModel);return 1===columns.length?{label:Object(l10nify_build_bundle_module.a)("Create metric from selection"),items:[{id:"mean",label:Object(l10nify_build_bundle_module.a)("Mean"),onClick:function(){return _this5.runRightClickCreateCalculatedMetric(columns,"mean")}},{id:"median",label:Object(l10nify_build_bundle_module.a)("Median"),onClick:function(){return _this5.runRightClickCreateCalculatedMetric(columns,"median",!1)}},{id:"columnMax",label:Object(l10nify_build_bundle_module.a)("Column Max"),onClick:function(){return _this5.runRightClickCreateCalculatedMetric(columns,"col-max",!1)}},{id:"columnMin",label:Object(l10nify_build_bundle_module.a)("Column Min"),onClick:function(){return _this5.runRightClickCreateCalculatedMetric(columns,"col-min",!1)}},{id:"columnSum",label:Object(l10nify_build_bundle_module.a)("Column Sum"),onClick:function(){return _this5.runRightClickCreateCalculatedMetric(columns,"col-sum",!1)}},{id:"openInCMB",label:Object(l10nify_build_bundle_module.a)("Open in Calculated Metric Builder"),onClick:function(){return _this5.runRightClickCreateCalculatedMetric(columns,null,!0)}}]}:{label:Object(l10nify_build_bundle_module.a)("Create metric from selection"),items:[{id:"divide",label:Object(l10nify_build_bundle_module.a)("Divide"),onClick:function(){return _this5.runRightClickCreateCalculatedMetric(columns,"divide")}},{id:"subtract",label:Object(l10nify_build_bundle_module.a)("Subtract"),onClick:function(){return _this5.runRightClickCreateCalculatedMetric(columns,"subtract")}},{id:"add",label:Object(l10nify_build_bundle_module.a)("Add"),onClick:function(){return _this5.runRightClickCreateCalculatedMetric(columns,"add")}},{id:"multiply",label:Object(l10nify_build_bundle_module.a)("Multiply"),onClick:function(){return _this5.runRightClickCreateCalculatedMetric(columns,"multiply")}},{id:"percentChange",label:Object(l10nify_build_bundle_module.a)("Percent Change"),onClick:function(){return _this5.runRightClickCreateCalculatedMetric(columns,"percentChange")}},{id:"openInCMB",label:Object(l10nify_build_bundle_module.a)("Open in Calculated Metric Builder"),onClick:function(){return _this5.runRightClickCreateCalculatedMetric(columns,"divide",!0)}}]}}},{key:"runRightClickCreateCalculatedMetric",value:function(columns,operation){createCalculatedMetric(columns,operation,arguments.length>2&&void 0!==arguments[2]&&arguments[2],this.reportlet,this.app)}},{key:"getAttributionOptions",value:function(cellModel){if(!this.app.hasAccessToFeature("attributionInFreeform"))return[];if(cellModel.isSummaryCell){var metric=cellModel.closestMetric;if(!metric||!metric.allocation||!cellModel.column.getAttributionInTree())return[]}else{if(!cellModel.isHeaderCell&&!cellModel.isLabelCell)return[];var component=cellModel.component;if(!component||!(component instanceof build_bundle_module.Hb)||!component.allocation)return[]}var menuItems=[{label:Object(l10nify_build_bundle_module.a)("Modify Attribution Model"),onClick:this.modifyAttributionModel.bind(this)}];return cellModel.isHeaderCell&&this.app.hasAccessToFeature("advancedCalculatedMetrics")&&menuItems.push({label:Object(l10nify_build_bundle_module.a)("Compare Attribution Models"),onClick:this.addComparativeAttributionModel.bind(this,cellModel)}),menuItems}},{key:"onShowMenu",value:function(elm){var _this6=this,cellAndRow=freeformGetCellAndRowFromElement(elm,this.reportlet),rowModel=cellAndRow.row,cellModel=cellAndRow.cell;this.currentRowModel=rowModel,this.currentCellModel=cellModel;var menuItems,contextMenuItems=this.getAllContextMenuItems();if(!cellModel)return this.rowContextMenuItems=[],!1;cellModel.selected||this.freeformModelUtil.selectCell(this.reportlet,cellModel,{deselectOthers:!0}),menuItems=cellModel.isHeaderCell?[this.showDeltaColumnOption()].concat(Object(toConsumableArray.a)(this.getAttributionOptions(cellModel)),[contextMenuItems.alertOption,contextMenuItems.chartOption,contextMenuItems.exportToCSVOption,this.showCreateSegmentOption(),this.showCompareAudienceOption(),contextMenuItems.resetColumnWidthsOption,contextMenuItems.deleteSelectedNodesOption,cellModel.column.component.isEditable(this.app)?contextMenuItems.editComponentOption:null]):rowModel.isSummaryRow?[this.showDeltaColumnOption()].concat(Object(toConsumableArray.a)(this.getAttributionOptions(cellModel)),[this.app.isLocalDev?contextMenuItems.showLastRequestOption:null,contextMenuItems.deleteBreakdownOption,contextMenuItems.alertOption,contextMenuItems.chartOption,contextMenuItems.exportToCSVOption,cellModel.isSummaryLabelCell?null:contextMenuItems.autoTrendOption,this.showCreateSegmentOption(),contextMenuItems.displayOnlySelectedRowsOption,this.reportlet.freeformTable.breakdowns.length?contextMenuItems.removeBreakdownsOption:null,this.reportlet.freeformTable.breakdowns.length?contextMenuItems.collapseBreakdownsOption:null,this.reportlet.freeformTable.breakdowns.length?contextMenuItems.expandBreakdownsOption:null]):[this.showDeltaColumnOption()].concat(Object(toConsumableArray.a)(this.getAttributionOptions(cellModel)),[rowModel.isStaticRow&&!rowModel.selected?contextMenuItems.deleteStaticRowOption:null,rowModel.isStaticRow&&rowModel.selected?contextMenuItems.deleteSelectedStaticRowsOption:null,contextMenuItems.alertOption,contextMenuItems.breakdownOption,contextMenuItems.chartOption,contextMenuItems.exportToCSVOption,contextMenuItems.autoTrendOption,this.showCreateSegmentOption(),this.showCompareAudienceOption(),contextMenuItems.displayOnlySelectedRowsOption,rowModel.isStaticRow&&rowModel.component instanceof build_bundle_module.Y?contextMenuItems.displayAllRowsOption:null,this.reportlet.freeformTable.breakdowns.length?contextMenuItems.removeBreakdownsOption:null,this.reportlet.freeformTable.breakdowns.length?contextMenuItems.collapseBreakdownsOption:null,this.reportlet.freeformTable.breakdowns.length?contextMenuItems.expandBreakdownsOption:null,this.showEditComponentOption(),this.showContributionAnalysisOption()]),this.isTimeComparisonEnabled(cellModel)&&this.app.hasAccessToFeature("advancedCalculatedMetrics")&&menuItems.unshift(this.getCompareOptions(cellModel)),(cellModel.isDataCell||cellModel.isHeaderCell)&&this.app.hasAccessToFeature("advancedCalculatedMetrics")&&menuItems.unshift(this.getCompareOptions(cellModel,!0)),menuItems.unshift(contextMenuItems.copyToClipboard),cellModel.isHeaderCell&&cellModel.column.topItemPosition&&menuItems.unshift(contextMenuItems.makeItemStatic),this.app.hasAccessToFeature("advancedCalculatedMetrics")&&this.isCreateCalculatedMetricEnabled(cellModel)&&menuItems.unshift(this.getCreateCalculatedMetricOptions(cellModel)),build_bundle_module.db.isActive("spoofData")&&menuItems.unshift({label:Object(l10nify_build_bundle_module.a)("Spoof Data Client Side"),onClick:function(){return _this6.spoofData(elm)}}),build_bundle_module.db.isActive("prototypeMode")&&(delete menuItems.exportToCSVOption,delete menuItems.alertOption),this.rowContextMenuItems=bundle_module.q.compact(menuItems)}},{key:"showDeltaColumnOption",value:function(){var cellModel=this.currentCellModel,metric=cellModel.closestMetric,deltaMetricView=bundle_module.q.get(metric,"metricViews",[]).find(function(mv){return mv.isDelta});return!cellModel.isLabelCell&&deltaMetricView?{label:Object(l10nify_build_bundle_module.a)("Add delta column"),onClick:this.addDeltaColumn.bind(this)}:null}},{key:"showEditComponentOption",value:function(){var cellModel=this.currentCellModel;return this.currentRowModel.isStaticRow&&cellModel&&cellModel.isLabelCell&&cellModel.component.isEditable(this.app)?this.getAllContextMenuItems().editComponentOption:null}},{key:"showCreateSegmentOption",value:function(){return this.reportSuite.permissions.segmentCreation&&bundle_module.q.find(this.reportlet.selectedCells,function(cell){return cell.isSegmentable()})?{label:Object(l10nify_build_bundle_module.a)("Create segment from selection"),onClick:this.createSegmentFromSelection.bind(this)}:null}},{key:"showCompareAudienceOption",value:function(){var isAudienceComparisonFeatureEnabled=ui_build_bundle_module.x.SegmentComparison.hasAccess(this.app);return bundle_module.q.some(this.reportlet.selectedCells,function(cell){if(!cell.isHeaderCell&&!cell.isLabelCell)return!1;var component=cell.component;return component&&[build_bundle_module.Y,build_bundle_module.ec,build_bundle_module.S].find(function(type){return component instanceof type})})&&isAudienceComparisonFeatureEnabled?{label:Object(l10nify_build_bundle_module.a)("Run in Segment Comparison"),onClick:this.runInSegmentComparison.bind(this)}:null}},{key:"showContributionAnalysisOption",value:function(){var cellModel=this.currentCellModel;return void 0!==cellModel.expectedValue&&null!==cellModel.expectedValue&&cellModel.parentTable.supportsContributionAnalysis&&ui_build_bundle_module.x.ContributionAnalysis.hasAccess(this.app)?{label:Object(l10nify_build_bundle_module.a)("Run Contribution Analysis"),onClick:this.runContributionAnalysis.bind(this)}:null}},{key:"onItemClick",value:function(item){if([build_bundle_module.X,build_bundle_module.ec,build_bundle_module.S,build_bundle_module.Hb,build_bundle_module.r,build_bundle_module.Y,build_bundle_module.Jb].find(function(type){return item instanceof type}))this.freeformModelUtil.breakdownRowFromComponents(this.currentRowModel.parent,this.currentRowModel,[item]);else if("visualization"===item.itemType){var subPanelType=item.baseVizType,vizType=item.vizType,newVisualization=build_bundle_module.nc.registeredVizTypes[subPanelType]({vizType:vizType});this.subPanel.linkSourceFromSelection(newVisualization,{snapShot:item.snapShot}),ui_core_build_bundle_module.lb.trackAction(null,"Right Click: Visualize: "+item.vizType)}}},{key:"render",value:function(){return react_default.a.createElement(ComposedComponent,this.props,this.props.children)}},{key:"reportlet",get:function(){return this.props.reportlet}},{key:"subPanel",get:function(){return this.props.subPanel}},{key:"reportSuite",get:function(){return this.props.reportSuite}}]),_class}(ui_build_bundle_module.d)},function(ComposedComponent){return function(_Component){function _class(props,context){var _this;Object(classCallCheck.a)(this,_class),_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(_class).call(this,props,context)),build_bundle_module.pb.undoIgnoredProperties=["columnWidths"],_this.setColumnWidths=_this.setColumnWidths.bind(Object(assertThisInitialized.a)(_this)),_this.customHandleCreate=_this.customHandleCreate.bind(Object(assertThisInitialized.a)(_this)),_this.customHandleRenderer=_this.customHandleRenderer.bind(Object(assertThisInitialized.a)(_this)),_this.resize=_this.resize.bind(Object(assertThisInitialized.a)(_this)),_this.userResize=_this.userResize.bind(Object(assertThisInitialized.a)(_this)),_this.stop=_this.stop.bind(Object(assertThisInitialized.a)(_this)),_this.updateResizableColumns=_this.updateResizableColumns.bind(Object(assertThisInitialized.a)(_this)),_this.colGroupColumnWidths=[];var self=Object(assertThisInitialized.a)(_this);return _this.getColumnWidthsForColGroup=function(){var reportlet=props.reportlet;return reportlet&&0===reportlet.cachedLeafNodes.length||(reportlet&&reportlet.resizeableColumnCount.length<2?self.colGroupColumnWidths=[]:reportlet&&reportlet.resizeableColumnCount.length!==self.colGroupColumnWidths.length&&(self.colGroupColumnWidths=freeformUtilities.getColumnWidths(self.freeformTable).columnWidths.map(function(width){return"".concat(width,"%")}))),self.colGroupColumnWidths},_this}return Object(inherits.a)(_class,_Component),Object(createClass.a)(_class,[{key:"componentDidMount",value:function(){var _this2=this;Object(esm_get.a)(Object(getPrototypeOf.a)(_class.prototype),"componentDidMount",this).call(this),this.$el=Object(ui_build_bundle_module.mb)(react_dom_default.a.findDOMNode(this)),this.updateResizableColumns(),this.registerOff(this.props.app.user.uiSettings.on("change:shellLeftRail",function(){_this2.updateResizableColumns(),setTimeout(_this2.updateResizableColumns,1e3)})),this.registerOff(this.props.subPanel.parentPanel.position.on("change",function(e){e&&"autoHeight"!==e.property&&_this2.updateResizableColumns()}))}},{key:"componentDidUpdate",value:function(prevProps){this.freeformTable&&0!==this.freeformTable.rows.length&&0!==this.props.reportlet.columnTree.nodes.length&&this.updateResizableColumns()}},{key:"applyColumnWidths",value:function(_ref){var params=_ref.params,columnWidths=_ref.columnWidths,breakdownCount=_ref.breakdownCount,BREAKDOWN_WIDTH_PERCENTAGE=_ref.BREAKDOWN_WIDTH_PERCENTAGE,$cells=params.$table.find(".an-FreeformTable-rowSummary").eq(0).find(".an-FreeformTable-cell");params.$cols.each(function(i,el){el.classList.contains("breakdown-cell-column")?params.setWidth(el,BREAKDOWN_WIDTH_PERCENTAGE):(Object(ui_build_bundle_module.mb)(el).data("resizable-column-src-el",$cells.eq(i-breakdownCount)),params.setWidth(el,columnWidths.shift()||0))})}},{key:"setColumnWidths",value:function(params,forceUniformWidths){var result=freeformUtilities.getColumnWidths(this.freeformTable,forceUniformWidths),opts=Object(objectSpread.a)({params:params},result);this.applyColumnWidths(opts)}},{key:"customHandleCreate",value:function(params){params.$table.find('[data-breakdown-level="'+(params.columnIndex+1)+'"]').length||params.$handle.appendTo(params.$handleContainer)}},{key:"customHandleRenderer",value:function(handleParams){var $columnTree=this.$el.closest(".js-panel-sub-panel").find(".an-FreeformReportlet-columnContainer"),$cell=handleParams.$srcCol.data("resizable-column-src-el");if($cell&&bundle_module.q.get($cell,"length")&&handleParams.$handleContainer&&bundle_module.q.get(handleParams,"$handleContainer.length")){var tableHeaderHeight=$columnTree.height(),left=$cell.outerWidth()+($cell.offset().left-handleParams.$handleContainer.offset().left),breakdownCell=handleParams.$handle.data("resizable-column-src-el");breakdownCell?handleParams.$handle.css({left:left,height:breakdownCell.outerHeight(),top:breakdownCell.offset().top-handleParams.$handleContainer.offset().top}):handleParams.$handle.css({left:left,height:handleParams.height+tableHeaderHeight,top:-1*tableHeaderHeight})}}},{key:"resize",value:function(event,ctrl,leftCol,rightCol,leftWidth,rightWidth){var headerCells=this.$el.closest(".js-panel-sub-panel").find(".an-FreeformReportlet-columnContainer").find("col"),self=this;this.$el.find(".an-FreeformTable col").each(function(index,el){headerCells.get(index)&&(headerCells.get(index).style.width=this.style.width,self.getColumnWidthsForColGroup()[index]=this.style.width)})}},{key:"userResize",value:function(){this.props.reportlet.emit("columnResized"),ui_core_build_bundle_module.lb.trackAction(null,"Resized Pivot Table Column"),build_bundle_module.sc.temporarilySuspendIgnore(this.freeformTable,"columnWidths")}},{key:"scale",value:function(widths){var max=Math.max.apply(Math,Object(toConsumableArray.a)(widths));return widths.map(function(width){return width/max})}},{key:"stop",value:function(event,ctrl,params){this.freeformTable.deepestBreakdownDepth;var prevWidths=this.scale(this.freeformTable.columnWidths),nextWidths=this.scale(params.columnWidths);(function(arr1,arr2){var ERROR=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.05;return arr1.length===arr2.length&&arr1.every(function(item,i){return item+ERROR>arr2[i]&&item-ERROR<arr2[i]})})(prevWidths,nextWidths)||this.freeformTable.columnWidths.replaceAll(nextWidths.map(function(width){return 100*width}))}},{key:"updateResizableColumns",value:function(){this.freeformTable&&this.freeformTable.rows.length&&(this.props.reportlet.emit("columnResized"),this.$el.find(".an-FreeformTable").resizableColumns({selector:"col",setColumnWidths:this.setColumnWidths,customHandleCreate:this.customHandleCreate,customHandleRenderer:this.customHandleRenderer,resize:this.resize,userResize:this.userResize,stop:this.stop,keepAspectRatiosTheSameOnResizeFirstColumn:!0,deepestBreakdownDepth:this.freeformTable.deepestBreakdownDepth}))}},{key:"render",value:function(){var props=Object.assign({},this.props,{getColumnWidths:this.getColumnWidthsForColGroup});return react_default.a.createElement(ComposedComponent,props,this.props.children)}},{key:"freeformTable",get:function(){return this.props.reportlet?this.props.reportlet.freeformTable:null}}]),_class}(react_essence_build_bundle_module.a)},function(ComposedComponent){return function(_Component){function _class(props,context){var _this;return Object(classCallCheck.a)(this,_class),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(_class).call(this,props,context))).onGridStackChangeStart=_this.onGridStackChangeStart.bind(Object(assertThisInitialized.a)(_this)),_this.onGridStackChangeEnd=_this.onGridStackChangeEnd.bind(Object(assertThisInitialized.a)(_this)),_this.onRailsToggled=_this.onRailsToggled.bind(Object(assertThisInitialized.a)(_this)),_this.initialize=_this.initialize.bind(Object(assertThisInitialized.a)(_this)),_this.destroy=_this.destroy.bind(Object(assertThisInitialized.a)(_this)),_this}return Object(inherits.a)(_class,_Component),Object(createClass.a)(_class,[{key:"componentDidMount",value:function(){var _this2=this;Object(esm_get.a)(Object(getPrototypeOf.a)(_class.prototype),"componentDidMount",this).call(this),this.$el=Object(ui_build_bundle_module.mb)(react_dom_default.a.findDOMNode(this)),this.$parentEl=this.$el.parent(),this.registerOff(this.$el.adStickyHeader({onGridStackChangeStart:this.onGridStackChangeStart,onGridStackChangeEnd:this.onGridStackChangeEnd,onRailsToggled:this.onRailsToggled,initialize:this.initialize,destroy:this.destroy,disableSticky:!this.props.subPanel.position.autoSize})),this.registerOff(this.props.subPanel.position.on("change:autoSize",function(){_this2.$el.trigger(ui_build_bundle_module.mb.Event("updateStickyHeader",{disableSticky:!_this2.props.subPanel.position.autoSize}))}))}},{key:"componentDidUpdate",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(_class.prototype),"componentDidUpdate",this).call(this),this.$el.trigger("updateStickyHeader")}},{key:"onGridStackChangeStart",value:function(){this.$el.trigger("updateStickyHeaderStart")}},{key:"onGridStackChangeEnd",value:function(){var _this3=this;setTimeout(function(){_this3.$el.trigger("updateStickyHeaderEnd")},400)}},{key:"onRailsToggled",value:function(){var _this4=this;setTimeout(function(){_this4.$el.trigger("updateStickyHeader")},600)}},{key:"initialize",value:function(){var onGridStackChangeStart=this.onGridStackChangeStart.bind(this.$parentEl),onGridStackChangeEnd=this.onGridStackChangeEnd.bind(this.$parentEl),gridContainer=this.$parentEl.parents(".an-Grid-container"),onRailsToggled=this.onRailsToggled.bind(this.$parentEl);gridContainer.on("an-Grid-start-change",onGridStackChangeStart),gridContainer.on("an-Grid-end-change an-Grid-refresh-complete",onGridStackChangeEnd),Object(ui_build_bundle_module.mb)(window).on("LeftRailPinnedStateChange RightRailPinnedStateChange",onRailsToggled),this.registerOff(function(){return gridContainer.off("an-Grid-start-change",onGridStackChangeStart)}),this.registerOff(function(){return gridContainer.off("an-Grid-end-change an-Grid-refresh-complete",onGridStackChangeEnd)}),this.registerOff(function(){return Object(ui_build_bundle_module.mb)(window).off("LeftRailPinnedStateChange RightRailPinnedStateChange",onRailsToggled)})}},{key:"destroy",value:function(){}},{key:"render",value:function(){return react_default.a.createElement(ComposedComponent,this.props,this.props.children)}}]),_class}(react_essence_build_bundle_module.a)},function(ComposedComponent){return function(_Component){function _class(){return Object(classCallCheck.a)(this,_class),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(_class).apply(this,arguments))}return Object(inherits.a)(_class,_Component),Object(createClass.a)(_class,[{key:"componentDidMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(_class.prototype),"componentDidMount",this).call(this),this.$el=Object(ui_build_bundle_module.mb)(react_dom_default.a.findDOMNode(this)),this.$headerEl=this.$el.find(".an-FreeformReportletHeader"),this.$contentsEl=this.$el.find(".js-freeform-table-contents"),this.setupCellTruncationSlideOver(),this.setupChartHoverEvents()}},{key:"setupCellTruncationSlideOver",value:function(){this.$contentsEl.anFreeformReportletShowTruncatedContent({selector:".js-show-truncated-content",container:".js-freeform-table-content-table",hasPopovers:!0})}},{key:"setupChartHoverEvents",value:function(){var _this=this;this.$el.on("mouseenter.syncHoverWithChart",".an-FreeformTable-cell",function(e){return _this.onHoverCellEnter(e)}),this.$el.on("mouseleave.syncHoverWithChart",".an-FreeformTable-cell",function(e){return _this.onHoverCellLeave(e)})}},{key:"onHoverCellEnter",value:function(e){var _this$props=this.props,reportlet=_this$props.reportlet,subPanel=_this$props.subPanel,$cell=Object(ui_build_bundle_module.mb)(e.currentTarget);reportlet.isSelecting||subPanel.linkedBy.forEach(function(linkee){var cellIds;cellIds=0===$cell.index()?bundle_module.q.map($cell.parent().find(".an-FreeformTable-cell"),function(cell){return Object(ui_build_bundle_module.mb)(cell).attr("data-cell-id")}):[$cell.attr("data-cell-id")],linkee.reportlet.highlightDataByIds&&linkee.reportlet.highlightDataByIds(cellIds)})}},{key:"onHoverCellLeave",value:function(e){this.props.subPanel.linkedBy.forEach(function(linkee){linkee.reportlet.unhighlightData&&linkee.reportlet.unhighlightData()})}},{key:"render",value:function(){return react_default.a.createElement(ComposedComponent,this.props,this.props.children)}},{key:"freeformTable",get:function(){return this.props.reportlet?this.props.reportlet.freeformTable:null}}]),_class}(react_essence_build_bundle_module.a)},function(ComposedComponent){return function(_React$Component){function _class(){return Object(classCallCheck.a)(this,_class),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(_class).apply(this,arguments))}return Object(inherits.a)(_class,_React$Component),Object(createClass.a)(_class,[{key:"componentDidMount",value:function(){this.$el=Object(ui_build_bundle_module.mb)(react_dom_default.a.findDOMNode(this)),this.forceRedraw()}},{key:"componentDidUpdate",value:function(){this.forceRedraw()}},{key:"forceRedraw",value:function(){if(this.props.isIEOrEdge||isIEOrEdge){var $tables=this.$el.find(".js-freeform-table-column-tree, .js-freeform-table-content-table");$tables.css("white-space","normal"),setTimeout(function(){return $tables.css("white-space","")},0)}}},{key:"render",value:function(){return react_default.a.createElement(ComposedComponent,this.props,this.props.children)}}]),_class}(react_default.a.Component)})(FreeformReportlet_FreeformReportlet);function VizList(props){var selectedChart=bundle_module.q.find(build_bundle_module.Nc.charts,function(chart){return chart.vizType===props.vizType}),chartList=build_bundle_module.Nc.contextMenuCharts;return react_default.a.createElement("div",{className:"an-VizList-selector"},react_default.a.createElement("div",{className:"an-VizList-selectorLabel"},react_default.a.createElement("label",null,Object(l10nify_build_bundle_module.a)("Visualization Type"))),react_default.a.createElement(ui_core_build_bundle_module.W,{placeholder:Object(l10nify_build_bundle_module.a)("Visualization Types"),clearable:!1,options:chartList,optionComponent:VizList_ChartSelectOption,value:selectedChart,valueComponent:VizList_ChartSelectValue,labelKey:"name",valueKey:"vizType",onChange:props.onVizTypeChange}))}var VizList_ChartSelectOption=function(_Component){function ChartSelectOption(){return Object(classCallCheck.a)(this,ChartSelectOption),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(ChartSelectOption).apply(this,arguments))}return Object(inherits.a)(ChartSelectOption,_Component),Object(createClass.a)(ChartSelectOption,[{key:"handleMouseDown",value:function(event){event.preventDefault(),event.stopPropagation(),this.props.onSelect(this.props.option,event)}},{key:"handleMouseEnter",value:function(event){this.props.onFocus(this.props.option,event)}},{key:"handleMouseMove",value:function(event){this.props.isFocused||this.props.onFocus(this.props.option,event)}},{key:"render",value:function(){var _this=this;return react_default.a.createElement("div",{className:this.props.className,onMouseDown:function(e){return _this.handleMouseDown(e)},onMouseEnter:function(e){return _this.handleMouseEnter(e)},onMouseMove:function(e){return _this.handleMouseMove(e)}},react_default.a.createElement(ui_core_build_bundle_module.C,{className:"chart-type-icon",size:"XS",icon:this.props.option.icon}),react_default.a.createElement("span",{className:"chart-type-label"},this.props.option.name))}}]),ChartSelectOption}(react_essence_build_bundle_module.a),VizList_ChartSelectValue=function(_Component2){function ChartSelectValue(){return Object(classCallCheck.a)(this,ChartSelectValue),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(ChartSelectValue).apply(this,arguments))}return Object(inherits.a)(ChartSelectValue,_Component2),Object(createClass.a)(ChartSelectValue,[{key:"render",value:function(){return react_default.a.createElement("div",{className:"Select-value"},react_default.a.createElement("span",{className:"Select-value-label"},react_default.a.createElement(ui_core_build_bundle_module.C,{className:"chart-type-icon",size:"XS",icon:this.props.value.icon}),react_default.a.createElement("span",{className:"chart-type-label"},this.props.value.name)))}}]),ChartSelectValue}(react_essence_build_bundle_module.a);function GranularitySelector(props){var granularityList=bundle_module.w.getGranularityList();return react_default.a.createElement("div",{className:"an-VizList-granularitySelector"},react_default.a.createElement("div",{className:"an-VizList-selectorLabel"},react_default.a.createElement("label",null,Object(l10nify_build_bundle_module.a)("Granularity"))),react_default.a.createElement(ui_core_build_bundle_module.W,{placeholder:Object(l10nify_build_bundle_module.a)("Granularity"),clearable:!1,options:granularityList,value:props.granularity,onChange:props.onGranularityChange}))}__webpack_require__(961);var VizSettings2_VizSettings2=function(_AppComponent){function VizSettings2(props,context){var _this;return Object(classCallCheck.a)(this,VizSettings2),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(VizSettings2).call(this,props,context))).state={},_this}return Object(inherits.a)(VizSettings2,_AppComponent),Object(createClass.a)(VizSettings2,[{key:"cache",value:function(){return["dimensions"]}},{key:"componentDidMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(VizSettings2.prototype),"componentDidMount",this).call(this),this.setupTracking(),this.observe(this.props.subPanel)}},{key:"setupTracking",value:function(){var propertiesToTrack={"reportlet.usePercentage":"Percent","reportlet.stacked100":"100% Stacked","reportlet.legendVisible":"Legend Visible","reportlet.hasLimit":"Limit Max Items","reportlet.dualYAxis":"Display Dual Axis","reportlet.normalized":"Normalization","reportlet.forceZero":"Anchor Y Axis at Zero","reportlet.showAnomalies":"Show Anomalies","reportlet.allowAnomaliesToRescale":"Allow Anomaly Detection to Scale Y Axis","reportlet.abbreviateValue":"Abbreviate Value"};this.registerOff(this.subPanel.on("change",function(e){if(bundle_module.q.has(propertiesToTrack,e.property)){var settingName=propertiesToTrack[e.property];ui_core_build_bundle_module.lb.trackAction(null,"Visualization Setting Changed",{vizSettingName:settingName,vizSettingEnabled:e.newValue})}}))}},{key:"chartTypeChange",value:function(viz){this.props.subPanel.changeReportlet(viz.vizType),ui_core_build_bundle_module.lb.trackAction(null,"Vizualization Setting Changed: ",{vizSettingName:"Visualization Type",value:viz.name}),this.props.subPanel.linkedSource&&this.props.subPanel.reportlet.updateDerivedDataSource(this.appContext)}},{key:"onGranularityChange",value:function(granularity){var newGranularity=this.state.dimensions.find(function(dimension){return dimension.id===granularity.dimensionId});this.props.subPanel.reportlet.customGranularity=newGranularity,ui_core_build_bundle_module.lb.trackAction(null,"Visualization Setting Changed",{vizSettingName:"Granularity Selector",value:newGranularity.name})}},{key:"render",value:function(){var Settings=this.props.getExtraSettings(),hideChartSelector=this.props.subPanel.reportlet.hideChartSelector,settingsClass=classnames_default()("ad-Popover-content1 columns-2",{"no-vert-padding":hideChartSelector}),granularityForViz=this.props.subPanel.reportlet.getGranularityForViz();return react_default.a.createElement("div",{className:"an-FreeformReportletSettings"},(!hideChartSelector||!!granularityForViz)&&react_default.a.createElement("div",{className:"ad-Popover-section1",style:{borderBottom:"solid 1px #c0c0c0",paddingBottom:"10px"}},react_default.a.createElement("div",{className:"ad-Popover-row1 an-VizList-selectorsContainer"},hideChartSelector?null:react_default.a.createElement(VizList,{vizType:this.props.subPanel.visualizationType,onVizTypeChange:this.chartTypeChange.bind(this)}),granularityForViz?react_default.a.createElement(GranularitySelector,{granularity:granularityForViz,onGranularityChange:this.onGranularityChange.bind(this)}):null)),Settings?react_default.a.createElement("div",{className:settingsClass,style:{borderTop:"none",marginTop:"0px"}},react_default.a.createElement(Settings,{subPanel:this.props.subPanel,app:this.app,appContext:this.appContext,subPanelComponent:this.props.subPanelComponent,settingsBaseComponent:this})):null)}},{key:"subPanel",get:function(){return this.props.subPanel}}]),VizSettings2}(ui_build_bundle_module.d);VizSettings2_VizSettings2.VizSettingsHeader=function(props){return react_default.a.createElement(ui_core_build_bundle_module.A,{className:"viz-setting-title"},props.label||Object(l10nify_build_bundle_module.a)("Visualization Settings"))},VizSettings2_VizSettings2.Stacked100=function(props){return react_default.a.createElement(ui_core_build_bundle_module.k,{size:"block",label:Object(l10nify_build_bundle_module.a)("100% Stacked"),checked:props.subPanel.reportlet.stacked100,onChange:function(e){props.subPanel.reportlet.stacked100=e.target.checked},"data-test-id":"viz-settings-stacked100"})},VizSettings2_VizSettings2.Percentages=function(props){return react_default.a.createElement(ui_core_build_bundle_module.k,{size:"block",label:Object(l10nify_build_bundle_module.a)("Percentages"),checked:props.subPanel.reportlet.usePercentage,onChange:function(e){props.subPanel.reportlet.usePercentage=e.target.checked},"data-test-id":"viz-settings-percentages"})},VizSettings2_VizSettings2.LegendVisible=function(props){return react_default.a.createElement(ui_core_build_bundle_module.k,{size:"block",label:Object(l10nify_build_bundle_module.a)("Legend Visible"),checked:props.subPanel.reportlet.legendVisible,onChange:function(e){props.subPanel.reportlet.legendVisible=e.target.checked},"data-test-id":"viz-settings-legend-visible"})},VizSettings2_VizSettings2.DisplayDualAxis=function(props){return react_default.a.createElement(ui_core_build_bundle_module.k,{size:"block",label:Object(l10nify_build_bundle_module.a)("Display Dual Axis"),checked:props.subPanel.reportlet.dualYAxis,onChange:function(e){props.subPanel.reportlet.dualYAxis=e.target.checked},disabled:2!==bundle_module.q.get(props.subPanel.reportlet,"data.length",0),"data-test-id":"viz-settings-display-dual-axis"})},VizSettings2_VizSettings2.Normalized=function(props){return react_default.a.createElement(ui_core_build_bundle_module.k,{size:"block",label:Object(l10nify_build_bundle_module.a)("Normalization"),checked:props.subPanel.reportlet.normalized,onChange:function(e){props.subPanel.reportlet.normalized=e.target.checked},disabled:bundle_module.q.get(props.subPanel.reportlet,"data.length",0)<=2,"data-test-id":"viz-settings-normalization"})},VizSettings2_VizSettings2.ForceZeroYAxis=function(props){return react_default.a.createElement(ui_core_build_bundle_module.k,{size:"block",label:Object(l10nify_build_bundle_module.a)("Anchor Y Axis at Zero"),checked:props.subPanel.reportlet.forceZero,onChange:function(e){props.subPanel.reportlet.forceZero=e.target.checked},"data-test-id":"viz-settings-force-zero-y-axis"})},VizSettings2_VizSettings2.RenderDeprecatedChart=function(props){return react_default.a.createElement(ui_core_build_bundle_module.k,{size:"block",label:Object(l10nify_build_bundle_module.a)("Render Deprecated Chart"),checked:props.subPanel.reportlet.renderDeprecatedChart,onChange:function(e){props.subPanel.reportlet.renderDeprecatedChart=e.target.checked},"data-test-id":"viz-settings-render-deprecated-chart"})},VizSettings2_VizSettings2.AnchorGraphToLeft=function(props){return bundle_module.q.get(props.subPanel,"linkedSource.reportlet")instanceof build_bundle_module.x&&!props.subPanel.linkedSource.reportlet.useDimensionColumn?react_default.a.createElement("div",{className:"ad-Popover-section1"},react_default.a.createElement(ui_core_build_bundle_module.A,{className:"viz-setting-title",label:Object(l10nify_build_bundle_module.a)("Cohort Table Options")}),react_default.a.createElement(ui_core_build_bundle_module.k,{size:"block",label:Object(l10nify_build_bundle_module.a)("Anchor Graph To Left"),checked:props.subPanel.reportlet.anchorToLeft,onChange:function(e){props.subPanel.reportlet.anchorToLeft=e.target.checked},"data-test-id":"viz-settings-anchor-graph-to-left"})):null},VizSettings2_VizSettings2.ShowAnomalies=function(props){return bundle_module.q.get(props.subPanel,"linkedSource.reportlet")instanceof build_bundle_module.x?null:react_default.a.createElement(ui_core_build_bundle_module.k,{size:"block",label:Object(l10nify_build_bundle_module.a)("Show Anomalies"),checked:props.subPanel.reportlet.showAnomalies,disabled:props.subPanel.reportlet.stacked100,onChange:function(e){props.subPanel.reportlet.showAnomalies=e.target.checked},"data-test-id":"viz-settings-show-anomalies"})},VizSettings2_VizSettings2.AllowAnomaliesToRescale=function(props){return react_default.a.createElement(ui_core_build_bundle_module.k,{size:"block",label:Object(l10nify_build_bundle_module.a)("Allow Anomaly Detection to Scale Y Axis"),checked:props.subPanel.reportlet.allowAnomaliesToRescale,disabled:!props.subPanel.reportlet.showAnomalies||props.subPanel.reportlet.stacked100,onChange:function(e){props.subPanel.reportlet.allowAnomaliesToRescale=e.target.checked},"data-test-id":"viz-settings-allow-anomaly-rescale"})};var VizSettings2_maxItems=bundle_module.q.range(1,26).map(function(item){return{label:item+"",value:item+""}});VizSettings2_VizSettings2.LimitMaxItems=function(props){return react_default.a.createElement("div",{className:"settings-select num-chart-items"},react_default.a.createElement(ui_core_build_bundle_module.k,{label:Object(l10nify_build_bundle_module.a)("Limit Max Items"),checked:props.subPanel.reportlet.hasLimit,onChange:function(e){props.subPanel.reportlet.hasLimit=e.target.checked},"data-test-id":"viz-settings-limit-max-items"}),!!props.subPanel.reportlet.hasLimit&&react_default.a.createElement(ui_core_build_bundle_module.W.Inline,{className:"inline-select",required:!0,hideArrow:!1,options:VizSettings2_maxItems,value:props.subPanel.reportlet.numItems+"",onChange:function(item){props.subPanel.reportlet.numItems=+item.value}}))},VizSettings2_VizSettings2.AbbreviateValue=function(props){var maxItems=bundle_module.q.range(0,4).map(function(item){return{label:item+"",value:item+""}});return react_default.a.createElement("div",{className:classnames_default()("settings-select","num-chart-items",props.className)},react_default.a.createElement(ui_core_build_bundle_module.k,{label:Object(l10nify_build_bundle_module.a)("Abbreviate Value"),disabled:props.disabled,checked:props.subPanel.reportlet.abbreviateValue,onChange:function(e){props.subPanel.reportlet.abbreviateValue=e.target.checked},"data-test-id":"viz-settings-abbreviate-value"}),!!props.subPanel.reportlet.abbreviateValue&&react_default.a.createElement(ui_core_build_bundle_module.W.Inline,{className:"inline-select",required:!0,hideArrow:!1,options:maxItems,disabled:props.disabled,value:props.subPanel.reportlet.abbreviatePrecision+"",onChange:function(item){props.subPanel.reportlet.abbreviatePrecision=+item.value}}))},VizSettings2_VizSettings2.show=function(){var opts=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ui_core_build_bundle_module.P.show({isModal:!1,closeOnClickOutside:!0,dialog:{header:Object(l10nify_build_bundle_module.a)("Visualization Settings")},target:opts.target,getComponent:function(){return react_default.a.createElement(VizSettings2_VizSettings2,opts)},onClose:function(){opts.subPanel.hasActivePopover=!1}})};__webpack_require__(962),__webpack_require__(963);function VizReportlet_templateObject(){var data=Object(taggedTemplateLiteral.a)(["Something went wrong."]);return VizReportlet_templateObject=function(){return data},data}var VizReportlet_VizReportlet=function(_Reportlet){function VizReportlet(props,context){var _this;return Object(classCallCheck.a)(this,VizReportlet),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(VizReportlet).call(this,props,context))).observe(_this.reportlet,"change",function(e){return"disabledLegends"!==e.property&&("customGranularity"===e.property&&_this.granularityChange(e.newValue),_this.shouldUpdateOnReportletChange(e))}),_this.registerOff(_this.reportlet.on("viz:update",_this.updateViz.bind(Object(assertThisInitialized.a)(_this)))),_this.registerOff(_this.reportlet.on("loadingPercentage",_this.onLoadingProgress.bind(Object(assertThisInitialized.a)(_this)))),_this._resizeHandler=bundle_module.q.debounce(_this._resizeHandler,100),_this.freeformModelUtil=new build_bundle_module.kb({app:_this.app,reportSuite:_this.app.reportSuite}),_this.reportlet.derivedDataSource||_this.generateDerivedDataSource(),_this.state={visualizationHeight:0,visualizationWidth:0},_this}return Object(inherits.a)(VizReportlet,_Reportlet),Object(createClass.a)(VizReportlet,[{key:"shouldUpdateOnReportletChange",value:function(e){return!0}},{key:"onLoadingProgress",value:function(params){this.props.setLoadingPercentage&&this.props.setLoadingPercentage(params.value)}},{key:"generateDerivedDataSource",value:function(){var _this2=this;return this.reportlet.updateDerivedDataSource(this.appContext).then(function(){return _this2.renderAfterRetrievingDerivedDataSoure()})}},{key:"renderAfterRetrievingDerivedDataSoure",value:function(){this.setState({})}},{key:"componentDidMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(VizReportlet.prototype),"componentDidMount",this).call(this),this.el=react_dom_default.a.findDOMNode(this),this.$el=Object(ui_build_bundle_module.mb)(this.el)}},{key:"updateViz",value:function(){var _this$viz,opts=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!!this.viz&&(this.viz[opts.method]?void(_this$viz=this.viz)[opts.method].apply(_this$viz,Object(toConsumableArray.a)(opts.params||[])):(window.isUnitTest||console.error("Calling invalid method on viz."),!1))}},{key:"onErrorFromViz",value:function(params){this.reportlet.onError(params)}},{key:"onMouseOver",value:function(eventParams){eventParams.dataPoint&&this.highlightDataSource(eventParams)}},{key:"onMouseOut",value:function(){this._unhighlightDataSource()}},{key:"getContextMenuProps",value:function(){return{items:[]}}},{key:"onContextMenu",value:function(eventParams){if((arguments.length<=1?0:arguments.length-1)>1)eventParams={dataItem:eventParams,index:arguments.length<=1?void 0:arguments[1],seriesIndex:arguments.length<=2?void 0:arguments[2],event:arguments.length<=3?void 0:arguments[3]};else if(!eventParams.event)return!1;var domNode,contextMenuProps=this.getContextMenuProps(eventParams),items=contextMenuProps.items||[];if(!items.length)return!1;ui_core_build_bundle_module.P.closeAll(),this._isMounted&&(domNode=react_dom_default.a.findDOMNode(this)),setTimeout(function(){ui_core_build_bundle_module.ab.show(Object.assign({sort:!1,showSearchBar:!1,target:Object(ui_build_bundle_module.gb)(eventParams.event,domNode),closeOnClickOutside:!0,items:items,labelKey:"label",height:40*items.length},contextMenuProps))},100)}},{key:"_resizeHandler",value:function(_ref){var width=_ref.width,height=_ref.height;this.isVegaViz?this.setState({visualizationHeight:height,visualizationWidth:width}):this.updateViz({method:"onResize"})}},{key:"onCustomLabelChange",value:function(_ref2){var id=_ref2.id,label=_ref2.label;this.reportlet.legendMappings.addEntry({id:id,label:label}),label||this.forceUpdate()}},{key:"onRender",value:function(){this.reportlet.vizRenderCount++}},{key:"getDisabledLegends",value:function(){return this.reportlet.disabledLegends}},{key:"setDisabledLegends",value:function(val){this.reportlet.disabledLegends=val}},{key:"showAnomalyTooltip",value:function(target,dataPoint){var _this3=this,popoverObj={target:target,onShow:function(){},openOn:"hover",getComponent:function(){},classes:"an-tooltip an-tooltip--inspect an-tooltip-hoverable"},expectedValue=dataPoint.value("expectedValue"),yValue=dataPoint.value("y"),cell=dataPoint.value("_cell"),_self=this;popoverObj.onShow=function(drop){var bounds=drop.content.getBoundingClientRect();Object(ui_build_bundle_module.mb)(document.body,_self.el).on("mousemove",function(loc){(loc.pageY<bounds.top-10||loc.pageY>bounds.bottom+10||loc.pageX<bounds.left-10||loc.pageX>bounds.right+10)&&(ui_core_build_bundle_module.P.closeAll(),Object(ui_build_bundle_module.mb)(document.body,self.el).off("mousemove"))})},popoverObj.getComponent=function(){var percentage=(Math.abs(expectedValue-yValue)/expectedValue*100).toFixed();"Infinity"===percentage&&(percentage=Object(l10nify_build_bundle_module.a)("Infinity"));var anomalyAmount=_this3.app.format(percentage)+"%",aboveOrBelowExpected=expectedValue>yValue?Object(l10nify_build_bundle_module.a)("below expected"):Object(l10nify_build_bundle_module.a)("above expected"),hasFeatureAccess=ui_build_bundle_module.x.ContributionAnalysis.hasAccess(_self.app);return react_default.a.createElement("div",null,react_default.a.createElement("div",{className:"an-VizSubPanel-anomaly-detected-heading"},Object(l10nify_build_bundle_module.a)("Anomaly Detected")),react_default.a.createElement("div",{className:"an-VizSubPanel-anomaly-percent"},anomalyAmount," ",aboveOrBelowExpected),function(){var DAY=bundle_module.w.DAY;return bundle_module.q.get(cell,"component.dimensionId")===DAY}()&&hasFeatureAccess?react_default.a.createElement(ui_core_build_bundle_module.lb,{action:"Run Contribution Analysis from 'Analyze' link (chart)"},react_default.a.createElement("div",{className:"an-VizSubPanel-analyze-anomaly-link",onClick:function(){addContributionAnalysisPanelFromFreeformCell(cell,_this3.appContext),ui_core_build_bundle_module.P.closeAll()}.bind(_this3)},react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"search",size:"XS"})," ",Object(l10nify_build_bundle_module.a)("Analyze"))):null)},ui_core_build_bundle_module.P.show(popoverObj)}},{key:"highlightDataSource",value:function(eventParams){this._unhighlightDataSource(),this._highlightDataSource(eventParams)}},{key:"granularityChange",value:function(newGranularity){var _this4=this,vizReportlet=this.reportlet;if(vizReportlet.derivedDataSource)vizReportlet.linkedSource.reportlet.hasExactlyOneTimeDimensionItem||vizReportlet.lockedSelection&&vizReportlet.linkedSource.reportlet.isTrendable?this.changeGranularityOnLinkedSource(newGranularity):vizReportlet.updateDerivedDataSource(this.appContext);else{this.changeGranularityOnLinkedSource(newGranularity);var allLinkedByExcludingSelf=vizReportlet.linkedSource.linkedBy.filter(function(subPanel){return subPanel.id!==_this4.reportlet.parent.id});bundle_module.q.pluck(allLinkedByExcludingSelf,"reportlet").forEach(function(viz){return viz.clearCustomGranularity()})}}},{key:"changeGranularityOnLinkedSource",value:function(newGranularity){this.reportlet.linkedSource.reportlet.onGranularityChange(newGranularity,this.app),this.loadData()}},{key:"_highlightDataSource",value:function(){var dataPoint=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).dataPoint;if(dataPoint){var cell=dataPoint.value("_cell");this.$panel.find(".cell_"+cell.id).addClass("chart-hover")}}},{key:"_unhighlightDataSource",value:function(){this.$panel.find(".chart-hover").removeClass("chart-hover")}},{key:"refreshOptions",value:function(){this.updateViz({method:"setOpts",params:[this.vizComponentOpts]})}},{key:"clearErrorsOnRender",value:function(){this.reportlet.clearErrors()}},{key:"_isValid",value:function(){return this.reportlet.validate()}},{key:"_render",value:function(){var _this5=this;this.reportlet.renderCount++,this.clearErrorsOnRender(),this.reportlet.needsDataSource&&(this.reportlet.data=this.reportlet.getDataFromDataProvider(this.appContext));var isValid=this._isValid();if(!this.vizLibraryType)throw new Error("You must set the vizLibraryType in the Reportlet(React)");var _this$state=this.state,visualizationHeight=_this$state.visualizationHeight,visualizationWidth=_this$state.visualizationWidth;return isValid&&this.reportlet.isDataReady?react_default.a.createElement(ui_core_build_bundle_module.T,{onChange:this._resizeHandler.bind(this),debounce:!0},this.isVegaViz?react_default.a.createElement(VizReportlet_VegaVizComponentErrorBoundary,null,react_default.a.createElement(ui_core_build_bundle_module.ob,{visualizationWidth:visualizationWidth,visualizationHeight:visualizationHeight,ref:function(v){return _this5.vizComponent=v},type:this.vizLibraryType,opts:this.vizComponentOpts,dataFormatter:ui_core_build_bundle_module.nb})):react_default.a.createElement(ui_core_build_bundle_module.pb,{ref:function(v){return _this5.vizComponent=v},type:this.vizLibraryType,opts:this.vizComponentOpts})):null}},{key:"viz",get:function(){return bundle_module.q.get(this,"vizComponent.viz",null)}},{key:"$panel",get:function(){return this.$el.closest(".js-panel")}},{key:"isVegaViz",get:function(){return!1}},{key:"l10nConfig",get:function(){var symbol=this.app.reportSuite.currency,positivePattern="{number} {symbol}",negativePattern="-{number} {symbol}";return"USD"===symbol&&(symbol="$",positivePattern="{symbol}{number}",negativePattern="-{symbol}{number}"),{numberFormat:{currency:{symbol:symbol,positivePattern:positivePattern,negativePattern:negativePattern}}}}},{key:"showLoadingIcon",get:function(){return!this.reportlet.isDataReady}},{key:"vizComponentOpts",get:function(){return{onError:this.onErrorFromViz.bind(this),onRender:this.onRender.bind(this),onMouseOver:this.onMouseOver.bind(this),onMouseOut:this.onMouseOut.bind(this),onContextMenu:this.onContextMenu.bind(this),data:this.reportlet.data,locale:l10nify_build_bundle_module.a.config.currentLocale.replace(/_/,"-").replace(/jp-jp/i,"ja-jp"),l10n:this.l10nConfig,serverRender:this.app.serverRender,hasSelection:this.reportlet.hasSelection,onCustomLabelChange:this.onCustomLabelChange.bind(this),getDisabledLegends:this.getDisabledLegends.bind(this),setDisabledLegends:this.setDisabledLegends.bind(this),supportsAnomalies:this.reportlet.supportsAnomalies,numberFormatter:this.app.format.bind(this.app),colors:dom_util_build_bundle_module.a.isIE()?bundle_module.s.defaultColorSchemeOptions[0].value:bundle_module.s.getColors()}}}],[{key:"additionalSubPanelClasses",get:function(){return Object(esm_get.a)(Object(getPrototypeOf.a)(VizReportlet),"additionalSubPanelClasses",this).concat(["an-sub-panel--VizReportlet"])}}]),VizReportlet}(Reportlet_Reportlet);VizReportlet_VizReportlet.showSettings=function(e,genericSubPanelModel,vizReportletUI,subPanelUI){genericSubPanelModel.hasActivePopover=!0,VizSettings2_VizSettings2.show({target:e.target,subPanel:genericSubPanelModel,getExtraSettings:function(){return subPanelUI.subPanelReportletComponent.Settings},subPanelComponent:subPanelUI})},VizReportlet_VizReportlet.getLineAreaContextMenuProps=function(params,hasCAAccess){var dataPoint=params.dataItem.data.d,items=[];return"variables/daterangeday"===bundle_module.q.get(dataPoint,"_data[1].rowComponent.dimension.id")&&hasCAAccess&&items.push({label:Object(l10nify_build_bundle_module.a)("Run Contribution Analysis"),onClick:function(){ui_core_build_bundle_module.lb.trackAction(null,"Run Contribution Analysis from right-click (chart)"),addContributionAnalysisPanelFromFreeformCell(dataPoint.value("_cell"),params.appContext)}}),{items:items}};var VizReportlet_VegaVizComponentErrorBoundary=function(_React$Component){function VegaVizComponentErrorBoundary(props){var _this6;return Object(classCallCheck.a)(this,VegaVizComponentErrorBoundary),(_this6=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(VegaVizComponentErrorBoundary).call(this,props))).state={hasError:!1},_this6}return Object(inherits.a)(VegaVizComponentErrorBoundary,_React$Component),Object(createClass.a)(VegaVizComponentErrorBoundary,[{key:"componentDidCatch",value:function(error,info){console.error(error,info)}},{key:"render",value:function(){return this.state.hasError?react_default.a.createElement("h1",null,Object(l10nify_build_bundle_module.a)(VizReportlet_templateObject())):this.props.children}}],[{key:"getDerivedStateFromError",value:function(error){return{hasError:!0}}}]),VegaVizComponentErrorBoundary}(react_default.a.Component),LineReportlet_LineReportlet=function(_VizReportlet){function LineReportlet(){return Object(classCallCheck.a)(this,LineReportlet),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(LineReportlet).apply(this,arguments))}return Object(inherits.a)(LineReportlet,_VizReportlet),Object(createClass.a)(LineReportlet,[{key:"getContextMenuProps",value:function(params){params.appContext=this.appContext;var hasCAAccess=ui_build_bundle_module.x.ContributionAnalysis.hasAccess(this.app);return this.constructor.getLineAreaContextMenuProps(params,hasCAAccess)}},{key:"setForceZero",value:function(val){this.reportlet.forceZero=val}},{key:"pointTooltipContent",value:function(d,i,j,formatted){var anomalyData,_this=this,data=d.data,hasAnomalyFeatureAccess=ui_build_bundle_module.x.AnomalyDetectionWorkspace.hasAccess(this.context.app),AnomalyTooltipContent=function(_ref){var anomalyAmount=_ref.anomalyAmount,aboveOrBelowExpected=_ref.aboveOrBelowExpected,hasContributionAnalysisFeatureAccess=_ref.hasContributionAnalysisFeatureAccess,adVizLineAnalyzeAnomaly=_ref.adVizLineAnalyzeAnomaly,supportsContributionAnalysis=_ref.supportsContributionAnalysis;return react_default.a.createElement("div",{className:"anomaly-tooltip-content aa-font"},react_default.a.createElement(ui_core_build_bundle_module.B,{className:"an-VizSubPanel-anomaly-detected-heading"},Object(l10nify_build_bundle_module.a)("Anomaly Detected")),react_default.a.createElement("div",{className:"an-VizSubPanel-anomaly-percent"},anomalyAmount," ",aboveOrBelowExpected),supportsContributionAnalysis()&&hasContributionAnalysisFeatureAccess?react_default.a.createElement(ui_core_build_bundle_module.lb,{action:"Run Contribution Analysis from 'Analyze' link (chart)"},react_default.a.createElement("div",{className:"an-VizSubPanel-analyze-anomaly-link",onClick:adVizLineAnalyzeAnomaly.bind(_this)},react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"search",size:"XS"})," ",Object(l10nify_build_bundle_module.a)("Analyze"))):null)},isCloudViz=!1;if(d.bounds&&(isCloudViz=!0),hasAnomalyFeatureAccess&&data.isAnomaly&&this.reportlet.showAnomalies){var expectedValue=data.expectedValue,yValue=data.y,datapoint=data.d;"function"===typeof datapoint&&(datapoint=datapoint());var cell=datapoint.value("_cell"),percentage=(Math.abs(expectedValue-yValue)/expectedValue*100).toFixed();"Infinity"===percentage&&(percentage=Object(l10nify_build_bundle_module.a)("Infinity"));anomalyData={anomalyAmount:this.context.app.format(percentage)+"%",aboveOrBelowExpected:expectedValue>yValue?Object(l10nify_build_bundle_module.a)("below expected"):Object(l10nify_build_bundle_module.a)("above expected"),adVizLineAnalyzeAnomaly:function(){addContributionAnalysisPanelFromFreeformCell(cell,_this.appContext)},supportsContributionAnalysis:function(){var DAY=bundle_module.w.DAY;return bundle_module.q.get(cell,"component.dimensionId")===DAY},hasContributionAnalysisFeatureAccess:ui_build_bundle_module.x.ContributionAnalysis.hasAccess(this.context.app)}}var contentDiv=document.createElement("div");return react_dom_default.a.render(react_default.a.createElement(function(_ref2){var seriesName=_ref2.seriesName,metricValue=_ref2.metricValue,metricName=_ref2.metricName,anomalyData=_ref2.anomalyData,isCloudViz=_ref2.isCloudViz;return react_default.a.createElement("div",{className:"cloudviz-tooltip-content aa-condensed-font"},seriesName?isCloudViz?react_default.a.createElement("span",{dangerouslySetInnerHTML:{__html:seriesName}}):react_default.a.createElement("span",{className:"series-name"},seriesName):null,react_default.a.createElement("span",{className:"metric-value"},metricValue),isCloudViz?react_default.a.createElement("span",{dangerouslySetInnerHTML:{__html:metricName}}):react_default.a.createElement("span",{className:"metric-name"},metricName),anomalyData?react_default.a.createElement(AnomalyTooltipContent,anomalyData):null)},Object.assign({},formatted,{anomalyData:anomalyData,isCloudViz:isCloudViz})),contentDiv),contentDiv}},{key:"_highlightDataSource",value:function(_ref3){var _this2=this,dataPoint=_ref3.dataPoint,dataPoints=_ref3.dataPoints;_ref3.event;"line"===_ref3.shape?dataPoints.forEach(function(point){var cell=point.value("_cell");_this2.$panel.find(".cell_"+cell.id).addClass("chart-hover")}):dataPoint._data[0].item.parent.cells.forEach(function(cell){_this2.$panel.find(".cell_"+cell.id).addClass("chart-hover")})}},{key:"vizLibraryType",get:function(){return build_bundle_module.db.isActive("vegaLineCharts")?this.vizComponentOpts.renderDeprecatedChart?"DeprecatedLine":build_bundle_module.db.isActive("checkSubpanelNameToRenderDeprecatedCharts")&&bundle_module.q.get(this,"reportlet.name","").includes("Deprecated")?"DeprecatedLine":"Line":"DeprecatedLine"}},{key:"isVegaViz",get:function(){return"Line"===this.vizLibraryType}},{key:"vizComponentOpts",get:function(){var opts=Object(esm_get.a)(Object(getPrototypeOf.a)(LineReportlet.prototype),"vizComponentOpts",this);return Object.assign({},opts,{anchorToLeft:this.reportlet.anchorToLeft,showAnomalies:this.reportlet.showAnomalies,allowAnomaliesToRescale:this.reportlet.allowAnomaliesToRescale,legendVisible:this.reportlet.legendVisible,normalized:this.reportlet.data&&this.reportlet.data.length>2&&this.reportlet.normalized,forceZero:this.reportlet.forceZero,setForceZero:this.setForceZero.bind(this),dualYAxis:this.reportlet.data&&2===this.reportlet.data.length&&this.reportlet.dualYAxis,usePercentage:this.reportlet.usePercentage,renderDeprecatedChart:this.reportlet.renderDeprecatedChart,pointTooltipContent:this.pointTooltipContent.bind(this)})}}]),LineReportlet}(VizReportlet_VizReportlet);LineReportlet_LineReportlet.Settings=function(props){return react_default.a.createElement("div",null,react_default.a.createElement("div",{className:"ad-Popover-section1"},react_default.a.createElement(VizSettings2_VizSettings2.VizSettingsHeader,null),react_default.a.createElement(VizSettings2_VizSettings2.Percentages,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LegendVisible,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LimitMaxItems,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.DisplayDualAxis,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.Normalized,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.ForceZeroYAxis,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.ShowAnomalies,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.AllowAnomaliesToRescale,{subPanel:props.subPanel}),build_bundle_module.db.isActive("showDeprecatedChartCheckbox")?react_default.a.createElement(VizSettings2_VizSettings2.RenderDeprecatedChart,{subPanel:props.subPanel}):null),react_default.a.createElement(VizSettings2_VizSettings2.AnchorGraphToLeft,{subPanel:props.subPanel}))};var AreaReportlet_AreaReportlet=function(_LineReportlet){function AreaReportlet(props,context){var _this;return Object(classCallCheck.a)(this,AreaReportlet),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(AreaReportlet).call(this,props,context))).state={},_this}return Object(inherits.a)(AreaReportlet,_LineReportlet),Object(createClass.a)(AreaReportlet,[{key:"vizLibraryType",get:function(){return"Area"}},{key:"vizComponentOpts",get:function(){var opts=Object(esm_get.a)(Object(getPrototypeOf.a)(AreaReportlet.prototype),"vizComponentOpts",this);return Object.assign({},opts,{anchorToLeft:this.reportlet.anchorToLeft,showAnomalies:this.reportlet.showAnomalies,legendVisible:this.reportlet.legendVisible,forceZero:this.reportlet.forceZero,numItems:this.reportlet.numItems,normalized:this.reportlet.data&&this.reportlet.data.length>2&&this.reportlet.normalized,dualYAxis:this.reportlet.data&&2===this.reportlet.data.length&&this.reportlet.dualYAxis})}}]),AreaReportlet}(LineReportlet_LineReportlet);AreaReportlet_AreaReportlet.Settings=function(props){return react_default.a.createElement("div",null,react_default.a.createElement("div",{className:"ad-Popover-section1"},react_default.a.createElement(VizSettings2_VizSettings2.VizSettingsHeader,null),react_default.a.createElement(VizSettings2_VizSettings2.Percentages,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LegendVisible,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LimitMaxItems,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.DisplayDualAxis,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.Normalized,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.ForceZeroYAxis,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.ShowAnomalies,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.AllowAnomaliesToRescale,{subPanel:props.subPanel})),react_default.a.createElement(VizSettings2_VizSettings2.AnchorGraphToLeft,{subPanel:props.subPanel}))};var AreaStackedReportlet_AreaStackedReportlet=function(_LineReportlet){function AreaStackedReportlet(props,context){var _this;return Object(classCallCheck.a)(this,AreaStackedReportlet),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(AreaStackedReportlet).call(this,props,context))).state={},_this}return Object(inherits.a)(AreaStackedReportlet,_LineReportlet),Object(createClass.a)(AreaStackedReportlet,[{key:"postDisabledLegendsChange",value:function(){this.forceUpdate()}},{key:"vizLibraryType",get:function(){return"AreaStacked"}},{key:"vizComponentOpts",get:function(){var _this2=this,opts=Object(esm_get.a)(Object(getPrototypeOf.a)(AreaStackedReportlet.prototype),"vizComponentOpts",this);return Object.assign({},opts,{anchorToLeft:this.reportlet.anchorToLeft,showAnomalies:this.reportlet.showAnomalies,legendVisible:this.reportlet.legendVisible,forceZero:this.reportlet.forceZero,numItems:this.reportlet.numItems,stacked100:this.reportlet.stacked100,postDisabledLegendsChange:function(){return _this2.postDisabledLegendsChange()}})}}]),AreaStackedReportlet}(LineReportlet_LineReportlet);AreaStackedReportlet_AreaStackedReportlet.Settings=function(props){return react_default.a.createElement("div",null,react_default.a.createElement("div",{className:"ad-Popover-section1"},react_default.a.createElement(VizSettings2_VizSettings2.VizSettingsHeader,null),react_default.a.createElement(VizSettings2_VizSettings2.Percentages,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.Stacked100,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LegendVisible,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LimitMaxItems,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.ForceZeroYAxis,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.ShowAnomalies,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.AllowAnomaliesToRescale,{subPanel:props.subPanel})),react_default.a.createElement(VizSettings2_VizSettings2.AnchorGraphToLeft,{subPanel:props.subPanel}))};var BarReportlet_BarReportlet=function(_VizReportlet){function BarReportlet(props,context){var _this;return Object(classCallCheck.a)(this,BarReportlet),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(BarReportlet).call(this,props,context))).state={},_this}return Object(inherits.a)(BarReportlet,_VizReportlet),Object(createClass.a)(BarReportlet,[{key:"vizLibraryType",get:function(){return"Bar"}},{key:"vizComponentOpts",get:function(){var opts=Object(esm_get.a)(Object(getPrototypeOf.a)(BarReportlet.prototype),"vizComponentOpts",this);return Object.assign({},opts,{legendVisible:this.reportlet.legendVisible,numItems:this.reportlet.numItems,normalized:this.reportlet.data&&this.reportlet.data.length>2&&this.reportlet.normalized,dualYAxis:this.reportlet.data&&2===this.reportlet.data.length&&this.reportlet.dualYAxis,usePercentage:this.reportlet.usePercentage})}}]),BarReportlet}(VizReportlet_VizReportlet);BarReportlet_BarReportlet.Settings=function(props){return react_default.a.createElement("div",{className:"ad-Popover-section1"},react_default.a.createElement(VizSettings2_VizSettings2.VizSettingsHeader,null),react_default.a.createElement(VizSettings2_VizSettings2.Percentages,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LegendVisible,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LimitMaxItems,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.DisplayDualAxis,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.Normalized,{subPanel:props.subPanel}))};var BarStackedReportlet_BarStackedReportlet=function(_VizReportlet){function BarStackedReportlet(props,context){var _this;return Object(classCallCheck.a)(this,BarStackedReportlet),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(BarStackedReportlet).call(this,props,context))).state={},_this}return Object(inherits.a)(BarStackedReportlet,_VizReportlet),Object(createClass.a)(BarStackedReportlet,[{key:"vizLibraryType",get:function(){return"BarStacked"}},{key:"vizComponentOpts",get:function(){var opts=Object(esm_get.a)(Object(getPrototypeOf.a)(BarStackedReportlet.prototype),"vizComponentOpts",this);return Object.assign({},opts,{legendVisible:this.reportlet.legendVisible,numItems:this.reportlet.numItems,normalized:this.reportlet.normalized,dualYAxis:this.reportlet.dualYAxis,stacked100:this.reportlet.stacked100})}}]),BarStackedReportlet}(VizReportlet_VizReportlet);BarStackedReportlet_BarStackedReportlet.Settings=function(props){return react_default.a.createElement("div",{className:"ad-Popover-section1"},react_default.a.createElement(VizSettings2_VizSettings2.VizSettingsHeader,null),react_default.a.createElement(VizSettings2_VizSettings2.Percentages,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.Stacked100,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LegendVisible,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LimitMaxItems,{subPanel:props.subPanel}))};var BulletReportlet_BulletReportlet=function(_VizReportlet){function BulletReportlet(props,context){var _this;return Object(classCallCheck.a)(this,BulletReportlet),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(BulletReportlet).call(this,props,context))).state={},_this}return Object(inherits.a)(BulletReportlet,_VizReportlet),Object(createClass.a)(BulletReportlet,[{key:"vizLibraryType",get:function(){return"Bullet"}}]),BulletReportlet}(VizReportlet_VizReportlet);BulletReportlet_BulletReportlet.Settings=function(props){var reportlet=props.subPanel.reportlet;function cleanNum(str){return+str.replace(/[^\d\.]?/g,"")}var percentSign=reportlet.usePercentage&&react_default.a.createElement("span",null,"%\xa0\xa0\xa0\xa0\xa0");return react_default.a.createElement("div",null,react_default.a.createElement("div",{className:"ad-Popover-section1"},react_default.a.createElement(VizSettings2_VizSettings2.VizSettingsHeader,null),react_default.a.createElement(VizSettings2_VizSettings2.Percentages,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LegendVisible,{subPanel:props.subPanel})),react_default.a.createElement("div",{className:"ad-Popover-section1 bullet-goals-row"},react_default.a.createElement(VizSettings2_VizSettings2.VizSettingsHeader,{label:Object(l10nify_build_bundle_module.a)("Bullet Options")}),react_default.a.createElement("label",{className:"textfield-label bullet-goals-label"},react_default.a.createElement(ui_core_build_bundle_module.jb,{className:"bullet-value-textfield",defaultValue:reportlet.goalVal,onChange:function(e){reportlet.goalVal=cleanNum(e.target.value)}}),react_default.a.createElement("span",{className:"coral-Checkbox-description"},percentSign,Object(l10nify_build_bundle_module.a)("High Goal"),react_default.a.createElement(ui_core_build_bundle_module.C.Help,{label:Object(l10nify_build_bundle_module.a)("'Goal Value' is the main goal you are shooting for. 'Low Goal' and 'Mid Goal' create ranges below the Goal Value. Note: when the \"Percentages\" option is checked, enter goals as whole numbers. I.E. \"20\" if your goal is twenty percent.")})),react_default.a.createElement("br",null)),react_default.a.createElement("label",{className:"textfield-label bullet-goals-label"},react_default.a.createElement(ui_core_build_bundle_module.jb,{className:"bullet-value-textfield",defaultValue:reportlet.midVal,onChange:function(e){reportlet.midVal=cleanNum(e.target.value)}}),react_default.a.createElement("span",{className:"coral-Checkbox-description"},percentSign,Object(l10nify_build_bundle_module.a)("Mid Goal")),react_default.a.createElement("br",null)),react_default.a.createElement("label",{className:"textfield-label bullet-goals-label"},react_default.a.createElement(ui_core_build_bundle_module.jb,{className:"bullet-value-textfield",defaultValue:reportlet.lowVal,onChange:function(e){reportlet.lowVal=cleanNum(e.target.value)}}),react_default.a.createElement("span",{className:"coral-Checkbox-description"},percentSign,Object(l10nify_build_bundle_module.a)("Low Goal")),react_default.a.createElement("br",null))))};var DonutReportlet_DonutReportlet=function(_VizReportlet){function DonutReportlet(props,context){var _this;return Object(classCallCheck.a)(this,DonutReportlet),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(DonutReportlet).call(this,props,context))).state={},_this}return Object(inherits.a)(DonutReportlet,_VizReportlet),Object(createClass.a)(DonutReportlet,[{key:"_highlightDataSource",value:function(_ref){var _this2=this,dataPayload=_ref.dataPayload,dataPoint=_ref.dataPoint;if("__other__"===dataPayload.data.sliceId){var sliceData=bundle_module.v.selectAll(this.$el.find(".plot .bar-geom")).data(),selectedCellIds=dataPoint._dataSet.data.map(function(d){return d.value("id")}),blacklistedIds=sliceData.map(function(slice){return slice.data.id});selectedCellIds.forEach(function(cellId){-1===blacklistedIds.indexOf(cellId)&&_this2.$panel.find(".cell_"+cellId).addClass("chart-hover")})}else{var cellId=dataPayload.data.id;this.$panel.find(".cell_"+cellId).addClass("chart-hover")}}},{key:"vizLibraryType",get:function(){return"Donut"}},{key:"vizComponentOpts",get:function(){var opts=Object(esm_get.a)(Object(getPrototypeOf.a)(DonutReportlet.prototype),"vizComponentOpts",this);return Object.assign({},opts,{legendVisible:this.reportlet.legendVisible,numItems:this.reportlet.numItems,hasLimit:this.reportlet.hasLimit,getAggregateLabel:this.reportlet.getAggregateLabel.bind(this.reportlet)})}}]),DonutReportlet}(VizReportlet_VizReportlet);DonutReportlet_DonutReportlet.Settings=function(props){return react_default.a.createElement("div",{className:"ad-Popover-section1"},react_default.a.createElement(VizSettings2_VizSettings2.VizSettingsHeader,null),react_default.a.createElement(VizSettings2_VizSettings2.Percentages,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LegendVisible,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LimitMaxItems,{subPanel:props.subPanel}))};__webpack_require__(964);var VizConfig_VizConfig=function(_AppComponent){function VizConfig(props,context){var _this;return Object(classCallCheck.a)(this,VizConfig),_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(VizConfig).call(this,props,context)),props.reportlet.updateDerivedDataSource(_this.appContext),_this}return Object(inherits.a)(VizConfig,_AppComponent),Object(createClass.a)(VizConfig,null,[{key:"propTypes",get:function(){return{reportlet:ui_core_build_bundle_module.R.object.isRequired,subPanel:ui_core_build_bundle_module.R.object.isRequired}}}]),Object(createClass.a)(VizConfig,[{key:"componentWillMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(VizConfig.prototype),"componentWillMount",this).call(this),this.props.reportlet.linkedSource.load(this.appContext)}}]),VizConfig}(ui_build_bundle_module.d),HistogramReportletConfig_HistogramReportletConfig=function(_VizConfig){function HistogramReportletConfig(props,context){var _this;return Object(classCallCheck.a)(this,HistogramReportletConfig),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(HistogramReportletConfig).call(this,props,context))).state={startingBucket:1,bucketCount:12,bucketSize:2,countingMethod:_this.app.reportSuite.visitorsCountingMethod,showAdvancedSettings:!1},_this}return Object(inherits.a)(HistogramReportletConfig,_VizConfig),Object(createClass.a)(HistogramReportletConfig,[{key:"onConfigComplete",value:function(){var _this2=this,config=bundle_module.q.omit(this.state,"showAdvancedSettings");["bucketCount","bucketSize","startingBucket"].forEach(function(prop){config[prop]=+config[prop]}),bundle_module.q.extend(this.props.reportlet,config),this.props.reportlet.modifyLinkedSource(this.app).then(function(){_this2.props.reportlet.linkedSource.load({app:_this2.app,reportSuite:_this2.app.reportSuite})})}},{key:"isConfigValid",value:function(){var config=bundle_module.q.omit(this.state,"showAdvancedSettings");return config.component=this.props.reportlet.component,HistogramReportletConfig.validateConfig(config)}},{key:"render",value:function(){var _this3=this,metricProps={components:bundle_module.q.compact([this.props.reportlet.component]),supportedComponentTypes:[build_bundle_module.Hb],limit:1,onChange:function(_ref){var value=_ref.value,component=bundle_module.q.get(value,"[0]");_this3.props.reportlet.component=component},isSupportedComponent:function(component){return component.segmentable}};return react_default.a.createElement("div",{className:"an-chart-config an-panel-config"},react_default.a.createElement("div",{className:"an-chart-config-wrap"},react_default.a.createElement("div",{className:"reportlet-config"},react_default.a.createElement(HistogramReportletConfig_HistogramPillGroup,{title:Object(l10nify_build_bundle_module.a)("Drop a metric below")},react_default.a.createElement(ui_build_bundle_module.n.Metric,metricProps)),react_default.a.createElement("div",null,react_default.a.createElement(ui_core_build_bundle_module.f,{className:"reportlet-config-button",variant:"primary",disabled:!this.isConfigValid(),onClick:function(){return _this3.onConfigComplete()},label:Object(l10nify_build_bundle_module.a)("Build"),"data-test-id":"histogram-reportlet-build-btn"})),react_default.a.createElement("div",{className:"histogram-settings-toggle",onClick:function(){return _this3.setState({showAdvancedSettings:!_this3.state.showAdvancedSettings})}},this.state.showAdvancedSettings?Object(l10nify_build_bundle_module.a)("Hide Advanced Settings"):Object(l10nify_build_bundle_module.a)("Show Advanced Settings")),react_default.a.createElement(HistogramReportletConfig_HistogramAdvancedSettings,{className:classnames_default()("histogram-settings",{hidden:!this.state.showAdvancedSettings}),updateState:this.setState.bind(this),bucketSize:this.state.bucketSize,bucketCount:this.state.bucketCount,startingBucket:this.state.startingBucket,countingMethod:this.state.countingMethod,reportSuite:this.app.reportSuite}))))}}],[{key:"validateConfig",value:function(config){return!["bucketCount","bucketSize","startingBucket"].some(function(prop){return!Number.isInteger(+config[prop])})&&config.component&&config.bucketCount>=1&&config.bucketCount<=50&&config.bucketSize>=1&&config.startingBucket>=0&&config.countingMethod}}]),HistogramReportletConfig}(VizConfig_VizConfig),HistogramReportletConfig_HistogramPillGroup=function(props){return react_default.a.createElement("div",{className:""},react_default.a.createElement(ui_core_build_bundle_module.B,{className:"reportlet-config-bucket-control",label:props.title}),props.children)},HistogramReportletConfig_HistogramReportletSetting=function(_AppComponent){function HistogramReportletSetting(props,context){var _this4;return Object(classCallCheck.a)(this,HistogramReportletSetting),(_this4=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(HistogramReportletSetting).call(this,props,context))).state={value:props.settings[props.bucketProp]},_this4}return Object(inherits.a)(HistogramReportletSetting,_AppComponent),Object(createClass.a)(HistogramReportletSetting,[{key:"handleChange",value:function(e){var val=e.value,_this$props=this.props,state=_this$props.settings,property=_this$props.bucketProp,updateState=_this$props.updateState;this.setState({value:val}),state[property]=val,updateState(Object(defineProperty.a)({},property,state[property]))}},{key:"render",value:function(){var _this5=this,_this$props2=this.props,label=_this$props2.label,lowerBound=(_this$props2.settings,_this$props2.bucketProp,_this$props2.lowerBound),upperBound=_this$props2.upperBound,className=_this$props2.className;return upperBound||(upperBound=1/0),react_default.a.createElement("div",{className:classnames_default()("histogram-bucket-setting-item",className)},react_default.a.createElement("div",{className:"textfield-label"},react_default.a.createElement(ui_core_build_bundle_module.B,{label:label})),react_default.a.createElement(ui_core_build_bundle_module.M,{min:lowerBound,max:upperBound,incBy:1,decBy:1,value:this.state.value,enableErrorTooltip:!0,onChange:function(e){return _this5.handleChange(e)},size:"M",variant:"quiet",controlled:!0}))}}]),HistogramReportletSetting}(ui_build_bundle_module.d),HistogramReportletConfig_HistogramSettingSelect=function(props){return react_default.a.createElement("div",{className:"histogram-setting-item"},react_default.a.createElement("div",{className:"textfield-label"},react_default.a.createElement(ui_core_build_bundle_module.B,{label:props.label})),react_default.a.createElement(ui_core_build_bundle_module.W,{options:props.options,value:props.countingMethod,size:"M",clearable:!1,searchable:!1,variant:"quiet",onChange:props.onChange}))},HistogramReportletConfig_HistogramAdvancedSettings=function(props){var bucketSettings={bucketCount:props.bucketCount,bucketSize:props.bucketSize,startingBucket:props.startingBucket},options=[{value:"hits",label:Object(l10nify_build_bundle_module.a)("Hit")},{value:"visits",label:Object(l10nify_build_bundle_module.a)("Visit")},{value:props.reportSuite.visitorsCountingMethod,label:props.reportSuite.visitorLabel}];return react_default.a.createElement("div",{className:props.className},react_default.a.createElement(HistogramReportletConfig_HistogramReportletSetting,{className:"advanced-settings",label:Object(l10nify_build_bundle_module.a)("Starting Bucket"),settings:bucketSettings,bucketProp:"startingBucket",lowerBound:0,updateState:props.updateState}),react_default.a.createElement(HistogramReportletConfig_HistogramReportletSetting,{className:"advanced-settings",label:Object(l10nify_build_bundle_module.a)("Metric Buckets"),settings:bucketSettings,bucketProp:"bucketCount",lowerBound:1,upperBound:50,updateState:props.updateState}),react_default.a.createElement(HistogramReportletConfig_HistogramReportletSetting,{className:"advanced-settings",label:Object(l10nify_build_bundle_module.a)("Metric Bucket Size"),settings:bucketSettings,bucketProp:"bucketSize",lowerBound:1,updateState:props.updateState}),react_default.a.createElement(HistogramReportletConfig_HistogramSettingSelect,{label:Object(l10nify_build_bundle_module.a)("Counting Method"),options:options,countingMethod:props.countingMethod,onChange:function(_ref2){var value=_ref2.value;return props.updateState({countingMethod:value})}}))},HistogramReportlet_HistogramReportlet=function(_VizReportlet){function HistogramReportlet(props,context){var _this;Object(classCallCheck.a)(this,HistogramReportlet),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(HistogramReportlet).call(this,props,context))).state={};var reportlet=props.reportlet,app=context.app;return _this.observe(props.reportlet,"change",function(e){reportlet.needsToBeConfigured||-1===["bucketCount","bucketSize","startingBucket","countingMethod"].indexOf(e.property)||reportlet.modifyLinkedSource(app,e.property).then(function(){reportlet.linkedSource.load({app:app,reportSuite:app.reportSuite})})}),_this}return Object(inherits.a)(HistogramReportlet,_VizReportlet),Object(createClass.a)(HistogramReportlet,[{key:"vizLibraryType",get:function(){return"Histogram"}},{key:"vizComponentOpts",get:function(){var opts=Object(esm_get.a)(Object(getPrototypeOf.a)(HistogramReportlet.prototype),"vizComponentOpts",this);return Object.assign({},opts,{legendVisible:this.reportlet.legendVisible,numItems:this.reportlet.numItems,normalized:this.reportlet.data&&this.reportlet.data.length>2&&this.reportlet.normalized,dualYAxis:this.reportlet.data&&2===this.reportlet.data.length&&this.reportlet.dualYAxis,usePercentage:this.reportlet.usePercentage,xAxisTitle:bundle_module.q.get(this.reportlet,"component.name"),tooltipContent:this.tooltipContent.bind(this)})}},{key:"tooltipContent",get:function(){var bucketSize=this.props.reportlet.bucketSize;return function(d,i,j){var rangeLabel="";if("+"===d.data.x.slice(-1))rangeLabel=d.data.xLabel;else{var upperBound=+d.data.x+bucketSize;rangeLabel="".concat(d.data.xLabel," - ").concat(d.data.xLabel.replace(/\d+/,upperBound))}return'<span class="metric-name">'.concat(bundle_module.q.escape(rangeLabel),'</span>\n\t\t\t\t\t\t<span class="metric-value">').concat(bundle_module.q.escape(d.data.yLabel),'</span>\n\t\t\t\t\t\t<span class="series-name">').concat(bundle_module.q.escape(d.data.seriesLabel),"</span>")}}}]),HistogramReportlet}(VizReportlet_VizReportlet);HistogramReportlet_HistogramReportlet.Settings=function(props){var reportlet=props.subPanel.reportlet,isDisabled=(props.app,!reportlet.component),bucketSettings={bucketCount:reportlet.bucketCount,bucketSize:reportlet.bucketSize,startingBucket:reportlet.startingBucket},updateReportlet=bundle_module.q.debounce(function(){if(Object.keys(bucketSettings).some(function(prop){return reportlet[prop]!==bucketSettings[prop]})&&function(){var config=Object.assign({},bucketSettings,{component:reportlet.component,countingMethod:reportlet.countingMethod});return HistogramReportletConfig_HistogramReportletConfig.validateConfig(config)}()){for(var prop in bucketSettings)bucketSettings[prop]=+bucketSettings[prop];bundle_module.q.assign(reportlet,bucketSettings)}},1e3);return react_default.a.createElement("div",null,react_default.a.createElement("div",{className:"ad-Popover-section1"},react_default.a.createElement(VizSettings2_VizSettings2.VizSettingsHeader,null),react_default.a.createElement(VizSettings2_VizSettings2.Percentages,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LegendVisible,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LimitMaxItems,{subPanel:props.subPanel})),react_default.a.createElement("div",{className:"ad-Popover-section1"},react_default.a.createElement(VizSettings2_VizSettings2.VizSettingsHeader,{label:Object(l10nify_build_bundle_module.a)("Histogram Settings")}),react_default.a.createElement(HistogramReportletConfig_HistogramReportletSetting,{className:"viz-setting",label:Object(l10nify_build_bundle_module.a)("Starting Bucket"),settings:bucketSettings,bucketProp:"startingBucket",lowerBound:0,isDisabled:isDisabled,updateState:updateReportlet}),react_default.a.createElement(HistogramReportletConfig_HistogramReportletSetting,{className:"viz-setting",label:Object(l10nify_build_bundle_module.a)("Metric Buckets"),settings:bucketSettings,bucketProp:"bucketCount",lowerBound:1,upperBound:50,isDisabled:isDisabled,updateState:updateReportlet}),react_default.a.createElement(HistogramReportletConfig_HistogramReportletSetting,{className:"viz-setting",label:Object(l10nify_build_bundle_module.a)("Metric Bucket Size"),settings:bucketSettings,bucketProp:"bucketSize",lowerBound:1,isDisabled:isDisabled,updateState:updateReportlet}),react_default.a.createElement(ui_core_build_bundle_module.B,null,Object(l10nify_build_bundle_module.a)("Counting Method")),react_default.a.createElement(ui_core_build_bundle_module.S.Group,{className:"padded-content",vertical:!0,disabled:isDisabled,selectedValue:reportlet.countingMethod},react_default.a.createElement(ui_core_build_bundle_module.S,{className:"radio-option",label:Object(l10nify_build_bundle_module.a)("Hit"),value:"hits",onChange:function(){reportlet.countingMethod="hits"},"data-test-id":"histogram-settings-counting-method-hit"}),react_default.a.createElement(ui_core_build_bundle_module.S,{className:"radio-option",label:Object(l10nify_build_bundle_module.a)("Visit"),value:"visits",onChange:function(){reportlet.countingMethod="visits"},"data-test-id":"histogram-settings-counting-method-visit"}),react_default.a.createElement(ui_core_build_bundle_module.S,{className:"radio-option",label:props.app.reportSuite.visitorLabel,value:props.app.reportSuite.visitorsCountingMethod,onChange:function(){reportlet.countingMethod=props.app.reportSuite.visitorsCountingMethod},"data-test-id":"histogram-settings-counting-method-visitor"}))))},HistogramReportlet_HistogramReportlet.SubPanelConfig=HistogramReportletConfig_HistogramReportletConfig;var HorizontalBarReportlet_HorizontalBarReportlet=function(_VizReportlet){function HorizontalBarReportlet(props,context){var _this;return Object(classCallCheck.a)(this,HorizontalBarReportlet),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(HorizontalBarReportlet).call(this,props,context))).state={},_this}return Object(inherits.a)(HorizontalBarReportlet,_VizReportlet),Object(createClass.a)(HorizontalBarReportlet,[{key:"vizLibraryType",get:function(){return"HorizontalBar"}},{key:"vizComponentOpts",get:function(){var opts=Object(esm_get.a)(Object(getPrototypeOf.a)(HorizontalBarReportlet.prototype),"vizComponentOpts",this);return Object.assign({},opts,{legendVisible:this.reportlet.legendVisible,numItems:this.reportlet.numItems,normalized:this.reportlet.data.length>2&&this.reportlet.normalized,dualYAxis:2===this.reportlet.data.length&&this.reportlet.dualYAxis})}}]),HorizontalBarReportlet}(VizReportlet_VizReportlet);HorizontalBarReportlet_HorizontalBarReportlet.Settings=function(props){return react_default.a.createElement("div",{className:"ad-Popover-section1"},react_default.a.createElement(VizSettings2_VizSettings2.VizSettingsHeader,null),react_default.a.createElement(VizSettings2_VizSettings2.Percentages,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LegendVisible,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LimitMaxItems,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.DisplayDualAxis,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.Normalized,{subPanel:props.subPanel}))};var HorizontalBarStackedReportlet_HorizontalBarStackedReportlet=function(_VizReportlet){function HorizontalBarStackedReportlet(props,context){var _this;return Object(classCallCheck.a)(this,HorizontalBarStackedReportlet),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(HorizontalBarStackedReportlet).call(this,props,context))).state={},_this}return Object(inherits.a)(HorizontalBarStackedReportlet,_VizReportlet),Object(createClass.a)(HorizontalBarStackedReportlet,[{key:"vizLibraryType",get:function(){return"HorizontalBarStacked"}},{key:"vizComponentOpts",get:function(){var opts=Object(esm_get.a)(Object(getPrototypeOf.a)(HorizontalBarStackedReportlet.prototype),"vizComponentOpts",this);return Object.assign({},opts,{legendVisible:this.reportlet.legendVisible,numItems:this.reportlet.numItems,stacked100:this.reportlet.stacked100})}}]),HorizontalBarStackedReportlet}(VizReportlet_VizReportlet);HorizontalBarStackedReportlet_HorizontalBarStackedReportlet.Settings=function(props){return react_default.a.createElement("div",{className:"ad-Popover-section1"},react_default.a.createElement(VizSettings2_VizSettings2.VizSettingsHeader,null),react_default.a.createElement(VizSettings2_VizSettings2.Percentages,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.Stacked100,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LegendVisible,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LimitMaxItems,{subPanel:props.subPanel}))};var MapReportletConfig_MapReportletConfig=function(_AppComponent){function MapReportletConfig(props,context){var _this;return Object(classCallCheck.a)(this,MapReportletConfig),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(MapReportletConfig).call(this,props,context))).state={component:props.reportlet.metricComponent,isLatLng:props.reportlet.isLatLng&&_this.isLatLngSupported},_this._setupBroadcastListeners(),_this}return Object(inherits.a)(MapReportletConfig,_AppComponent),Object(createClass.a)(MapReportletConfig,[{key:"_setupBroadcastListeners",value:function(){var _this2=this;this.observe(this.props.reportlet,"project:change",function(){_this2.props.reportlet.changeIsLatLngIfNeeded(_this2.app.cache),_this2.setState({isLatLng:_this2.props.reportlet.isLatLng})}),this.observe(this.props.reportlet,"project:refresh"),this.observe(this.props.reportlet,"panel:change"),this.observe(this.props.reportlet,"change:metricComponent",function(){_this2.setState({component:_this2.props.reportlet.metricComponent})}),this.observe(this.props.reportlet,"change:isLatLng",function(){_this2.setState({isLatLng:_this2.props.reportlet.isLatLng})})}},{key:"onConfigComplete",value:function(){this.props.reportlet.resetData(),this.props.reportlet.metricComponent=this.state.component,this.props.reportlet.isLatLng=this.state.isLatLng,this.props.reportlet.expandInlineConfig=!1,this.props.reportlet.load({app:this.app,reportSuite:this.app.reportSuite})}},{key:"radioButtonSelectionChanged",value:function(type){"lat/long"===type?this.state.isLatLng=!0:"geographicDimension"===type&&(this.state.isLatLng=!1),this.forceUpdate(),ui_core_build_bundle_module.lb.trackAction(null,"Visualization Setting Changed",{vizSettingName:"Map Type (Mobile LatLong/GeographicDimension)",type:type})}},{key:"render",value:function(){var _this3=this,metricProps={components:bundle_module.q.compact([this.state.component]),supportedComponentTypes:[build_bundle_module.Hb,build_bundle_module.r],limit:1,onChange:function(_ref){var value=_ref.value;return _this3.setState({component:bundle_module.q.get(value,"[0]")})}},isDataValid=this.state.component,updateLatLongEvarURL=this.app.omnitureUrl.switchpfs("am","ReportSuite.EditSelection",{rs_list:this.app.reportSuite.rsid,rs_feature:"MobileAppReporting",rs_args:""}),selectedValue=this.state.isLatLng?"lat/long":"geographicDimension";return react_default.a.createElement("div",{className:"an-chart-config an-panel-config"},react_default.a.createElement("div",{className:"an-chart-config-wrap"},react_default.a.createElement("div",{className:"reportlet-config"},react_default.a.createElement(ui_core_build_bundle_module.B,{className:"reportlet-config-bucket-control",label:Object(l10nify_build_bundle_module.a)("Drop a metric below")}),react_default.a.createElement(ui_build_bundle_module.n.Metric,metricProps),react_default.a.createElement(ui_core_build_bundle_module.S.Group,{vertical:!0,selectedValue:selectedValue},react_default.a.createElement(ui_core_build_bundle_module.S,{label:Object(l10nify_build_bundle_module.a)("Mobile Lat/Long"),value:"lat/long",onChange:function(){_this3.radioButtonSelectionChanged("lat/long")},disabled:!this.isLatLngSupported,"data-test-id":"map-data-type-mobile-lat-long"},"\xa0\xa0",react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"helpCircle",size:"XS",style:{color:"#4b4b4b"}}),react_default.a.createElement(ui_core_build_bundle_module.kb,{variant:"info",hoverable:!0,position:"top"},Object(l10nify_build_bundle_module.a)("This data is collected by the Adobe Mobile SDK and only available for mobile app report suites. This allows you to plot events based on mobile Latitude and Longitude."),!this.isLatLngSupported&&react_default.a.createElement("div",null,react_default.a.createElement("br",null),Object(l10nify_build_bundle_module.a)("For mobile app report suites, you must also enable Location Tracking in order to collect this data."),react_default.a.createElement("br",null),react_default.a.createElement("br",null),react_default.a.createElement(ui_core_build_bundle_module.F,{href:updateLatLongEvarURL,target:"_blank"},Object(l10nify_build_bundle_module.a)("Click here to enable Location Tracking."))))),react_default.a.createElement(ui_core_build_bundle_module.S,{label:Object(l10nify_build_bundle_module.a)("Geographic Dimension"),value:"geographicDimension",onChange:function(){_this3.radioButtonSelectionChanged("geographicDimension")},"data-test-id":"map-data-type-geographic-dimension"},"\xa0\xa0",react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"helpCircle",size:"XS","data-tooltip-immediate":Object(l10nify_build_bundle_module.a)("This data is collected based on IP address and works with all data sets. This allows you to plot events based on country, city, state, etc.")}))),react_default.a.createElement("div",null,react_default.a.createElement(ui_core_build_bundle_module.f,{className:"reportlet-config-button",variant:"primary",disabled:!isDataValid,onClick:function(){return _this3.onConfigComplete()},label:Object(l10nify_build_bundle_module.a)("Build"),"data-test-id":"test-map-reportlet-build-btn"})))))}},{key:"isLatLngSupported",get:function(){return this.props.reportlet.reportSuiteSupportsLatLng(this.app.cache)}}],[{key:"getInlineConfigHeader",value:function(reportlet){return bundle_module.q.get(reportlet,"metricComponent.label","")}}]),MapReportletConfig}(ui_build_bundle_module.d),MapReportlet_MapReportlet=function(_VizReportlet){function MapReportlet(){return Object(classCallCheck.a)(this,MapReportlet),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(MapReportlet).apply(this,arguments))}return Object(inherits.a)(MapReportlet,_VizReportlet),Object(createClass.a)(MapReportlet,[{key:"shouldUpdateOnReportletChange",value:function(e){return"isLatLng"===e.property?(this.reportlet.load(this.appContext),!0):!this.undoing&&build_bundle_module.sc.undoRedoInProgress&&"loading"!==e.property?(this.undoing=!0,this.updateViz({method:"setColorTheme",params:[this.reportlet.colorTheme]}),this.updateViz({method:"setColors"}),this.refreshOptions(),this.updateViz({method:"refreshStyle"}),this.reportlet.loadingPercentage=null,this.undoing=!1,!1):"zoom"!==e.property&&("pitch"!==e.property&&("bearing"!==e.property&&("center"!==e.property&&("clusterRadius"!==e.property&&("useCustomMaxValue"!==e.property&&"customMaxValue"!==e.property)))))}},{key:"clearErrorsOnRender",value:function(){}},{key:"isSupportedBrowser",value:function(){return!(dom_util_build_bundle_module.a.isIE()&&dom_util_build_bundle_module.a.ieVersion()<12)}},{key:"_isValid",value:function(){return this.isSupportedBrowser()?Object(esm_get.a)(Object(getPrototypeOf.a)(MapReportlet.prototype),"_isValid",this).call(this):(this.reportlet.onError({id:"Unsupported Browser"}),!1)}},{key:"getContextMenuProps",value:function(params){var _this=this,resetStyles={label:Object(l10nify_build_bundle_module.a)("Reset Map"),onClick:function(f){_this.reportlet.resetMapParams(),_this.refreshOptions(),_this.updateViz({method:"refreshStyle"}),_this.updateViz({method:"setColorTheme",params:[_this.reportlet.colorTheme]}),_this.updateViz({method:"setColors"})}},createFreeformFromDataPoints=null;return bundle_module.q.get(params,"dataIds.length",0)&&(createFreeformFromDataPoints={label:Object(l10nify_build_bundle_module.a)("Create table from data point(s)"),onClick:function(){_this.onDataPointRightClick(params.dataIds)}}),{items:bundle_module.q.compact([createFreeformFromDataPoints,resetStyles])}}},{key:"onDataPointRightClick",value:function(dataPointIds){var _this2=this,dataPoints=dataPointIds.map(function(dataPointId){return _this2.reportlet.structuredData[dataPointId]});if(0!==dataPoints.length){var freeformReportletSubPanel=build_bundle_module.vb.create("FreeformReportlet");freeformReportletSubPanel.name=Object(l10nify_build_bundle_module.a)("Map Data Points"),this.props.subPanel.addSibling(freeformReportletSubPanel,"after",!0),freeformReportletSubPanel.makeNameUnique();var freeformModelUtil=new build_bundle_module.kb(this.appContext),staticRowComponents=[],breakdowns=[];dataPoints.forEach(function(dataPoint,i){if(dataPoint&&dataPoint.parentItem&&dataPoint.parentItem.parentItem){var staticRowId=guid_build_bundle_module.a.create();staticRowComponents.push({id:staticRowId,component:dataPoint.parentItem.parentItem.getDimensionItem()}),breakdowns.push({staticRowComponents:[dataPoint.parentItem.getDimensionItem()],parentItemId:staticRowId,breakdowns:[{staticRowComponents:[dataPoint.getDimensionItem()],parentPosition:0}]})}if(dataPoint&&dataPoint.parentItem&&!dataPoint.parentItem.parentItem){var _staticRowId=guid_build_bundle_module.a.create();staticRowComponents.push({id:_staticRowId,component:dataPoint.parentItem.getDimensionItem()}),breakdowns.push({staticRowComponents:[dataPoint.getDimensionItem()],parentItemId:_staticRowId})}dataPoint&&!dataPoint.parentItem&&staticRowComponents.push(dataPoint.getDimensionItem())}),freeformModelUtil.setupReport(freeformReportletSubPanel.reportlet,{columnComponents:[this.reportlet.metricComponent],staticRowComponents:staticRowComponents,breakdowns:breakdowns})}}},{key:"vizLibraryType",get:function(){return"GeoMap"}},{key:"vizComponentOpts",get:function(){var _this3=this,opts=Object(esm_get.a)(Object(getPrototypeOf.a)(MapReportlet.prototype),"vizComponentOpts",this);return opts.mapType=this.reportlet.mapType,opts.mapStyle=this.reportlet.mapStyle,opts.colorTheme=this.reportlet.colorTheme,opts.center=this.reportlet.center,opts.zoom=this.reportlet.zoom,opts.isLatLng=this.reportlet.isLatLng,opts.clusterRadius=this.reportlet.clusterRadius,opts.breakdownLevel=this.reportlet.breakdownLevel,opts.pitch=this.reportlet.pitch,opts.bearing=this.reportlet.bearing,opts.maxValue=this.reportlet.useCustomMaxValue?this.reportlet.customMaxValue:this.reportlet.maxItemValue,opts.saveSettings=function(_ref){var zoom=_ref.zoom,center=_ref.center,pitch=_ref.pitch,bearing=_ref.bearing;_this3.reportlet.pitch=pitch,_this3.reportlet.bearing=bearing,_this3.reportlet.zoom=zoom,_this3.reportlet.center[0]===center.lng&&_this3.reportlet.center[1]===center.lat||(_this3.reportlet.center=[center.lng,center.lat])},opts.negativeIsGood=bundle_module.q.get(this,"reportlet.metricComponent.polarity","")===build_bundle_module.Qb.NEGATIVE,opts.loadBreakdownOnDataPoints=function(args){return _this3.reportlet.loadBreakdownOnDataPoints(_this3.appContext,args)},opts.onMapMoveStart=bundle_module.q.throttle(function(){Object(ui_build_bundle_module.mb)(".an-tempTarget").remove()},100),Object.assign({},opts,{})}}]),MapReportlet}(VizReportlet_VizReportlet),colorThemes=bundle_module.q.map(ui_core_build_bundle_module.v.colorThemes,function(theme){return{label:theme.label,value:theme.id}}),mapStyles=bundle_module.q.map(ui_core_build_bundle_module.v.mapStyles,function(mapStyle){return{label:mapStyle.label,value:mapStyle.id}});MapReportlet_MapReportlet.Settings=function(_AppComponent){function Settings(){var _getPrototypeOf2,_this4;Object(classCallCheck.a)(this,Settings);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this4=Object(possibleConstructorReturn.a)(this,(_getPrototypeOf2=Object(getPrototypeOf.a)(Settings)).call.apply(_getPrototypeOf2,[this].concat(args)))).debouncedOnSliderChange=bundle_module.q.debounce(function(){_this4.refreshMapStyle()},200),_this4.debouncedMaxSliderChange=bundle_module.q.debounce(function(){_this4.props.subPanelComponent.subPanelComponent.updateViz({method:"updatePaintingProperties"})},200),_this4}return Object(inherits.a)(Settings,_AppComponent),Object(createClass.a)(Settings,[{key:"onClusterSliderChange",value:function(value){this.props.subPanel.reportlet.clusterRadius=value,this.forceUpdate(),this.debouncedOnSliderChange(),ui_core_build_bundle_module.lb.trackAction(null,"Visualization Setting Changed",{vizSettingName:"Map Cluster Radius",value:value})}},{key:"onMaxValueSliderChange",value:function(value){value=Math.min(value,this.highestPossibleMaxValue),value=Math.max(value,.001),this.maxValueSlider&&this.maxValueSlider.setState({value:value}),this.props.subPanel.reportlet.customMaxValue=value,this.props.subPanelComponent.subPanelComponent.refreshOptions(),this.debouncedMaxSliderChange(),this.forceUpdate(),ui_core_build_bundle_module.lb.trackAction(null,"Visualization Setting Changed",{vizSettingName:"Map Custom Max Value Changed",value:value})}},{key:"onUseCustomMaxValueClick",value:function(e){this.props.subPanel.reportlet.useCustomMaxValue=e.target.checked,this.props.subPanel.reportlet.useCustomMaxValue&&(this.props.subPanel.reportlet.customMaxValue=this.props.subPanel.reportlet.maxItemValue),this.props.subPanelComponent.subPanelComponent.refreshOptions(),this.props.subPanelComponent.subPanelComponent.updateViz({method:"updatePaintingProperties"}),this.forceUpdate(),e.target.checked?ui_core_build_bundle_module.lb.trackAction(null,"Visualization Setting Changed",{vizSettingEnabled:!0,vizSettingName:"Map Custom Max Value"}):ui_core_build_bundle_module.lb.trackAction(null,"Visualization Setting Changed",{vizSettingEnabled:!1,vizSettingName:"Map Custom Max Value"})}},{key:"onManualMaxValueInput",value:function(e){var value=this.format(e,{type:"raw",precision:-1});value=value||0,this.onMaxValueSliderChange(value)}},{key:"refreshMapStyle",value:function(){this.props.subPanelComponent.subPanelComponent.refreshOptions(),this.props.subPanelComponent.subPanelComponent.updateViz({method:"refreshStyle"})}},{key:"updateColors",value:function(colorTheme){this.props.subPanelComponent.subPanelComponent.updateViz({method:"setColorTheme",params:[colorTheme]}),this.props.subPanelComponent.subPanelComponent.updateViz({method:"setColors"})}},{key:"mapTypeChanged",value:function(type){this.props.subPanel.reportlet.mapType=type,"heatmap"===type&&(this.props.subPanel.reportlet.colorTheme="heat1"),ui_core_build_bundle_module.lb.trackAction(null,"Visualization Setting Changed",{vizSettingName:"Map Type (Bubbles/Heatmap)",value:type})}},{key:"mapColorThemeChanged",value:function(item){this.props.subPanel.reportlet.colorTheme=item.value,this.updateColors(item.value),this.forceUpdate(),ui_core_build_bundle_module.lb.trackAction(null,"Visualization Setting Changed",{vizSettingName:"Color Theme",value:item.value})}},{key:"mapStyleChanged",value:function(item){this.props.subPanel.reportlet.mapStyle=item.value,ui_core_build_bundle_module.lb.trackAction(null,"Visualization Setting Changed",{vizSettingName:"Map Style",value:item.value})}},{key:"render",value:function(){var _this5=this,props=this.props,currentMaxValue=(props.subPanel.reportlet.reportSuiteSupportsLatLng(props.app.cache),props.subPanel.reportlet.useCustomMaxValue?props.subPanel.reportlet.customMaxValue:props.subPanel.reportlet.maxItemValue);currentMaxValue=bundle_module.q.round(currentMaxValue,2);var maxValueForSlider=this.highestPossibleMaxValue,maxValuePrecision=maxValueForSlider>=10?0:2;return react_default.a.createElement("div",null,react_default.a.createElement(ui_core_build_bundle_module.B,null,Object(l10nify_build_bundle_module.a)("Map Type")),react_default.a.createElement(ui_core_build_bundle_module.S.Group,{vertical:!0,selectedValue:props.subPanel.reportlet.mapType},react_default.a.createElement(ui_core_build_bundle_module.S,{label:Object(l10nify_build_bundle_module.a)("Bubbles"),value:"bubbles",onChange:function(){_this5.mapTypeChanged("bubbles")},"data-test-id":"map-settings-bubbles"},"\xa0\xa0",react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"helpCircle",size:"XS","data-tooltip-immediate":Object(l10nify_build_bundle_module.a)("Plot events using bubbles.")})),react_default.a.createElement(ui_core_build_bundle_module.S,{label:Object(l10nify_build_bundle_module.a)("Heatmap"),value:"heatmap",onChange:function(){_this5.mapTypeChanged("heatmap")},"data-test-id":"map-settings-heatmap"},"\xa0\xa0",react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"helpCircle",size:"XS","data-tooltip-immediate":Object(l10nify_build_bundle_module.a)("Plot events using a heatmap.")}))),react_default.a.createElement(ui_core_build_bundle_module.B,{style:{marginTop:"15px"}},Object(l10nify_build_bundle_module.a)("Styles")),react_default.a.createElement("div",{className:"settings-select no-flex","data-test-id":"map-color-theme"},Object(l10nify_build_bundle_module.a)("Color Theme"),":",react_default.a.createElement(ui_core_build_bundle_module.W.Inline,{className:"inline-select",required:!0,hideArrow:!1,options:colorThemes,value:props.subPanel.reportlet.colorTheme,onChange:function(item){_this5.mapColorThemeChanged(item)}})),react_default.a.createElement("div",{className:"settings-select no-flex","data-test-id":"map-style"},Object(l10nify_build_bundle_module.a)("Map Style"),":",react_default.a.createElement(ui_core_build_bundle_module.W.Inline,{className:"inline-select",required:!0,hideArrow:!1,options:mapStyles,value:props.subPanel.reportlet.mapStyle,onChange:function(item){_this5.mapStyleChanged(item)}})),react_default.a.createElement("div",{className:classnames_default()({"ad-disabled-text":"heatmap"===props.subPanel.reportlet.mapType}),style:{marginTop:"20px"}},Object(l10nify_build_bundle_module.a)("Cluster Radius"),":\xa0\xa0",props.subPanel.reportlet.clusterRadius,"\xa0\xa0",react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"helpCircle",size:"XS","data-tooltip-immediate":Object(l10nify_build_bundle_module.a)("Groups data points together by proximity. (Only applicable for bubble visualization.)")}),react_default.a.createElement(ui_core_build_bundle_module.bb,{disabled:"heatmap"===props.subPanel.reportlet.mapType,step:1,min:0,max:100,leftLabel:0,rightLabel:100,defaultValue:props.subPanel.reportlet.clusterRadius,onChange:this.onClusterSliderChange.bind(this),style:{width:"200px"}})),react_default.a.createElement("div",{style:{marginTop:"30px",marginBottom:"20px"}},react_default.a.createElement(ui_core_build_bundle_module.k,{checked:props.subPanel.reportlet.useCustomMaxValue,onChange:this.onUseCustomMaxValueClick.bind(this),size:"S","data-test-id":"map-use-custom-max-value"},Object(l10nify_build_bundle_module.a)("Custom Max Value:")),react_default.a.createElement(ui_core_build_bundle_module.l,{style:{width:"auto",padding:"5px 0px",minWidth:0,height:"26px",display:"inline-block",verticalAlign:"bottom",marginBottom:"2px"},disabled:!props.subPanel.reportlet.useCustomMaxValue,value:this.format(currentMaxValue,{precision:-1}),onChange:this.onManualMaxValueInput.bind(this)}),react_default.a.createElement("span",{style:{display:"inline-block",paddingLeft:"5px",lineHeight:"27px"}},react_default.a.createElement(ui_core_build_bundle_module.C,{style:{zIndex:2},icon:"helpCircle",size:"XS","data-tooltip-immediate":Object(l10nify_build_bundle_module.a)("Sets the value for the largest circles and most intense colors.")})),react_default.a.createElement(ui_core_build_bundle_module.bb,{ref:function(node){return _this5.maxValueSlider=node},disabled:!props.subPanel.reportlet.useCustomMaxValue,step:.01,min:.01,max:maxValueForSlider,leftLabel:0,rightLabel:this.format(maxValueForSlider,{precision:maxValuePrecision}),defaultValue:currentMaxValue,onChange:function(value){_this5.onMaxValueSliderChange(bundle_module.q.round(value,maxValuePrecision))},style:{width:"200px"}})))}},{key:"highestPossibleMaxValue",get:function(){return+bundle_module.q.max([this.props.subPanel.reportlet.initialCustomMaxValue?this.props.subPanel.reportlet.initialCustomMaxValue:0,this.props.subPanel.reportlet.maxItemValue,.001])}}]),Settings}(ui_build_bundle_module.d),MapReportlet_MapReportlet.SubPanelConfig=MapReportletConfig_MapReportletConfig,MapReportlet_MapReportlet.InlineConfig=MapReportletConfig_MapReportletConfig;var ScatterReportlet_ScatterReportlet=function(_VizReportlet){function ScatterReportlet(props,context){var _this;return Object(classCallCheck.a)(this,ScatterReportlet),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(ScatterReportlet).call(this,props,context))).state={},_this}return Object(inherits.a)(ScatterReportlet,_VizReportlet),Object(createClass.a)(ScatterReportlet,[{key:"_highlightDataSource",value:function(_ref){var _this2=this;_ref.dataPoint.value("_cell").parent.cells.forEach(function(cell){_this2.$panel.find(".cell_"+cell.id).addClass("chart-hover")})}},{key:"setForceZero",value:function(val){this.reportlet.forceZero=val}},{key:"vizLibraryType",get:function(){return"Scatter"}},{key:"vizComponentOpts",get:function(){var opts=Object(esm_get.a)(Object(getPrototypeOf.a)(ScatterReportlet.prototype),"vizComponentOpts",this);return Object.assign({},opts,{legendVisible:this.reportlet.legendVisible,numItems:this.reportlet.numItems,forceZero:this.reportlet.forceZero,setForceZero:this.setForceZero.bind(this)})}}]),ScatterReportlet}(VizReportlet_VizReportlet);ScatterReportlet_ScatterReportlet.Settings=function(props){return react_default.a.createElement("div",{className:"ad-Popover-section1"},react_default.a.createElement(VizSettings2_VizSettings2.VizSettingsHeader,null),react_default.a.createElement(VizSettings2_VizSettings2.Percentages,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LegendVisible,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LimitMaxItems,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.ForceZeroYAxis,{subPanel:props.subPanel}))};var SummaryChangeReportlet_SummaryChangeReportlet=function(_VizReportlet){function SummaryChangeReportlet(props,context){var _this;return Object(classCallCheck.a)(this,SummaryChangeReportlet),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(SummaryChangeReportlet).call(this,props,context))).state={},_this}return Object(inherits.a)(SummaryChangeReportlet,_VizReportlet),Object(createClass.a)(SummaryChangeReportlet,[{key:"vizLibraryType",get:function(){return"SummaryChange"}},{key:"vizComponentOpts",get:function(){var opts=Object(esm_get.a)(Object(getPrototypeOf.a)(SummaryChangeReportlet.prototype),"vizComponentOpts",this);return Object.assign({},opts,{legendVisible:this.reportlet.legendVisible,displayType:this.reportlet.displayType})}}]),SummaryChangeReportlet}(VizReportlet_VizReportlet);SummaryChangeReportlet_SummaryChangeReportlet.Settings=function(props){return react_default.a.createElement("div",null,react_default.a.createElement("div",{className:"ad-Popover-section1"},react_default.a.createElement(VizSettings2_VizSettings2.VizSettingsHeader,null),react_default.a.createElement(VizSettings2_VizSettings2.Percentages,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LegendVisible,{subPanel:props.subPanel})),react_default.a.createElement("div",{className:"ad-Popover-section1"},react_default.a.createElement(VizSettings2_VizSettings2.VizSettingsHeader,{label:Object(l10nify_build_bundle_module.a)("Summary Change Options")}),react_default.a.createElement(ui_core_build_bundle_module.B,null,Object(l10nify_build_bundle_module.a)("Display Type")),react_default.a.createElement(ui_core_build_bundle_module.S,{size:"block",label:Object(l10nify_build_bundle_module.a)("Show Percent Change"),checked:"change"===props.subPanel.reportlet.displayType,onChange:function(e){props.subPanel.reportlet.displayType="change"},"data-test-id":"summary-change-show-percent-change"}),react_default.a.createElement(ui_core_build_bundle_module.S,{size:"block",label:Object(l10nify_build_bundle_module.a)("Show Raw Difference"),checked:"difference"===props.subPanel.reportlet.displayType,onChange:function(e){props.subPanel.reportlet.displayType="difference"},"data-test-id":"summary-change-show-raw-difference"}),react_default.a.createElement(VizSettings2_VizSettings2.AbbreviateValue,{className:"setting-indent",disabled:"difference"!==props.subPanel.reportlet.displayType,subPanel:props.subPanel})))};var SummaryNumberReportlet_SummaryNumberReportlet=function(_VizReportlet){function SummaryNumberReportlet(props,context){var _this;return Object(classCallCheck.a)(this,SummaryNumberReportlet),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(SummaryNumberReportlet).call(this,props,context))).state={},_this}return Object(inherits.a)(SummaryNumberReportlet,_VizReportlet),Object(createClass.a)(SummaryNumberReportlet,[{key:"vizLibraryType",get:function(){return"SummaryNumber"}},{key:"vizComponentOpts",get:function(){var opts=Object(esm_get.a)(Object(getPrototypeOf.a)(SummaryNumberReportlet.prototype),"vizComponentOpts",this);return Object.assign({},opts,{legendVisible:this.reportlet.legendVisible,abbreviateValue:this.reportlet.abbreviateValue,placeholderText:Object(l10nify_build_bundle_module.a)("No Data")})}}]),SummaryNumberReportlet}(VizReportlet_VizReportlet);SummaryNumberReportlet_SummaryNumberReportlet.Settings=function(props){return react_default.a.createElement("div",null,react_default.a.createElement("div",{className:"ad-Popover-section1"},react_default.a.createElement(VizSettings2_VizSettings2.VizSettingsHeader,null),react_default.a.createElement(VizSettings2_VizSettings2.Percentages,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LegendVisible,{subPanel:props.subPanel})),react_default.a.createElement("div",{className:"ad-Popover-section1"},react_default.a.createElement(VizSettings2_VizSettings2.VizSettingsHeader,{label:Object(l10nify_build_bundle_module.a)("Summary Number Options")}),react_default.a.createElement(VizSettings2_VizSettings2.AbbreviateValue,{subPanel:props.subPanel})))};var TextReportlet_TextReportlet=function(_VizReportlet){function TextReportlet(props,context){var _this;return Object(classCallCheck.a)(this,TextReportlet),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(TextReportlet).call(this,props,context))).state={},_this.startWithOpen=_this.reportlet.addedFromUser,_this.reportlet.textContent||(_this.reportlet.textContent=""),_this.reportlet.addedFromUser=void 0,_this}return Object(inherits.a)(TextReportlet,_VizReportlet),Object(createClass.a)(TextReportlet,[{key:"focus",value:function(){this.richContentEditable.focus()}},{key:"_render",value:function(){var _this2=this;return react_default.a.createElement(ui_build_bundle_module.U,{size:"block",startWithEditorOpen:this.startWithOpen,value:this.reportlet.textContent,placeholder:Object(l10nify_build_bundle_module.a)("Enter text here"),onChange:function(v){_this2.reportlet.textContent=v},saveOnBlur:!0,persist:!0,ref:function(_ref){return _this2.richContentEditable=_ref}})}}]),TextReportlet}(VizReportlet_VizReportlet);TextReportlet_TextReportlet.Settings=function(props){return react_default.a.createElement("div",null)},TextReportlet_TextReportlet.showSettings=null;var TreemapReportlet_TreemapReportlet=function(_VizReportlet){function TreemapReportlet(props,context){var _this;return Object(classCallCheck.a)(this,TreemapReportlet),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(TreemapReportlet).call(this,props,context))).state={},_this}return Object(inherits.a)(TreemapReportlet,_VizReportlet),Object(createClass.a)(TreemapReportlet,[{key:"_highlightDataSource",value:function(_ref){var cellId=_ref.dataPoint.id;this.$panel.find(".cell_"+cellId).addClass("chart-hover")}},{key:"vizLibraryType",get:function(){return"Treemap"}},{key:"vizComponentOpts",get:function(){var opts=Object(esm_get.a)(Object(getPrototypeOf.a)(TreemapReportlet.prototype),"vizComponentOpts",this);return Object.assign({},opts,{numItems:this.reportlet.numItems})}}]),TreemapReportlet}(VizReportlet_VizReportlet);TreemapReportlet_TreemapReportlet.Settings=function(props){return react_default.a.createElement("div",{className:"ad-Popover-section1"},react_default.a.createElement(VizSettings2_VizSettings2.VizSettingsHeader,null),react_default.a.createElement(VizSettings2_VizSettings2.Percentages,{subPanel:props.subPanel}),react_default.a.createElement(VizSettings2_VizSettings2.LimitMaxItems,{subPanel:props.subPanel}))};var server_browser=__webpack_require__(965),server_browser_default=__webpack_require__.n(server_browser),VennReportlet_VennReportlet=function(_VizReportlet){function VennReportlet(props,context){var _this;return Object(classCallCheck.a)(this,VennReportlet),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(VennReportlet).call(this,props,context))).state={},_this}return Object(inherits.a)(VennReportlet,_VizReportlet),Object(createClass.a)(VennReportlet,[{key:"getContextMenuProps",value:function(params){var _this2=this;return{items:[{label:Object(l10nify_build_bundle_module.a)("Create Segment from Selection"),onClick:function(){var _onClick=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(f){var components,segment;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return components=params.items.map(function(item){return item.value("columnComponent")}),_context.next=3,build_bundle_module.ec.fromComponents(components,_this2.app);case 3:segment=_context.sent,_this2.app.inAppEditors.showSegmentBuilder({segment:segment});case 5:case"end":return _context.stop()}},_callee)}));return function(_x){return _onClick.apply(this,arguments)}}()}]}}},{key:"tooltipContent",value:function(_ref){var _this3=this,d=_ref.d,sets=(_ref.i,_ref.j,_ref.sets),overlapSize=d.size,labels=[d.label],setData=[];sets.length>1&&(labels=sets.map(function(set){return set.value("label")}),setData=sets.map(function(set){if(0===set.size)return null;var setPercentage=overlapSize/set.value("size");return{label:set.value("label"),formattedPercent:_this3.format(setPercentage,{type:"percent"}),formattedSize:_this3.format(set.value("size"),{type:"int"})}}),setData=bundle_module.q.compact(setData));var viz=bundle_module.q.get(this,"vizComponent.viz"),formatOpts=bundle_module.q.get(this,"vizComponent.viz._opts.data.numberFormatOptions",{}),metricValue=viz?viz.formatNumber(d.size,formatOpts):this.format(d.size),tooltip=react_default.a.createElement("div",null,react_default.a.createElement("div",{className:"series-name"},labels.map(function(label,i){return react_default.a.createElement("div",{key:i},label)})),react_default.a.createElement("div",{className:"metric-value"},metricValue),!!setData.length&&react_default.a.createElement("div",{className:"metric-name"},setData.map(function(set,i){return react_default.a.createElement("div",{key:i},Object(l10nify_build_bundle_module.a)("%1$s of %2$s (%3$s)",[set.formattedPercent,set.label,set.formattedSize]))})));return server_browser_default.a.renderToStaticMarkup(tooltip)}},{key:"vizLibraryType",get:function(){return"Venn"}},{key:"vizComponentOpts",get:function(){var opts=Object(esm_get.a)(Object(getPrototypeOf.a)(VennReportlet.prototype),"vizComponentOpts",this);return Object.assign({},opts,{legendVisible:this.reportlet.legendVisible,tooltipContent:this.tooltipContent.bind(this)})}}]),VennReportlet}(VizReportlet_VizReportlet);VennReportlet_VennReportlet.Settings=function(props){return react_default.a.createElement("div",{className:"ad-Popover-section1"},react_default.a.createElement(VizSettings2_VizSettings2.VizSettingsHeader,null),react_default.a.createElement(VizSettings2_VizSettings2.LegendVisible,{subPanel:props.subPanel}))},VennReportlet_VennReportlet.SubPanelConfig=function(_VizConfig){function VennConfig(props,context){var _this4;return Object(classCallCheck.a)(this,VennConfig),(_this4=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(VennConfig).call(this,props,context))).state={metrics:[],segments:[]},_this4}return Object(inherits.a)(VennConfig,_VizConfig),Object(createClass.a)(VennConfig,[{key:"onConfigComplete",value:function(){var _this5=this;this.props.reportlet.modifyLinkedSource(this.app).then(function(){_this5.props.reportlet.linkedSource.load({app:_this5.app,reportSuite:_this5.app.reportSuite})})}},{key:"_postProcess",value:function(){this.props.subPanel.emit("configComplete")}},{key:"render",value:function(){var _this6=this,segmentProps={components:this.props.reportlet.segments,limit:3,onChange:function(_ref2){var value=_ref2.value;_this6.props.reportlet.segments=value}},metricProps={components:this.props.reportlet.metrics,limit:1,onChange:function(_ref3){var value=_ref3.value;_this6.props.reportlet.metrics=value},isSupportedComponent:function(component){return"metrics/estimatedpeople"!==component.id}},isDataValid=1===this.props.reportlet.metrics.length&&this.props.reportlet.segments.length>=2;return react_default.a.createElement("div",{className:"an-chart-config an-panel-config"},react_default.a.createElement("div",{className:"an-chart-config-wrap"},react_default.a.createElement(VennReportlet_VennPillGroup,{title:Object(l10nify_build_bundle_module.a)("Add up to 3 Segments")},react_default.a.createElement(ui_build_bundle_module.n.Segment,Object.assign({},segmentProps,{alignPillsVertically:!0}))),react_default.a.createElement(VennReportlet_VennPillGroup,{title:Object(l10nify_build_bundle_module.a)("Add one Metric")},react_default.a.createElement(ui_build_bundle_module.n.Metric,metricProps)),react_default.a.createElement("div",{className:"panel-config-column run-comparison-column"},react_default.a.createElement(ui_core_build_bundle_module.f,{className:"coral-Button coral-Button--primary run-comparison-button",disabled:!isDataValid,onClick:this.onConfigComplete.bind(this),"data-test-id":"venn-build-btn",label:Object(l10nify_build_bundle_module.a)("Build")}))))}}]),VennConfig}(VizConfig_VizConfig);var VennReportlet_VennPillGroup=function(props){return react_default.a.createElement("div",{className:"panel-config-column"},react_default.a.createElement(ui_core_build_bundle_module.B,{className:"panel-config-heading segment-heading",label:props.title}),props.children)};function _templateObject5(){var data=Object(taggedTemplateLiteral.a)(["",", Rolling Cohort"]);return _templateObject5=function(){return data},data}function _templateObject4(){var data=Object(taggedTemplateLiteral.a)(["Dimension Column **(",")**"]);return _templateObject4=function(){return data},data}function _templateObject3(){var data=Object(taggedTemplateLiteral.a)(["Retention: ",""]);return _templateObject3=function(){return data},data}function CohortConfigSummary_templateObject2(){var data=Object(taggedTemplateLiteral.a)(["Churn: ",""]);return CohortConfigSummary_templateObject2=function(){return data},data}function CohortConfigSummary_templateObject(){var data=Object(taggedTemplateLiteral.a)([", "]);return CohortConfigSummary_templateObject=function(){return data},data}var indexedComparisonLabels=bundle_module.q.indexBy(build_bundle_module.x.metricQualifierList,"value"),indexedJoinOperators=bundle_module.q.indexBy(build_bundle_module.x.metricBooleanOperators,"value"),CohortConfigSummary_CohortCriteriaSummary=function(_React$Component){function CohortCriteriaSummary(){return Object(classCallCheck.a)(this,CohortCriteriaSummary),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(CohortCriteriaSummary).apply(this,arguments))}return Object(inherits.a)(CohortCriteriaSummary,_React$Component),Object(createClass.a)(CohortCriteriaSummary,[{key:"getTitle",value:function(){return this.props.isInclusion?Object(l10nify_build_bundle_module.a)("Inclusion:"):Object(l10nify_build_bundle_module.a)("Return:")}},{key:"getJoinOperator",value:function(metricOperator){var labelAndValue=indexedJoinOperators[metricOperator];return labelAndValue?labelAndValue.label:metricOperator}},{key:"render",value:function(){var criteria=this.props.criteria,metricSummaries=criteria.metricComparisons.map(function(c,i){return react_default.a.createElement(CohortConfigSummary_MetricComparisonSummary,{key:JSON.stringify(c)+i,metricComparison:c})}),segmentSummaries=criteria.segments.map(function(s){return react_default.a.createElement(ui_core_build_bundle_module.J,{key:JSON.stringify(s),variant:"inline"},"**".concat(s.label||s.name,"**"))});return react_default.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",marginRight:5}},react_default.a.createElement("span",null,this.getTitle(),"\xa0"),function(arr,Separator){var nextArray=[];return arr.forEach(function(item,index){nextArray.push(item),index<arr.length-1&&nextArray.push(react_default.a.createElement(Separator,{key:"separator"+index}))}),nextArray}(metricSummaries.concat(segmentSummaries),function(){return react_default.a.createElement("span",null,Object(l10nify_build_bundle_module.a)(CohortConfigSummary_templateObject()),"\xa0")}))}}]),CohortCriteriaSummary}(react_default.a.Component),CohortConfigSummary_MetricComparisonSummary=function(_React$Component2){function MetricComparisonSummary(){return Object(classCallCheck.a)(this,MetricComparisonSummary),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(MetricComparisonSummary).apply(this,arguments))}return Object(inherits.a)(MetricComparisonSummary,_React$Component2),Object(createClass.a)(MetricComparisonSummary,[{key:"getComparisonOperator",value:function(comparisonType){var comparison=indexedComparisonLabels[comparisonType];return comparison?comparison.label:comparisonType}},{key:"render",value:function(){var metricComparison=this.props.metricComparison;return react_default.a.createElement(ui_core_build_bundle_module.J,{variant:"inline"},"**".concat(metricComparison.metric.label||metricComparison.metric.name,"** ").concat(this.getComparisonOperator(metricComparison.comparisonType)," ").concat(String(metricComparison.value)))}}]),MetricComparisonSummary}(react_default.a.Component),CohortConfigSummary_CohortConfigSummary=function(_React$Component3){function CohortConfigSummary(){return Object(classCallCheck.a)(this,CohortConfigSummary),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(CohortConfigSummary).apply(this,arguments))}return Object(inherits.a)(CohortConfigSummary,_React$Component3),Object(createClass.a)(CohortConfigSummary,[{key:"getMainTitle",value:function(){var isChurn=this.props.reportlet.churn,secondTitle=this.getSecondTitle();return secondTitle?isChurn?Object(l10nify_build_bundle_module.a)(CohortConfigSummary_templateObject2(),secondTitle):Object(l10nify_build_bundle_module.a)(_templateObject3(),secondTitle):isChurn?Object(l10nify_build_bundle_module.a)("Churn"):Object(l10nify_build_bundle_module.a)("Retention")}},{key:"getSecondTitle",value:function(){var part1,reportlet=this.props.reportlet,rolling=this.props.reportlet.rollingCohortEnabled;return part1=reportlet.dimensionColumnEnabled&&reportlet.dimension?Object(l10nify_build_bundle_module.a)(_templateObject4(),reportlet.dimension.label):reportlet.latencyTableEnabled?Object(l10nify_build_bundle_module.a)("Latency Table"):"",rolling&&part1?Object(l10nify_build_bundle_module.a)(_templateObject5(),part1):rolling?Object(l10nify_build_bundle_module.a)("Rolling Cohort"):part1}},{key:"render",value:function(){var reportlet=this.props.reportlet;return react_default.a.createElement("div",null,react_default.a.createElement(ui_core_build_bundle_module.y,null,react_default.a.createElement(ui_core_build_bundle_module.J,{varaint:"inline"},this.getMainTitle())),react_default.a.createElement("div",{className:"an-CohortConfigSummary-wrapper"},react_default.a.createElement(CohortConfigSummary_CohortCriteriaSummary,{isInclusion:!0,criteria:reportlet.inclusionCriteria}),react_default.a.createElement(CohortConfigSummary_CohortCriteriaSummary,{isInclusion:!1,criteria:reportlet.returnCriteria}),react_default.a.createElement(ui_core_build_bundle_module.C,{onClick:function(){return reportlet.isConfigVisible=!0},"data-test-id":"cohort-pencil",className:"an-CohortConfigSummary-pencil  hide-for-print",icon:"edit",size:"XS"})))}}]),CohortConfigSummary}(react_default.a.Component);var cohortReportletDragDrop=function(reactComponent){var isIE=dom_util_build_bundle_module.a.isIE(),ieVersion=dom_util_build_bundle_module.a.ieVersion(),subPanel=reactComponent.props.subPanel,reportlet=reactComponent.props.reportlet,$el=reactComponent.$el;function isBlacklistedForSelection($tgt){return $tgt.add($tgt.parentsUntil(".js-selectable")).is(".js-not-selectable")}function updateSelection(method,args,selectionModel){var _selectionModel;(_selectionModel=selectionModel=selectionModel||reportlet)[method].apply(_selectionModel,Object(toConsumableArray.a)(args||[]))}reactComponent.$reportlet.on("click",".js-selectable",function(event){var $tgt=Object(ui_build_bundle_module.mb)(event.target);if(!isBlacklistedForSelection($tgt)){var cell=reactComponent.getCellAndRowFromElement(event.currentTarget).cell;if(!cell||cell.parent.isHeaderRow)return;event.shiftKey?updateSelection("selectRange",[reportlet.anchorCell||cell,$tgt.hasClass("an-FreeformTable-rowNum")?cell.parent.cells[cell.parent.cells.length-1]:cell]):event.ctrlKey||event.metaKey?!cell.selected&&$tgt.hasClass("an-FreeformTable-rowNum")?updateSelection("selectRow",[cell.parent,!1]):cell.selected?updateSelection("unSelectCell",[cell,!1]):updateSelection("selectCell",[cell,!1]):!cell.selected&&$tgt.hasClass("an-FreeformTable-rowNum")?updateSelection("selectRow",[cell.parent]):cell.selected?updateSelection("unSelectCell",[cell]):updateSelection("selectCell",[cell,!0])}}),reactComponent.$reportlet.on("dblclick",".js-selectable",function(event){var $tgt=Object(ui_build_bundle_module.mb)(event.target),deselectOthers=!(event.ctrlKey||event.metaKey);if(!isBlacklistedForSelection($tgt)){var cell=reactComponent.getCellAndRowFromElement(event.currentTarget).cell;if(cell.parent.isHeaderRow){var startIdx=cell.index,endIdx=cell.index+cell.colspan-1;endIdx>startIdx?updateSelection("selectContiguousColumns",[startIdx,endIdx,0,deselectOthers]):updateSelection("selectColumn",[startIdx,0,deselectOthers])}else updateSelection("selectRow",[cell.parent,deselectOthers])}}),reactComponent.$reportlet.on("mousedown",".js-selectable-drag-start",function(event){var originPt,currentCell,dragStartThreshold=5,dragging=!1;function onMouseMove(event){if(isIE&&ieVersion<10&&event.preventDefault(),dragging){if(!(currentCell=reactComponent.getCellAndRowFromElement(event.currentTarget).cell)||currentCell.parent.isHeaderRow)return;currentCell!==reportlet.activeCell&&updateSelection("selectRange",[reportlet.anchorCell||currentCell,currentCell,!(event.ctrlKey||event.metaKey)])}else(function(pt1,pt2){var xs=pt2.x-pt1.x,ys=pt2.y-pt1.y;return Math.sqrt(xs*xs+ys*ys)})(originPt,{x:event.clientX,y:event.clientY})>dragStartThreshold&&(dragging=!0,updateSelection("selectRange",[currentCell=reactComponent.getCellAndRowFromElement(event.currentTarget).cell,currentCell,!(event.ctrlKey||event.metaKey)]))}isBlacklistedForSelection(Object(ui_build_bundle_module.mb)(event.target))||event.shiftKey||(originPt={x:event.clientX,y:event.clientY},Object(ui_build_bundle_module.mb)(window.document).on("mouseup",function onMouseUp(){dragging=!1,originPt=null,Object(ui_build_bundle_module.mb)(window.document).off("mouseup",onMouseUp),reactComponent.$reportlet.off("mousemove",".js-selectable",onMouseMove)}),reactComponent.$reportlet.on("mousemove",".js-selectable",onMouseMove)),event.shiftKey&&isIE&&event.preventDefault()}),$el.on("mouseenter.syncHoverWithChart",".an-CohortTable-cell",function(e){var $cell=Object(ui_build_bundle_module.mb)(e.currentTarget);reportlet.isSelecting||subPanel.linkedBy.forEach(function(linkee){var cellIds=[$cell.attr("data-cell-id")];0===$cell.index()&&(cellIds=bundle_module.q.map($cell.parent().find(".an-CohortTable-cell"),function(cell){return Object(ui_build_bundle_module.mb)(cell).attr("data-cell-id")})),linkee.reportlet.highlightDataByIds&&linkee.reportlet.highlightDataByIds(cellIds)})}),$el.on("mouseleave.syncHoverWithChart",".an-CohortTable-cell",function(e){subPanel.linkedBy.forEach(function(linkee){linkee.reportlet.unhighlightData&&linkee.reportlet.unhighlightData()})})};var CohortCriteriaConfig_SegmentsConfig=function(_Component){function SegmentsConfig(props,context){var _this;return Object(classCallCheck.a)(this,SegmentsConfig),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(SegmentsConfig).call(this,props,context))).updateSegments=_this.updateSegments.bind(Object(assertThisInitialized.a)(_this)),_this.metricBooleanOptions=build_bundle_module.x.metricBooleanOperators,_this.observe(_this.props.app,ui_build_bundle_module.f.DEFINITION_UPDATED,function(entity){_this.forceUpdate()}),_this}return Object(inherits.a)(SegmentsConfig,_Component),Object(createClass.a)(SegmentsConfig,null,[{key:"defaultProps",get:function(){return{onChange:function(){},disabled:!1}}}]),Object(createClass.a)(SegmentsConfig,[{key:"componentDidMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(SegmentsConfig.prototype),"componentDidMount",this).call(this),this.observe(this.getCriteria())}},{key:"updateSegments",value:function(res){this.getSegments().replaceAll(res.value)}},{key:"getCriteria",value:function(){this.props.reportlet;return this.props.criteria}},{key:"getSegments",value:function(){return this.getCriteria().segments}},{key:"getMetrics",value:function(){return this.getCriteria().metricComparisons.map(function(c){return c.metric})}},{key:"getMetricComparisonsInfoText",value:function(){return this.props.isInclusion?Object(l10nify_build_bundle_module.a)("The components used to define your initial visitor cohorts (max of 3 metrics)."):Object(l10nify_build_bundle_module.a)("The components used to determine if a visitor has returned (max of 3 metrics).")}},{key:"render",value:function(){var _this2=this,isInclusion=(this.props.reportlet,this.props.isInclusion),title=isInclusion?Object(l10nify_build_bundle_module.a)("Inclusion Criteria"):Object(l10nify_build_bundle_module.a)("Return Criteria");return react_default.a.createElement("div",{className:"an-CohortReportlet-config-column an-CohortReportlet-".concat(isInclusion?"Inclusion":"Return","Criteria")},react_default.a.createElement(ui_core_build_bundle_module.x,{className:"an-CohortReportlet-config-flex an-CohortReportlet-column-title"},title,react_default.a.createElement(CohortConfig_HelpIcon,{infoText:this.getMetricComparisonsInfoText()})),react_default.a.createElement(ui_core_build_bundle_module.B,{className:"an-CohortReportlet-config-bb an-CohortReportlet-column-title"},Object(l10nify_build_bundle_module.a)("Segments (optional)")),react_default.a.createElement(ui_build_bundle_module.n.Segment,{limit:10,isSupportedComponent:function(s){return!(_this2.props.disabled||s.isSegmentable&&!s.isSegmentable())&&s.id},components:this.getSegments(),onChange:this.updateSegments,placeholderLabel:Object(l10nify_build_bundle_module.a)("Drop a Segment here")}))}}]),SegmentsConfig}(react_essence_build_bundle_module.a),CohortCriteriaConfig_MetricsConfig=function(_Component2){function MetricsConfig(props,context){var _this3;return Object(classCallCheck.a)(this,MetricsConfig),(_this3=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(MetricsConfig).call(this,props,context))).updateMetrics=_this3.updateMetrics.bind(Object(assertThisInitialized.a)(_this3)),_this3.renderPill=_this3.renderPill.bind(Object(assertThisInitialized.a)(_this3)),_this3.metricBooleanOptions=build_bundle_module.x.metricBooleanOperators,_this3}return Object(inherits.a)(MetricsConfig,_Component2),Object(createClass.a)(MetricsConfig,null,[{key:"defaultProps",get:function(){return{onChange:function(){},disabled:!1}}}]),Object(createClass.a)(MetricsConfig,[{key:"componentDidMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(MetricsConfig.prototype),"componentDidMount",this).call(this),this.observe(this.getCriteria())}},{key:"getMetricComparisonsInfoText",value:function(){return this.props.isInclusion?Object(l10nify_build_bundle_module.a)("The components used to define your initial visitor cohorts (max of 3 metrics)."):Object(l10nify_build_bundle_module.a)("The components used to determine if a visitor has returned (max of 3 metrics).")}},{key:"updateMetrics",value:function(res){var metricComparisons=this.getCriteria().metricComparisons,currentConfigValues=metricComparisons.map(function(_ref){return{comparisonType:_ref.comparisonType,value:_ref.value}}),updatedMetrics=res.value,newMetricComparisons=updatedMetrics.map(function(metric,index){return new build_bundle_module.x.MetricComparison(index<currentConfigValues.length?{metric:metric,comparisonType:currentConfigValues[index].comparisonType,value:currentConfigValues[index].value}:{metric:metric})});metricComparisons.splice.apply(metricComparisons,[0,updatedMetrics.length].concat(Object(toConsumableArray.a)(newMetricComparisons)))}},{key:"getCriteria",value:function(){this.props.reportlet;return this.props.criteria}},{key:"getSegments",value:function(){return this.getCriteria().segments}},{key:"getMetrics",value:function(){return this.getCriteria().metricComparisons.map(function(c){return c.metric})}},{key:"renderPill",value:function(component,props,updateComponents,pillIndex){var _this4=this;return react_default.a.createElement("div",{key:component.id+"_"+pillIndex},react_default.a.createElement("div",{className:"an-CohortReportlet-metric-comparison"},react_default.a.createElement(ui_build_bundle_module.m,Object.assign({key:component.id,className:"an-CohortReportlet-criteria-pill an-CohortReportlet-no-flex-shrink",component:component,addORBetweenPills:props.addORBetweenPills,onRemove:function(){_this4.getCriteria().metricComparisons.splice(pillIndex,1)},onReplace:function(added,removed){return updateComponents({added:added,removed:[removed]})}},props)),react_default.a.createElement(ui_core_build_bundle_module.W,{className:"an-CohortReportlet-metricQualifierDropDown an-CohortReportlet-no-flex-shrink",autoAdjustWidth:!0,clearable:!1,searchable:!1,value:this.getCriteria().metricComparisons[pillIndex].comparisonType,options:build_bundle_module.x.metricQualifierList,canCreateNew:!1,onChange:function(obj){_this4.getCriteria();_this4.getCriteria().metricComparisons[pillIndex].comparisonType=obj.value,_this4.forceUpdate()}}),react_default.a.createElement(ui_core_build_bundle_module.M.Vertical,{ref:function(_ref2){return _this4.numericInput=_ref2},min:1,max:9,className:"an-CohortReportlet-numeric-input",value:this.getCriteria().metricComparisons[pillIndex].value,onChange:function(value){_this4.getCriteria().metricComparisons[pillIndex].value=value,_this4.props.onChange()},variant:"default"})),(pillIndex<this.getMetrics().length-1||this.getMetrics().length<3)&&react_default.a.createElement(ui_core_build_bundle_module.W,{options:this.metricBooleanOptions,clearable:!1,searchable:!1,autoAdjustWidth:!0,canCreateNew:!1,value:this.getCriteria().metricOperator,onChange:function(_ref3){var value=_ref3.value;return _this4.getCriteria().metricOperator=value},variant:"quiet"}))}},{key:"isSupportedComponent",value:function(d){return!this.props.disabled&&("metric"===d.itemType&&"int"===d.type&&d.segmentable&&!bundle_module.q.contains(["metrics/units","metrics/visitors"],d.id))}},{key:"render",value:function(){this.props.reportlet;var isInclusion=this.props.isInclusion,title=isInclusion?Object(l10nify_build_bundle_module.a)("Inclusion Criteria"):Object(l10nify_build_bundle_module.a)("Return Criteria");return react_default.a.createElement("div",{className:"an-CohortReportlet-config-column"},react_default.a.createElement(ui_core_build_bundle_module.B,{className:"an-CohortReportlet-config-bb an-CohortReportlet-column-title"},title),react_default.a.createElement("div",{className:"an-CohortReportlet-config-flex"},react_default.a.createElement(ui_build_bundle_module.n.Metric,{limit:3,onChange:this.updateMetrics,isSupportedComponent:this.isSupportedComponent.bind(this),components:this.getMetrics(),renderPill:this.renderPill,alignPillsVertically:!0,onlyAddUniqueComponents:!1,placeholderLabel:Object(l10nify_build_bundle_module.a)("Drop a Metric here"),"data-test-id":isInclusion?"cohort-table-inclusion-metric":"cohort-table-exclusion-metric"})))}}]),MetricsConfig}(react_essence_build_bundle_module.a),CohortConfig_CohortConfig=(__webpack_require__(967),function(_AppComponent){function CohortConfig(props,context){var _this;Object(classCallCheck.a)(this,CohortConfig),_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(CohortConfig).call(this,props,context));var reportlet=props.reportlet;return _this.granularityList=build_bundle_module.Cc,_this.metricQualifierList=build_bundle_module.x.metricQualifierList,_this.observe(reportlet),_this}return Object(inherits.a)(CohortConfig,_AppComponent),Object(createClass.a)(CohortConfig,[{key:"onHeaderGearClick",value:function(){this.props.reportlet.isConfigVisible=!this.props.reportlet.isConfigVisible,this.setState({})}},{key:"handleBlur",value:function(type,e){""===e.currentTarget.value&&(""===this.props.reportlet.returnComparisonValue&&(this.props.reportlet.returnComparisonValue="1"),""===this.props.reportlet.inclusionComparisonValue&&(this.props.reportlet.inclusionComparisonValue="1"))}},{key:"constrainNumericKeypress",value:function(e){!e.charCode||ui_build_bundle_module.H.isNumericKeypress(e.charCode)&&"0"!==String.fromCharCode(e.charCode)||e.preventDefault()}},{key:"resetHeader",value:function(){var reportlet=this.props.reportlet;reportlet.cohortTable.tableLoaded=!1,reportlet.cohortTable.tableOutOfSync=!1,reportlet.clearAllAlerts(),reportlet.clearAll(),reportlet.cohortTable.finalRows=[],reportlet.cohortTable.headerRow=new build_bundle_module.y,reportlet.dimension=void 0,reportlet.dimensionColumnEnabled=!1,reportlet.churn=!1,reportlet.rollingCohortEnabled=!1,reportlet.latencyTableEnabled=!1}},{key:"validateBuildButton",value:function(){this.props.reportlet.emitLoad(),this.props.reportlet.isConfigVisible=!1}},{key:"onMetricChange",value:function(property,event){this.props.reportlet[property]=event.value,this.forceUpdate()}},{key:"getSelectedAdvancedRadioValue",value:function(){var reportlet=this.props.reportlet;return reportlet.latencyTableEnabled||reportlet.dimensionColumnEnabled?reportlet.latencyTableEnabled?"latency":reportlet.dimensionColumnEnabled?"dimensionColumn":void 0:""}},{key:"onMetricCriteriaChange",value:function(){this.forceUpdate()}},{key:"getCohortTrackingParams",value:function(){var reportlet=this.props.reportlet,cohortSettingsList=[];return reportlet.rollingCohortEnabled&&cohortSettingsList.push("Rolling Calculation"),reportlet.latencyTableEnabled&&cohortSettingsList.push("Latency Table"),reportlet.dimensionColumnEnabled&&cohortSettingsList.push("Custom Dimension Cohort"),{granularityValue:reportlet.granularityValue,inclusionMetrics:bundle_module.q.pluck(reportlet.inclusionMetrics,"id").join(","),returnMetrics:bundle_module.q.pluck(reportlet.returnMetrics,"id").join(","),inclusionSegments:bundle_module.q.pluck(reportlet.inclusionSegments,"name").join(","),returnSegments:bundle_module.q.pluck(reportlet.returnSegments,"name").join(","),cohortType:reportlet.churn?"Churn":"Retention",cohortSettings:cohortSettingsList.join(","),numInclusionMetrics:reportlet.inclusionMetrics.length,numReturnMetrics:reportlet.returnMetrics.length,numInclusionSegments:reportlet.inclusionSegments.length,numReturnSegments:reportlet.returnSegments.length}}},{key:"render",value:function(){var _this2=this,reportlet=this.props.reportlet;return react_default.a.createElement("div",{className:"an-CohortReportlet-config"},react_default.a.createElement("div",{"data-test-id":"cohort-reportlet-config-wrapper",className:"an-CohortReportlet-animate-height",style:{verticalAlign:"bottom",maxHeight:reportlet.isConfigVisible?2e3:0,minWidth:800}},react_default.a.createElement("div",{className:"an-CohortReportlet-config-row"},react_default.a.createElement(CohortCriteriaConfig_SegmentsConfig,{disabled:!this.props.reportlet.isConfigVisible,reportlet:reportlet,criteria:reportlet.inclusionCriteria,isInclusion:!0,app:this.app}),react_default.a.createElement(CohortCriteriaConfig_SegmentsConfig,{disabled:!this.props.reportlet.isConfigVisible,reportlet:reportlet,criteria:reportlet.returnCriteria,isInclusion:!1,app:this.app})),react_default.a.createElement("div",{className:"an-CohortReportlet-config-row"},react_default.a.createElement(CohortCriteriaConfig_MetricsConfig,{disabled:!reportlet.isConfigVisible,onChange:this.onMetricCriteriaChange.bind(this),reportlet:reportlet,criteria:reportlet.inclusionCriteria,isInclusion:!0}),react_default.a.createElement(CohortCriteriaConfig_MetricsConfig,{disabled:!reportlet.isConfigVisible,onChange:this.onMetricCriteriaChange.bind(this),reportlet:reportlet,criteria:reportlet.returnCriteria,isInclusion:!1})),react_default.a.createElement("div",{className:"an-CohortReportlet-config-centered-row"},react_default.a.createElement("div",{className:"an-CohortReportlet-config-centered-column",style:{marginRight:50}},react_default.a.createElement(ui_core_build_bundle_module.B,null,Object(l10nify_build_bundle_module.a)("Granularity")),react_default.a.createElement(ui_core_build_bundle_module.W,{className:"an-CohortReportlet-configGranularitySelect",clearable:!1,searchable:!1,autoAdjustWidth:!0,variant:"quiet",value:reportlet.granularityValue,onChange:function(item){reportlet.granularityValue=item.value},options:this.granularityList}),react_default.a.createElement("br",null),react_default.a.createElement(ui_core_build_bundle_module.B,null,Object(l10nify_build_bundle_module.a)("Type")),react_default.a.createElement(ui_core_build_bundle_module.S.Group,{vertical:!0,selectedValue:reportlet.churn?"churn":"retention"},react_default.a.createElement(ui_core_build_bundle_module.S,{"data-test-id":"cohort-retention-radio",value:"retention",onChange:function(){reportlet.churn=!1}},react_default.a.createElement("span",null,Object(l10nify_build_bundle_module.a)("Retention"),react_default.a.createElement(CohortConfig_HelpIcon,{infoText:Object(l10nify_build_bundle_module.a)("A retention cohort measures how well your visitor cohorts return to your property over time.")}))),react_default.a.createElement(ui_core_build_bundle_module.S,{"data-test-id":"cohort-churn-radio",value:"churn",onChange:function(){reportlet.churn=!0}},react_default.a.createElement("span",null,Object(l10nify_build_bundle_module.a)("Churn"),react_default.a.createElement(CohortConfig_HelpIcon,{infoText:Object(l10nify_build_bundle_module.a)("A churn cohort measures how your visitor cohorts fall out of your property over time. Churn = 1 - Retention.")}))))),react_default.a.createElement("div",{className:"an-CohortReportlet-config-centered-column",style:{marginLeft:50}},react_default.a.createElement(ui_core_build_bundle_module.B,null,Object(l10nify_build_bundle_module.a)("Settings")),react_default.a.createElement(CohortConfig_FlexRow,null,react_default.a.createElement(ui_core_build_bundle_module.k,{label:Object(l10nify_build_bundle_module.a)("Rolling Calculation"),checked:reportlet.rollingCohortEnabled,name:"rolling",onChange:function(){return reportlet.rollingCohortEnabled=!reportlet.rollingCohortEnabled}}),react_default.a.createElement("span",{style:{marginLeft:-8}},react_default.a.createElement(CohortConfig_HelpIcon,{infoText:Object(l10nify_build_bundle_module.a)("Calculate retention or churn based on the previous column, rather than the Included column (default).")}))),react_default.a.createElement(CohortConfig_FlexRow,null,react_default.a.createElement(ui_core_build_bundle_module.k,{"data-test-id":"cohort-advanced-checkbox",label:Object(l10nify_build_bundle_module.a)("Advanced"),checked:reportlet.latencyTableEnabled||reportlet.dimensionColumnEnabled,onChange:function(e){reportlet.clearDimension(),reportlet.latencyTableEnabled||reportlet.dimensionColumnEnabled?(reportlet.latencyTableEnabled=!1,reportlet.dimensionColumnEnabled=!1,reportlet.clearDimension(),reportlet.dimensionSearch=new build_bundle_module.Cb):reportlet.latencyTableEnabled=!0},name:"advanced"})),react_default.a.createElement("div",{className:classnames_default()("an-CohortConfig-advanced-settings",{"an-CohortConfig-advanced-settings-disabled":!reportlet.latencyTableEnabled&&!reportlet.dimensionColumnEnabled})},react_default.a.createElement(ui_core_build_bundle_module.S.Group,{vertical:!0,selectedValue:this.getSelectedAdvancedRadioValue()},react_default.a.createElement(ui_core_build_bundle_module.S,{"data-test-id":"cohort-latency-radio",value:"latency",onChange:function(){reportlet.latencyTableEnabled=!0,reportlet.dimensionColumnEnabled=!1,reportlet.clearDimension(),reportlet.dimensionSearch=new build_bundle_module.Cb}},react_default.a.createElement("span",null,Object(l10nify_build_bundle_module.a)("Latency Table"),react_default.a.createElement(CohortConfig_HelpIcon,{infoText:Object(l10nify_build_bundle_module.a)("A latency table measures the time that has elapsed before and after the inclusion event occurred.")}))),react_default.a.createElement(ui_core_build_bundle_module.S,{value:"dimensionColumn","data-test-id":"cohort-dimension-radio",onChange:function(){reportlet.latencyTableEnabled=!1,reportlet.dimensionColumnEnabled=!0}},react_default.a.createElement("span",null,Object(l10nify_build_bundle_module.a)("Custom Dimension Cohort"),react_default.a.createElement(CohortConfig_HelpIcon,{infoText:Object(l10nify_build_bundle_module.a)("Create cohorts based on the selected dimension, rather than time-based cohorts (default).")})))),reportlet.dimensionColumnEnabled&&react_default.a.createElement(ui_build_bundle_module.n.Dimension,{components:reportlet.dimension?[reportlet.dimension]:[],limit:1,isSupportedComponent:function(dim){return!!_this2.props.reportlet.isConfigVisible},actions:[react_default.a.createElement(ui_build_bundle_module.V,{key:"mysearch",search:reportlet.dimensionSearch})],onChange:function(_ref){var value=_ref.value;reportlet.dimensionSearch=new build_bundle_module.Cb,value&&value.length>0?reportlet.dimension=value[0]:reportlet.dimension=void 0}})))),react_default.a.createElement("br",null),react_default.a.createElement("br",null),react_default.a.createElement("br",null),react_default.a.createElement("br",null),react_default.a.createElement("div",{className:"an-CohortReportlet-configButtonContainer"},react_default.a.createElement(ui_core_build_bundle_module.f,{"data-test-id":"cohort-reportlet-reset-button",className:"an-CohortReportlet-resetButton",disabled:reportlet.cohortTable.loading,onClick:this.resetHeader.bind(this),label:Object(l10nify_build_bundle_module.a)("Reset")}),react_default.a.createElement(ui_core_build_bundle_module.lb,{action:"Run Cohort Report Clicked",params:this.getCohortTrackingParams.bind(this)},react_default.a.createElement(ui_core_build_bundle_module.f,{className:"an-CohortReportlet-buildButton",variant:"primary","data-test-id":"test-cohort-build-btn",onClick:this.validateBuildButton.bind(this),label:Object(l10nify_build_bundle_module.a)("Build"),disabled:!this.props.reportlet.configSectionComplete()||reportlet.cohortTable.displayLoadingIcon||!1})))),react_default.a.createElement("div",{className:"an-CohortReportlet-animate-height overflow-truncate",style:{maxHeight:reportlet.isConfigVisible?0:500}},react_default.a.createElement(CohortConfigSummary_CohortConfigSummary,{labelClassName:"an--CohortReportlet-SearchFilter-searchValue-override",reportlet:reportlet})))}}]),CohortConfig}(ui_build_bundle_module.d)),CohortConfig_FlexRow=function(_ref2){var children=_ref2.children;return react_default.a.createElement("div",{style:{display:"flex",alignItems:"center"}},children)},CohortConfig_HelpIcon=function(_ref3){var infoText=_ref3.infoText;return react_default.a.createElement("span",{style:{marginLeft:5}},react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"helpCircle",size:"XS",style:{color:"#4b4b4b"}}),react_default.a.createElement(ui_core_build_bundle_module.kb,{variant:"info",hoverable:!0,position:"top"},react_default.a.createElement("span",null,infoText)))};__webpack_require__(968);var cohort_CohortTable=Object(react_essence_build_bundle_module.b)(function(props){var reportlet=props.reportlet,decimalSeparator=props.decimalSeparator,thousandsSeparator=props.thousandsSeparator,churn=props.reportlet.churn;function getBGColor(percentage,isInclusionCell){if(!isInclusionCell&&""!==percentage&&void 0!==percentage){var min=reportlet.cohortTable.minPercentage,max=reportlet.cohortTable.maxPercentage,result=max>min?(percentage-min)/(max-min):percentage;return churn?{backgroundColor:"rgba(215, 55, 63,"+result+")"}:{backgroundColor:"rgba(115, 180, 58,"+result+")"}}}return react_default.a.createElement("div",{"data-test-id":"cohort-table"},react_default.a.createElement("div",{className:"cohort-table-head-content"},react_default.a.createElement("div",{className:"js-cohort-table-header"},react_default.a.createElement("table",{className:classnames_default()({"an-CohortTable":reportlet.cohortTable.hasHeaderCells()})},react_default.a.createElement(ColGroup,{size:reportlet.resizeableColumnCount.length}),react_default.a.createElement("thead",null,react_default.a.createElement("tr",{className:"an-CohortTable-row"},reportlet.cohortTable.headerRow.cells.map(function(cell,index){var inclusionHeaderCellIndex=reportlet.cohortTable.headerRow.cells.length/2,isLatencyInclusionCell=reportlet.latencyTableEnabled&&index===inclusionHeaderCellIndex;return react_default.a.createElement("th",{key:cell._key,"data-cell-id":cell.id,className:"an-CohortTable-cell an-DataProvider-cell an-CohortTable-headerDimension js-selectable","data-title":!0,"data-test-id":"cohort-table-header-cell-".concat(index)},reportlet.latencyTableEnabled&&isLatencyInclusionCell&&Object(l10nify_build_bundle_module.a)("Included"),reportlet.latencyTableEnabled&&react_default.a.createElement("br",null),cell.value)})))))),react_default.a.createElement("div",{className:"an-CohortTable-container","data-test-id":"cohort-table-container"},react_default.a.createElement("table",{className:classnames_default()({"an-CohortTable":!reportlet.cohortTable.isEmpty})},react_default.a.createElement(ColGroup,{size:reportlet.resizeableColumnCount.length}),react_default.a.createElement("tbody",null,reportlet.cohortTable.finalRows.map(function(currentRow,i){return react_default.a.createElement("tr",{key:currentRow._key,className:"an-CohortTable-row"},currentRow.cells.map(function(cell,j){return react_default.a.createElement("td",{key:cell.id,className:"an-CohortTable-cell an-DataProvider-cell an-CohortTable-cellDimension js-selectable js-selectable-drag-start ",style:getBGColor(cell.percentage,cell.isInclusionCell),"data-cell-id":cell.id,"data-test-id":"cohort-table-cell-row-".concat(i,"-col-").concat(j)},react_default.a.createElement("div",{className:classnames_default()({"an-CohortTable-cellSelected":cell.selected,"an-CohortTable-cellContainer an-DataProvider-cell-container":cell.percentage||0===cell.value,"an-CohortTable-cellLabelContainer":cell.isLabelCell},"cell_"+cell.id),"data-title":!0},cell.value===Object(l10nify_build_bundle_module.a)("Invalid")?react_default.a.createElement(ui_core_build_bundle_module.m,{show:cell.value===Object(l10nify_build_bundle_module.a)("Invalid"),variant:"error",label:Object(l10nify_build_bundle_module.a)("Error loading data")}):react_default.a.createElement(ui_core_build_bundle_module.m,{show:reportlet.cohortTable.tableOutOfSync&&!cell.isLabelCell&&cell.value,variant:"warning",label:Object(l10nify_build_bundle_module.a)("Data possibly out of sync")}),react_default.a.createElement("span",{className:"value-cell"},cell.format("html",{decimalSeparator:decimalSeparator,thousandsSeparator:thousandsSeparator})),cell.showPercentage?react_default.a.createElement("span",{className:"an-CohortTable-cellPercentage"},"\xa0",null===cell.percentage?"":" "+props.format(cell.percentage,{type:"percent",precision:cell.precision})):null))}))}))),!reportlet.configSectionComplete()&&react_default.a.createElement(ui_core_build_bundle_module.b,{show:reportlet.cohortTable.isEmpty&&!reportlet.cohortTable.hasHeaderCells(),header:Object(l10nify_build_bundle_module.a)("TIP"),contents:Object(l10nify_build_bundle_module.a)("Drag an inclusion metric and return metric from the left to get started.")}),react_default.a.createElement(ui_core_build_bundle_module.qb,{show:reportlet.cohortTable.loading,variant:"overlay"})))},{prop:"reportlet",include:["cohortTable"]}),CohortReportlet_CohortReportlet=(__webpack_require__(969),function(_Reportlet){function CohortReportlet(props,context){var _this;Object(classCallCheck.a)(this,CohortReportlet),_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(CohortReportlet).call(this,props,context));props.reportlet;return _this.onSelectionChange=_this.onSelectionChange.bind(Object(assertThisInitialized.a)(_this)),_this}return Object(inherits.a)(CohortReportlet,_Reportlet),Object(createClass.a)(CohortReportlet,[{key:"componentDidMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(CohortReportlet.prototype),"componentDidMount",this).call(this),this.domNode=react_dom_default.a.findDOMNode(this),this.$el=Object(ui_build_bundle_module.mb)(this.domNode),this.$reportlet=this.$el.closest(".an-subpanel-contents"),this.setupContextMenu(),cohortReportletDragDrop(this),this.observe(this.props.reportlet,"change"),this.componentDidUpdate(),this.props.reportlet.on("change:selection",this.onSelectionChange)}},{key:"componentWillUnmount",value:function(){this.props.reportlet.off("change:selection",this.onSelectionChange)}},{key:"onSelectionChange",value:function(e){this.props.reportlet.updateLinkedByDerivedDataSourcesForSelectionChange(this.appContext)}},{key:"componentDidUpdate",value:function(){var _this2=this;setTimeout(function(){!function(reactComponent){var cohortTable=reactComponent.props.reportlet.cohortTable,$el=reactComponent.$el;cohortTable.constructor.undoIgnoredProperties=["columnWidths"],$el.find(".an-CohortTable-container .an-CohortTable").resizableColumns({selector:"col",keepAspectRatiosTheSameOnResizeFirstColumn:!0,deepestBreakdownDepth:0,setColumnWidths:function(params,forceUniformWidths){var dataColumnWidths,averageColumnWidth,dataColumnCount=params.$cols.size(),uniformWidth=100/dataColumnCount;forceUniformWidths?dataColumnWidths=bundle_module.q.fill(new Array(dataColumnCount),uniformWidth):(0===(dataColumnWidths=cohortTable.columnWidths).length&&dataColumnWidths.push(50),dataColumnWidths.length>dataColumnCount&&dataColumnWidths.splice(0,dataColumnCount),dataColumnWidths.length<dataColumnCount&&(averageColumnWidth=1===dataColumnWidths.length?dataColumnWidths[0]:bundle_module.q.sum(dataColumnWidths.slice(1))/(dataColumnWidths.length-1),dataColumnWidths=dataColumnWidths.concat(bundle_module.q.fill(new Array(dataColumnCount-dataColumnWidths.length),averageColumnWidth))),bundle_module.q.each(dataColumnWidths,function(o,k){dataColumnWidths[k]=bundle_module.q.max([o,.1])}),this._resizeColumnWidths(dataColumnWidths),dataColumnWidths[0]<9&&(dataColumnWidths[0]=9));this._resizeColumnWidths(dataColumnWidths);var $cells=params.$table.find(".an-CohortTable-row").eq(0).find(".an-CohortTable-cell");bundle_module.q.each(params.$cols,function(o,k){Object(ui_build_bundle_module.mb)(o).data("resizable-column-src-el",$cells.eq(k)),params.setWidth(o,dataColumnWidths[k])})},_resizeColumnWidths:function(dataColumnWidths){if(bundle_module.q.sum(dataColumnWidths)>105||bundle_module.q.sum(dataColumnWidths)<95){var ratio=100/bundle_module.q.sum(dataColumnWidths);bundle_module.q.each(dataColumnWidths,function(o,k){dataColumnWidths[k]=o*ratio})}},customHandleCreate:function(params){params.$handle.appendTo(params.$handleContainer)},customHandleRenderer:function(handleParams){var $headerTable=$el.find(".cohort-table-head-content .an-CohortTable"),$cell=handleParams.$srcCol.data("resizable-column-src-el"),tableHeaderHeight=$headerTable.height(),left=$cell.outerWidth()+($cell.offset().left-handleParams.$handleContainer.offset().left);handleParams.$handle.css({left:left,height:handleParams.height+tableHeaderHeight,top:-1*tableHeaderHeight})},resize:function(event,ctrl,leftCol,rightCol,leftWidth,rightWidth){var headerCells=$el.find(".cohort-table-head-content .an-CohortTable").find("col");$el.find(".an-CohortTable-container .an-CohortTable col").each(function(index,el){headerCells.get(index).style.width=this.style.width})},userResize:function(){ui_core_build_bundle_module.lb.trackAction(null,"Resized Cohort Table Column"),build_bundle_module.sc.temporarilySuspendIgnore(cohortTable,"columnWidths")},stop:function(event,ctrl,params){bundle_module.q.isEqual(cohortTable.columnWidths,params.columnWidths)||(cohortTable.columnWidths=params.columnWidths)}})}(_this2)},0)}},{key:"setupContextMenu",value:function(){var _this3=this,cohortService=new build_bundle_module.z(this.appContext),copyToClipboardMenuOption={name:Object(l10nify_build_bundle_module.a)("Copy To Clipboard"),itemType:"settings",onClick:function(){var str=_this3.props.reportlet.formatForClipboard(_this3.app);str&&(ui_build_bundle_module.i.setData(str),_this3.app.addAlert({variant:"success",contents:Object(l10nify_build_bundle_module.a)("Data copied to clipboard.")}),ui_core_build_bundle_module.lb.trackAction(null,"Right-click: Copy to Clipboard"))}};this.setupContextMenuListener(".an-CohortTable-cellLabelContainer",function(){return[copyToClipboardMenuOption]}),this.setupContextMenuListener(".an-CohortTable-cellContainer",function(elm){for(var _this4=this,cellModel=this.getCellAndRowFromElement(elm).cell,selectedCells=cellModel.parent.parent.selectedCells,isSelectedCell=!1,i=0;i<selectedCells.length;i++)if(cellModel===selectedCells[i]){isSelectedCell=!0;break}isSelectedCell||(this.props.reportlet.unSelectAll(),selectedCells=[]);var createSegment={name:selectedCells.length>1?Object(l10nify_build_bundle_module.a)("Create Segment From Selection"):Object(l10nify_build_bundle_module.a)("Create Segment From Cell"),itemType:"settings",onClick:function(){ui_core_build_bundle_module.lb.trackAction(null,"Cohort right-click: Create segment from cell");var cells=selectedCells.length>1?selectedCells:[cellModel];cohortService.openSegBuilder(cells,_this4.props.subPanel.parent)}},cohortMenu=[this.app.reportSuite.permissions.segmentCreation?createSegment:null,copyToClipboardMenuOption];return bundle_module.q.compact(cohortMenu)}.bind(this))}},{key:"setupContextMenuListener",value:function(selector,getItems){this.$el.on("contextmenu",selector,function(e){if(!e.altKey){e.preventDefault();var items=getItems(e.target);ui_core_build_bundle_module.P.closeAll(),ui_core_build_bundle_module.ab.show({target:e.target,items:items,labelKey:"name"})}})}},{key:"getCellAndRowFromElement",value:function(elm){var rowModel,cellModel,cellId=Object(ui_build_bundle_module.mb)(elm).closest("td").attr("data-cell-id")||Object(ui_build_bundle_module.mb)(elm).closest("th").attr("data-cell-id");if(cellId){var cell=bundle_module.q.find(bundle_module.q.flatten(bundle_module.q.pluck(this.props.reportlet.cohortTable.finalRows.concat(this.props.reportlet.cohortTable.headerRow),"cells")),{id:cellId});cell&&(cellModel=cell,rowModel=cell.parent)}return{cell:cellModel,row:rowModel}}},{key:"_render",value:function(){return react_default.a.createElement("div",{className:"an-CohortReportlet"},react_default.a.createElement(CohortConfig_CohortConfig,{reportlet:this.props.reportlet}),react_default.a.createElement(cohort_CohortTable,{reportlet:this.props.reportlet,decimalSeparator:this.app.user.numberLocalization.decimalSeparator,thousandsSeparator:this.app.user.numberLocalization.thousandsSeparator,format:this.format.bind(this)}))}}]),CohortReportlet}(Reportlet_Reportlet)),workspace_WorkspaceUtilities=function(){function WorkspaceUtilities(appContext){Object(classCallCheck.a)(this,WorkspaceUtilities),this.cache=appContext.app.cache,this.dateService=appContext.reportSuite.dateService,this.freeformModelUtil=new build_bundle_module.kb(appContext)}return Object(createClass.a)(WorkspaceUtilities,[{key:"trendComponents",value:function(subPanel,columnTreeNodes){var _ref=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},_ref$subPanelName=_ref.subPanelName,subPanelName=void 0===_ref$subPanelName?"":_ref$subPanelName,_ref$rowBasedPercenta=_ref.rowBasedPercentages,rowBasedPercentages=void 0===_ref$rowBasedPercenta||_ref$rowBasedPercenta;columnTreeNodes[0]instanceof build_bundle_module.fb||console.log("ERROR: You must pass columnTreeNodes to trendComponents.");var flattenedComponents=bundle_module.q.flatten(columnTreeNodes.concat(columnTreeNodes.map(function(node){return node.allNodesInTree})));flattenedComponents=flattenedComponents.map(function(node){return node.component});var hiddenSubPanel=build_bundle_module.vb.create("FreeformReportlet"),lineChart=this._addLineChartForHiddenSubPanel({subPanel:subPanel,hiddenSubPanel:hiddenSubPanel});subPanelName&&(lineChart.name=subPanelName,hiddenSubPanel.name=subPanelName);var defaultGranularity=this.dateService.getGranularityDimensionBasedOnDateRange(hiddenSubPanel.parent.dateRange.definition);bundle_module.q.set(hiddenSubPanel,"reportlet.freeformTable.settings.rowBasedPercentages",rowBasedPercentages),this.freeformModelUtil.setupReport(hiddenSubPanel.reportlet,{columnComponents:columnTreeNodes,staticRowComponents:[],dimension:this._getTrendDimensionFromComponents(flattenedComponents,defaultGranularity)})}},{key:"_addLineChartForHiddenSubPanel",value:function(_ref2){var subPanel=_ref2.subPanel,hiddenSubPanel=_ref2.hiddenSubPanel,subPanels=subPanel.parent.subPanels;subPanels.push(hiddenSubPanel),hiddenSubPanel.visible=!1,hiddenSubPanel.visualizationIndex=hiddenSubPanel.parent.nextVisualizationIndexByType(hiddenSubPanel.visualizationType);var newLineChart=build_bundle_module.vb.create("LineReportlet");return newLineChart.linkedSource=hiddenSubPanel,newLineChart.visualizationIndex=subPanel.parent.nextVisualizationIndexByType(newLineChart.visualizationType),build_bundle_module.xb.addItemAboveAnchor(newLineChart,subPanel,subPanels),newLineChart}},{key:"_getTrendDimensionFromComponents",value:function(components,defaultGranularity){var granularities={};bundle_module.q.each(components,function(component){if(component.dimensionId&&"time"===component.dimension.type){var granularity=component.dimensionId?component.dimensionId:component.id;granularities[granularity]=granularity}});var lowestGranularity=this.dateService.getLowestGranularity(bundle_module.q.values(granularities));return lowestGranularity=this.dateService.decreaseGranularity(lowestGranularity),lowestGranularity=this.dateService.getLowestGranularity([lowestGranularity,defaultGranularity]),this.cache.has(build_bundle_module.X,lowestGranularity)?this.cache.get(build_bundle_module.X,lowestGranularity):new build_bundle_module.X({id:lowestGranularity})}}]),WorkspaceUtilities}();function FalloutLegend_templateObject2(){var data=Object(taggedTemplateLiteral.a)(["All ",""]);return FalloutLegend_templateObject2=function(){return data},data}function FalloutLegend_templateObject(){var data=Object(taggedTemplateLiteral.a)(["All Visits"]);return FalloutLegend_templateObject=function(){return data},data}var FalloutLegend_FalloutLegend=function(_AppComponent){function FalloutLegend(props,context){var _this;return Object(classCallCheck.a)(this,FalloutLegend),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(FalloutLegend).call(this,props,context))).state={loading:!1},build_bundle_module.db.isActive("dropzoneGuides")&&(_this.dropIndicator=Object(ui_build_bundle_module.mb)(document.createElement("div")).addClass("generic-drop-indicator")),_this.dropTargetProps={disabled:function(draggedModels){return draggedModels instanceof Array||(draggedModels=[draggedModels]),!draggedModels.every(function(d){return ui_build_bundle_module.n.Segment.defaultProps.supportedComponentTypes.indexOf(d.constructor)>-1&&ui_build_bundle_module.n.Segment.defaultProps.isSupportedComponent(d)})},onStart:function(){_this.$el.addClass("is-dragging")},onEnd:function(){_this.$el.removeClass("is-dragging")},onDrop:function(d){var added=d.dragData;_this.setState({loading:!0}),_this._segmentUtilityService=_this._segmentUtilityService||new build_bundle_module.kc(_this.app),_this._segmentUtilityService.convertToSegments(added).then(function(segments){_this.props.onChange(_this.value.concat(segments)),_this.setState({loading:!1})}),build_bundle_module.db.isActive("dropzoneGuides")&&_this.hideDropIndicator()},onOver:function(e){build_bundle_module.db.isActive("dropzoneGuides")&&_this.showDropIndicator(e)},onLeave:function(e){build_bundle_module.db.isActive("dropzoneGuides")&&_this.hideDropIndicator()}},_this}return Object(inherits.a)(FalloutLegend,_AppComponent),Object(createClass.a)(FalloutLegend,[{key:"showDropIndicator",value:function(e){var currentDropTarget=Object(ui_build_bundle_module.mb)(e.currentTarget),elementOffset=currentDropTarget.offset();this.dropIndicator.css({left:elementOffset.left,top:elementOffset.top,width:currentDropTarget.outerWidth(),height:currentDropTarget.outerHeight()}).attr("data-text",Object(l10nify_build_bundle_module.a)("Add")).removeClass().addClass("add-icon"),this.dropIndicator.addClass("generic-drop-indicator dropzone-guides"),this.dropIndicator.parent().length||this.dropIndicator.appendTo("body")}},{key:"hideDropIndicator",value:function(){this.dropIndicator.parent().length&&this.dropIndicator.remove()}},{key:"componentDidMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(FalloutLegend.prototype),"componentDidMount",this).call(this),this.el=react_dom_default.a.findDOMNode(this),this.$el=Object(ui_build_bundle_module.mb)(this.el)}},{key:"onRemove",value:function(item){this.props.onChange(bundle_module.q.without(this.value,item))}},{key:"getLabel",value:function(id,defaultLabel){if("All_Visits"===id){var reportSuite=this.app.reportSuite;return"visits"===this.props.falloutContainer?Object(l10nify_build_bundle_module.a)(FalloutLegend_templateObject()):Object(l10nify_build_bundle_module.a)(FalloutLegend_templateObject2(),reportSuite.visitorLabelPlural)}return this.props.legendMappings.getCustomLabel(id,defaultLabel)}},{key:"render",value:function(){var _this2=this;return react_default.a.createElement(react_drag_drop_build_bundle_module.g,this.dropTargetProps,react_default.a.createElement("div",{className:classnames_default()("an-Legend","an-flex",{"dropzone-guides":build_bundle_module.db.isActive("dropzoneGuides")}),style:{height:"50px"}},react_default.a.createElement(ui_core_build_bundle_module.qb,{show:this.state.loading,variant:"overlay"}),this.value.map(function(item,i){return react_default.a.createElement("div",{className:"an-flex-content an-Legend-cell an-flex",key:item._key},react_default.a.createElement("div",{className:"an-flex-content",style:{width:"10px"}},react_default.a.createElement("div",{"data-title":!0,className:"cv-legend-title"},_this2.getLabel(item.id,item.label)),!!_this2.props.getItemColor&&react_default.a.createElement("span",{className:"cv-legend-marker bar",style:{backgroundColor:_this2.props.getItemColor(item)}}),!!_this2.props.getItemValue&&react_default.a.createElement("div",{"data-title":!0,className:"cv-legend-num"},_this2.props.getItemValue(item,i))),react_default.a.createElement(ui_build_bundle_module.M.Icon,{component:item,className:"an-Legend-icon an-Legend-cellDelete",size:"XS",previewOptions:{closestContainerSelector:".an-Legend-cell"}}),react_default.a.createElement(ui_core_build_bundle_module.C,{className:"an-Legend-icon an-Legend-cellDelete",icon:"close",size:"XS",onClick:_this2.onRemove.bind(_this2,item)}))})))}},{key:"value",get:function(){return this.props.value||[]}}]),FalloutLegend}(ui_build_bundle_module.d);__webpack_require__(970);function Fallout_templateObject3(){var data=Object(taggedTemplateLiteral.a)(["all ",""]);return Fallout_templateObject3=function(){return data},data}function Fallout_templateObject2(){var data=Object(taggedTemplateLiteral.a)(["All ",""]);return Fallout_templateObject2=function(){return data},data}function Fallout_templateObject(){var data=Object(taggedTemplateLiteral.a)(["All Visits"]);return Fallout_templateObject=function(){return data},data}var Fallout_Fallout=function(_Reportlet){function Fallout(props,context){var _this;return Object(classCallCheck.a)(this,Fallout),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(Fallout).call(this,props,context))).freeformModelUtil=new build_bundle_module.kb(_this.appContext),_this.observe(_this.reportlet),_this.observe(_this.reportlet,"loadData",_this.loadData.bind(Object(assertThisInitialized.a)(_this))),_this.observe(_this.reportlet,"change:falloutContainer",_this.loadData.bind(Object(assertThisInitialized.a)(_this))),_this.state={mouseOver:!1,dragOver:!1},_this.updateBubbles=bundle_module.q.throttle(_this.updateBubbles.bind(Object(assertThisInitialized.a)(_this)),100),_this.previewPopoverOpen=!1,_this.dropIndicator=Object(ui_build_bundle_module.mb)(document.createElement("div")),_this}return Object(inherits.a)(Fallout,_Reportlet),Object(createClass.a)(Fallout,[{key:"componentDidMount",value:function(){var _this2=this;Object(esm_get.a)(Object(getPrototypeOf.a)(Fallout.prototype),"componentDidMount",this).call(this),this.el=react_dom_default.a.findDOMNode(this),this.$el=Object(ui_build_bundle_module.mb)(this.el),this.$checkpointsContainer=Object(ui_build_bundle_module.mb)(this.checkpointsContainer),this.setupDragDrop(),this.legendHelper=new ui_core_build_bundle_module.E(this.el),this.legendHelper.setOptions({legendClassName:"an-Legend-cell",getLegendMappings:this.reportlet.getLegendMappings.bind(this.reportlet),setLegendMappings:this.reportlet.setLegendMappings.bind(this.reportlet),getCustomLabelId:this.getCustomLabelId.bind(this),onCustomLabelChange:function(_ref){var id=_ref.id,label=_ref.label;_this2.reportlet.legendMappings.addEntry({id:id,label:label}),_this2.forceUpdate()},getChart:function(){}}),this.legendHelper.initLegendRename()}},{key:"getCustomLabelId",value:function(index){return this.props.reportlet.segments[index].id}},{key:"getDroptargetLines",value:function(){return this.$checkpointsContainer.find(this.dragDataIsACheckpoint()?".an-Fallout-droptargetLine.isRow,.an-Fallout-droptargetArea":".an-Fallout-droptargetLine,.an-Fallout-droptargetArea")}},{key:"dragDataIsACheckpoint",value:function(){return"Checkpoint"===this.props.dragManager.currentDragData()._className}},{key:"_getElementClosestToPoint",value:function(cursorPoint,items){var tops=bundle_module.q.indexBy(Object(ui_build_bundle_module.mb)(items),function(item){return item.getBoundingClientRect().top}),closest=999;return bundle_module.q.each(tops,function(o,k){Math.abs(cursorPoint-k)<Math.abs(cursorPoint-closest)&&(closest=k)}),Object(ui_build_bundle_module.mb)(tops[closest])}},{key:"getDropIndicatorState",value:function($currentDropTarget){var elementOffset=$currentDropTarget.offset();this.indicator={text:Object(l10nify_build_bundle_module.a)("Add"),warningText:"",iconClass:"add-icon",warningClass:"",defaultClass:"generic-drop-indicator dropzone-guides",extraClass:"",left:elementOffset.left,top:elementOffset.top,width:$currentDropTarget.outerWidth(),height:$currentDropTarget.outerHeight()},$currentDropTarget[0].classList.contains("an-Fallout-droptargetArea")?($currentDropTarget[0].classList.add("dropzone-guides"),this.indicator.extraClass="an-Fallout-droptargetArea"):$currentDropTarget[0].classList.contains("an-Fallout-droptargetLine")&&($currentDropTarget[0].classList.add("dropzone-guides"),this.indicator.extraClass="an-Fallout-droptargetLine")}},{key:"setDropIndicatorGuide",value:function(){this.dropIndicator.removeClass().addClass("".concat(this.indicator.defaultClass," ").concat(this.indicator.iconClass," ").concat(this.indicator.extraClass," ").concat(this.indicator.warningClass)).attr("data-text","".concat(this.indicator.warningText?this.indicator.warningText:this.indicator.text)).css({left:this.indicator.left,top:this.indicator.top,width:this.indicator.width,height:this.indicator.height})}},{key:"showDropIndicator",value:function(){this.dropIndicator.parent().length||this.dropIndicator.appendTo("body")}},{key:"hideDropIndicator",value:function(){this.dropIndicator.parent().length&&this.dropIndicator.remove()}},{key:"setupDragDrop",value:function(){var _this3=this;this.$checkpointsContainer.adDropTarget({disabled:function(e){return!_this3.dragDataIsACheckpoint()&&!bundle_module.q.all(_this3.props.dragManager.currentDragData(!0),_this3.reportlet.isSupportedCheckpointItemType.bind(_this3.reportlet))},onStart:function(e){_this3.$el.addClass("display-above-backdrop")},onEnter:function(){_this3.setState({dragOver:!0})},onLeave:function(){_this3.getDroptargetLines().removeClass("selected"),_this3.setState({dragOver:!1}),_this3.hideDropIndicator()},onEnd:function(){_this3.$el.removeClass("display-above-backdrop"),_this3.getDroptargetLines().removeClass("selected"),_this3.setState({dragOver:!1}),_this3.hideDropIndicator()},onOver:function(e){var $droptargetLines=_this3.getDroptargetLines(),$currentDroptargetLine=_this3._getElementClosestToPoint(e.globalPt.y,$droptargetLines);Object(ui_build_bundle_module.mb)($droptargetLines).removeClass("selected"),$currentDroptargetLine.addClass("selected"),build_bundle_module.db.isActive("dropzoneGuides")&&(_this3.getDropIndicatorState($currentDroptargetLine),_this3.setDropIndicatorGuide(),_this3.showDropIndicator())},onDrop:function(e){var $droptargetLines=_this3.getDroptargetLines(),$currentDroptargetLine=_this3._getElementClosestToPoint(e.globalPt.y,$droptargetLines);Object(ui_build_bundle_module.mb)($droptargetLines).removeClass("selected");var checkpointIndex=$currentDroptargetLine.is(".isRow")?$currentDroptargetLine.attr("data-row-index"):$currentDroptargetLine.closest(".an-Fallout-labelRow").find(".an-Fallout-droptargetLine").eq(0).attr("data-row-index");checkpointIndex=parseInt(checkpointIndex,10);var addDraggedItemAsNewCheckpoint=1!==$currentDroptargetLine.closest(".an-Fallout-labelCell").size(),addDraggedItemToSpecificPositionWithinCheckpoint=!addDraggedItemAsNewCheckpoint,addDraggedItemToExistingCheckpoint=$currentDroptargetLine.is(".an-Fallout-droptargetArea"),dragData=_this3.props.dragManager.currentDragData(!0),dragDataIsACheckpoint=_this3.dragDataIsACheckpoint();if(addDraggedItemToExistingCheckpoint){var checkpoint=_this3.reportlet.checkpoints[checkpointIndex];if(dragDataIsACheckpoint&&bundle_module.q.get(dragData,"[0]")===checkpoint)return;var checkpoints=dragData.filter(function(i){return"Checkpoint"===i._className}),items=dragData.filter(function(i){return"Checkpoint"!==i._className});checkpoints.forEach(function(c){items=items.concat(c.items)}),checkpoint.items.insertAll(items,0),checkpoints.forEach(function(c){return _this3.reportlet.checkpoints.remove(c)}),_this3.loadData()}else if(addDraggedItemToSpecificPositionWithinCheckpoint){var insertIndex=$currentDroptargetLine.attr("data-row-index");if(!dragDataIsACheckpoint){var _checkpoint=_this3.reportlet.checkpoints[checkpointIndex],doReload=!0;1===dragData.length&&bundle_module.q.contains(_checkpoint.items,dragData[0])&&(doReload=!1),_checkpoint.items.insertAll(dragData,insertIndex),doReload&&_this3.loadData()}}else addDraggedItemAsNewCheckpoint&&(dragDataIsACheckpoint||_this3.reportlet.addCheckpointFromItems(dragData,checkpointIndex),dragDataIsACheckpoint&&_this3.reportlet.checkpoints.insert(dragData[0],checkpointIndex),_this3.loadData());build_bundle_module.db.isActive("dropzoneGuides")&&_this3.hideDropIndicator()}})}},{key:"updateBubbles",value:function(){this.$el&&this.$el.find(".an-Fallout-barItem").each(function(i,bar){var fallThroughRect,fallOutRect,$bar=Object(ui_build_bundle_module.mb)(bar),$fallThrough=$bar.find(".an-Fallout-percentageBubbleFallthrough"),$fallOut=$bar.find(".an-Fallout-percentageBubbleFallout"),fallThrough=$fallThrough.get(0),fallOut=$fallOut.get(0),barRect=bar.getBoundingClientRect();fallThrough&&(fallThroughRect=fallThrough.getBoundingClientRect()),fallOut&&($fallOut.show(),$fallOut.css("left","3px"),fallOutRect=fallOut.getBoundingClientRect());var roundToNearestHundreth=function(number){return Math.round(100*number)/100};if(fallOut&&fallOutRect.right>barRect.right-5){var newLeft=parseInt($fallOut.css("left"),10)-(fallOutRect.right-(barRect.right-5))+"px";$fallOut.css("left",newLeft),fallOutRect=fallOut.getBoundingClientRect()}if(fallThrough&&fallOut&&fallThroughRect.right>fallOutRect.left-5){var _newLeft=parseInt($fallOut.css("left"),10)+(fallThroughRect.right-(fallOutRect.left-5))+"px";$fallOut.css("left",_newLeft),fallOutRect=fallOut.getBoundingClientRect()}fallOut&&roundToNearestHundreth(fallOutRect.right)>roundToNearestHundreth(barRect.right-5)&&$fallOut.hide()})}},{key:"loadData",value:function(){var _loadData=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(){var forceUpdate,_this$app,result,_args=arguments;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return forceUpdate=!(_args.length>0&&void 0!==_args[0])||_args[0],_this$app=this.app,_this$app.appService,_this$app.reportSuite,!0===forceUpdate&&this.forceUpdate(),_context.next=5,this.reportlet.load(this.appContext);case 5:return result=_context.sent,this.forceUpdate(),_context.abrupt("return",result);case 8:case"end":return _context.stop()}},_callee,this)}));return function(){return _loadData.apply(this,arguments)}}()},{key:"onChangeSegments",value:function(val){ui_core_build_bundle_module.lb.trackAction(null,"Visualization Setting Changed",{vizSettingName:"Fallout Segments in Legend"}),val=bundle_module.q.unique(val),this.reportlet.segments.replaceAll(val),this.loadData()}},{key:"onChangeCheckpoint",value:function(checkpoint,val){var _checkpoint$items;(_checkpoint$items=checkpoint.items).splice.apply(_checkpoint$items,[0,checkpoint.items.length].concat(Object(toConsumableArray.a)(val))),this.loadData()}},{key:"onNewCheckpointChange",value:function(valObj){this.reportlet.addCheckpointFromItems(valObj.value),this.loadData()}},{key:"onRemoveCheckpointItem",value:function(checkpoint,item){checkpoint.items.remove(item),this.loadData()}},{key:"onPreviewCheckpointItem",value:function(item,event){var _this4=this;ui_core_build_bundle_module.P.closeAll(),this.previewPopoverOpen=!0,ui_build_bundle_module.M.show(item,event,{closestContainerSelector:"div",pointFrom:"right",app:this.app,onClose:function(){return!1===_this4.mouseOver&&_this4.setState({mouseOver:!1}),_this4.previewPopoverOpen=!1,!0}})}},{key:"onRightClickBar",value:function(isFallthrough,cell,event){var _this5=this;if(!event.altKey&&(event.preventDefault(),ui_core_build_bundle_module.P.closeAll(),"All_Visits"!==bundle_module.q.get(cell,"parent.checkpoint.items[0].id"))){event.stopPropagation();var items=[{name:Object(l10nify_build_bundle_module.a)("Trend touchpoint"),onClick:function(){ui_core_build_bundle_module.lb.trackAction(null,"Fallout right-click: Trend touchpoint"),_this5.trendSegment(cell.parent.getSegmentSequence(),cell)}},{name:Object(l10nify_build_bundle_module.a)("Trend touchpoint (%)"),usesAdvancedCalcMetric:!0,onClick:function(){ui_core_build_bundle_module.lb.trackAction(null,"Fallout right-click: Trend touchpoint (%)"),_this5.trendPercent(cell)}},{name:Object(l10nify_build_bundle_module.a)("Trend all touchpoints (%)"),usesAdvancedCalcMetric:!0,onClick:function(){ui_core_build_bundle_module.lb.trackAction(null,"Fallout right-click: Trend all touchpoints (%)"),_this5.trendAllTouchpointPercents(cell)}},{name:react_default.a.createElement("span",null,Object(l10nify_build_bundle_module.a)("Breakdown fallthrough at this touchpoint"),react_default.a.createElement(ui_core_build_bundle_module.C.Help,{label:Object(l10nify_build_bundle_module.a)("Fallthrough shows the immediate hit after this touchpoint for visitors that made it to the next touchpoint.")})),onClick:function(){ui_core_build_bundle_module.lb.trackAction(null,"Fallout right-click: Breakdown fallthrough at this touchpoint"),_this5.createBreakDownTable(cell.parent.getFallthroughSegment(),cell)}},{name:react_default.a.createElement("span",null,Object(l10nify_build_bundle_module.a)("Breakdown fallout at this touchpoint"),react_default.a.createElement(ui_core_build_bundle_module.C.Help,{label:Object(l10nify_build_bundle_module.a)("Fallout shows the immediate hit after the previous touchpoint for visitors that never made it to this touchpoint.")})),onClick:function(){ui_core_build_bundle_module.lb.trackAction(null,"Fallout right-click: Breakdown fallout at this touchpoint"),_this5.createBreakDownTable(cell.parent.getFalloutSegment(),cell)}},{name:Object(l10nify_build_bundle_module.a)("Create segment from touchpoint"),onClick:function(){ui_core_build_bundle_module.lb.trackAction(null,"Fallout right-click: Create segment from touchpoint"),_this5.createSegmentFromCheckpointDataRow(cell.parent,cell)}}];this.app.hasAccessToFeature("advancedCalculatedMetrics")||(items=items.filter(function(item){return!item.usesAdvancedCalcMetric})),ui_core_build_bundle_module.ab.show({target:event.target,items:items,labelKey:"name"})}}},{key:"trendSegment",value:function(segment,cell){var _this6=this,metric=this.app.cache.get(build_bundle_module.Hb,"metrics/"+this.reportlet.falloutContainer);segment.name=cell.parent.pathName,this.app.repo.save(segment).then(function(savedSegment){var columnNode=_this6._createColumnNodes(metric,savedSegment,cell);_this6.workspaceUtilities.trendComponents(_this6.props.subPanel,[columnNode],{subPanelName:savedSegment.name})})}},{key:"getSegmentAndPercentCalcMetricForTouchpoint",value:function(){var _getSegmentAndPercentCalcMetricForTouchpoint=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee2(cell){var totalSegment,metric,segment,calculatedMetric;return regenerator_default.a.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if((totalSegment=build_bundle_module.ec.fromJSON(build_bundle_module.ec.ALL_VISITS.toJSON())).name="visits"===this.falloutContainer?Object(l10nify_build_bundle_module.a)(Fallout_templateObject()):Object(l10nify_build_bundle_module.a)(Fallout_templateObject2(),this.app.reportSuite.visitorLabelPlural),this.reportlet.hasAllVisitsAsFirstCheckpoint()){_context2.next=6;break}return _context2.next=5,build_bundle_module.ec.fromComponents(this.reportlet.checkpoints[0].items,this.app,{internal:!0,save:!0,rootContext:this.reportlet.falloutContainer});case 5:totalSegment=_context2.sent;case 6:return metric=build_bundle_module.Hb.fromCache(this.app.cache,{id:"metrics/"+this.reportlet.falloutContainer}),_context2.next=9,this.app.repo.save(cell.parent.getSegmentSequence());case 9:return(segment=_context2.sent).name=cell.parent.pathName,_context2.next=13,this.app.repo.save(this.calculatedMetricUtilityService.createSegmentDividedBySegmentCalcMetric(segment,totalSegment,metric));case 13:return calculatedMetric=_context2.sent,_context2.abrupt("return",{segment:segment,calculatedMetric:calculatedMetric,cell:cell});case 15:case"end":return _context2.stop()}},_callee2,this)}));return function(_x){return _getSegmentAndPercentCalcMetricForTouchpoint.apply(this,arguments)}}()},{key:"trendAllTouchpointPercents",value:function(){var _trendAllTouchpointPercents=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee3(cell){var cellIndex,cells,allTouchpointSegmentsAndCalcMetrics,columnNodes,_this7=this;return regenerator_default.a.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.prev=0,cellIndex=cell.parent.cells.indexOf(cell),cells=this.reportlet.data.rows.filter(function(row,i){return 0!==i}).map(function(row){return row.cells[cellIndex]}),_context3.next=5,Promise.all(cells.map(function(cell){return _this7.getSegmentAndPercentCalcMetricForTouchpoint(cell)}));case 5:allTouchpointSegmentsAndCalcMetrics=_context3.sent,columnNodes=allTouchpointSegmentsAndCalcMetrics.map(function(tp){return _this7.getPercentTrendColumnNode(tp.calculatedMetric,tp.cell)}),this.workspaceUtilities.trendComponents(this.props.subPanel,columnNodes,{subPanelName:Object(l10nify_build_bundle_module.a)("All Touchpoints Trended"),rowBasedPercentages:!1}),_context3.next=14;break;case 10:throw _context3.prev=10,_context3.t0=_context3.catch(0),this.app.addAlert({variant:"error",contents:Object(l10nify_build_bundle_module.a)("There was an error trending all touchpoint percents")}),_context3.t0;case 14:case"end":return _context3.stop()}},_callee3,this,[[0,10]])}));return function(_x2){return _trendAllTouchpointPercents.apply(this,arguments)}}()},{key:"getPercentTrendColumnNode",value:function(calculatedMetric,cell){var columnNode=new build_bundle_module.fb({component:calculatedMetric});if(cell.meta.columnSegment&&"All_Visits"!==cell.meta.columnSegment.id){var segmentNode=new build_bundle_module.fb({component:cell.meta.columnSegment});columnNode.addNode(segmentNode)}return columnNode}},{key:"trendPercent",value:function(){var _trendPercent=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee4(cell){var _ref2,segment,calculatedMetric,columnNode;return regenerator_default.a.wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.prev=0,_context4.next=3,this.getSegmentAndPercentCalcMetricForTouchpoint(cell);case 3:_ref2=_context4.sent,segment=_ref2.segment,calculatedMetric=_ref2.calculatedMetric,columnNode=this.getPercentTrendColumnNode(calculatedMetric,cell),this.workspaceUtilities.trendComponents(this.props.subPanel,[columnNode],{subPanelName:segment.name,rowBasedPercentages:!1}),_context4.next=14;break;case 10:throw _context4.prev=10,_context4.t0=_context4.catch(0),this.app.addAlert({variant:"error",contents:Object(l10nify_build_bundle_module.a)("There was an error trending touchpoint percent for the fallout checkpoint.")}),_context4.t0;case 14:case"end":return _context4.stop()}},_callee4,this,[[0,10]])}));return function(_x3){return _trendPercent.apply(this,arguments)}}()},{key:"createBreakDownTable",value:function(segmentPromise,cell){var _this8=this;this.reportlet.loading=!0,segmentPromise.then(function(segment){var newPivotTabelSubPanel=build_bundle_module.vb.create("FreeformReportlet");newPivotTabelSubPanel.name=segment.name,_this8.props.subPanel.addSibling(newPivotTabelSubPanel,"after",!0);var metric=build_bundle_module.Hb.fromCache(_this8.app.cache,{id:"metrics/"+_this8.reportlet.falloutContainer}),dimension=cell.parent.firstDimension,columnNode=_this8._createColumnNodes(metric,segment,cell);_this8.freeformModelUtil.setupReport(newPivotTabelSubPanel.reportlet,{columnComponents:[columnNode],dimension:dimension}),_this8.reportlet.loading=!1}).catch(function(e){_this8.reportlet.loading=!1})}},{key:"_createColumnNodes",value:function(metric,segment,cell){var columnNode=new build_bundle_module.fb({component:metric});if(cell.meta.columnSegment&&"All_Visits"!==cell.meta.columnSegment.id){var segmentNode=new build_bundle_module.fb({component:cell.meta.columnSegment});columnNode.addNode(segmentNode),segmentNode.addNode(new build_bundle_module.fb({component:segment}))}else columnNode.addNode(new build_bundle_module.fb({component:segment}));return columnNode}},{key:"createSegmentFromCheckpointDataRow",value:function(checkpointDataRow,cell){var _this9=this;checkpointDataRow.getSegmentSequenceWithVizSegment(cell.meta.columnSegment).then(function(definition){_this9.app.inAppEditors.showSegmentBuilder({segment:build_bundle_module.ec.fromJSON({definition:definition})})})}},{key:"toggleAllVisits",value:function(val){this.reportlet.toggleAllVisitsCheckpoint(val),this.loadData()}},{key:"onMouseEnter",value:function(){this.mouseOver=!0,this.setState({mouseOver:!0})}},{key:"onMouseLeave",value:function(){this.mouseOver=!1,this.previewPopoverOpen||this.setState({mouseOver:!1})}},{key:"render",value:function(){var visitsLabel,_this10=this,self=this,reportlet=this.props.subPanel.reportlet,colors=dom_util_build_bundle_module.a.isIE()?bundle_module.s.defaultColorSchemeOptions[0].value:bundle_module.s.getColors(),colorsBySegment={};bundle_module.q.each(this.reportlet.segments,function(segment,i){return colorsBySegment[segment.id]=colors[i]}),visitsLabel="visits"===reportlet.falloutContainer?Object(l10nify_build_bundle_module.a)("visits"):this.app.reportSuite.visitorLabelPluralLowercase;var isValidRequest=bundle_module.q.get(this,"reportlet.data.isValidRequest",!0);return react_default.a.createElement("div",null,react_default.a.createElement(ui_core_build_bundle_module.b,{show:!this.reportlet.sequenceSegmentValid,variant:"warning",contents:react_default.a.createElement(ui_core_build_bundle_module.J,null,react_default.a.createElement("span",null,Object(l10nify_build_bundle_module.a)("The current Fallout configuration is invalid, most likely due to an invalid segment container with one of the segments being used.  For help on resolving this issue, please see the documentation ")," ",react_default.a.createElement("a",{className:"coral-Link coral-Link--subtle",target:"_blank",href:"https://docs.adobe.com/content/help/".concat(l10nify_build_bundle_module.a.config.currentLocale.substring(0,2),"/analytics/analyze/analysis-workspace/visualizations/fallout/compare-segments-fallout.html")},Object(l10nify_build_bundle_module.a)("here"))))}),react_default.a.createElement("div",{className:"an-Fallout an-Viz an-Viz-Fallout",onMouseLeave:this.onMouseLeave.bind(this)},react_default.a.createElement(FalloutLegend_FalloutLegend,{legendHelper:this.legendHelper,legendMappings:this.reportlet.legendMappings,value:this.reportlet.segments,getItemColor:function(item){return colorsBySegment[item.id]},getItemValue:function(item,i){return self.format(bundle_module.q.get(reportlet,"data.totalRow.cells["+i+"].value",""))},onChange:this.onChangeSegments.bind(this),falloutContainer:reportlet.falloutContainer}),react_default.a.createElement("br",null),react_default.a.createElement("div",{ref:function(cpc){return _this10.checkpointsContainer=cpc},className:classnames_default()("an-Fallout-checkpoints",{isHovering:this.state.mouseOver&&!this.state.dragOver||this.state.draggingCheckpointItem||this.state.selectMenuIsOpen},"".concat(build_bundle_module.db.isActive("dropzoneGuides")?"dropzone-guides":"")),style:{padding:"15px",marginBottom:"10px"}},this.reportlet.data&&this.reportlet.data.rows&&this.reportlet.data.rows.map(function(checkpointDataRow,i){return react_default.a.createElement("div",{key:checkpointDataRow.checkpoint.id,className:classnames_default()("an-Fallout-labelRow",{"an-Fallout-allVisitsRow":_this10.reportlet.hasAllVisitsAsFirstCheckpoint()&&0===i})},react_default.a.createElement("div",{className:"an-Fallout-droptargetLine isRow","data-row-index":i}),react_default.a.createElement("div",{className:classnames_default()({"an-Fallout-droptargetArea":!(_this10.reportlet.hasAllVisitsAsFirstCheckpoint()&&0===i)}),"data-row-index":i},react_default.a.createElement("div",{className:classnames_default()("an-Fallout-row an-flex",{isLast:i+1===_this10.reportlet.data.rows.length})},react_default.a.createElement("div",{className:"an-Fallout-labelCell",onMouseEnter:_this10.onMouseEnter.bind(_this10)},react_default.a.createElement(EditableFalloutLabel,{visitsLabel:visitsLabel,isAllVisitsRow:_this10.reportlet.hasAllVisitsAsFirstCheckpoint()&&0===i,checkpointDataRow:checkpointDataRow,onRemoveGroupClick:_this10.onChangeCheckpoint.bind(_this10,checkpointDataRow.checkpoint,[])}),react_default.a.createElement("div",{className:"an-Fallout-checkpointCountRowContainer"},checkpointDataRow.cells.map(function(cell,j){return react_default.a.createElement("div",{key:j,className:"an-Fallout-checkoutCountRow an-Fallout-barItem"},react_default.a.createElement("div",{className:"an-Fallout-checkoutCount"},_this10.format(bundle_module.q.get(cell,"value",""))+" "+visitsLabel))}),react_default.a.createElement(NextHitOrEventualSelect,{onOpen:function(){return _this10.setState({selectMenuIsOpen:!0})},onClose:function(){return _this10.setState({selectMenuIsOpen:!1})},selectMenuIsOpen:_this10.state.selectMenuIsOpen,hide:i+1===_this10.reportlet.data.rows.length||_this10.reportlet.hasAllVisitsAsFirstCheckpoint()&&0===i,checkpointDataRow:checkpointDataRow,onChange:_this10.loadData.bind(_this10)})),react_default.a.createElement(react_drag_drop_build_bundle_module.f,{dragData:checkpointDataRow.checkpoint,disableDrag:function(e){return!!e.target.closest(".component-pill")}},react_default.a.createElement("div",{className:"an-Fallout-draggable-checkpoint-child"},react_default.a.createElement("div",{className:"hoverView"},checkpointDataRow.checkpoint.items.map(function(item,j){return react_default.a.createElement("div",{key:item.id},react_default.a.createElement("div",{className:"an-Fallout-droptargetLine","data-row-index":j}),react_default.a.createElement(react_drag_drop_build_bundle_module.f,{onDragEnd:function(){_this10.setState({draggingCheckpointItem:!1})},onDragStart:function(){_this10.setState({draggingCheckpointItem:!0})},dragData:[item]},react_default.a.createElement("div",{className:classnames_default()("component-pill",item.itemType)},react_default.a.createElement("div",{className:"component-pill-label","data-title":!0},item.label||item.fullName||item.name),react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"infoCircle",size:"XS",className:"component-pill-icon",onClick:_this10.onPreviewCheckpointItem.bind(_this10,item)}),react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"close",size:"XS",className:"component-pill-icon",onClick:_this10.onRemoveCheckpointItem.bind(_this10,checkpointDataRow.checkpoint,item)}))))}),react_default.a.createElement("div",{className:"an-Fallout-droptargetLine","data-row-index":checkpointDataRow.checkpoint.items.length}))))),react_default.a.createElement("div",{className:"an-Fallout-barCell an-flex-content "},isValidRequest?checkpointDataRow.cells.map(function(cell,j){return react_default.a.createElement(ui_core_build_bundle_module.kb.Wrap,{key:j,tooltipProps:{label:react_default.a.createElement(FalloutTooltip,{title:checkpointDataRow.name,cell:cell,visitsLabel:visitsLabel,formatter:_this10.format.bind(_this10),shouldShowColumnSegmentLabel:_this10.reportlet.segments.length>1||1===_this10.reportlet.segments.length&&"All_Visits"!==_this10.reportlet.segments[0].id}),position:"left",variant:"inspect"}},react_default.a.createElement("div",{className:"an-Fallout-barItem an-flex"},react_default.a.createElement(ui_core_build_bundle_module.T,{onWidthChange:_this10.updateBubbles,debounce:!1},react_default.a.createElement(Fallout_FalloutBarAnimate,null,react_default.a.createElement("div",{className:"an-Fallout-fallthroughBar ",onContextMenu:_this10.onRightClickBar.bind(_this10,!0,cell),style:{width:100*cell.meta.falloutTotalPercentage+"%",backgroundColor:colorsBySegment[bundle_module.q.get(cell,"meta.columnSegment.id")]}},cell.meta.falloutTotalPercentage>0&&react_default.a.createElement("div",{className:"an-Fallout-percentageBubble an-Fallout-percentageBubbleFallthrough"},_this10.format(cell.meta.falloutTotalPercentage,{type:"percent",precision:1}))))),react_default.a.createElement("div",{className:"an-Fallout-falloutBar an-flex-content",onContextMenu:_this10.onRightClickBar.bind(_this10,!1,cell)},cell.meta.falloutCheckpointPercentageDiff<0&&react_default.a.createElement("div",{className:"an-Fallout-percentageBubble an-Fallout-percentageBubbleFallout"},react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"arrowDown",size:"XS"})," ",_this10.format(Math.abs(cell.meta.falloutCheckpointPercentageDiff),{type:"percent",precision:1})))))}):react_default.a.createElement("div",{className:"an-Fallout-invalidBar"})))))}),react_default.a.createElement("div",{className:"an-Fallout-droptargetLine isRow","data-row-index":bundle_module.q.get(this,"reportlet.checkpoints.length",0)}),react_default.a.createElement("div",{className:"an-Fallout-row an-flex"},react_default.a.createElement("div",{className:"an-Fallout-labelCell"},react_default.a.createElement(ui_build_bundle_module.n,{components:[],isSupportedComponent:reportlet.isSupportedCheckpointItemType.bind(reportlet),placeholderLabel:Object(l10nify_build_bundle_module.a)("Add Touchpoint"),placeholderTooltip:Object(l10nify_build_bundle_module.a)("Drag and drop dimension items, segments, or metrics here."),onChange:this.onNewCheckpointChange.bind(this),className:classnames_default()("an-Fallout-addTouchpoint","an-clearfix",{"dropzone-guides":build_bundle_module.db.isActive("dropzoneGuides")})}),react_default.a.createElement("div",{style:{clear:"both"}})))),react_default.a.createElement(ui_core_build_bundle_module.qb,{show:this.reportlet.loading,variant:"overlay"})))}},{key:"reportlet",get:function(){return this.props.subPanel.reportlet}},{key:"workspaceUtilities",get:function(){return this._workspaceUtilities||(this._workspaceUtilities=new workspace_WorkspaceUtilities(this.appContext)),this._workspaceUtilities}},{key:"calculatedMetricUtilityService",get:function(){return this._calculatedMetricUtilityService||(this._calculatedMetricUtilityService=new build_bundle_module.s(this.app)),this._calculatedMetricUtilityService}}]),Fallout}(Reportlet_Reportlet);function NextHitOrEventualSelect(_ref3){var checkpointDataRow=_ref3.checkpointDataRow,_onChange=_ref3.onChange,hide=_ref3.hide,_onOpen=_ref3.onOpen,_onClose=_ref3.onClose;_ref3.selectMenuIsOpen;if(hide)return null;var options=[{label:Object(l10nify_build_bundle_module.a)("EVENTUAL PATH"),value:"eventual"},{label:Object(l10nify_build_bundle_module.a)("NEXT HIT"),value:"direct"}];return react_default.a.createElement("div",{className:"an-Fallout-checkpointDataRow-select"},react_default.a.createElement(ui_core_build_bundle_module.W.Inline,{value:checkpointDataRow.within,quiet:!0,hideArrow:!1,options:options,onOpen:function(){return _onOpen()},onChange:function(e){checkpointDataRow.within=e.value,_onChange()},onClose:function(){return _onClose()}}))}function EditableFalloutLabel(_ref4){var editableLabel,removeGroupButton,visitsLabel=_ref4.visitsLabel,checkpointDataRow=_ref4.checkpointDataRow,isAllVisitsRow=_ref4.isAllVisitsRow,onRemoveGroupClick=_ref4.onRemoveGroupClick;return isAllVisitsRow?editableLabel=react_default.a.createElement("span",{className:"an-Fallout-checkoutLabel an-Fallout-allVisitsLabel overflow-truncate"},Object(l10nify_build_bundle_module.a)(Fallout_templateObject3(),visitsLabel)):(editableLabel=react_default.a.createElement(ui_core_build_bundle_module.l,{textOverflowEllipsis:!0,className:"an-Fallout-checkoutLabel overflow-truncate",placeholder:checkpointDataRow.defaultName,value:checkpointDataRow.checkpointName,onChange:function(v){checkpointDataRow.checkpointName=v,ui_core_build_bundle_module.lb.trackAction(null,"Fallout: touchpoint name edit")}}),removeGroupButton=react_default.a.createElement(ui_core_build_bundle_module.C,{"data-tooltip":Object(l10nify_build_bundle_module.a)("Delete Group"),className:"an-Legend-cellDelete an-Fallout-removeGroup-icon",icon:"close",size:"XS",onClick:onRemoveGroupClick})),react_default.a.createElement("div",null,editableLabel,removeGroupButton)}function FalloutTooltip(_ref5){var cell=_ref5.cell,visitsLabel=_ref5.visitsLabel,formatter=_ref5.formatter,title=_ref5.title,shouldShowColumnSegmentLabel=(_ref5.reportlet,_ref5.shouldShowColumnSegmentLabel);return react_default.a.createElement("div",{className:"an-Fallout-tooltip"},react_default.a.createElement(ui_core_build_bundle_module.B,null,Object(l10nify_build_bundle_module.a)("Touchpoint")),react_default.a.createElement("div",{className:"an-Fallout-tooltipValue"},title," ",shouldShowColumnSegmentLabel?Object(l10nify_build_bundle_module.a)("[%s]",[cell.meta.columnSegment.name]):null),react_default.a.createElement(ui_core_build_bundle_module.B,null,visitsLabel),react_default.a.createElement("div",{className:"an-Fallout-tooltipValue"},formatter(cell.value)),react_default.a.createElement(ui_core_build_bundle_module.B,null,Object(l10nify_build_bundle_module.a)("Total Success %")),react_default.a.createElement("div",{className:"an-Fallout-tooltipValue"},formatter(cell.meta.falloutTotalPercentage,{type:"percent",precision:1})),react_default.a.createElement(ui_core_build_bundle_module.B,null,Object(l10nify_build_bundle_module.a)("Touchpoint %")),react_default.a.createElement("div",{className:"an-Fallout-tooltipValue"},formatter(cell.meta.falloutCheckpointPercentage,{type:"percent",precision:1})))}var FalloutSettings=Object(react_essence_build_bundle_module.b)(function(props){props.subPanel.reportlet.falloutContainer;var helpLabel=Object(l10nify_build_bundle_module.a)('This option determines if you would like to see the number of "Visits" or "Visitors" that progressed to each touchpoint.'),falloutContainer=props.subPanel.reportlet.falloutContainer;return react_default.a.createElement("div",null,react_default.a.createElement(ui_core_build_bundle_module.B,null,Object(l10nify_build_bundle_module.a)("Fallout Container"),react_default.a.createElement(ui_core_build_bundle_module.C.Help,{style:{position:"relative",top:"1px",paddingLeft:"7px"},label:helpLabel})),react_default.a.createElement(ui_core_build_bundle_module.S.Group,{vertical:!0,selectedValue:falloutContainer},react_default.a.createElement(ui_core_build_bundle_module.S,{label:Object(l10nify_build_bundle_module.a)("Visit"),value:"visits",onChange:function(){ui_core_build_bundle_module.lb.trackAction(null,"Visualization Setting Changed",{vizSettingName:"Fallout Visit Container",vizSettingEnabled:!0}),props.subPanel.reportlet.falloutContainer="visits"},"data-test-id":"fallout-settings-visit"}),react_default.a.createElement(ui_core_build_bundle_module.S,{label:props.reportSuite.visitorLabel,value:"visitors",onChange:function(){ui_core_build_bundle_module.lb.trackAction(null,"Visualization Setting Changed",{vizSettingName:"Fallout Visitor Container",vizSettingEnabled:!0}),props.subPanel.reportlet.falloutContainer="visitors"},"data-test-id":"fallout-settings-visitor"})),react_default.a.createElement("br",null),react_default.a.createElement("br",null),react_default.a.createElement(ui_core_build_bundle_module.k,{label:"visits"===falloutContainer?Object(l10nify_build_bundle_module.a)('Show "All Visits" as the first touchpoint.'):Object(l10nify_build_bundle_module.a)('Show "All Visitors" as the first touchpoint.'),checked:props.subPanel.reportlet.hasAllVisitsAsFirstCheckpoint(),onChange:function(e){ui_core_build_bundle_module.lb.trackAction(null,"Visualization Setting Changed",{vizSettingName:"Fallout Show All Visits",vizSettingEnabled:e.target.checked}),props.subPanelUI.toggleAllVisits(e.target.checked)},"data-test-id":"fallout-show-all-visits"}))},"subPanel");Fallout_Fallout.showSettings=function(e,genericSubPanelModel,falloutUI,subPanelUI){return genericSubPanelModel.hasActivePopover=!0,ui_core_build_bundle_module.P.show({isModal:!1,closeOnClickOutside:!0,dialog:{header:Object(l10nify_build_bundle_module.a)("Fallout Settings"),style:{width:"350px"}},target:e.target,getComponent:function(){return react_default.a.createElement(FalloutSettings,{subPanel:genericSubPanelModel,subPanelUI:falloutUI,reportSuite:subPanelUI.app.reportSuite})},onClose:function(){genericSubPanelModel.hasActivePopover=!1}})};var Fallout_FalloutBarAnimate=function(_Component){function FalloutBarAnimate(props,context){var _this11;return Object(classCallCheck.a)(this,FalloutBarAnimate),(_this11=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(FalloutBarAnimate).call(this,props,context))).state={beforeEnter:!0},_this11}return Object(inherits.a)(FalloutBarAnimate,_Component),Object(createClass.a)(FalloutBarAnimate,[{key:"componentDidMount",value:function(){var _this12=this;setTimeout(function(){_this12.setState({beforeEnter:!1})},1)}},{key:"render",value:function(){var child=this.props.children;return react_default.a.cloneElement(child,{className:classnames_default()(child.props.className,child.className,{beforeEnter:this.state.beforeEnter})})}}]),FalloutBarAnimate}(react_essence_build_bundle_module.a);__webpack_require__(971);function Flow_templateObject(){var data=Object(taggedTemplateLiteral.a)(["Multi-valued dimensions behave uniquely in Flow visualizations. As a result, this visualization will be reloaded and may change. Do you want to continue?"]);return Flow_templateObject=function(){return data},data}var Flow_Flow=function(_Reportlet){function Flow(props,context){var _this;Object(classCallCheck.a)(this,Flow),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(Flow).call(this,props,context))).observe(_this.reportlet),_this._chartInstance=null;var flowAdapter=new ui_core_build_bundle_module.t;return _this.state={},_this.reportlet.needsConfig?_this.state.displayConfig=!0:_this.state.formattedData=flowAdapter.process(_this.reportlet.getAllNodes()),_this.reportlet.on("reportlet:render",function(e){_this.setState({formattedData:flowAdapter.process(_this.reportlet.getAllNodes())})}),_this.reportlet.on("change:flowContainer",function(){_this.loadData()}),_this.reportlet.on("undoRedoComplete",function(){_this.reportlet.needsConfig&&_this.setState({displayConfig:!0})}),_this.reportlet.on("change:disableTruncation",function(){_this.render()}),_this.observe(_this.reportlet,"resetConfig",function(){_this.setState({displayConfig:!0})}),_this.freeformModelUtil=new build_bundle_module.kb(_this.appContext),_this.dropIndicator=Object(ui_build_bundle_module.mb)(document.createElement("div")),_this}return Object(inherits.a)(Flow,_Reportlet),Object(createClass.a)(Flow,[{key:"loadData",value:function(){var _this2=this;if(!this.reportlet.needsConfig)return this.reportlet.load(this.appContext).then(function(){_this2.setState({displayConfig:!1})})}},{key:"componentDidMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(Flow.prototype),"componentDidMount",this).call(this),this.el=react_dom_default.a.findDOMNode(this),this.$el=Object(ui_build_bundle_module.mb)(this.el)}},{key:"expandNode",value:function(node,dimension){return this.reportlet.loadNode(this.app,node,dimension)}},{key:"expandNodes",value:function(nodes,dimension){var _this3=this;return Promise.all(nodes.map(function(node){return _this3.reportlet.loadNode(_this3.app,node,dimension)}))}},{key:"collapseNode",value:function(node){return this.reportlet.collapseNode(this.app,node)}},{key:"collapseNodes",value:function(nodes){var _this4=this;return Promise.all(nodes.map(function(node){return _this4.reportlet.collapseNode(_this4.app,node)}))}},{key:"loadNextColumn",value:function(column,dimension){return column.nodes.forEach(function(node){node.component&&(node.expanded=!0)}),this.reportlet.loadNextColumn(this.app,column,dimension)}},{key:"setFocusDimensionItem",value:function(dimensionItem){this.reportlet.focusDimensionItem=dimensionItem,this.loadData()}},{key:"collapseColumn",value:function(column){this.reportlet.collapseColumn(column)}},{key:"postRender",value:function(chartInstance){this._chartInstance=chartInstance,this.attachContextMenuListener(),this.flagRootNode()}},{key:"vizContextMenuItemClick",value:function(d,item){var component=item&&item.component;[build_bundle_module.X,build_bundle_module.ec,build_bundle_module.S,build_bundle_module.Hb,build_bundle_module.r].find(function(type){return component instanceof type})&&(ui_core_build_bundle_module.lb.trackAction(null,"Flow right-click: Breakdown"),this.breakdownNode(d,component))}},{key:"attachContextMenuListener",value:function(){var _self=this;this._chartInstance.on("contextmenu",function(d){bundle_module.v.event.preventDefault(),ui_core_build_bundle_module.ab.closeAll(),ui_core_build_bundle_module.ab.show({target:bundle_module.v.event.currentTarget,chartType:"pathing",labelKey:"name",showSearchBar:!0,data:d,onClick:function(item){_self.vizContextMenuItemClick(d,item)},items:_self.getContextMenuItems(d)})})}},{key:"exportSegmentIsDisabledMessage",value:function(){return build_bundle_module.db.isActive("flowRepeatsExportSegment")?"":Object(l10nify_build_bundle_module.a)("This action is not currently supported")}},{key:"getContextMenuItems",value:function(d){var _self=this;return[{name:Object(l10nify_build_bundle_module.a)("Focus on this node"),hidden:d.isMoreNode||"X_0"===d.id||"E_0"===d.id,onClick:function(){ui_core_build_bundle_module.lb.trackAction(null,"Flow right-click: Focus on this node"),_self.pivotNode(d)}},{name:Object(l10nify_build_bundle_module.a)("Start Over"),onClick:function(d){ui_core_build_bundle_module.lb.trackAction(null,"Flow right-click: Start Over"),_self.resetConfig()}},{name:Object(l10nify_build_bundle_module.a)("Create segment for this path"),disabled:!build_bundle_module.db.isActive("flowRepeatsExportSegment"),hidden:d.isMoreNode,helpLabel:this.exportSegmentIsDisabledMessage(),onClick:function(){ui_core_build_bundle_module.lb.trackAction(null,"Flow right-click: Create segment for this path"),_self.openSegmentBuilderForNode(d)}},{name:Object(l10nify_build_bundle_module.a)("Breakdown"),disabled:!build_bundle_module.db.isActive("flowRepeatsExportSegment"),hidden:d.isMoreNode,helpLabel:this.exportSegmentIsDisabledMessage(),items:_self.getBreakdownItems()},{name:Object(l10nify_build_bundle_module.a)("Trend"),disabled:!build_bundle_module.db.isActive("flowRepeatsExportSegment"),hidden:d.isMoreNode,helpLabel:this.exportSegmentIsDisabledMessage(),onClick:function(){var _onClick=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(){return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return ui_core_build_bundle_module.lb.trackAction(null,"Flow right-click: Trend"),_context.next=3,_self.trendNode(d);case 3:case"end":return _context.stop()}},_callee)}));return function(){return _onClick.apply(this,arguments)}}()},{name:Object(l10nify_build_bundle_module.a)("Expand entire column"),onClick:function(){ui_core_build_bundle_module.lb.trackAction(null,"Flow right-click: Expand entire column"),_self.expandEntireColumn(d)}},{name:Object(l10nify_build_bundle_module.a)("Collapse entire column"),onClick:function(){ui_core_build_bundle_module.lb.trackAction(null,"Flow right-click: Collapse entire column"),_self.collapseEntireColumn(d)}}]}},{key:"getBreakdownItems",value:function(){var _this5=this,isSupportedComponent=this.subPanel.isSupportedComponent.bind(this.subPanel),cache=this.app.cache,mapToSlideMenuItem=function(component){return{name:component.name,id:component.id,component:component,disabled:!build_bundle_module.db.isActive("flowRepeatsExportSegment"),helpLabel:_this5.exportSegmentIsDisabledMessage()}},getCacheItems=function(collectionName){return cache.getCollection(collectionName).items||[]};return bundle_module.q.filter([{name:Object(l10nify_build_bundle_module.a)("Dimensions"),dataKey:"dimensions",items:getCacheItems("dimensions").filter(isSupportedComponent).map(mapToSlideMenuItem),sort:"asc"},{name:Object(l10nify_build_bundle_module.a)("Metrics"),dataKey:"combinedMetrics",items:getCacheItems("combinedMetrics").filter(isSupportedComponent).map(mapToSlideMenuItem),sort:"asc"},{name:Object(l10nify_build_bundle_module.a)("Segments"),dataKey:"segments",items:getCacheItems("segments").filter(isSupportedComponent).map(mapToSlideMenuItem),sort:"asc"},{name:Object(l10nify_build_bundle_module.a)("Time"),dataKey:"dateRanges",items:getCacheItems("dateRanges").filter(isSupportedComponent).map(mapToSlideMenuItem)}],function(group){return group.items.length})}},{key:"getNodeModelFromCloudVizNode",value:function(d){return this.reportlet.findNodeById(d.additionalData.nodeId)}},{key:"reapplyRootComponent",value:function(){this.reportlet.isEntryFlow?this.reportlet.setRootComponent(this.reportlet.entryDimension,"entry"):this.reportlet.isExitFlow?this.reportlet.setRootComponent(this.reportlet.exitDimension,"exit"):this.reportlet.isFocusFlow&&this.reportlet.setRootComponent(this.reportlet.focusDimensionItem,"focus")}},{key:"_pivotNode",value:function(d){var node=this.getNodeModelFromCloudVizNode(d);this.setFocusDimensionItem(node.component)}},{key:"pivotNode",value:function(d){var _this6=this;build_bundle_module.sc.createChangeSet(function(changeSet){_this6._pivotNode(d),changeSet.afterUndo(_this6.reapplyRootComponent.bind(_this6)),changeSet.afterRedo(_this6.reapplyRootComponent.bind(_this6))},this.reportlet)()}},{key:"openSegmentBuilderForNode",value:function(d){var node=this.getNodeModelFromCloudVizNode(d),definition=this.reportlet.generateSegmentDefinitionFromNode(this.app,node,!0);this.app.inAppEditors.showSegmentBuilder({segment:build_bundle_module.ec.fromJSON({definition:definition})})}},{key:"breakdownNode",value:function(){var _breakdownNode=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee2(d,component){var node,segment,occurrences,subPanel;return regenerator_default.a.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return node=this.getNodeModelFromCloudVizNode(d),_context2.next=3,this.reportlet.saveSegmentFromNode(this.app,node,!1);case 3:segment=_context2.sent,occurrences=build_bundle_module.Hb.fromCache(this.app.cache,{id:"metrics/occurrences"}),(subPanel=build_bundle_module.vb.create("FreeformReportlet")).name=segment.name,subPanel.reportlet.columnTree.addNodeFromComponent(segment),build_bundle_module.Hb.isMetricLike(component)||subPanel.reportlet.columnTree.nodes[0].addNodeFromComponent(occurrences),this.freeformModelUtil.applyComponents({freeformTable:subPanel.reportlet.freeformTable,components:[component]}),build_bundle_module.xb.addItemAboveAnchor(subPanel,this.subPanel,this.parentPanel.subPanels);case 11:case"end":return _context2.stop()}},_callee2,this)}));return function(_x,_x2){return _breakdownNode.apply(this,arguments)}}()},{key:"trendNode",value:function(){var _trendNode=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee3(d){var node,segment,occurrences,columnNode;return regenerator_default.a.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return node=this.getNodeModelFromCloudVizNode(d),_context3.next=3,this.reportlet.saveSegmentFromNode(this.app,node,!1);case 3:segment=_context3.sent,this.workspaceUtilities=this.workspaceUtilities||new workspace_WorkspaceUtilities(this.appContext),occurrences=build_bundle_module.Hb.fromCache(this.app.cache,{id:"metrics/occurrences"}),(columnNode=new build_bundle_module.fb({component:occurrences})).addNode(new build_bundle_module.fb({component:segment})),this.workspaceUtilities.trendComponents(this.subPanel,[columnNode],{subPanelName:segment.name});case 9:case"end":return _context3.stop()}},_callee3,this)}));return function(_x3){return _trendNode.apply(this,arguments)}}()},{key:"expandEntireColumn",value:function(d){var node=this.getNodeModelFromCloudVizNode(d);this.loadNextColumn(node.column)}},{key:"collapseEntireColumn",value:function(d){var node=this.getNodeModelFromCloudVizNode(d);if(node.column.parentColumn)this.collapseColumn(node.column.parentColumn);else if(this.collapseColumn(node.column),node.isFocusNode){var otherRootNode=this.reportlet.findNodeById(d.additionalData.otherRootNodeId);this.collapseColumn(otherRootNode.column)}}},{key:"insertDropTargets",value:function(){var leftMostColumn,rightMostColumn,chartInstance=this._chartInstance,chartSelection=chartInstance._cvWrapper,nodes=chartSelection.select("svg").select(".pathing-svg-container").selectAll(".node"),leftMostBBox={x:1/0},rightMostBBox={x:0},addOntoColumnWidth=7,flowComponent=this,processedColumns=new Set;if(build_bundle_module.db.isActive("dropzoneGuides")&&(addOntoColumnWidth=13),this.removeDropTargetListeners(chartSelection),nodes.each(function(d){var column=flowComponent.getNodeModelFromCloudVizNode(d).column;if(!processedColumns.has(column)){var columnBBox=chartInstance.getColumnBBox(bundle_module.v.select(this));columnBBox.height<50&&(columnBBox.height=50);var replaceListener=flowComponent.addDropTargetListener(columnBBox,chartSelection);Object(ui_build_bundle_module.mb)(replaceListener.node()).data("column",column),columnBBox.x<leftMostBBox.x&&(leftMostBBox=columnBBox,leftMostColumn=column),columnBBox.x>rightMostBBox.x&&(rightMostBBox=columnBBox,rightMostColumn=column),processedColumns.add(column)}}),leftMostBBox.x-=addOntoColumnWidth,rightMostBBox.x+=rightMostBBox.width+3,leftMostBBox.width=addOntoColumnWidth,rightMostBBox.width=addOntoColumnWidth,this.reportlet.isFocusFlow||this.reportlet.isEntryFlow){var rightListener=this.addDropTargetListener(rightMostBBox,chartSelection).classed("an-Pathing-addOntoIndicator an-Pathing-addOntoIndicator-right",!0);Object(ui_build_bundle_module.mb)(rightListener.node()).data("column",rightMostColumn)}if(this.reportlet.isFocusFlow||this.reportlet.isExitFlow){var leftListener=this.addDropTargetListener(leftMostBBox,chartSelection).classed("an-Pathing-addOntoIndicator an-Pathing-addOntoIndicator-left",!0);Object(ui_build_bundle_module.mb)(leftListener.node()).data("column",leftMostColumn)}}},{key:"resetConfig",value:function(){this.reportlet.resetConfig(),this.setState({displayConfig:!0})}},{key:"removeDropTargetListeners",value:function(selection){selection?selection.selectAll(".".concat(this._dropTargetListenerClassName)).remove():bundle_module.v.selectAll(".".concat(this._dropTargetListenerClassName)).remove()}},{key:"addDropTargetListener",value:function(boundingBox,selection){var div=selection.append("div").classed(this._dropTargetListenerClassName,!0),_self=this,domNode=div.node();return Object(ui_build_bundle_module.mb)(domNode).on("mouseover",function(){_self.activateDropTarget(this)}),Object(ui_build_bundle_module.mb)(domNode).on("mouseout",function(){_self.deactivateDropTarget(this)}),div.style({width:"".concat(boundingBox.width,"px"),height:"".concat(boundingBox.height,"px"),top:"".concat(boundingBox.y-3,"px"),left:"".concat(boundingBox.x-3,"px")}),div}},{key:"activateDropTarget",value:function(domNode){build_bundle_module.db.isActive("dropzoneGuides")?(this.getDropIndicatorState(domNode),this.setDropIndicatorGuide(),this.showDropIndicator()):this.updateDropTarget(domNode,!0)}},{key:"deactivateDropTarget",value:function(domNode){build_bundle_module.db.isActive("dropzoneGuides")?this.hideDropIndicator():this.updateDropTarget(domNode,!1)}},{key:"updateDropTarget",value:function(domNode,activateFlag){bundle_module.v.select(domNode).classed(this._dropTargetIndicatorClassName,activateFlag)}},{key:"getDropIndicatorState",value:function(domNode){var currentTarget=Object(ui_build_bundle_module.mb)(domNode),elementOffset=currentTarget.offset();this.indicator={text:"",warningText:"",iconClass:"",warningClass:"",defaultClass:"dropzone-guides",extraClass:"",left:elementOffset.left,top:elementOffset.top-3,width:currentTarget.outerWidth()+6,height:currentTarget.outerHeight()+9},domNode.classList.contains("an-Pathing-addOntoIndicator")?(this.indicator.text=Object(l10nify_build_bundle_module.a)("Add"),this.indicator.iconClass="add-icon",domNode.classList.contains("an-Pathing-addOntoIndicator-left")?this.indicator.extraClass="".concat("drop-indicator-left"," ").concat(domNode.classList.value):domNode.classList.contains("an-Pathing-addOntoIndicator-right")&&(this.indicator.extraClass="".concat("drop-indicator-right"," ").concat(domNode.classList.value))):(this.indicator.text=Object(l10nify_build_bundle_module.a)("Replace"),this.indicator.iconClass="replace-icon",this.indicator.extraClass+="generic-drop-indicator ".concat(domNode.classList.value))}},{key:"setDropIndicatorGuide",value:function(){this.dropIndicator.removeClass().addClass("".concat(this.indicator.defaultClass," ").concat(this.indicator.iconClass," ").concat(this.indicator.extraClass," ").concat(this.indicator.warningClass)).attr("data-text","".concat(this.indicator.warningText?this.indicator.warningText:this.indicator.text)).css({left:this.indicator.left,top:this.indicator.top,width:this.indicator.width,height:this.indicator.height})}},{key:"showDropIndicator",value:function(){this.dropIndicator.parent().length||this.dropIndicator.appendTo("body")}},{key:"hideDropIndicator",value:function(){this.dropIndicator.parent().length&&this.dropIndicator.remove()}},{key:"isSupportedFlowComponent",value:function(c){return bundle_module.q.get(c,"dimension.segmentable",c.segmentable)}},{key:"isSupportedDimension",value:function(c){return c instanceof build_bundle_module.X&&!bundle_module.q.get(c,"isEntryOrExit")&&this.isSupportedFlowComponent(c)}},{key:"isSupportedDimensionItem",value:function(c){return c instanceof build_bundle_module.Y&&!bundle_module.q.get(c,"dimension.isEntryOrExit")&&this.isSupportedFlowComponent(c)}},{key:"isSupportedFocusComponent",value:function(c){return this.isSupportedDimension(c)||this.isSupportedDimensionItem(c)}},{key:"componentIsCompatibleWithCurrentFlowConfig",value:function(c){return this.reportlet.isExitEntryFlow?this.isSupportedDimension(c):this.reportlet.isFocusFlow?this.isSupportedDimension(c)||this.isSupportedDimensionItem(c):void 0}},{key:"toggleNode",value:function(cloudVizNode){var otherRootNode,node=this.getNodeModelFromCloudVizNode(cloudVizNode);node.isFocusNode&&(otherRootNode=this.reportlet.findNodeById(cloudVizNode.additionalData.otherRootNodeId)),node.expanded?(ui_core_build_bundle_module.lb.trackAction(null,"Flow node click (collapse)"),node.isFocusNode?this.collapseNodes([node,otherRootNode]):this.collapseNode(node)):(ui_core_build_bundle_module.lb.trackAction(null,"Flow node click (expand)"),node.isFocusNode?this.expandNodes([node,otherRootNode]):this.expandNode(node))}},{key:"getEntryDimensionPillGroupProps",value:function(){var _this7=this,reportlet=this.reportlet;return{limit:1,isSupportedComponent:this.isSupportedDimension.bind(this),components:bundle_module.q.compact([reportlet.entryDimension]),placeholderLabel:Object(l10nify_build_bundle_module.a)("Entry (Dimensions Only)"),placeholderTooltip:Object(l10nify_build_bundle_module.a)("Add a dimension here to see the top dimension items right after the user entered","flowAddDimensionEntry"),onChange:function(e){ui_core_build_bundle_module.lb.trackAction(null,"Flow drop initial component: Entry"),reportlet.entryDimension=bundle_module.q.get(e,"value[0]"),reportlet.entryDimension.isMultiValued&&!reportlet.includeRepeatInstances&&(reportlet.includeRepeatInstances=!0),_this7.loadData()}}}},{key:"getFocusPointPillGroupProps",value:function(){var _this8=this,reportlet=this.reportlet;return{limit:1,components:bundle_module.q.compact([reportlet.focusDimensionItem]),isSupportedComponent:this.isSupportedFocusComponent.bind(this),placeholderLabel:Object(l10nify_build_bundle_module.a)("Dimension or Item"),placeholderTooltip:Object(l10nify_build_bundle_module.a)("Add a dimension item here to see the top previous and next dimension items"),onChange:function(e){ui_core_build_bundle_module.lb.trackAction(null,"Flow drop initial component: Focus Node");var dimensionItem=bundle_module.q.get(e,"value[0]");dimensionItem&&(dimensionItem.isMultiValued&&!reportlet.includeRepeatInstances&&(reportlet.includeRepeatInstances=!0),reportlet.focusDimensionItem=dimensionItem,_this8.loadData())},transformAddedComponents:function(){var _transformAddedComponents=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee4(added){var component,topItem;return regenerator_default.a.wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if("item"!==(component=added[0]).itemType){_context4.next=5;break}return _context4.abrupt("return",added);case 5:if("dimension"!==component.itemType){_context4.next=10;break}return _context4.next=8,_this8.reportlet.getFocusItemFromDimension(component,_this8.app);case 8:return topItem=_context4.sent,_context4.abrupt("return",bundle_module.q.compact([topItem]));case 10:case"end":return _context4.stop()}},_callee4)}));return function(_x4){return _transformAddedComponents.apply(this,arguments)}}()}}},{key:"getExitDimensionPillGroupProps",value:function(){var _this9=this,reportlet=this.reportlet;return{limit:1,isSupportedComponent:this.isSupportedDimension.bind(this),components:bundle_module.q.compact([reportlet.exitDimension]),placeholderLabel:Object(l10nify_build_bundle_module.a)("Exit (Dimensions Only)"),placeholderTooltip:Object(l10nify_build_bundle_module.a)("Add a dimension here to see the top dimension items right before the user exited","flowAddDimensionExit"),onChange:function(e){ui_core_build_bundle_module.lb.trackAction(null,"Flow drop initial component: Exit"),reportlet.exitDimension=bundle_module.q.get(e,"value[0]"),reportlet.exitDimension.isMultiValued&&!reportlet.includeRepeatInstances&&(reportlet.includeRepeatInstances=!0),_this9.loadData()}}}},{key:"confirmChangeSettingForMultiValued",value:function(){var _confirmChangeSettingForMultiValued=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee5(component){var confirmed;return regenerator_default.a.wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.prev=0,_context5.next=3,ui_core_build_bundle_module.o.confirm(Object(l10nify_build_bundle_module.a)(Flow_templateObject()));case 3:confirmed=!0,_context5.next=9;break;case 6:_context5.prev=6,_context5.t0=_context5.catch(0),confirmed=!1;case 9:return _context5.abrupt("return",confirmed);case 10:case"end":return _context5.stop()}},_callee5,null,[[0,6]])}));return function(_x5){return _confirmChangeSettingForMultiValued.apply(this,arguments)}}()},{key:"getDropTargetProps",value:function(){var _this10=this;return{isSupportedComponent:this.componentIsCompatibleWithCurrentFlowConfig.bind(this),onEnter:function(){_this10.insertDropTargets()},onOver:function(e){var component=e.dragData[0],dropTargetListeners=_this10.$el.find(".an-Pathing-dropTargetListener");_this10.activeDropTarget=void 0,dropTargetListeners.each(function(i,el){var $el=Object(ui_build_bundle_module.mb)(el),column=$el.data("column");if(function(dropTargetListener,globalPt){var rect=dropTargetListener.getBoundingClientRect(),x=globalPt.x,y=globalPt.y;return y>rect.top&&y<rect.bottom&&x>rect.left&&x<rect.right}(el,e.globalPt)&&function(column,comp){return column.isFocusColumn?_this10.isSupportedDimensionItem(comp):_this10.isSupportedDimension(comp)}(column,component)){if(_this10.activeDropTarget=_this10.activeDropTarget||$el,_this10.activeDropTarget.trigger("mouseover"),build_bundle_module.db.isActive("dropzoneGuides"))return!1}else build_bundle_module.db.isActive("dropzoneGuides")||$el.trigger("mouseout");build_bundle_module.db.isActive("dropzoneGuides")&&i===dropTargetListeners.length-1&&$el.trigger("mouseout")})},onLeave:function(e){_this10.removeDropTargetListeners()},onDrop:function(){var _onDrop=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee6(e){var component,shouldChangeSettingsForMultiValuedVar,column,parentColumn;return regenerator_default.a.wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:if(component=e[0],!_this10.activeDropTarget){_context6.next=46;break}if(!(shouldChangeSettingsForMultiValuedVar=component.isMultiValued&&!_this10.reportlet.hasMultiValuedDimensions())){_context6.next=12;break}return _context6.next=6,_this10.confirmChangeSettingForMultiValued();case 6:if(!_context6.sent){_context6.next=11;break}_this10.reportlet.includeRepeatInstances=!0,_context6.next=12;break;case 11:return _context6.abrupt("return");case 12:if(column=_this10.activeDropTarget.data("column"),!_this10.activeDropTarget.hasClass("an-Pathing-addOntoIndicator")){_context6.next=21;break}return ui_core_build_bundle_module.lb.trackAction(null,"Flow drop additional component: append"),column.childColumn&&column.childColumn.remove(),_context6.next=19,_this10.loadNextColumn(column,component);case 19:_context6.next=43;break;case 21:if(ui_core_build_bundle_module.lb.trackAction(null,"Flow drop additional component: replace"),!column.isFocusColumn){_context6.next=27;break}return _context6.next=25,_this10.setFocusDimensionItem(component);case 25:_context6.next=43;break;case 27:if(!column.isRootEntryColumn){_context6.next=33;break}return _this10.reportlet.entryDimension=component,_context6.next=31,_this10.loadData();case 31:_context6.next=43;break;case 33:if(!column.isRootExitColumn){_context6.next=39;break}return _this10.reportlet.exitDimension=component,_context6.next=37,_this10.loadData();case 37:_context6.next=43;break;case 39:return parentColumn=column.parentColumn,column.remove(),_context6.next=43,_this10.loadNextColumn(parentColumn,component);case 43:if(!shouldChangeSettingsForMultiValuedVar){_context6.next=46;break}return _context6.next=46,_this10.loadData();case 46:_this10.removeDropTargetListeners();case 47:case"end":return _context6.stop()}},_callee6)}));return function(_x6){return _onDrop.apply(this,arguments)}}(),hideDropIndicatorGuide:!0}}},{key:"_render",value:function(){var reportlet=this.reportlet,formatter=this.app.getMetricFormatter(this.reportSuite),colorHexValues=bundle_module.q.get(this,"_chartInstance._options.colors",[]),entryDimensionPillGroupProps=this.getEntryDimensionPillGroupProps(),focusPointPillGroupProps=this.getFocusPointPillGroupProps(),exitDimensionPillGroupProps=this.getExitDimensionPillGroupProps(),dropTargetProps=this.getDropTargetProps(),cloudVizOpts={colors:dom_util_build_bundle_module.a.isIE()?bundle_module.s.defaultColorSchemeOptions[0].value:bundle_module.s.getColors(),data:this.state.formattedData,pivotNode:this.pivotNode.bind(this),toggleNode:this.toggleNode.bind(this),nodeTitleMaxChars:12,nodeTitleTruncationTailLength:7,postRender:this.postRender.bind(this),disableTruncation:this.reportlet.disableTruncation},Or=function(){return react_default.a.createElement("div",{className:"or-container"},react_default.a.createElement("span",{className:"or"},Object(l10nify_build_bundle_module.a)("OR")))};return react_default.a.createElement("div",{className:"an-Flow"},this.state.displayConfig?react_default.a.createElement(function(){return react_default.a.createElement("div",{"data-test-id":"flow-config"},react_default.a.createElement("div",{className:"drop-target-title"},Object(l10nify_build_bundle_module.a)("Drop a Dimension or Dimension Item at one of the points below:")),react_default.a.createElement("div",{className:"pill-groups"},react_default.a.createElement(ui_build_bundle_module.n.Dimension,Object.assign({},entryDimensionPillGroupProps,{"data-test-id":"flow-entry-dimension-dropzone"})),react_default.a.createElement(Or,null),react_default.a.createElement(ui_build_bundle_module.n,Object.assign({},focusPointPillGroupProps,{"data-test-id":"flow-focus-point-dropzone"})),react_default.a.createElement(Or,null),react_default.a.createElement(ui_build_bundle_module.n.Dimension,Object.assign({},exitDimensionPillGroupProps,{"data-test-id":"flow-exit-dimension-dropzone"})),react_default.a.createElement(Or,null)))},null):react_default.a.createElement(ui_build_bundle_module.l,dropTargetProps,react_default.a.createElement(ui_core_build_bundle_module.O,{cloudVizOpts:cloudVizOpts,formatter:formatter,colors:colorHexValues,getNodeModelById:reportlet.findNodeById.bind(reportlet),className:"an-Flow"})),react_default.a.createElement(ui_core_build_bundle_module.qb,{show:reportlet.loading,variant:"overlay",size:"L"}))}},{key:"flagRootNode",value:function(){var nodes=this.chartWrapper.selectAll(".node"),_self=this;nodes.select(".node-metric-name").remove(),nodes.each(function(d){if(d.isFocusNode||"E_0"===d.id||"X_0"===d.id){var focusNode=bundle_module.v.select(this).classed("an-Pathing-focusFlag",!0),totalNode=focusNode.select(".node-total"),titleNode=focusNode.select(".node-title"),metricNameNode=focusNode.select(".node-metric-name"),yVal=+totalNode.node().getBBox().height+ +totalNode.attr("y");titleNode.text();if(_self.props.subPanel.reportlet.disableTruncation){var tspan=titleNode.select("tspan");tspan.text("* "+tspan.text())}else titleNode.text("* "+titleNode.text());metricNameNode.empty()&&(metricNameNode=focusNode.insert("text",".node-hit-area")),metricNameNode.classed("node-metric-name",!0).attr("text-anchor",totalNode.attr("text-anchor")).attr("y",yVal).attr("x",totalNode.attr("x")).attr("dy",totalNode.attr("dy")).text(Object(l10nify_build_bundle_module.a)("Path Views"))}})}},{key:"_dropTargetListenerClassName",get:function(){return"an-Pathing-dropTargetListener"}},{key:"_dropTargetIndicatorClassName",get:function(){return"an-Pathing-dropTargetIndicator"}},{key:"subPanel",get:function(){return this.props.subPanel}},{key:"parentPanel",get:function(){return bundle_module.q.get(this,"props.subPanel.parent")}},{key:"chartWrapper",get:function(){return bundle_module.v.select(this._chartInstance.getOption("parent"))}}],[{key:"defaultProps",get:function(){return{}}},{key:"propTypes",get:function(){return{subPanel:ui_core_build_bundle_module.R.object.isRequired}}}]),Flow}(Reportlet_Reportlet),FlowSettings=Object(react_essence_build_bundle_module.b)(function(props){var includeRepeatsIsDisabled=props.reportlet.hasMultiValuedDimensions(),disabledRepeatsMessage=Object(l10nify_build_bundle_module.a)("Repeats cannot be removed from Flow visualizations that include multi-valued dimensions.  "),defaultRepeatsMessage=Object(l10nify_build_bundle_module.a)("Flow visualizations are based on instances of a dimension. This setting gives you the option to include or exclude repeated instances, e.g. Page reloads. "),disabledRepeatsLink="https://marketing.adobe.com/resources/help/".concat(l10nify_build_bundle_module.a.config.currentLocale,"/sc/implement/listN.html"),defaultRepeatsLink="https://marketing.adobe.com/resources/help/".concat(l10nify_build_bundle_module.a.config.currentLocale,"/analytics/analysis-workspace/flow-settings.html");return react_default.a.createElement("div",{className:"ad-Popover-content1 columns-2",style:{borderTop:"none",marginTop:"0px"}},react_default.a.createElement("div",{className:"ad-Popover-section1 column"},react_default.a.createElement(ui_core_build_bundle_module.B,null,Object(l10nify_build_bundle_module.a)("Flow Container"),react_default.a.createElement(ui_core_build_bundle_module.C.Help,{style:{position:"relative",top:"1px",paddingLeft:"7px"},label:Object(l10nify_build_bundle_module.a)('This option determines if you would like to see the number of "Visits" or "Visitors" that progressed to each touchpoint.')})),react_default.a.createElement(ui_core_build_bundle_module.S.Group,{vertical:!0,selectedValue:props.reportlet.flowContainer},react_default.a.createElement(ui_core_build_bundle_module.S,{label:Object(l10nify_build_bundle_module.a)("Visit"),value:"visits",onChange:function(){ui_core_build_bundle_module.lb.trackAction(null,"Flow settings: Visit Container"),props.reportlet.flowContainer="visits"},"data-test-id":"flow-settings-visit"}),react_default.a.createElement(ui_core_build_bundle_module.S,{label:props.reportSuite.visitorLabel,value:"visitors",onChange:function(){ui_core_build_bundle_module.lb.trackAction(null,"Flow settings: Visitor Container"),props.reportlet.flowContainer="visitors"},"data-test-id":"flow-settings-visitor"}))),react_default.a.createElement("div",{className:"ad-Popover-section1 column"},react_default.a.createElement(ui_core_build_bundle_module.B,null,Object(l10nify_build_bundle_module.a)("Flow Options")),react_default.a.createElement(ui_core_build_bundle_module.k,{size:"block",label:Object(l10nify_build_bundle_module.a)("Wrap Labels"),checked:props.reportlet.disableTruncation,onChange:function(){ui_core_build_bundle_module.lb.trackAction(null,"Flow settings: Disable Label Truncation"),props.reportlet.disableTruncation=!props.reportlet.disableTruncation},"data-test-id":"flow-disable-label-truncation"}),react_default.a.createElement("div",{className:"flow-options-include-repeats-container"},react_default.a.createElement(ui_core_build_bundle_module.k,{size:"block",label:Object(l10nify_build_bundle_module.a)("Include Repeat Instances"),checked:props.reportlet.includeRepeatInstances,disabled:includeRepeatsIsDisabled,onChange:function(){ui_core_build_bundle_module.lb.trackAction(null,"Flow settings: Include Repeat Instances"),props.reportlet.includeRepeatInstances=!props.reportlet.includeRepeatInstances,props.loadData()},"data-test-id":"flow-include-repeat-instances"}),react_default.a.createElement(ui_core_build_bundle_module.C.Help,{className:"helpIcon",style:{paddingLeft:0,paddingTop:"5px"}}),react_default.a.createElement(ui_core_build_bundle_module.kb,{position:"right",hoverable:!0},includeRepeatsIsDisabled?disabledRepeatsMessage:defaultRepeatsMessage,react_default.a.createElement(ui_core_build_bundle_module.F,{label:Object(l10nify_build_bundle_module.a)("Learn More."),target:"_blank",href:includeRepeatsIsDisabled?disabledRepeatsLink:defaultRepeatsLink})))))},{prop:"reportlet",event:"change:flowContainer"},{prop:"reportlet",event:"change:disableTruncation"},{prop:"reportlet",event:"change:includeRepeatInstances"});Flow_Flow.showSettings=function(e,genericSubPanelModel,flowUI,subPanelUI){return genericSubPanelModel.hasActivePopover=!0,ui_core_build_bundle_module.P.show({isModal:!1,closeOnClickOutside:!0,dialog:{header:Object(l10nify_build_bundle_module.a)("Flow Settings")},target:e.target,getComponent:function(){return react_default.a.createElement(FlowSettings,{reportlet:genericSubPanelModel.reportlet,reportSuite:subPanelUI.app.reportSuite,loadData:function(){return flowUI.loadData()}})},onClose:function(){genericSubPanelModel.hasActivePopover=!1}})};Object(react_essence_build_bundle_module.b)(FlowSettings,"subPanel"),__webpack_require__(972),__webpack_require__(973);function SubPanel_templateObject(){var data=Object(taggedTemplateLiteral.a)(["An error is preventing this visualization from rendering. You can try refreshing your project. If the error persists, try rebuilding the visualization."]);return SubPanel_templateObject=function(){return data},data}var registeredReportlets={FreeformReportlet:FreeformReportletEnhancedWithDynamicBehaviors,AreaReportlet:AreaReportlet_AreaReportlet,AreaStackedReportlet:AreaStackedReportlet_AreaStackedReportlet,BarReportlet:BarReportlet_BarReportlet,BarStackedReportlet:BarStackedReportlet_BarStackedReportlet,BulletReportlet:BulletReportlet_BulletReportlet,DonutReportlet:DonutReportlet_DonutReportlet,HistogramReportlet:HistogramReportlet_HistogramReportlet,HorizontalBarReportlet:HorizontalBarReportlet_HorizontalBarReportlet,HorizontalBarStackedReportlet:HorizontalBarStackedReportlet_HorizontalBarStackedReportlet,LineReportlet:LineReportlet_LineReportlet,MapReportlet:MapReportlet_MapReportlet,ScatterReportlet:ScatterReportlet_ScatterReportlet,SummaryChangeReportlet:SummaryChangeReportlet_SummaryChangeReportlet,SummaryNumberReportlet:SummaryNumberReportlet_SummaryNumberReportlet,TextReportlet:TextReportlet_TextReportlet,TreemapReportlet:TreemapReportlet_TreemapReportlet,VennReportlet:VennReportlet_VennReportlet,CohortReportlet:CohortReportlet_CohortReportlet,Fallout:Fallout_Fallout,Flow:Flow_Flow},SubPanel_SubPanel=function(_AppComponent){function SubPanel(props,context){var _this;Object(classCallCheck.a)(this,SubPanel),_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(SubPanel).call(this,props,context));var subPanel=props.subPanel;return _this.popover=null,_this.observe(subPanel,"change",_this.onSubPanelChange.bind(Object(assertThisInitialized.a)(_this))),_this.observe(subPanel,"project:render"),subPanel.linkedSource&&_this.observe(subPanel.linkedSource,"change:statusLabel",function(e){subPanel.statusLabel=e.newValue}),_this.isReconfigurable&&_this.observe(subPanel.reportlet,"reportlet:render"),_this.registerOff(_this.subPanel.on("focus",_this.focus.bind(Object(assertThisInitialized.a)(_this)))),_this.registerOff(_this.subPanel.position.on("change:autoSize",function(){return _this.subPanel.broadcast("reportlet:render")})),_this}return Object(inherits.a)(SubPanel,_AppComponent),Object(createClass.a)(SubPanel,[{key:"onSubPanelChange",value:function(e){return"virtualize"===e.property?(this.forceUpdate(),!1):"position.autoHeight"!==e.property&&("linkedSourceId"===e.property&&this.removeBackgroundColorFromLockedSelection(e.oldValue),!0)}},{key:"getSubPanelContextMenuItems",value:function(){var _this2=this,subPanel=this.subPanel,subPanelContextMenuItems=[{name:Object(l10nify_build_bundle_module.a)("Copy Visualization"),onClick:function(){PanelSubPanelCopyPaste.copy(_this2.subPanel,_this2.app),_this2.app.addAlert({variant:"success",contents:Object(l10nify_build_bundle_module.a)("Visualization copied.  Right click on a panel or a visualization header to insert.")})}},{name:Object(l10nify_build_bundle_module.a)("Duplicate Visualization"),onClick:function(){_this2.duplicate()}},{name:Object(l10nify_build_bundle_module.a)("Edit Description"),onClick:function(){subPanel.collapsed=!1,_this2.description.edit(),_this2.forceUpdate()}}];build_bundle_module.db.isActive("prototypeMode")||subPanelContextMenuItems.push({name:Object(l10nify_build_bundle_module.a)("Get Visualization Link"),onClick:function(){_this2.getVisualizationLink()}});var clipboardText=this.subPanel.reportlet.formatForClipboard(this.app);return clipboardText&&subPanelContextMenuItems.unshift({name:Object(l10nify_build_bundle_module.a)("Copy To Clipboard"),onClick:function(item,e){ui_build_bundle_module.i.setData(clipboardText,e),_this2.app.addAlert({variant:"success",contents:Object(l10nify_build_bundle_module.a)("Data copied to clipboard.")}),ui_core_build_bundle_module.lb.trackAction(null,"Right-click: Copy to Clipboard")}}),PanelSubPanelCopyPaste.getCurrentClipboardItem(this.app)&&"subPanel"===PanelSubPanelCopyPaste.getCurrentClipboardItem(this.app).type&&subPanelContextMenuItems.unshift({name:Object(l10nify_build_bundle_module.a)("Insert Copied Visualization"),onClick:function(){PanelSubPanelCopyPaste.paste(subPanel,_this2.app)}}),this.app.isLocalDev&&"FreeformReportlet"===bundle_module.q.get(subPanel,"reportlet.type")&&subPanelContextMenuItems.push({name:Object(l10nify_build_bundle_module.a)("Export Test Case"),onClick:function(){var fileName=subPanel.reportlet.name||"FreeformReportlet";fileName=bundle_module.q.capitalize(bundle_module.q.camelCase(fileName)),Object(ui_build_bundle_module.hb)(_this2.app,{filename:"".concat(fileName,".spec"),filetype:"js",mimeType:"text/javascript",dataString:Object(build_bundle_module.Gc)(subPanel.reportlet)})}}),(build_bundle_module.db.isActive("debugPanel")||this.app.isLocalDev)&&subPanelContextMenuItems.push({name:Object(l10nify_build_bundle_module.a)("Log Reportlet to Console"),onClick:function(){var reportlet=subPanel.reportlet,globalKey=Object(bundle_module.t)(reportlet);console.log("reportlet (".concat(globalKey,"): "),reportlet)}}),subPanelContextMenuItems}},{key:"duplicate",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Duplicate SubPanel"),PanelSubPanelDuplicator.duplicateSubPanel(this.app,this.subPanel)}},{key:"getVisualizationLink",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Get Visualization Link"),this.app.emit("getProjectLink",{subPanelId:this.subPanel.id})}},{key:"componentDidMount",value:function(){for(var _get2,_this3=this,_len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];(_get2=Object(esm_get.a)(Object(getPrototypeOf.a)(SubPanel.prototype),"componentDidMount",this)).call.apply(_get2,[this].concat(args));var subPanel=this.subPanel;this.$el=Object(ui_build_bundle_module.mb)(this.el),this.registerOff(subPanel.on("change:collapsed",function(e){!1===e.newValue&&_this3.reportlet.load(_this3.appContext,{queryOptionOverrides:{refreshLoadedBreakdowns:!0}})})),this.componentDidUpdate(),this.loadReportletOnMount()}},{key:"componentDidUpdate",value:function(){for(var _get3,_len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];if((_get3=Object(esm_get.a)(Object(getPrototypeOf.a)(SubPanel.prototype),"componentDidUpdate",this)).call.apply(_get3,[this].concat(args)),this.subPanel.autoDisplayDataSourceSettings&&(this.subPanel.autoDisplayDataSourceSettings=!1,this.showDataSourceSettings()),this.subPanel.autoDisplaySettings){var gear=this.$el.find(".js-settings-gear").get(0);this.subPanel.autoDisplaySettings=!1,this.showSettings(this.subPanelReportletComponent,{target:gear})}}},{key:"focus",value:function(){this.subPanelComponent&&this.subPanelComponent.focus&&this.subPanelComponent.focus()}},{key:"loadReportletOnMount",value:function(){this.subPanel.isHiddenOrCollapsed||this.reportlet.emitLoad()}},{key:"onDeleteSubPanelClick",value:function(e){var subPanel=this.subPanel;if(subPanel.linkedSource&&1===subPanel.linkedSource.linkedBy.length&&!subPanel.linkedSource.visible&&subPanel.linkedSource.remove(),subPanel.linkedBy.length>0){var linkedSubPanels=subPanel.getAllLinkedBySubPanelsThatDependOnThisSubPanel({visibleOnly:!0});ui_core_build_bundle_module.o.confirm(react_default.a.createElement("div",null,react_default.a.createElement("div",null,Object(l10nify_build_bundle_module.a)("This data source is being used by the following visualizations"),":"),react_default.a.createElement("ul",null,linkedSubPanels.map(function(item){return react_default.a.createElement("li",{key:item._key},item.label)})),react_default.a.createElement("div",null,Object(l10nify_build_bundle_module.a)("Would you like to delete these visualizations, too?"))),{title:Object(l10nify_build_bundle_module.a)("Delete Linked Visualizations?"),actionButtons:[{label:Object(l10nify_build_bundle_module.a)("No"),variant:"secondary",reject:!0},{label:Object(l10nify_build_bundle_module.a)("OK")}],closable:!0}).then(function(){subPanel.remove(!0)},function(){subPanel.visible=!1})}else subPanel.remove()}},{key:"showContextMenu",value:function(e){var _this4=this;if(!e.altKey){e.preventDefault();var items=this.getSubPanelContextMenuItems().slice(0);this.subPanel.reportlet.isReconfigurable&&!this.subPanel.reportlet.needsToBeConfigured&&items.push({name:Object(l10nify_build_bundle_module.a)("Start Over"),onClick:function(){return _this4.subPanel.reportlet.resetConfig(_this4.appContext)}}),ui_core_build_bundle_module.P.closeAll(),ui_core_build_bundle_module.ab.show({sort:!1,showSearchBar:!1,target:Object(ui_build_bundle_module.gb)(e),items:items,labelKey:"name"})}}},{key:"showLinkedVisualizations",value:function(e){var _this5=this,target=this.$el.find(".data-source-settings-icon").get(0);ui_core_build_bundle_module.P.closeAll(),ui_core_build_bundle_module.P.show({target:target,isModal:!1,closeOnClickOutside:!0,dialog:{header:Object(l10nify_build_bundle_module.a)("Data Source Settings"),closable:!0},getComponent:function(){return react_default.a.createElement(workspace_DataSourceSettings.Provider,{subPanel:_this5.subPanel})}})}},{key:"showDataSourceSettings",value:function(){var _this6=this,target=this.$el.find(".data-source-settings-icon").get(0);ui_core_build_bundle_module.P.closeAll(),ui_core_build_bundle_module.P.show({target:target,isModal:!1,closeOnClickOutside:!0,dialog:{header:Object(l10nify_build_bundle_module.a)("Data Source Settings"),info:Object(l10nify_build_bundle_module.a)("Visualization Source is where you can designate which data you want flowing into this visualization along with the option to hide that source or to lock your current cell selections."),closable:!0},getComponent:function(){return react_default.a.createElement(workspace_DataSourceSettings.Consumer,{subPanel:_this6.subPanel,subPanelComponent:_this6.subPanelComponent,onToggleLock:_this6.applyBackgroundColorToLockedSelection.bind(_this6)})},onShow:function(){_this6.applyBackgroundColorToLockedSelection()},onClose:function(){_this6.removeBackgroundColorFromLockedSelection()}})}},{key:"getLinkedSourceEl",value:function(linkedSourceId){var id=linkedSourceId||bundle_module.q.get(this,"subPanel.linkedSource.id");if(id)return this.$el.parent().parent().find(".js-an-sub-panel[data-sub-panel-id=".concat(id,"]")).first()}},{key:"applyBackgroundColorToLockedSelection",value:function(){this.removeBackgroundColorFromLockedSelection();var linkedReportlet=this.subPanel.linkedSource.reportlet;this.subPanel.linkedSource.reportlet.freeformTable;if(this.hasLockedSelection){var lockType=this.reportlet.isSelectionLockedByPositions?"positions":"items",selectedCells=this.reportlet.lockedSelection.getLockedCells({reportlet:linkedReportlet,lockType:lockType}),$selectedCells=[],$nonSelectedCells=[],selectedCellsById=bundle_module.q.indexBy(selectedCells,"id");this.getLinkedSourceEl().find(".an-DataProvider-cell").each(function(){var $cell=Object(ui_build_bundle_module.mb)(this),cellId=$cell.data("cell-id");selectedCellsById[cellId]?$selectedCells.push($cell):$nonSelectedCells.push($cell)}),$selectedCells=Object(ui_build_bundle_module.mb)($selectedCells).map(ui_build_bundle_module.mb.fn.toArray),$nonSelectedCells=Object(ui_build_bundle_module.mb)($nonSelectedCells).map(ui_build_bundle_module.mb.fn.toArray),$selectedCells.find(".an-DataProvider-cell-container").addClass("locked-selection locked-selection--locked"),$nonSelectedCells.find(".an-DataProvider-cell-container").addClass("locked-selection locked-selection--not-locked")}}},{key:"removeBackgroundColorFromLockedSelection",value:function(linkedSourceId){this.getLinkedSourceEl(linkedSourceId).find(".locked-selection").removeClass("locked-selection locked-selection--locked locked-selection--not-locked")}},{key:"showSettings",value:function(SubPanelComponent,e){this.popover=SubPanelComponent.showSettings(e,this.subPanel,this.subPanelComponent,this)}},{key:"onSelection",value:function(){this.project.selectedItem=this.subPanel}},{key:"showOberonDebugMenu",value:function(){var _showOberonDebugMenu=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(_ref){var target,items;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return target=_ref.target,_context.next=3,buildDebugMenu(this.app,bundle_module.q.get(this,"subPanel.reportlet.dataSource.id",this.subPanel.id));case 3:(items=_context.sent).length&&ui_core_build_bundle_module.ab.show({target:target,items:items});case 5:case"end":return _context.stop()}},_callee,this)}));return function(_x){return _showOberonDebugMenu.apply(this,arguments)}}()},{key:"setLoadingPercentage",value:function(value){if(this.reportletLoadingBar){var $el=Object(ui_build_bundle_module.mb)(react_dom_default.a.findDOMNode(this)),$nestedBars=$el.find(".an-nestedLoadingBar"),$loadingBar=Object(ui_build_bundle_module.mb)(this.reportletLoadingBar).add($nestedBars);if(null===value||void 0===value)return $loadingBar.find(".an-loading-bar").width("0%"),$loadingBar.css("height",0),void $el.removeClass("an-SubPanel-loading");$loadingBar.show(),$loadingBar.css("height",""),$loadingBar.find(".an-loading-bar").width(Math.round(value)+"%"),$el.addClass("an-SubPanel-loading")}}},{key:"shouldVirtualize",value:function(){return!this.subPanel.description&&(!!this.subPanel.reportlet.shouldVirtualize()&&this.subPanel.virtualize)}},{key:"getVirtualReportletHeight",value:function(){return this.subPanel.position.height-85}},{key:"render",value:function(){var _this7=this,subPanel=this.subPanel,props=this.props,virtualReportletProps={};if(!1===subPanel.visible)return null;var mappingKey=subPanel.reportletType||subPanel.type;if(!registeredReportlets[mappingKey])throw new Error("No registeredReportlets in SubPanel.js for: "+mappingKey);var SubPanelComponent=registeredReportlets[mappingKey];this.shouldVirtualize()?(SubPanelComponent=VirtualReportlet_VirtualReportlet,virtualReportletProps.heightInPixels=this.getVirtualReportletHeight()):subPanel.reportlet.needsToBeConfigured&&SubPanelComponent.SubPanelConfig&&(SubPanelComponent=SubPanelComponent.SubPanelConfig);var showSettingsGear=bundle_module.q.isFunction(SubPanelComponent.showSettings);this.subPanelReportletComponent=SubPanelComponent,ui_core_build_bundle_module.P.update(this.popover);var isDataSourceProviderSubpanel=bundle_module.q.contains(["FreeformReportlet","CohortReportlet"],subPanel.visualizationType),subPanelClasses=classnames_default()("an-Grid-item-content","js-an-sub-panel js-panel-sub-panel an-sub-panel an-sub-panel--"+subPanel.type,"an-sub-panel--"+subPanel.reportletType,SubPanelComponent.additionalSubPanelClasses,{show:!1,collapsed:subPanel.collapsed,selected:build_bundle_module.db.isActive("dynamicSelection")&&subPanel.selected}),subPanelContentClasses=classnames_default()("an-subpanel-contents",{"has-description":subPanel.description});return react_default.a.createElement(ui_core_build_bundle_module.Y,{onSelection:function(){return _this7.onSelection()}},react_default.a.createElement("div",Object.assign({"data-sub-panel-id":subPanel.id,className:subPanelClasses},Object(bundle_module.K)(props),{ref:function(el){return _this7.el=el}}),react_default.a.createElement("div",{className:"sub-panel-header an-Grid-item-content-handle"},react_default.a.createElement("div",{className:"header-outer",onContextMenu:this.showContextMenu.bind(this)},react_default.a.createElement("span",{className:"left-content"},react_default.a.createElement(ui_core_build_bundle_module.C,{"data-test-id":"data-source-settings-icon",show:subPanel.linkedSourceId,size:"XS",icon:subPanel.reportlet.isSelectionLocked?"lockOn":"circle",style:{color:subPanel.getSwatchColor()},className:"swatch-icon swatch-icon-editable an-Grid-not-handle data-source-settings-icon","data-tooltip":Object(l10nify_build_bundle_module.a)("Manage Data Source"),onClick:this.showDataSourceSettings.bind(this)}),react_default.a.createElement(ui_core_build_bundle_module.C,{show:!subPanel.linkedSourceId,size:"XS",icon:"circle",className:isDataSourceProviderSubpanel?"swatch-icon swatch-icon-editable an-Grid-not-handle data-source-settings-icon":"swatch-icon an-Grid-not-handle",style:{color:subPanel.getSwatchColor()},"data-tooltip":Object(l10nify_build_bundle_module.a)("Any visualization with this color is linked to this data source."),onClick:isDataSourceProviderSubpanel?this.showLinkedVisualizations.bind(this):function(){}})),react_default.a.createElement("span",{className:classnames_default()("right-content",{show:subPanel.hasActivePopover})},react_default.a.createElement("div",{className:"sub-panel-controls js-sub-panel-controls"},react_default.a.createElement("div",{style:{display:"inline-block"}},react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"gear",show:showSettingsGear,size:"XS",onClick:this.showSettings.bind(this,SubPanelComponent),className:"an-Grid-not-handle js-settings-gear","data-tooltip":Object(l10nify_build_bundle_module.a)("Visualization Settings")})),react_default.a.createElement(ui_core_build_bundle_module.C,{show:!subPanel.position.autoSize,size:"XS",onClick:function(){subPanel.position.autoSize=!subPanel.position.autoSize},icon:"circle","data-tooltip":Object(l10nify_build_bundle_module.a)("Return to Default Height"),className:"ad-Icon--resize an-Grid-not-handle"}),react_default.a.createElement(ui_core_build_bundle_module.lb,{action:"SubPanel Collapse/Expand"},react_default.a.createElement(ui_core_build_bundle_module.C,{size:"XS",onClick:function(e){subPanel.collapsed=!subPanel.collapsed},onDoubleClick:function(){_this7.props.updateSubPanelCollapses(!subPanel.collapsed)},icon:subPanel.collapsed?"accordionLeft":"accordionDown",className:classnames_default()("an-Grid-not-handle hide-for-print",{"coral-Icon--accordionLeft":subPanel.collapsed,"coral-Icon--accordionDown":!subPanel.collapsed})})),react_default.a.createElement(ui_core_build_bundle_module.C,{size:"XS",onClick:this.onDeleteSubPanelClick.bind(this),icon:"close","data-tooltip":Object(l10nify_build_bundle_module.a)("Delete Visualization"),className:"an-Grid-not-handle delete-chart an-Grid-not-handle"}))),build_bundle_module.Yb.includeOberonXml?react_default.a.createElement("span",{className:"oberon-xml-debug"},react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"bug",onClick:this.showOberonDebugMenu.bind(this),"data-tooltip":Object(l10nify_build_bundle_module.a)("View Ranked Requests Info")})):null,props.subPanel.supportsAnomalies?react_default.a.createElement("span",{className:"status-label"},props.subPanel.statusLabel):null,react_default.a.createElement("div",{className:"main-content overflow-truncate"},react_default.a.createElement(ui_core_build_bundle_module.l,{className:"an-sub-panel-title",value:subPanel.label,placeholder:subPanel.defaultName,onChange:function(v){subPanel.name=v}}))),react_default.a.createElement(ui_build_bundle_module.U,{ref:function(d){return _this7.description=d},style:{display:!subPanel.collapsed&&(subPanel.description||!subPanel.description&&bundle_module.q.get(this,"description.state.isEditing"))?"block":"none"},className:"an-sub-panel-description an-Grid-not-handle",size:"block",value:subPanel.description,placeholder:Object(l10nify_build_bundle_module.a)("Description"),onChange:function(v){subPanel.description=v,_this7.forceUpdate()},saveOnBlur:!0}),react_default.a.createElement("div",{className:"an-sub-panel-loading-bar-container",ref:function(node){return _this7.reportletLoadingBar=node}},react_default.a.createElement("div",{className:"an-loading-bar"}))),subPanel.collapsed?null:react_default.a.createElement(ui_build_bundle_module.w,{errorMessage:Object(l10nify_build_bundle_module.a)(SubPanel_templateObject())},react_default.a.createElement("div",{className:subPanelContentClasses},react_default.a.createElement(react_drag_drop_build_bundle_module.d.Consumer,null,function(dragManager){return react_default.a.createElement(ReportSuiteContext.a,null,function(_ref2){var reportSuite=_ref2.reportSuite;return react_default.a.createElement(SubPanelComponent,Object.assign({subPanel:subPanel,reportlet:subPanel.reportlet,reportSuite:reportSuite,dragManager:dragManager,ref:function(node){return _this7.subPanelComponent=node},setLoadingPercentage:_this7.setLoadingPercentage.bind(_this7)},virtualReportletProps))})})))))}},{key:"subPanel",get:function(){return this.props.subPanel}},{key:"reportlet",get:function(){return bundle_module.q.get(this,"subPanel.reportlet")}},{key:"project",get:function(){return this.subPanel.root}},{key:"isReconfigurable",get:function(){return bundle_module.q.get(this,"reportlet.isReconfigurable",!1)}},{key:"hasLockedSelection",get:function(){return bundle_module.q.get(this,"reportlet.lockedSelection",!1)}}]),SubPanel}(ui_build_bundle_module.d),slicedToArray=(__webpack_require__(974),__webpack_require__(111));__webpack_require__(975);function AttributionPanelConfig_templateObject(){var data=Object(taggedTemplateLiteral.a)([""," Attribution Model"]);return AttributionPanelConfig_templateObject=function(){return data},data}var _registeredConfigs,LAST_TOUCH="variables/lasttouchchannel",LAST_TOUCH_DETAIL="variables/lasttouchchanneldetail",FIRST_TOUCH="variables/firsttouchchannel",FIRST_TOUCH_DETAIL="variables/firsttouchchanneldetail",AttributionPanelConfig_AttributionPanelConfig=function(_AppComponent){function AttributionPanelConfig(props,context){var _this;return Object(classCallCheck.a)(this,AttributionPanelConfig),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(AttributionPanelConfig).call(this,props,context))).state={showAdvancedConfig:!1,loading:!1},_this}return Object(inherits.a)(AttributionPanelConfig,_AppComponent),Object(createClass.a)(AttributionPanelConfig,null,[{key:"propTypes",get:function(){return{config:ui_core_build_bundle_module.R.instanceOf(build_bundle_module.k).isRequired}}}]),Object(createClass.a)(AttributionPanelConfig,[{key:"cache",value:function(){return["attributionTemplates"]}},{key:"runReport",value:function(){var _runReport=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(){var generatedPanel,_this2=this;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return this.config.attributions.forEach(function(attribution){var context="visits"===_this2.config.context?"sessions":_this2.config.context;attribution.definition.context=context}),this.setState({loading:!0}),_context.next=4,this.config.createVisualizations(this.app);case 4:generatedPanel=_context.sent,this.config.parent.subPanels=generatedPanel.subPanels,this.setState({loading:!1}),ui_core_build_bundle_module.lb.trackAction(null,"Run Attribution Panel",{dimension:this.config.dimension.id,metric:this.config.successMetric.id,numAttributions:this.config.attributions.length,attributions:bundle_module.q.pluck(this.config.attributions,"template.id").join(", ")});case 9:case"end":return _context.stop()}},_callee,this)}));return function(){return _runReport.apply(this,arguments)}}()},{key:"toggleAdvancedConfig",value:function(show){this.setState({showAdvancedConfig:bundle_module.q.isUndefined(show)?!this.state.showAdvancedConfig:show})}},{key:"shouldShowUpdatedDimensionDialog",value:function(dimension){return[LAST_TOUCH,FIRST_TOUCH,LAST_TOUCH_DETAIL,FIRST_TOUCH_DETAIL].includes(dimension.id)&&this.app.cache.has(build_bundle_module.X,"variables/marketingchannel")}},{key:"showUpdatedDimensionDialog",value:function(){return ui_core_build_bundle_module.o.confirm(Object(l10nify_build_bundle_module.a)("The First Touch Channel, Last Touch Channel, and Channel Detail dimensions in Analysis Workspace have been replaced by a single Marketing Channels dimension. Would you like to replace your selection with the new dimension?"),{title:Object(l10nify_build_bundle_module.a)("Updated Dimension")})}},{key:"getPillGroupProps",value:function(componentType){var _this3=this,config=this.config;return{limit:1,dropZoneProps:{disbaled:function(){return config.needsToBeConfigured}},components:bundle_module.q.compact([config[componentType]]),onChange:function(){var _onChange=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee2(_ref){var value,_value,component;return regenerator_default.a.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(value=_ref.value,_value=Object(slicedToArray.a)(value,1),component=_value[0]){_context2.next=6;break}config[componentType]=null,_context2.next=19;break;case 6:if("dimension"!==componentType||!_this3.shouldShowUpdatedDimensionDialog(component)){_context2.next=18;break}return _context2.prev=7,_context2.next=10,_this3.showUpdatedDimensionDialog();case 10:config.dimension=build_bundle_module.X.fromCache(_this3.app.cache,{id:"variables/marketingchannel"}),_context2.next=16;break;case 13:_context2.prev=13,_context2.t0=_context2.catch(7),config.dimension=component;case 16:_context2.next=19;break;case 18:config[componentType]=component;case 19:case"end":return _context2.stop()}},_callee2,null,[[7,13]])}));return function(_x){return _onChange.apply(this,arguments)}}()}}},{key:"render",value:function(){var _this4=this;return react_default.a.createElement("div",{className:classnames_default()(this.props.className,"an-attribution-config an-panel-config"),"data-test-id":"attribution-panel-config"},react_default.a.createElement("div",{className:"attribution-config-wrap"},react_default.a.createElement("div",{className:"panel-config-column"},react_default.a.createElement(ui_core_build_bundle_module.B,{className:"panel-config-heading metric-heading"},Object(l10nify_build_bundle_module.a)("Success Metric")),react_default.a.createElement(ui_build_bundle_module.n,Object.assign({supportedComponentTypes:[build_bundle_module.Hb],isSupportedComponent:function(metric){return metric.allocation},placeholderLabel:Object(l10nify_build_bundle_module.a)("Add Metric")},this.getPillGroupProps("successMetric")))),react_default.a.createElement("div",{className:"panel-config-column"},react_default.a.createElement("div",{className:"an-AttributionPanelConfig-labelContainer"},react_default.a.createElement(ui_core_build_bundle_module.B,{className:"panel-config-heading dimension-heading"},Object(l10nify_build_bundle_module.a)("Channel")),react_default.a.createElement(ui_core_build_bundle_module.C.Help,{className:"an-AttributionPanelConfig-helpIcon"}),react_default.a.createElement(ui_core_build_bundle_module.kb,{position:"right",hoverable:!0},Object(l10nify_build_bundle_module.a)("Place any dimension to attribute against here. This can be marketing channels, campaigns, or any other dimension."))),react_default.a.createElement(ui_build_bundle_module.n.Dimension,this.getPillGroupProps("dimension")))),react_default.a.createElement("div",{className:"attribution-config-wrap"},react_default.a.createElement("div",{className:"panel-config-column"},react_default.a.createElement("div",{className:"an-AttributionPanelConfig-labelContainer"},react_default.a.createElement(ui_core_build_bundle_module.B,{className:"panel-config-heading model-heading"},Object(l10nify_build_bundle_module.a)("Included Models")),react_default.a.createElement(ui_core_build_bundle_module.C.Help,{className:"an-AttributionPanelConfig-helpIcon"}),react_default.a.createElement(ui_core_build_bundle_module.kb,{position:"right",hoverable:!0},Object(l10nify_build_bundle_module.a)("The model determines how credit is assigned to touchpoints. "),react_default.a.createElement(ui_core_build_bundle_module.F,{label:Object(l10nify_build_bundle_module.a)("Learn more."),target:"_blank",href:"https://experiencecloud.adobe.com/resources/help/".concat(l10nify_build_bundle_module.a.config.currentLocale,"/analytics/analysis-workspace/attribution.html")}))),this.state.attributionTemplates&&react_default.a.createElement(AttributionPanelConfig_AttributionModelSelect,{options:this.state.attributionTemplates,config:this.config})),react_default.a.createElement("div",{className:"panel-config-column"},react_default.a.createElement("div",{className:"an-AttributionPanelConfig-labelContainer"},react_default.a.createElement(ui_core_build_bundle_module.B,{className:"panel-config-heading context-heading"},Object(l10nify_build_bundle_module.a)("Lookback Window")),react_default.a.createElement(ui_core_build_bundle_module.C.Help,{className:"an-AttributionPanelConfig-helpIcon"}),react_default.a.createElement(ui_core_build_bundle_module.kb,{position:"right",hoverable:!0},Object(l10nify_build_bundle_module.a)("This setting determines the window of data attribution that will be applied to for each conversion. "),react_default.a.createElement(ui_core_build_bundle_module.F,{label:Object(l10nify_build_bundle_module.a)("Learn more."),target:"_blank",href:"https://experiencecloud.adobe.com/resources/help/".concat(l10nify_build_bundle_module.a.config.currentLocale,"/analytics/analysis-workspace/attribution.html")}))),react_default.a.createElement(ui_core_build_bundle_module.S.Group,{vertical:!0,className:"context-radio-group",selectedValue:this.config.context,onSelect:function(context){return _this4.config.context=context}},react_default.a.createElement(ui_core_build_bundle_module.S,{label:Object(l10nify_build_bundle_module.a)("Visit"),value:"visits","data-test-id":"attribution-panel-visits"}),react_default.a.createElement(ui_core_build_bundle_module.S,{value:"visitors","data-test-id":"attribution-panel-visitors"},this.reportSuite.visitorLabel," ",react_default.a.createElement("span",{style:{fontWeight:"100"}},"(",Object(l10nify_build_bundle_module.a)("Reporting Window"),")"))))),react_default.a.createElement(ui_core_build_bundle_module.f,{className:"run-attribution-button","data-test-id":"run-attribution-button",variant:"primary",onClick:function(){return _this4.runReport()},disabled:this.config.needsToBeConfigured},Object(l10nify_build_bundle_module.a)("Build")),this.state.loading&&react_default.a.createElement(ui_core_build_bundle_module.qb,{variant:"overlay",size:"L"}))}},{key:"config",get:function(){return this.props.config}},{key:"reportSuite",get:function(){return this.props.reportSuite}},{key:"advancedSettingsToggleText",get:function(){return this.state.showAdvancedConfig?Object(l10nify_build_bundle_module.a)("Hide Advanced Settings"):Object(l10nify_build_bundle_module.a)("Show Advanced Settings")}}]),AttributionPanelConfig}(ui_build_bundle_module.d),AttributionPanelConfig_AttributionModelSelect=function(_React$Component){function AttributionModelSelect(props){var _this5;return Object(classCallCheck.a)(this,AttributionModelSelect),(_this5=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(AttributionModelSelect).call(this,props))).state={textValue:_this5.getAttributionTextValue()},_this5}return Object(inherits.a)(AttributionModelSelect,_React$Component),Object(createClass.a)(AttributionModelSelect,[{key:"getAttributionTextValue",value:function(){var attributions=this.config.attributions,textValue=Object(l10nify_build_bundle_module.a)("Select Model (s)...");if(attributions.length>1)textValue=Object(l10nify_build_bundle_module.a)("Multiple Selected");else if(1===attributions.length){var template=Object(slicedToArray.a)(attributions,1)[0].template;textValue=react_default.a.createElement("span",null,react_default.a.createElement(ui_core_build_bundle_module.C,{icon:template.icon,size:"XS"})," ",template.name)}return textValue}},{key:"isTemplateSelected",value:function(template){return!!this.config.attributions.find(function(attribution){return attribution.template.id===template.id})}},{key:"isCustomOption",value:function(_ref2){var id=_ref2.id;return["allocation-positionBased","allocation-timeDecay"].includes(id)}},{key:"handleAttributionOptionMouseDown",value:function(option,event){var _this6=this,shouldShowCustomDialog=["allocation-positionBased","allocation-timeDecay"].includes(option.id)&&!this.isTemplateSelected(option),attribution=build_bundle_module.j.fromTemplate(option);if(shouldShowCustomDialog){ui_core_build_bundle_module.o.show(react_default.a.createElement(AttributionSettingsDialog.a,{selectedAttribution:attribution,applySettings:function(updatedAttribution){if("allocation-positionBased"===option.id){var _updatedAttribution$d=updatedAttribution.definition,firstWeight=_updatedAttribution$d.firstWeight,middleWeight=_updatedAttribution$d.middleWeight,lastWeight=_updatedAttribution$d.lastWeight;attribution.definition.firstWeight=firstWeight,attribution.definition.middleWeight=middleWeight,attribution.definition.lastWeight=lastWeight}else if("allocation-timeDecay"===option.id){var _updatedAttribution$d2=updatedAttribution.definition,halfLifeGranularity=_updatedAttribution$d2.halfLifeGranularity,halfLifeNumPeriods=_updatedAttribution$d2.halfLifeNumPeriods;attribution.definition.halfLifeGranularity=halfLifeGranularity,attribution.definition.halfLifeNumPeriods=halfLifeNumPeriods}_this6.onAttributionSelect(attribution,event)},customEdit:!0}),{title:Object(l10nify_build_bundle_module.a)(AttributionPanelConfig_templateObject(),option.name)})}else this.onAttributionSelect(attribution,event)}},{key:"onAttributionSelect",value:function(attributionModel){if(this.isTemplateSelected(attributionModel.template)){var index=bundle_module.q.findIndex(this.config.attributions,function(attribution){return attribution.template.id===attributionModel.template.id});this.config.attributions.splice(index,1)}else this.config.attributions.push(attributionModel);var textValue=this.getAttributionTextValue();this.setState({textValue:textValue})}},{key:"renderAttributionOption",value:function(option){var _this7=this;return react_default.a.createElement("div",{className:"an-item",onMouseDown:function(e){return _this7.handleAttributionOptionMouseDown(option,e)}},react_default.a.createElement(ui_core_build_bundle_module.k,{checked:this.isTemplateSelected(option),onChange:function(){},"data-test-id":"attribution-panel-config-".concat(bundle_module.q.kebabCase(option.name))}),this.renderAttributionOptionLabel(option),react_default.a.createElement(ui_core_build_bundle_module.C.Help,{label:option.description,className:"an-AttributionModelSelect-helpIcon"}))}},{key:"renderCustomAttributionLabel",value:function(_ref3){var id=_ref3.id,attributionModel=this.config.attributions.find(function(attribution){return attribution.template.id===id});if(attributionModel){if("allocation-positionBased"===id){var _attributionModel$def=attributionModel.definition,firstWeight=_attributionModel$def.firstWeight,middleWeight=_attributionModel$def.middleWeight,lastWeight=_attributionModel$def.lastWeight;return"(".concat(firstWeight,"/").concat(middleWeight,"/").concat(lastWeight,")")}if("allocation-timeDecay"===id){var _attributionModel$def2=attributionModel.definition,halfLifeGranularity=_attributionModel$def2.halfLifeGranularity,halfLifeNumPeriods=_attributionModel$def2.halfLifeNumPeriods;return"(".concat(halfLifeNumPeriods,"/").concat(halfLifeGranularity,")")}}return null}},{key:"renderAttributionOptionLabel",value:function(option){return react_default.a.createElement("div",{style:{width:"100%"},"data-title":!0},react_default.a.createElement(ui_core_build_bundle_module.C,{icon:option.icon}),react_default.a.createElement("span",null,"\xa0",option.name,"\xa0",this.isCustomOption(option)&&react_default.a.createElement("em",{className:"an-AttributionModelSelect-customDetail"},this.renderCustomAttributionLabel(option))))}},{key:"render",value:function(){return react_default.a.createElement(ui_core_build_bundle_module.W,{className:"included-models-select",menuContainerClassName:"included-models-select-menu",multi:!1,searchable:!1,options:this.options,optionRenderer:this.renderAttributionOption.bind(this),placeholder:this.state.textValue,allowCreate:!1,clearable:!1,closeOnSelect:!1,onChange:function(){}})}},{key:"config",get:function(){return this.props.config}},{key:"options",get:function(){return this.props.options.filter(function(o){return"allocation-participation"!==o.id})}}]),AttributionModelSelect}(react_default.a.Component),AudienceComparisonPanelConfig_AudienceComparisonPanelConfig=(__webpack_require__(976),function(_AppComponent){function AudienceComparisonPanelConfig(props,context){var _this;return Object(classCallCheck.a)(this,AudienceComparisonPanelConfig),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(AudienceComparisonPanelConfig).call(this,props,context))).state={showAdvancedConfig:!1,validSegments:[]},_this.toggleAdvancedConfig=_this.toggleAdvancedConfig.bind(Object(assertThisInitialized.a)(_this)),_this._inverseSegment=null,_this._secondSegmentSetManually=!1,_this}return Object(inherits.a)(AudienceComparisonPanelConfig,_AppComponent),Object(createClass.a)(AudienceComparisonPanelConfig,null,[{key:"propTypes",get:function(){return{config:ui_core_build_bundle_module.R.object.isRequired}}}]),Object(createClass.a)(AudienceComparisonPanelConfig,[{key:"cache",value:function(){return["metrics","dimensions","segments"]}},{key:"componentDidMount",value:function(){var _this2=this;Object(esm_get.a)(Object(getPrototypeOf.a)(AudienceComparisonPanelConfig.prototype),"componentDidMount",this).call(this);var config=this.props.config;this.audienceComparisonService=new build_bundle_module.n(this.appContext),this.segmentUtilityService=new build_bundle_module.kc(this.app),this.config.hiddenBlacklistComponentIds||this.app.cache.when("segments","dimensions","metrics").then(function(){_this2.audienceComparisonService.getDefaultComponentBlacklist().then(function(data){_this2.config.hiddenBlacklistComponentIds=data.hiddenBlacklistIds,_this2.config.emit("change"),_this2.config.blacklistComponents.length||(_this2.config.blacklistComponents=_this2.getBlacklistComponentsFromIds(data.defaultBlacklistIds)),!0===_this2.config.autorun&&_this2.autorunReport()})}),config.firstSegment&&this.validateSegment(config.firstSegment),config.secondSegment&&this.validateSegment(config.secondSegment),this.registerOff(this.config.on("segmentsUpdated",this.refreshSegmentPills.bind(this)))}},{key:"autorunReport",value:function(){var _this3=this,opts={hasInverseSegment:!0,appMetrics:this.state.metrics,appDimensions:this.state.dimensions,appSegments:this.state.segments,uniqueVisitors:this.app.cache.get(build_bundle_module.Hb,"metrics/visitors")};build_bundle_module.sc.runAndIgnoreAllChanges(function(){_this3.config.runReport(_this3.app,opts)})}},{key:"getBlacklistComponentsFromIds",value:function(ids){var blacklistEntityTypes=[build_bundle_module.ec,build_bundle_module.Hb,build_bundle_module.X];return bundle_module.q.compact(ids.map(function(id){var entity,_this4=this;return blacklistEntityTypes.forEach(function(Type){_this4.app.cache.has(Type,id)&&(entity=_this4.app.cache.get(Type,id))}),entity}.bind(this)))}},{key:"toggleAdvancedConfig",value:function(show){this.setState({showAdvancedConfig:bundle_module.q.isUndefined(show)?!this.state.showAdvancedConfig:show})}},{key:"refreshSegmentPills",value:function(){var _this5=this,firstPillGroupInstance=this.firstPillGroup,secondPillGroupInstance=this.secondPillGroup;new Promise(function(resolve,reject){_this5.config.secondSegment?secondPillGroupInstance.updateComponents({added:_this5.config.secondSegment}).then(resolve,reject):resolve()}).then(function(){_this5.config.firstSegment&&firstPillGroupInstance.updateComponents({added:_this5.config.firstSegment})})}},{key:"runComparison",value:function(){var _this6=this,opts={hasInverseSegment:[this.config.firstSegment.id,this.config.secondSegment.id].indexOf(bundle_module.q.get(this._inverseSegment,"id"))>-1,appMetrics:this.state.metrics,appDimensions:this.state.dimensions,appSegments:this.state.segments,uniqueVisitors:this.app.cache.get(build_bundle_module.Hb,"metrics/visitors")};this.toggleAdvancedConfig(!1),ui_core_build_bundle_module.lb.trackAction(null,"Run Segment Comparison",{usedEveryoneElseSegment:opts.hasInverseSegment});var preRunPromises=[];return this.config.parent.subPanels.length&&preRunPromises.push(ui_core_build_bundle_module.o.confirm(Object(l10nify_build_bundle_module.a)("Are you sure you want to clear this report and create a new one?"))),Promise.all(preRunPromises).then(function(){build_bundle_module.sc.createChangeSet(function(changeSet){_this6.config.setCurrentChangeSet(changeSet,_this6.app,_this6.appContext),_this6.config.runReport(_this6.app,opts)},_this6.config)()})}},{key:"validateSegment",value:function(segment){var _this7=this;return this.segmentUtilityService=this.segmentUtilityService||new build_bundle_module.kc(this.app),segment?this.state.validSegments.includes(segment)?Promise.resolve(!0):segment===this._inverseSegment?(this.setState({validSegments:[].concat(Object(toConsumableArray.a)(this.state.validSegments),[segment])}),Promise.resolve(!0)):this.segmentUtilityService.validateSegment(segment).then(function(result){var isValid=bundle_module.q.get(result,"data.valid",!1);return!0===isValid?_this7.setState({validSegments:[].concat(Object(toConsumableArray.a)(_this7.state.validSegments),[segment])}):!1===isValid&&_this7.app.addAlert({variant:"error",contents:Object(l10nify_build_bundle_module.a)('The segment "%1$s" is invalid.  Use the Segment Builder to correct any invalid rules before running Segment Comparison.',[segment.name]),closable:!0,autoHide:!1}),isValid}):Promise.resolve(!1)}},{key:"addEveryoneElseSegmentIfNecessary",value:function(){var _this8=this,secondPillGroupInstance=this.secondPillGroup,config=this.props.config;if(secondPillGroupInstance&&config.firstSegment&&(!config.secondSegment||bundle_module.q.get(config.secondSegment,"id")===bundle_module.q.get(this._inverseSegment,"id"))){if(bundle_module.q.get(config,"firstSegment.template"))return;secondPillGroupInstance.setState({loading:!0});var inverseSegmentName=Object(l10nify_build_bundle_module.a)("Everyone Else");return this.segmentUtilityService=this.segmentUtilityService||new build_bundle_module.kc(this.app),this.segmentUtilityService.createInverseSegment(config.firstSegment.id,inverseSegmentName).then(function(segment){_this8._secondSegmentSetManually||(secondPillGroupInstance.setState({loading:!1}),_this8._inverseSegment=segment,secondPillGroupInstance.updateComponents({added:[_this8._inverseSegment]}),_this8._secondSegmentSetManually=!1)})}}},{key:"render",value:function(){var _this9=this,config=this.props.config,self=this,segmentPillProps={limit:1,dropTargetProps:{disabled:function(dragData){return config.isLoading}}},firstSegmentPillProps=bundle_module.q.extend({},segmentPillProps,{components:bundle_module.q.compact([config.firstSegment]),onChange:function(e){config.firstSegment=e.value[0],_this9._secondSegmentSetManually=!1,_this9.validateSegment(e.value[0]).then(function(segmentIsValid){segmentIsValid&&_this9.addEveryoneElseSegmentIfNecessary()})}}),secondSegmentPillProps=bundle_module.q.extend({},segmentPillProps,{components:bundle_module.q.compact([config.secondSegment]),onChange:function(e){bundle_module.q.get(e,"value[0].name","")!==Object(l10nify_build_bundle_module.a)("Everyone Else")&&(_this9._secondSegmentSetManually=!0),config.secondSegment=e.value[0],_this9.validateSegment(e.value[0])}}),defaultBlacklistIds=[];var blacklistDropTargetOptions={items:this.config.blacklistComponents,supportedComponentTypes:[build_bundle_module.X,build_bundle_module.ec,build_bundle_module.Hb],label:Object(l10nify_build_bundle_module.a)("Excluded Components"),buttonOpts:{disabled:function(){var blacklistDropTargetIds=bundle_module.q.map(blacklistDropTargetOptions.items,"id");return bundle_module.q.isEqual(blacklistDropTargetIds.sort(),defaultBlacklistIds.sort())},onClick:function(){return self.audienceComparisonService.saveDefaultComponentBlacklist(blacklistDropTargetOptions.items).then(function(){defaultBlacklistIds=bundle_module.q.map(blacklistDropTargetOptions.items,"id"),self.app.addAlert({variant:"success",contents:Object(l10nify_build_bundle_module.a)("Excluded components were successfully saved.")})})},label:Object(l10nify_build_bundle_module.a)("Set as default")},clearButtonOpts:{disabled:function(){return!self.config.blacklistComponents.length},onClick:function(){ui_core_build_bundle_module.o.confirm(Object(l10nify_build_bundle_module.a)("Are you sure you want to clear all excluded dimensions?")).then(function(){self.config.blacklistComponents=[]}).catch(function(){})},label:Object(l10nify_build_bundle_module.a)("Clear All")},onChange:function(e){_this9.config.blacklistComponents=e.value}};return react_default.a.createElement("div",{className:classnames_default()(this.props.className,"an-audience-comparison-config an-panel-config")},react_default.a.createElement("div",{className:"audience-comparison-config-wrap"},react_default.a.createElement("div",{className:"panel-config-column"},react_default.a.createElement(ui_core_build_bundle_module.B,{className:"panel-config-heading segment-heading"},Object(l10nify_build_bundle_module.a)("Add a segment")),react_default.a.createElement(ui_build_bundle_module.n.Segment,Object.assign({},firstSegmentPillProps,{ref:function(g){return _this9.firstPillGroup=g}}))),react_default.a.createElement("div",{className:"panel-config-column"},react_default.a.createElement(ui_core_build_bundle_module.B,{className:"panel-config-heading segment-heading"},Object(l10nify_build_bundle_module.a)("Compare Against")),react_default.a.createElement(ui_build_bundle_module.n.Segment,Object.assign({},secondSegmentPillProps,{ref:function(g){return _this9.secondPillGroup=g}}))),react_default.a.createElement("div",{className:"panel-config-column run-comparison-column"},react_default.a.createElement(ui_core_build_bundle_module.f,{className:"run-comparison-button",variant:"primary",disabled:!this.segmentsAreValid||!config.hasSegments()||!config.hiddenBlacklistComponentIds,onClick:function(){return _this9.runComparison()}},Object(l10nify_build_bundle_module.a)("Build")))),this.state.showAdvancedConfig?react_default.a.createElement(ui_core_build_bundle_module.F,{className:"audience-config-advanced-link",onClick:function(e){return _this9.toggleAdvancedConfig()}},Object(l10nify_build_bundle_module.a)("Hide Advanced Settings")):react_default.a.createElement(ui_core_build_bundle_module.F,{className:"audience-config-advanced-link",onClick:function(e){return _this9.toggleAdvancedConfig()}},Object(l10nify_build_bundle_module.a)("Show Advanced Settings")),this.state.showAdvancedConfig?react_default.a.createElement("div",{className:"audience-comparison-advanced-config-wrap"},react_default.a.createElement("div",{className:"advanced-option"},react_default.a.createElement(ui_build_bundle_module.A,blacklistDropTargetOptions))):null)}},{key:"config",get:function(){return this.props.config}},{key:"deletePanelWarning",get:function(){return Object(l10nify_build_bundle_module.a)("This segment comparison analysis is not finished loading. If you remove this panel, then this analysis will stop processing.")}},{key:"segmentsAreValid",get:function(){var config=this.props.config,firstSegmentIsValid=this.state.validSegments.includes(config.firstSegment),secondSegmentIsValid=this.state.validSegments.includes(config.secondSegment);return firstSegmentIsValid&&secondSegmentIsValid}}]),AudienceComparisonPanelConfig}(ui_build_bundle_module.d)),$=(__webpack_require__(977),ui_build_bundle_module.mb),ContributionAnalysisPanelConfig_ContributionAnalysisPanelConfig=function(_AppComponent){function ContributionAnalysisPanelConfig(props,context){var _this;return Object(classCallCheck.a)(this,ContributionAnalysisPanelConfig),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(ContributionAnalysisPanelConfig).call(this,props,context))).state={runButtonEnabled:_this.canRunCA},_this.disableRunButton=_this.disableRunButton.bind(Object(assertThisInitialized.a)(_this)),_this.config=props.config,_this.defaultBlacklistIds=[],_this.blacklistDropTargetOptions={items:_this.config.blacklistComponents,supportedComponentTypes:[build_bundle_module.X],label:Object(l10nify_build_bundle_module.a)("Excluded Dimensions"),buttonOpts:{disabled:_this.blackListDropTargetIsDefaults.bind(Object(assertThisInitialized.a)(_this)),onClick:_this.saveDefaultBlacklist.bind(Object(assertThisInitialized.a)(_this)),label:Object(l10nify_build_bundle_module.a)("Set as default")},clearButtonOpts:{disabled:function(){return!_this.config.blacklistComponents.length},onClick:_this.clearBlacklist.bind(Object(assertThisInitialized.a)(_this)),label:Object(l10nify_build_bundle_module.a)("Clear All")},onChange:function(e){_this.config.blacklistComponents=e.value}},_this}return Object(inherits.a)(ContributionAnalysisPanelConfig,_AppComponent),Object(createClass.a)(ContributionAnalysisPanelConfig,[{key:"cache",value:function(){return["dimensions"]}},{key:"componentDidMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(ContributionAnalysisPanelConfig.prototype),"componentDidMount",this).call(this),this.app.on("contributionAnalysisDisabled",this.disableRunButton)}},{key:"componentWillUnmount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(ContributionAnalysisPanelConfig.prototype),"componentWillUnmount",this).call(this),this.app.off("contributionAnalysisDisabled",this.disableRunButton)}},{key:"disableRunButton",value:function(){this.setState({runButtonEnabled:!1})}},{key:"saveDefaultBlacklist",value:function(){var _this2=this,itemsToSave={dimensions:bundle_module.q.map(this.blacklistDropTargetOptions.items,function(item){return{id:item.id,hidden:!1}})};return build_bundle_module.K.saveDefaultBlacklist(this.app.appService,this.app.reportSuite.rsid,itemsToSave).then(function(){_this2.defaultBlacklistIds=bundle_module.q.map(_this2.blacklistDropTargetOptions.items,"id"),_this2.app.addAlert({variant:"success",contents:Object(l10nify_build_bundle_module.a)("Excluded dimensions were successfully saved.")})})}},{key:"clearBlacklist",value:function(){var _this3=this;ui_core_build_bundle_module.o.confirm(Object(l10nify_build_bundle_module.a)("Are you sure you want to clear all excluded dimensions?")).then(function(){_this3.config.blacklistComponents=[]}).catch(function(){})}},{key:"blackListDropTargetIsDefaults",value:function(){var blacklistDropTargetIds=bundle_module.q.map(this.blacklistDropTargetOptions.items,"id");return bundle_module.q.isEqual(blacklistDropTargetIds.sort(),this.defaultBlacklistIds.sort())}},{key:"incrementUsedTokenCount",value:function(){ui_build_bundle_module.x.ContributionAnalysis.incrementUsedTokenCount(this.app)}},{key:"showRemainingTokensMessage",value:function(){var alertType=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"info",numTokensRemaining=this.numTokensRemaining,tokens=1===numTokensRemaining?"token":"tokens",warningMessage=Object(l10nify_build_bundle_module.a)("You have **%1$s Contribution Analysis %2$s** remaining.",[numTokensRemaining,tokens]);this.app.user.isAdmin&&(warningMessage=Object(l10nify_build_bundle_module.a)("You have **%1$s Contribution Analysis %2$s** remaining. To restrict who can use these tokens, edit your group permissions.",[numTokensRemaining,tokens])),this.app.addAlert({variant:alertType,contents:react_default.a.createElement(ui_core_build_bundle_module.J,{variant:"inline"},warningMessage),autoHide:!1,closable:!0})}},{key:"rerenderProjectIfNeeded",value:function(){this.numTokensRemaining<=0&&(this.config.parent.parentProject.broadcast("project:render"),this.app.emit("contributionAnalysisDisabled"))}},{key:"runContributionAnalysis",value:function(){var _this4=this;this.canRunCA?(-1!==this.app.featureAccess.contributionAnalysis.usageTokens&&(this.incrementUsedTokenCount(),this.showRemainingTokensMessage(),this.rerenderProjectIfNeeded()),build_bundle_module.sc.createChangeSet(function(changeSet){_this4.config.setCurrentChangeSet(changeSet,_this4.app,_this4.appContext),_this4.config.runReport(_this4.app,{appDimensions:_this4.state.dimensions}).then(function(){setTimeout(function(){$("body").trigger("content:resize")},10)})},this.config)(),ui_core_build_bundle_module.lb.trackAction(null,"Run Contribution Analysis")):this.showRemainingTokensMessage("error")}},{key:"cacheInitialized",value:function(){var _this5=this;build_bundle_module.K.getDefaultBlacklist(this.app.appService,this.app.reportSuite.rsid).then(function(data){build_bundle_module.sc.runAndIgnoreAllChanges(function(){_this5.config.hiddenBlacklistComponentIds=data.hiddenBlacklistIds,_this5.defaultBlacklistIds=data.defaultBlacklistIds,_this5.config.blacklistComponents=bundle_module.q.compact(_this5.defaultBlacklistIds.map(function(id){return _this5.app.cache.has(build_bundle_module.X,id)?_this5.app.cache.get(build_bundle_module.X,id):null})),_this5.setState({})})})}},{key:"render",value:function(){var _this6=this,config=this.props.config,displayConfigAsOverlay=config.parent.visibleSubPanels.length>0&&!config.isLoading;return react_default.a.createElement("div",{className:classnames_default()("an-panel-config","panel-expanded-config",{"is-overlay":displayConfigAsOverlay})},react_default.a.createElement("div",{className:"an-ContributionAnalysisPanelConfig-configWrap"},react_default.a.createElement(ui_build_bundle_module.A,Object.assign({},Object.assign({},this.blacklistDropTargetOptions),{disabled:function(){return _this6.config.isLoading}}))),react_default.a.createElement("div",{className:"an-ContributionAnalysisPanelConfig-configWrap"},react_default.a.createElement("div",{className:"panel-config-column run-comparison-column"},react_default.a.createElement(ui_core_build_bundle_module.f,{className:"an-ContributionAnalysisPanelConfig-runComparisonButton",variant:"primary",disabled:!this.state.dimensions||!this.state.runButtonEnabled,onClick:this.runContributionAnalysis.bind(this)},Object(l10nify_build_bundle_module.a)("Run Contribution Analysis"))),!this.state.runButtonEnabled&&react_default.a.createElement(ui_core_build_bundle_module.kb,null,Object(l10nify_build_bundle_module.a)("You have 0 Contribution Analysis tokens remaining."))))}},{key:"numTokensRemaining",get:function(){return this.app.featureAccess.contributionAnalysis.usageTokens-this.app.featureAccess.contributionAnalysis.currentlyUsedUsageTokensCount}},{key:"canRunCA",get:function(){return ui_build_bundle_module.x.ContributionAnalysis.hasAccess(this.app)}},{key:"deletePanelWarning",get:function(){return Object(l10nify_build_bundle_module.a)("This contribution analysis is not finished loading. If you remove this panel, then this analysis will stop processing.")}}]),ContributionAnalysisPanelConfig}(ui_build_bundle_module.d),registeredConfigs=(_registeredConfigs={},Object(defineProperty.a)(_registeredConfigs,build_bundle_module.k.TYPE,AttributionPanelConfig_AttributionPanelConfig),Object(defineProperty.a)(_registeredConfigs,build_bundle_module.m.TYPE,AudienceComparisonPanelConfig_AudienceComparisonPanelConfig),Object(defineProperty.a)(_registeredConfigs,build_bundle_module.L.TYPE,ContributionAnalysisPanelConfig_ContributionAnalysisPanelConfig),_registeredConfigs),PanelConfig_PanelConfig=function(_AppComponent){function PanelConfig(){return Object(classCallCheck.a)(this,PanelConfig),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(PanelConfig).apply(this,arguments))}return Object(inherits.a)(PanelConfig,_AppComponent),Object(createClass.a)(PanelConfig,[{key:"onDeletePanelClick",value:function(){var _this=this,config=this.props.config,deletePanelWarning=bundle_module.q.get(this,"customConfig.deletePanelWarning",Object(l10nify_build_bundle_module.a)("Are you sure you want to delete this panel?"));"function"===typeof config.isStreaming&&config.isStreaming()?ui_core_build_bundle_module.o.confirm(deletePanelWarning,{confirmButtonLabel:Object(l10nify_build_bundle_module.a)("Yes, remove this panel")}).then(function(){config.cancelReports(_this.app),config.parent.remove(),build_bundle_module.sc.getCurrentChangeSet(config).afterUndo(function(){config.returnToConfigState()})}).catch(function(){}):config.parent.remove()}},{key:"componentDidMount",value:function(){var _this2=this;Object(esm_get.a)(Object(getPrototypeOf.a)(PanelConfig.prototype),"componentDidMount",this).call(this);var config=this.props.config;this.domNode=react_dom_default.a.findDOMNode(this);var $el=Object(ui_build_bundle_module.mb)(this.domNode),$expandedConfigSection=$el.find(".panel-expanded-config");$el.closest(".an-panel-contents").find(".an-panel-subpanels").append($expandedConfigSection);var slideUpOrDown=function(e){if($expandedConfigSection){var action="slideDown";e.newValue||(action="slideUp"),$expandedConfigSection[action](200)}};config.on("change:expand",slideUpOrDown),config instanceof build_bundle_module.k&&config.parentProject.on("change:reportSuite",function(){return _this2.forceUpdate()}),slideUpOrDown({newValue:config.expand}),this.observe(config)}},{key:"componentWillUnmount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(PanelConfig.prototype),"componentWillUnmount",this).call(this),this.props.config.off("change:expand")}},{key:"render",value:function(){var _this3=this,props=this.props,config=props.config,CustomConfig=registeredConfigs[props.config.type],displayConfigAsOverlay=config.parent.visibleSubPanels.length>0&&!config.isLoading;return CustomConfig?react_default.a.createElement("div",{className:"an-panel-config"},react_default.a.createElement("div",{className:"panel-config-header"},react_default.a.createElement("div",{className:"panel-config-description overflow-truncate"},react_default.a.createElement("span",{"data-tooltip":config.descriptionMeta},config.description)),displayConfigAsOverlay?react_default.a.createElement(ui_core_build_bundle_module.C,{icon:config.expand?"minus":"gear",size:"S","data-tooltip":config.expand?Object(l10nify_build_bundle_module.a)("Collapse Panel Configuration"):Object(l10nify_build_bundle_module.a)("Configure Panel"),onClick:function(){config.expand=!config.expand},className:"config-icon"}):null),react_default.a.createElement(CustomConfig,{ref:function(c){return _this3.customConfig=c},reportSuite:config.parentProject.reportSuite,className:classnames_default()("panel-expanded-config",{"is-overlay":displayConfigAsOverlay}),config:config})):null}}]),PanelConfig}(ui_build_bundle_module.d);PanelConfig_PanelConfig.TYPE="panelConfig";__webpack_require__(978);function BlankPanelVizList_BlankPanelVizList(props){return react_default.a.createElement("div",{"data-test-id":"blank-panel",className:"an-BlankPanelVizList-container"},["FreeformReportlet","Fallout","Flow","CohortReportlet","HistogramReportlet","VennReportlet","MapReportlet"].map(function(vizType,idx){var viz=function(vizType){return build_bundle_module.Nc.all.find(function(visualization){return visualization.vizType===vizType})}(vizType);return react_default.a.createElement(ui_core_build_bundle_module.lb,{action:"Added Visualization from Blank Panel",params:{chartType:vizType},key:idx},react_default.a.createElement("div",{className:"an-BlankPanelVizList-vizSquare",onClick:function(e){return function(e,viz){e.target.classList.contains("coral-Icon--infoCircle")||props.onVizClick(viz.vizType)}(e,viz)}},react_default.a.createElement("p",null,react_default.a.createElement(ui_core_build_bundle_module.C,{icon:viz.icon,className:"an-BlankPanelVizList-vizIcon"})),react_default.a.createElement("p",{className:"an-BlankPanelVizList-label","data-title":!0},viz.label),viz.isNew&&react_default.a.createElement("div",{className:"an-BlankPanelVizList-newIcon"},react_default.a.createElement("div",null,react_default.a.createElement(ui_build_bundle_module.L,{newIconForBlankPanelViz:!0}),react_default.a.createElement("div",{className:"an-BlankPanelVizList-newIconTriangle"}))),react_default.a.createElement("div",{className:"an-BlankPanelVizList-infoIcon",key:"previewIcon",onClick:function(e){return props.onPreviewClick(e,viz)}},react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"infoCircle",size:"XS"}))))}))}var EmptyPanelComponent_EmptyPanelComponent=function(_AppComponent){function EmptyPanelComponent(){return Object(classCallCheck.a)(this,EmptyPanelComponent),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(EmptyPanelComponent).apply(this,arguments))}return Object(inherits.a)(EmptyPanelComponent,_AppComponent),Object(createClass.a)(EmptyPanelComponent,[{key:"componentDidMount",value:function(){for(var _get2,_len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];(_get2=Object(esm_get.a)(Object(getPrototypeOf.a)(EmptyPanelComponent.prototype),"componentDidMount",this)).call.apply(_get2,[this].concat(args)),this.observe(this.app.user.uiSettings,"change:newBlankPanelAsDefault"),this.observe(this.app.user.uiSettings,"refresh")}},{key:"onBlankPanelDefaultChange",value:function(e){var checked=e.target.checked;this.app.user.uiSettings.setAttribute("newBlankPanelAsDefault",checked),checked&&ui_core_build_bundle_module.lb.trackAction(null,"New Blank Panel As Default Selected")}},{key:"render",value:function(){var props=this.props,panel=props.panel,blankPanelVizListProps={onVizClick:props.onVizClick,onPreviewClick:props.onPreviewClick},checkboxProps={checked:this.app.user.uiSettings.getAttribute("newBlankPanelAsDefault"),onChange:this.onBlankPanelDefaultChange.bind(this),label:Object(l10nify_build_bundle_module.a)("Make this my default state for new projects")};return panel.config?null:react_default.a.createElement("div",{className:classnames_default()("empty-panel-message",props.classNames)},react_default.a.createElement(ui_core_build_bundle_module.y,null,Object(l10nify_build_bundle_module.a)("Start analyzing with one of these visualization options")),react_default.a.createElement(BlankPanelVizList_BlankPanelVizList,blankPanelVizListProps),react_default.a.createElement(ui_core_build_bundle_module.k,Object.assign({},checkboxProps,{"data-test-id":"empty-panel-default-state"})))}}]),EmptyPanelComponent}(ui_build_bundle_module.d),prop_types=__webpack_require__(4),prop_types_default=__webpack_require__.n(prop_types),VirtualizePanelContents_$=ui_build_bundle_module.mb,workspace_VirtualizePanelContents=function(componentToEnhance){return function(_React$Component){function _class(){var _getPrototypeOf2,_this;Object(classCallCheck.a)(this,_class);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=Object(possibleConstructorReturn.a)(this,(_getPrototypeOf2=Object(getPrototypeOf.a)(_class)).call.apply(_getPrototypeOf2,[this].concat(args)))).refreshVirtualizationThrottled=bundle_module.q.throttle(function(){_this.refreshVirtualization()},700,{leading:!1,trailing:!0}),_this.state={},_this.offFunctions=[],_this.onShellContentsScroll=_this.onShellContentsScroll.bind(Object(assertThisInitialized.a)(_this)),_this.onPanelAreaScroll=_this.onPanelAreaScroll.bind(Object(assertThisInitialized.a)(_this)),_this.onGridstackChange=_this.onGridstackChange.bind(Object(assertThisInitialized.a)(_this)),_this}return Object(inherits.a)(_class,_React$Component),Object(createClass.a)(_class,null,[{key:"propTypes",get:function(){return{panel:prop_types_default.a.instanceOf(build_bundle_module.Rb).isRequired,disableVirtualization:prop_types_default.a.bool}}},{key:"defaultProps",get:function(){return{disableVirtualization:!1}}}]),Object(createClass.a)(_class,[{key:"componentDidMount",value:function(){this.domNode=react_dom_default.a.findDOMNode(this),this.anPanelSubPanelsContents=this.domNode.closest(".an-panel-subpanels"),this.viewportTop=0,this.shellScrollContentsEl=this.domNode.closest(".an-ViewLayout-scrollContent"),this.panelEl=this.domNode.closest(".an-panel"),this.$body=VirtualizePanelContents_$(document.body),this.props.disableVirtualization||this.setUpEventListeners()}},{key:"componentDidUpdate",value:function(prevProps){prevProps.disableVirtualization!==this.props.disableVirtualization&&(this.props.disableVirtualization?this.unregisterEventListeners():this.setUpEventListeners(),this.refreshVirtualizationThrottled())}},{key:"componentWillUnmount",value:function(){this.unregisterEventListeners()}},{key:"setUpEventListeners",value:function(){var _this2=this;this.registerOff(ui_core_build_bundle_module.rb.on(this.shellScrollContentsEl,"scroll",this.onShellContentsScroll)),document.body.addEventListener("an-Grid-refresh-complete",this.onGridstackChange),this.offFunctions.push(function(){return document.body.removeEventListener("an-Grid-refresh-complete",_this2.onGridstackChange)})}},{key:"unregisterEventListeners",value:function(){this.offFunctions.forEach(function(f){return f()}),this.refreshVirtualizationThrottled.cancel()}},{key:"registerOff",value:function(){var _this$offFunctions;(_this$offFunctions=this.offFunctions).push.apply(_this$offFunctions,arguments)}},{key:"onShellContentsScroll",value:function(e){this.scrollAreaIsAtTopOrBottom(e)?this.refreshVirtualization():this.refreshVirtualizationThrottled()}},{key:"onPanelAreaScroll",value:function(e){this.refreshVirtualizationThrottled()}},{key:"onGridstackChange",value:function(){var newKey=this.generateCacheKey();newKey!==this.cacheKey&&this.refreshVirtualizationThrottled(),this.cacheKey=newKey}},{key:"scrollAreaIsAtTopOrBottom",value:function(e){var _e$target=e.target,scrollTop=_e$target.scrollTop,scrollHeight=_e$target.scrollHeight,offsetHeight=_e$target.offsetHeight;return 0===scrollTop||offsetHeight+scrollTop===scrollHeight}},{key:"generateCacheKey",value:function(){return"".concat(this.panel.position.y,"|").concat(this.panel.position.height)}},{key:"refreshVirtualization",value:function(){var _this3=this,panelClientRect=this.panelEl.getBoundingClientRect(),subPanelsContainerTop=this.anPanelSubPanelsContents.getBoundingClientRect().top,opts={panelTop:panelClientRect.top,panelBottom:panelClientRect.bottom,viewportTop:this.viewportTop,viewportBottom:this.viewportBottom};this.panel.subPanels.forEach(function(subPanel){_this3.props.disableVirtualization?subPanel.virtualize=!1:subPanel.virtualize=_this3.shouldVirtualizeSubPanel(subPanel,subPanelsContainerTop,opts)})}},{key:"containerContains",value:function(containerTop,containerBottom,containeeTop,containeeBottom){return containeeTop>=containerTop&&containeeTop<=containerBottom||containeeBottom<=containerBottom&&containeeBottom>=containerTop||containeeTop<=containerTop&&containeeBottom>=containerBottom}},{key:"shouldVirtualizeSubPanel",value:function(subPanel,subPanelsContainerTop){var params=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},subPanelHeight=subPanel.position.height,subPanelTop=subPanel.position.y,subPanelBottom=subPanelTop+subPanelHeight;return subPanelTop+=subPanelsContainerTop,subPanelBottom+=subPanelsContainerTop,this.shouldVirtualize(Object(objectSpread.a)({subPanelTop:subPanelTop,subPanelBottom:subPanelBottom},params))}},{key:"shouldVirtualize",value:function(){var params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},panelTop=params.panelTop,panelBottom=params.panelBottom,viewportTop=params.viewportTop,viewportBottom=params.viewportBottom,subPanelTop=params.subPanelTop,subPanelBottom=params.subPanelBottom;if([panelTop,subPanelTop,viewportTop].some(function(p){return!Object(bundle_module.C)(p)}))return!1;var panelIsInViewport=this.containerContains(viewportTop-5e3,viewportBottom+5e3,panelTop,panelBottom),subPanelIsInViewport=this.containerContains(viewportTop-5e3,viewportBottom+5e3,subPanelTop,subPanelBottom),shouldVirtualize=!panelIsInViewport||!subPanelIsInViewport;return shouldVirtualize}},{key:"render",value:function(){var props=bundle_module.q.omit(this.props,Object.keys(this.constructor.propTypes));return react_default.a.createElement(componentToEnhance,Object(objectSpread.a)({},props),this.props.children)}},{key:"panel",get:function(){return this.props.panel}},{key:"viewportBottom",get:function(){return window.innerHeight||document.documentElement.clientHeight}}]),_class}(react_default.a.Component)};__webpack_require__(979);function Panel_templateObject(){var data=Object(taggedTemplateLiteral.a)(["An error is preventing this panel from rendering. You can try refreshing your project. If the error persists, try rebuilding the panel."]);return Panel_templateObject=function(){return data},data}var GridWithVirtualization=workspace_VirtualizePanelContents(ui_build_bundle_module.z),Panel_$=ui_build_bundle_module.mb,Panel_Panel=function(_AppComponent){function Panel(props,context){var _this;Object(classCallCheck.a)(this,Panel),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(Panel).call(this,props,context))).subPanelRefs={};var self=Object(assertThisInitialized.a)(_this);props.panel;return _this.updateDisabled=_this.updateDisabled.bind(Object(assertThisInitialized.a)(_this)),_this.updateDisabled(),_this.observe(_this.panel,"project:change"),_this.observe(_this.app,ui_build_bundle_module.f.DEFINITION_UPDATED,function(entity){(bundle_module.q.some(_this.panel.segments,{id:entity.id})||bundle_module.q.get(_this.panel,"dateRange.id")&&entity.id===_this.panel.dateRange.id)&&_this.panel.broadcast("panel:change","down")}),_this.registerOff(_this.panel.segmentGroups.on("change",function(e){_this.panel.collapsed||_this.panel.broadcast("panel:change",e)})),_this.registerOff(_this.panel.position.on("change:autoSize",function(){return _this.panel.broadcast("reportlet:render")})),_this.datePickerDropTarget={useDefaultTheme:!0,supportedComponentTypes:[build_bundle_module.S],disabled:function(dragData){return bundle_module.q.get(self,"panel.config.isLoading",!1)},onDrop:function(added){if(ui_core_build_bundle_module.lb.trackAction(null,"Dropped DateRange on panel datePicker"),added.length){var dateRangeComponent=added[0];_this.panel.dateRange=dateRangeComponent,_this.panel.broadcast("panel:change","down")}}},_this.state={reportSuite:_this.props.reportSuite},_this.app.on("change:reportSuite",function(e){_this.setState({reportSuite:e.newValue})}),_this}return Object(inherits.a)(Panel,_AppComponent),Object(createClass.a)(Panel,[{key:"updateDisabled",value:function(){this.props.panel.updateDisabled(this.app)}},{key:"duplicate",value:function(){var _duplicate=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(){return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,PanelSubPanelDuplicator.duplicatePanel(this.app,this.panel);case 2:_context.sent,ui_core_build_bundle_module.lb.trackAction(null,"Duplicate Panel");case 4:case"end":return _context.stop()}},_callee,this)}));return function(){return _duplicate.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(Panel.prototype),"componentWillUnmount",this).call(this),this.app.off("change:reportSuite",this.updateDisabled);var hasCancelReportsFunction=!!bundle_module.q.get(this,"props.panel.config.cancelReports"),hasIsStreamingFunction=!!bundle_module.q.get(this,"props.panel.config.isStreaming");hasCancelReportsFunction&&hasIsStreamingFunction&&this.props.panel.config.isStreaming()&&this.props.panel.config.cancelReports(this.app)}},{key:"getPanelLink",value:function(){ui_core_build_bundle_module.lb.trackAction(null,"Get Panel Link"),this.app.emit("getProjectLink",{panelId:this.panel.id})}},{key:"updatePanelCollapses",value:function(collapsed){ui_core_build_bundle_module.lb.trackAction(null,collapsed?"Collapse All Panels":"Uncollapse All Panels"),this.props.updatePanelCollapses(collapsed)}},{key:"updateSubPanelCollapses",value:function(collapsed){var _this2=this;ui_core_build_bundle_module.lb.trackAction(null,collapsed?"Collapse All SubPanels":"Uncollapse All SubPanels"),this.panel.subPanels.forEach(function(subPanel){_this2.subPanelRefs[subPanel.id];subPanel.collapsed=collapsed})}},{key:"showContextMenu",value:function(e){var _this3=this;if(!e.altKey){e.preventDefault();var items=this.panelContextMenuItems.filter(function(item){return("pasteSubPanel"!==item.id&&"duplicatePanel"!==item.id&&"copyPanel"!==item.id||!bundle_module.q.get(_this3.props,"panel.config.isLoading",!1))&&("pasteSubPanel"!==item.id||!bundle_module.q.get(_this3.props,"panel.config.needsToBeConfigured",!1)&&!bundle_module.q.get(_this3.props,"panel.config.needsToBeBuilt",!1))});ui_core_build_bundle_module.P.closeAll(),ui_core_build_bundle_module.ab.show({sort:!1,showSearchBar:!1,target:Object(ui_build_bundle_module.gb)(e),items:items,labelKey:"name"})}}},{key:"componentDidMount",value:function(){var _this4=this;Object(esm_get.a)(Object(getPrototypeOf.a)(Panel.prototype),"componentDidMount",this).call(this),this.el=react_dom_default.a.findDOMNode(this),this.$el=Panel_$(this.el),this.app.on("change:reportSuite",this.updateDisabled),this.registerOff(this.props.panel.on("change",function(e){if((["name","collapsed","dateRange","description","position.autoSize"].includes(e.property)||e.property.includes("config"))&&_this4._debouncedChangeHandler(),["segmentGroups"].includes(e.property)){var added=bundle_module.q.get(e,"parentEvent.added",[]).length>0,removed=bundle_module.q.get(e,"parentEvent.removed",[]).length>0;(added||removed)&&_this4._debouncedChangeHandler()}}))}},{key:"componentDidUpdate",value:function(){for(var _get2,_len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];(_get2=Object(esm_get.a)(Object(getPrototypeOf.a)(Panel.prototype),"componentDidUpdate",this)).call.apply(_get2,[this].concat(args)),this.el=react_dom_default.a.findDOMNode(this),this.$el=Panel_$(this.el)}},{key:"addSubPanel",value:function(){var vizType=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"FreeformReportlet",visualization=build_bundle_module.Nc.allByType[vizType];build_bundle_module.Rb.createSubPanelWithLinkedSourceIfNeeded({panel:this.panel,subPanelType:"genericSubPanel",vizType:vizType,appContext:{app:this.app,reportSuite:this.reportSuite},width:visualization.gridWidth})}},{key:"onDeleteClick",value:function(){this.panel.config&&bundle_module.q.get(this,"panelConfig.onDeletePanelClick")?this.panelConfig.onDeletePanelClick():this.panel.remove()}},{key:"onSelection",value:function(){this.project.selectedItem=this.panel}},{key:"onSegmentPillGroupSelection",value:function(){this.project.selectedItem={component:this,isSupportedComponent:function(component){return component instanceof build_bundle_module.ec},name:this.panel.name+" "+Object(l10nify_build_bundle_module.a)("Segments")}}},{key:"getDraggableDatePickerModel",value:function(){var dateRange=this.panel.dateRange.copy();if(!dateRange.name){var dateService=this.reportSuite.dateService;dateRange.name=dateService.formatRange(dateService.getRangeFromRangeString(dateRange.definition))}return[dateRange]}},{key:"onPreviewClick",value:function(e,viz){ui_build_bundle_module.M.show(viz,e,{pointFrom:"right",classes:"an-".concat(viz.itemType,"PopoverContainer"),rsid:this.reportSuite.rsid})}},{key:"renderEmptyPanelComponent",value:function(gridProps){var _this5=this,panel=this.panel,props=Object(objectSpread.a)({},gridProps,{panel:panel,onVizClick:function(vizType){return _this5.addSubPanel(vizType)},onPreviewClick:function(e,viz){return _this5.onPreviewClick(e,viz)}});return react_default.a.createElement(EmptyPanelComponent_EmptyPanelComponent,props)}},{key:"dragDropIsDisabled",value:function(dragData){if(this.panel.collapsed)return!0;var draggingComponents=dragData;return bundle_module.q.isArray(draggingComponents)||(draggingComponents=[draggingComponents]),!bundle_module.q.some(draggingComponents,function(component){return"visualization"===component.itemType})||this.panel.config&&0===this.panel.visibleSubPanels.length}},{key:"createNewSubPanelOnDrop",value:function(dragData){var subPanelType=dragData[0].baseVizType,vizType=dragData[0].vizType;return ui_core_build_bundle_module.lb.trackAction(null,"Added Visualization",{chartType:vizType}),build_bundle_module.Rb.createNewSubPanel({panel:this.panel,subPanelType:subPanelType,vizType:vizType,width:dragData[0].gridWidth,appContext:{app:this.app,reportSuite:this.reportSuite},addToSubPanelsArray:!1})}},{key:"newSubPanelWasDropped",value:function(subPanel){var subPanels=this.panel.subPanels,linkedSource=build_bundle_module.Rb.createLinkedSourceIfNeeded({subPanel:subPanel,panel:this.panel});linkedSource&&!subPanels.includes(linkedSource)&&build_bundle_module.xb.addItemBelowAnchor(linkedSource,subPanel,subPanels)}},{key:"renderGridItemContents",value:function(subPanel){var _this6=this,props={ref:function(_ref){return _this6.subPanelRefs[subPanel.id]=_ref},key:subPanel._key,updateSubPanelCollapses:function(collapsed){return _this6.updateSubPanelCollapses(collapsed)},subPanel:subPanel};return react_default.a.createElement(SubPanel_SubPanel,props)}},{key:"renderSubPanels",value:function(){var gridProps={models:this.panel.subPanels,dropTargetClass:".js-panel-sub-panel",modelClass:build_bundle_module.nc,dragDropIsDisabled:this.dragDropIsDisabled.bind(this),createNewModelOnDrop:this.createNewSubPanelOnDrop.bind(this),gridItemWasDropped:this.newSubPanelWasDropped.bind(this),childrenClassName:"an-Grid-item-sub-panel",emptyGridComponent:this.renderEmptyPanelComponent.bind(this),renderGridItemContents:this.renderGridItemContents.bind(this),qeLabel:"subPanels"},virtualizeProps={panel:this.panel,disableVirtualization:!this.shouldVirtualizeSubPanels};return react_default.a.createElement("div",{className:"an-panel-subpanels"},react_default.a.createElement("div",{className:"an-subpanel-grid-wrapper"},react_default.a.createElement(GridWithVirtualization,Object.assign({},gridProps,virtualizeProps))))}},{key:"render",value:function(){var _this7=this,panel=this.panel,datePicker=react_default.a.createElement(react_drag_drop_build_bundle_module.f,{dragData:this.getDraggableDatePickerModel.bind(this)},react_default.a.createElement(ui_build_bundle_module.l,Object.assign({},this.datePickerDropTarget,{isPopulated:null!==this.panel.dateRange}),react_default.a.createElement(ui_build_bundle_module.g,Object.assign({className:"an-Grid-not-handle"},this.calendarProps)))),loadingBarStyle={width:bundle_module.q.get(panel,"config.percentageLoaded")>0?+bundle_module.q.get(panel,"config.percentageLoaded")+"%":"2px"},panelClasses=classnames_default()("an-Grid-item-content","js-panel an-panel",{collapsed:panel.isCollapsedOrDisabled,selected:build_bundle_module.db.isActive("dynamicSelection")&&panel.selected,"an-panel-loading":bundle_module.q.get(panel,"config.isLoading",!1),"has-visible-subpanels":panel.visibleSubPanels.length>0,"has-config":panel.config});return react_default.a.createElement(ReportSuiteContext.c,{reportSuite:this.state.reportSuite},react_default.a.createElement(ui_core_build_bundle_module.Y,{onSelection:function(){return _this7.onSelection()}},react_default.a.createElement("div",Object.assign({"data-panel-id":panel.id,className:panelClasses},Object(bundle_module.K)(this.props)),react_default.a.createElement("div",{className:"an-panel-title-bar an-Grid-item-content-handle",onContextMenu:this.showContextMenu.bind(this)},react_default.a.createElement("div",{className:"header-outer"},react_default.a.createElement("div",{className:"an-panel-loading-bar-container"},react_default.a.createElement("div",{className:"an-loading-bar",style:loadingBarStyle})),react_default.a.createElement("span",{className:"right-content"},this.app.serverRender&&datePicker,react_default.a.createElement("div",{className:"an-panel-controls"},react_default.a.createElement(ui_core_build_bundle_module.C,{show:!panel.position.autoSize,size:"XS",icon:"panelControl",onClick:function(){panel.position.autoSize=!panel.position.autoSize},"data-tooltip":Object(l10nify_build_bundle_module.a)("Return to Default Height"),className:"ad-Icon--resize an-Grid-not-handle coral-Icon--panelControl"}),react_default.a.createElement(ui_core_build_bundle_module.lb,{action:"Panel Collapse/Expand"},react_default.a.createElement(ui_core_build_bundle_module.C,{"data-test-id":"minimize-panel-icon",icon:panel.isCollapsedOrDisabled?"accordionLeft":"accordionDown",size:"XS",className:"an-Grid-not-handle hide-for-print coral-Icon--panelControl",onClick:function(e){panel.collapsed=!panel.collapsed},onDoubleClick:function(){_this7.updatePanelCollapses(!panel.collapsed)}})),react_default.a.createElement(ui_core_build_bundle_module.lb,{action:"Delete Panel"},react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"close",className:"hide-for-print an-Grid-not-handle coral-Icon--panelControl",size:"XS","data-tooltip":Object(l10nify_build_bundle_module.a)("Delete Panel"),onClick:this.onDeleteClick.bind(this)})))),react_default.a.createElement("div",{className:"main-content overflow-truncate"},react_default.a.createElement(ui_core_build_bundle_module.l,{value:panel.name,placeholder:panel.defaultName,onChange:function(v){panel.name=v}})))),panel.disabled?react_default.a.createElement("div",{"data-tooltip-immediate":panel.disabledPopoverMessage,className:"an-panel-title-bar disabled-panel-overlay an-Grid-item-content-handle"},react_default.a.createElement(ui_core_build_bundle_module.C,{icon:"close",className:"hide-for-print an-Grid-not-handle coral-Icon--panelControl",size:"XS","data-tooltip":Object(l10nify_build_bundle_module.a)("Delete Panel"),onClick:this.onDeleteClick.bind(this)})):null,panel.isCollapsedOrDisabled||panel.disabled?null:react_default.a.createElement(ui_build_bundle_module.w,{errorMessage:Object(l10nify_build_bundle_module.a)(Panel_templateObject())},react_default.a.createElement("div",{className:classnames_default()("an-panel-contents",{"no-segments":0===panel.segments.length})},react_default.a.createElement("div",{className:"an-panel-description-container"},react_default.a.createElement(ui_build_bundle_module.U,{ref:function(d){return _this7.description=d},style:{display:!panel.isCollapsedOrDisabled&&(panel.description||!panel.description&&bundle_module.q.get(this,"description.state.isEditing"))?"block":"none"},className:"an-panel-description an-Grid-not-handle",size:"block",value:panel.description,placeholder:Object(l10nify_build_bundle_module.a)("Description"),onChange:function(v){panel.description=v,_this7.forceUpdate()},saveOnBlur:!0})),react_default.a.createElement("div",{className:"an-panel-filters-and-config"},react_default.a.createElement("div",{className:"an-panel-filters"},react_default.a.createElement(ui_core_build_bundle_module.Y,{onSelection:function(){return _this7.onSegmentPillGroupSelection()}},react_default.a.createElement(ui_build_bundle_module.n.Dropdown,{componentGroups:this.panel.segmentGroups,disabled:bundle_module.q.get(this,"panel.config.isLoading",!1),onChange:function(_ref2){var value=_ref2.value;_this7.panel.segmentGroups=value},placeholderLabel:react_default.a.createElement(ui_core_build_bundle_module.J,null,Object(l10nify_build_bundle_module.a)("Drop a **Segment** Here (or any other component)")),className:classnames_default()("an-panel-segments",{selected:build_bundle_module.db.isActive("dynamicSelection")&&this.state.segmentPillGroupSelected})})),!this.app.serverRender&&datePicker),react_default.a.createElement("div",{className:"an-global-segments-divider"}),panel.config?react_default.a.createElement(PanelConfig_PanelConfig,{ref:function(pc){return _this7.panelConfig=pc},config:panel.config}):null,react_default.a.createElement("div",{className:"an-panel-loading-overlay"},react_default.a.createElement("div",{className:"an-panel-loading-message"},react_default.a.createElement("div",null,bundle_module.q.get(panel,"config.loadingText")),0===bundle_module.q.get(panel,"config.queuedJobs.length",0)&&bundle_module.q.get(panel,"config.timeRemaining")>0?react_default.a.createElement("div",null,Object(l10nify_build_bundle_module.a)("Time Remaining: %s",[bundle_module.q.get(panel,"config.formattedTimeRemaining")])):null))),this.renderSubPanels())))))}},{key:"reportSuite",get:function(){return this.state.reportSuite}},{key:"panelContextMenuItems",get:function(){var _this8=this,contextMenuItems=[];this.panel.disabled||contextMenuItems.push.apply(contextMenuItems,[{id:"copyPanel",name:Object(l10nify_build_bundle_module.a)("Copy Panel"),onClick:function(){PanelSubPanelCopyPaste.copy(_this8.panel,_this8.app),_this8.app.addAlert({variant:"success",contents:Object(l10nify_build_bundle_module.a)("Panel copied.  Right click on a panel header to insert.")})}},{id:"duplicatePanel",name:Object(l10nify_build_bundle_module.a)("Duplicate Panel"),onClick:function(){_this8.duplicate()}},{id:"collpasePanels",name:Object(l10nify_build_bundle_module.a)("Collapse All Panels"),onClick:function(){_this8.updatePanelCollapses(!0)}},{id:"expandPanels",name:Object(l10nify_build_bundle_module.a)("Expand All Panels"),onClick:function(){_this8.updatePanelCollapses(!1)}},{id:"collapseVisualizations",name:Object(l10nify_build_bundle_module.a)("Collapse All Visualizations In Panel"),onClick:function(){_this8.updateSubPanelCollapses(!0)}},{id:"expandVisualizations",name:Object(l10nify_build_bundle_module.a)("Expand All Visualizations In Panel"),onClick:function(){_this8.updateSubPanelCollapses(!1)}},{id:"editDescription",name:Object(l10nify_build_bundle_module.a)("Edit Description"),onClick:function(){_this8.panel.collapsed=!1,_this8.description.edit(),_this8.forceUpdate()}},{id:"getPanelLink",name:Object(l10nify_build_bundle_module.a)("Get Panel Link"),onClick:function(){_this8.getPanelLink()}}]);var clipboardItem=PanelSubPanelCopyPaste.getCurrentClipboardItem(this.app);return clipboardItem&&"panel"===clipboardItem.type?contextMenuItems.unshift({id:"pastePanel",name:Object(l10nify_build_bundle_module.a)("Insert Copied Panel"),onClick:function(){PanelSubPanelCopyPaste.paste(_this8.panel,_this8.app)}}):clipboardItem&&contextMenuItems.unshift({id:"pasteSubPanel",name:Object(l10nify_build_bundle_module.a)("Insert Copied Visualization"),onClick:function(){PanelSubPanelCopyPaste.paste(_this8.panel,_this8.app)}}),contextMenuItems}},{key:"calendarProps",get:function(){var _this9=this;return{stringValue:this.panel.dateRange.definition,dateRangeId:this.panel.dateRange.id,hideApplyToAllPanels:!1,onChange:function(value,valueObj,applyToAllPanels){var panelsToUpdate=applyToAllPanels?_this9.panel.parent.panels:[_this9.panel];valueObj&&bundle_module.q.each(panelsToUpdate,function(panel){_this9.app.cache.has(build_bundle_module.S,valueObj.dateRangeId)?panel.dateRange=_this9.app.cache.get(build_bundle_module.S,valueObj.dateRangeId):panel.dateRange=build_bundle_module.S.fromJSON({definition:bundle_module.q.clone(value)}),panel.broadcast("panel:change","down")})}}}},{key:"panel",get:function(){return this.props.panel}},{key:"workspace",get:function(){return bundle_module.q.get(this,"panel.parent")}},{key:"project",get:function(){return this.panel.root}},{key:"shouldVirtualizeSubPanels",get:function(){return!!build_bundle_module.db.isActive("panelVirtualization")&&(!this.app.serverRender&&(!!dom_util_build_bundle_module.a.isChrome()&&!!this.panel.position.autoSize))}}]),Panel}(ui_build_bundle_module.d),Project_Project=(__webpack_require__(980),__webpack_require__(749),__webpack_require__(981),function(_AppComponent){function Project(props,context){var _this;return Object(classCallCheck.a)(this,Project),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(Project).call(this,props,context)))._onScrollTo=_this._onScrollTo.bind(Object(assertThisInitialized.a)(_this)),_this._setupViewListeners(props),_this.registerOff(_this.app.on(ui_build_bundle_module.f.DEFINITION_UPDATED,function(entity){var project=_this.props.view.project;project&&bundle_module.q.some(project.getEmbeddedModels(entity.constructor),{id:entity.id})&&build_bundle_module.Yb.clearCache()})),_this.state={},_this.addPanel=_this.addPanel.bind(Object(assertThisInitialized.a)(_this)),_this}return Object(inherits.a)(Project,_AppComponent),Object(createClass.a)(Project,[{key:"cache",value:function(){return["metrics","dimensions"]}},{key:"componentWillMount",value:function(){var _this2=this;Object(esm_get.a)(Object(getPrototypeOf.a)(Project.prototype),"componentWillMount",this).call(this),this.registerOff(this.props.view.on("change:project",function(){return _this2.workspace.initSwatchColors()})),this.props.view.project&&(this.workspace.initSwatchColors(),this.props.view.project.broadcast("project:render"))}},{key:"componentDidMount",value:function(){var _this3=this;Object(esm_get.a)(Object(getPrototypeOf.a)(Project.prototype),"componentDidMount",this).call(this),this.el=react_dom_default.a.findDOMNode(this),this.$el=Object(ui_build_bundle_module.mb)(this.el),this.setupCopyPaste(),this.$el.on("click",".an-RichTextEditor.readOnly a",function(e){e.preventDefault(),_this3.confirmLinkRedirect(e,!0)}),this.$el.on("click",".an-RichTextEditor.is-editing a",function(e){e.preventDefault(),_this3.confirmLinkRedirect(e,!1)})}},{key:"componentWillReceiveProps",value:function(nextProps){this.props.view!==nextProps.view&&(this._unObserve(),this.props.view.off("project:scrollTo",this._onScrollTo),this._setupViewListeners(nextProps))}},{key:"scrollToProjectOnFullyLoaded",value:function(project){var _this4=this;if(project){var fullyLoadedListener=project.currentWorkspace.on("change:fullyLoaded",function(event){event.newValue&&(fullyLoadedListener(),_this4.scrollToComponent())});this.registerOff(fullyLoadedListener)}}},{key:"_setupViewListeners",value:function(props){var _this5=this;props.view.project&&(bundle_module.q.get(props,"view.project.currentWorkspace.fullyLoaded")?this.scrollToComponent():this.scrollToProjectOnFullyLoaded(props.view.project)),this.observe(props.view,"change:project",function(e){_this5.scrollToProjectOnFullyLoaded(e.newValue)}),props.view.on("project:scrollTo",this._onScrollTo)}},{key:"_scrollingError",value:function(err){this.app.addAlert({variant:"error",contents:err,expireInSeconds:4,closable:!0})}},{key:"_onScrollTo",value:function(changeEvent){var _this6=this;changeEvent&&"panel"===changeEvent.type?WorkspaceScrollTo_WorkspaceScrollTo.scrollToPanel(changeEvent.id).then(function(res){},function(err){_this6._scrollingError(err)}):changeEvent&&"subPanel"===changeEvent.type&&WorkspaceScrollTo_WorkspaceScrollTo.scrollToSubPanel(changeEvent.id).then(function(res){},function(err){_this6._scrollingError(err)})}},{key:"addPanel",value:function(){if(this.workspace){var newPanel=new build_bundle_module.Rb;newPanel.makeNameUnique({parent:this.workspace}),this.workspace.panels.push(newPanel)}}},{key:"onSelection",value:function(){this.project&&(this.project.selectedItem=this.project)}},{key:"setupCopyPaste",value:function(){var _this7=this;Object(ui_build_bundle_module.mb)(window.document).on("copy",function(event){if(!($tgt=Object(ui_build_bundle_module.mb)(event.target)).is("input,textarea,button,li")&&!$tgt.get(0).isContentEditable&&!event.target.closest(".an-AlertList")){if(!_this7.project.selectedItem.format)return;var outputString=_this7.project.selectedItem.format("tsv",{app:_this7.app});window.clipboardData?window.clipboardData.setData("Text",outputString):event.originalEvent.clipboardData.setData("text/plain",outputString),event.preventDefault()}var $tgt})}},{key:"scrollToComponent",value:function(){var queryParams=Object(bundle_module.A)(window.location.hash),subPanelId=queryParams.subPanelId,panelId=queryParams.panelId;subPanelId?this.scrollTo({subPanelId:subPanelId}):panelId&&this.scrollTo({panelId:panelId})}},{key:"confirmLinkRedirect",value:function(e,readOnly){var url=e.currentTarget.href,classes=e.target.className+" "+e.currentTarget.className;url&&(readOnly?this._checkLinkLogic(url):readOnly||-1===classes.indexOf("ql-preview")||this._checkLinkLogic(url))}},{key:"_checkLinkLogic",value:function(url){if(Object(ui_build_bundle_module.ob)(url)){url=this.app.omnitureUrl.s(url);var queryParamsNewUrl=Object(bundle_module.A)(url),projectId=(Object(bundle_module.A)(window.location.href),queryParamsNewUrl.projectId),subPanelId=queryParamsNewUrl.subPanelId,panelId=queryParamsNewUrl.panelId;if(projectId===this.project.id||"self"===projectId)subPanelId?this.scrollTo({subPanelId:subPanelId}):panelId?this.scrollTo({panelId:panelId}):this.scrollTo({top:!0});else window.open(url,"_blank").focus()}else ui_core_build_bundle_module.sb.openExternalLink(url)}},{key:"scrollTo",value:function(_ref){var _this8=this,subPanelId=_ref.subPanelId,panelId=_ref.panelId,top=_ref.top,panels=this.project.panels;subPanelId?(panels.forEach(function(panel){panel.subPanels.forEach(function(subPanel){subPanel.id===subPanelId&&(subPanel.collapsed&&(subPanel.collapsed=!1),panel.collapsed&&(panel.collapsed=!1))})}),WorkspaceScrollTo_WorkspaceScrollTo.scrollToSubPanel(subPanelId).then(function(res){},function(err){_this8._scrollingError(err)})):panelId?(panels.forEach(function(panel){panel.id===panelId&&panel.collapsed&&(panel.collapsed=!1)}),WorkspaceScrollTo_WorkspaceScrollTo.scrollToPanel(panelId).then(function(res){},function(err){_this8._scrollingError(err)})):top&&WorkspaceScrollTo_WorkspaceScrollTo.scrollToTop()}},{key:"renderEmptyProjectComponent",value:function(props){return react_default.a.createElement("div",{className:classnames_default()("empty-project-message",props.classNames)},react_default.a.createElement(ui_core_build_bundle_module.y,{label:Object(l10nify_build_bundle_module.a)("This project is empty!")}),react_default.a.createElement("p",null,react_default.a.createElement("span",{className:"add-panel-link",onClick:this.addPanel},Object(l10nify_build_bundle_module.a)("Add a Blank Panel"))," ",Object(l10nify_build_bundle_module.a)("to get started.")))}},{key:"renderGridItemContents",value:function(panel){var _this9=this,props={panel:panel,key:panel._key,updatePanelCollapses:function(collapsed){return _this9.updatePanelCollapses(collapsed)},reportSuite:this.reportSuite};return react_default.a.createElement(Panel_Panel,props)}},{key:"createPanelOnDrop",value:function(dragData){var newPanel,panelType=dragData[0].id;switch(ui_core_build_bundle_module.lb.trackAction(null,"Added Panel",{panelType:panelType}),panelType){case workspace_panelTypes.FREEFORM_PANEL:default:newPanel=build_bundle_module.Rb.createWithFreeformTable({name:Object(l10nify_build_bundle_module.a)("Freeform")});break;case workspace_panelTypes.BLANK_PANEL:newPanel=new build_bundle_module.Rb({name:Object(l10nify_build_bundle_module.a)("Panel")});break;case workspace_panelTypes.SEGMENT_COMPARISON_PANEL:newPanel=build_bundle_module.Rb.createWithAudienceComparisonConfig({name:Object(l10nify_build_bundle_module.a)("Segment Comparison")},this.app);break;case workspace_panelTypes.ATTRIBUTION_PANEL:newPanel=build_bundle_module.Rb.createWithAttributionConfig({name:Object(l10nify_build_bundle_module.a)("Attribution")},this.app)}return newPanel.makeNameUnique({parent:this.workspace}),newPanel}},{key:"updatePanelCollapses",value:function(collapsed){this.workspace.nonDisabledPanels.forEach(function(panel){return panel.collapsed=collapsed})}},{key:"dragDropIsDisabled",value:function(dragData){return"panel"!==(bundle_module.q.isArray(dragData)?dragData[0]:dragData).itemType}},{key:"render",value:function(){var _this10=this,workspace=(this.props,this.workspace);return react_default.a.createElement(ui_core_build_bundle_module.Y,{onSelection:function(){return _this10.onSelection()},closest:".an-ViewLayout-componentContent"},react_default.a.createElement("div",{className:"anw-Project"},workspace?react_default.a.createElement(ui_build_bundle_module.z,this.gridProps):null,!this.app.serverRender&&react_default.a.createElement(AddBlankPanel,{clickAction:function(){ui_core_build_bundle_module.lb.trackAction(null,'Clicked "Add Blank Panel" button'),_this10.addPanel()}}),react_default.a.createElement(views_workspace_TipOfTheDay,null)))}},{key:"workspace",get:function(){return this.props.view.workspace}},{key:"project",get:function(){return this.props.view.project}},{key:"panels",get:function(){return this.workspace.panels}},{key:"gridProps",get:function(){var _this11=this;return this.workspace?{models:this.workspace.panels,dropTargetClass:".js-panel",modelClass:build_bundle_module.Rb,createNewModelOnDrop:this.createPanelOnDrop.bind(this),childrenClassName:"an-Grid-item-panel",emptyGridComponent:this.renderEmptyProjectComponent.bind(this),renderGridItemContents:function(item){return _this11.renderGridItemContents(item)},dragDropIsDisabled:this.dragDropIsDisabled.bind(this),qeLabel:"panels"}:{}}}]),Project}(ui_build_bundle_module.d));function AddBlankPanel(props){return react_default.a.createElement("div",{className:"an-AddBlankPanel-wrapper"},react_default.a.createElement("div",{className:classnames_default()("an-AddBlankPanel-sidebars")}),react_default.a.createElement(ui_core_build_bundle_module.C,{className:classnames_default()("an-AddBlankPanel-icon"),icon:"addCircle",size:"M","data-tooltip":Object(l10nify_build_bundle_module.a)("Add Blank Panel"),onClick:props.clickAction}),react_default.a.createElement("div",{className:classnames_default()("an-AddBlankPanel-sidebars")}))}__webpack_require__(982);var PrintHeader_PrintHeader=function(_ProjectComponent){function PrintHeader(){return Object(classCallCheck.a)(this,PrintHeader),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(PrintHeader).apply(this,arguments))}return Object(inherits.a)(PrintHeader,_ProjectComponent),Object(createClass.a)(PrintHeader,[{key:"render",value:function(){var formattedDate=Object(bundle_module.I)(bundle_module.w.instance().now()).format("ll"),generatedOnMessage=Object(l10nify_build_bundle_module.a)("Generated on %1$s",[formattedDate]),reportSuiteTitle=this.app.reportSuite.name,projectName=bundle_module.q.get(this,"project.name","");return react_default.a.createElement("div",{className:"an-print-header"},react_default.a.createElement("h1",null,projectName),react_default.a.createElement("h3",null,"".concat(reportSuiteTitle," - ").concat(generatedOnMessage)),react_default.a.createElement("div",{className:"aph-watermark"},react_default.a.createElement("div",{className:"aph-text-powered-by"},"powered by"),react_default.a.createElement("div",{className:"aph-text-adobe-analytics"},"Adobe Analytics"),react_default.a.createElement("i",{className:"aph-watermark-image"})))}}]),PrintHeader}(ProjectComponent_ProjectComponent),Views=__webpack_require__(42);__webpack_require__(983);function Workspace_templateObject4(){var data=Object(taggedTemplateLiteral.a)(['The project "','" has unsaved changes. Do you want to save the changes before proceeding?']);return Workspace_templateObject4=function(){return data},data}function Workspace_templateObject3(){var data=Object(taggedTemplateLiteral.a)(['The template "','" has unsaved changes. Do you want to save the changes before proceeding?']);return Workspace_templateObject3=function(){return data},data}function Workspace_templateObject2(){var data=Object(taggedTemplateLiteral.a)(['The template "','" has unsaved changes. If you reload you will lose all of your current progress.']);return Workspace_templateObject2=function(){return data},data}function Workspace_templateObject(){var data=Object(taggedTemplateLiteral.a)(['The project "','" has unsaved changes. If you reload you will lose all of your current progress.']);return Workspace_templateObject=function(){return data},data}var Workspace_PanelsPanel=function(_AppComponent){function PanelsPanel(){return Object(classCallCheck.a)(this,PanelsPanel),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(PanelsPanel).apply(this,arguments))}return Object(inherits.a)(PanelsPanel,_AppComponent),Object(createClass.a)(PanelsPanel,[{key:"cache",value:function(){return["metricViews","functions"]}},{key:"render",value:function(){var panels=function(app){var panels=[{id:workspace_panelTypes.BLANK_PANEL,name:Object(l10nify_build_bundle_module.a)("Blank Panel"),itemType:"panel",icon:"experienceAdd",description:Object(l10nify_build_bundle_module.a)("Build a completely customized analysis by adding data tables and visualizations freely."),learnMoreLink:"https://www.youtube.com/watch?v=SYaioiwBTrk",gridWidth:build_bundle_module.xb.DEFAULT_GRID_WIDTH,gridHeight:build_bundle_module.xb.DEFAULT_GRID_HEIGHT,autoSize:!0},{id:workspace_panelTypes.FREEFORM_PANEL,name:Object(l10nify_build_bundle_module.a)("Freeform"),itemType:"panel",icon:"experienceAdd",description:Object(l10nify_build_bundle_module.a)("Perform unlimited comparisons and breakdowns, then add visualizations to tell a rich data story."),learnMoreLink:"https://www.youtube.com/watch?v=SYaioiwBTrk",gridWidth:build_bundle_module.xb.DEFAULT_GRID_WIDTH,gridHeight:build_bundle_module.xb.DEFAULT_GRID_HEIGHT,autoSize:!0}];if(ui_build_bundle_module.x.SegmentComparison.hasAccess(app)&&panels.push({id:workspace_panelTypes.SEGMENT_COMPARISON_PANEL,name:Object(l10nify_build_bundle_module.a)("Segment Comparison"),itemType:"panel",icon:"experienceAdd",description:Object(l10nify_build_bundle_module.a)("Quickly compare two segments across all data points to automatically find relevant differences."),learnMoreLink:"https://www.youtube.com/watch?v=fO3PNB93U_w",gridWidth:build_bundle_module.xb.DEFAULT_GRID_WIDTH,gridHeight:build_bundle_module.xb.DEFAULT_GRID_HEIGHT,autoSize:!0}),app.hasAccessToFeature("attributionPanel")){var attributionPanelObj={id:workspace_panelTypes.ATTRIBUTION_PANEL,name:Object(l10nify_build_bundle_module.a)("Attribution"),itemType:"panel",icon:"experienceAdd",description:Object(l10nify_build_bundle_module.a)("Quickly compare and visualize any number of attribution models using any dimension and conversion metric."),learnMoreLink:"https://www.youtube.com/watch?v=Yu0hy2klzA0",gridWidth:build_bundle_module.xb.DEFAULT_GRID_WIDTH,gridHeight:build_bundle_module.xb.DEFAULT_GRID_HEIGHT};panels.splice(1,0,attributionPanelObj)}return panels}(this.app);return react_default.a.createElement(ui_build_bundle_module.G,{shrinkButton:!0,items:panels,disableInfiniteScroll:!0,disableSorting:!0,iconName:"experienceAdd",panelTitle:Object(l10nify_build_bundle_module.a)("panels"),searchPlaceholder:Object(l10nify_build_bundle_module.a)("Search Panels")})}}]),PanelsPanel}(ui_build_bundle_module.d),Workspace_Workspace=function(_Component){function Workspace(props,context){var _this;return Object(classCallCheck.a)(this,Workspace),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(Workspace).call(this,props,context))).props.app&&!_this.props.app.hasAccessToFeature("workspace")?(location.href=_this.app.omnitureUrl.fs("Main.AccessDenied"),Object(possibleConstructorReturn.a)(_this)):(build_bundle_module.Lc.progress(build_bundle_module.Lc.WORKSPACE_STARTED),_this.hotkeys=_this.getDefaultHotkeys(),_this.onBeforeUnload=_this.onBeforeUnload.bind(Object(assertThisInitialized.a)(_this)),_this.onUnload=_this.onUnload.bind(Object(assertThisInitialized.a)(_this)),_this.onWorkspaceTabClick=_this.onWorkspaceTabClick.bind(Object(assertThisInitialized.a)(_this)),_this.reloadCurrentRoute=_this.reloadCurrentRoute.bind(Object(assertThisInitialized.a)(_this)),"undefined"!==typeof window&&window.dv&&(window.dv.FADE_IN_LABELS=!1),Object(bundle_module.L)("workspaceView",Object(assertThisInitialized.a)(_this)),_this)}return Object(inherits.a)(Workspace,_Component),Object(createClass.a)(Workspace,[{key:"componentWillMount",value:function(){var _this2=this;this.view=this.view||new ProjectViewModel_ProjectView({},{app:this.props.app}),this.controller=this.controller||new WorkspaceController_WorkspaceController(this),this.controller.openProjectsList=function(){ui_core_build_bundle_module.lb.trackAction(null,"Clicked Action Bar: Open Existing Project"),_this2.app.showFullScreenModal({view:Views.a.get("workspace-launch"),title:Object(l10nify_build_bundle_module.a)("Open Project"),hideSave:!0})},this.globalUtilities=this.globalUtilities||new WorkspaceGlobalUtilities_WorkspaceGlobalUtilities(this),this.registerOff(this.view.on("change:loading",function(e){return ui_core_build_bundle_module.I.Content[e.newValue?"show":"hide"]()})),this.registerOff(this.props.history.block(this.onBeforeRouteChange.bind(this)))}},{key:"componentDidMount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(Workspace.prototype),"componentDidMount",this).call(this),this.observe(this.view,"change:project"),this.loadView(this.getLoadParams(this.props)),window.addEventListener("beforeunload",this.onBeforeUnload),window.addEventListener("unload",this.onUnload),this._offFunctions.push(Object(dom_util_build_bundle_module.b)(document.body,"click",".coral-Shell-workspaces-workspace.workspace",this.onWorkspaceTabClick)),this.registerOff(this.app.on("project:reloadRoute",this.reloadCurrentRoute)),build_bundle_module.Mc.useCommonGroupId(),this.globalUtilities.initialize()}},{key:"componentWillUnmount",value:function(){Object(esm_get.a)(Object(getPrototypeOf.a)(Workspace.prototype),"componentWillUnmount",this).call(this),this.globalUtilities.destroy(),this.view.destroy(),window.removeEventListener("beforeunload",this.onBeforeUnload),window.removeEventListener("unload",this.onUnload),build_bundle_module.Mc.useIndividualTimingIds(this.app),this.setDefaultViewDensity()}},{key:"componentWillReceiveProps",value:function(nextProps){this.loadView(this.getLoadParams(nextProps))}},{key:"setDefaultViewDensity",value:function(){setViewDensityCSSVariables("expanded"),this.app.user.viewDensity="expanded"}},{key:"getLoadParams",value:function(props){var params={projectId:void 0,jobId:void 0,pasteId:void 0,templateId:void 0,customTemplateId:void 0,legacyId:void 0,legacyReportName:""};if(props.subPath)switch(props.subPath){case"edit":case"project":params.projectId=props.id;break;case"template":params.templateId=props.id;break;case"legacy":params.legacyId=props.id;break;case"alertResult":params.jobId=props.id;break;case"paste":params.pasteId=props.id}return params||{}}},{key:"loadView",value:function(params){var customTemplateId,overrideReportSuite,_this3=this,force=arguments.length>1&&void 0!==arguments[1]&&arguments[1],projectId=params.projectId,jobId=params.jobId,templateId=params.templateId,legacyId=params.legacyId,pasteId=params.pasteId;templateId&&!PublicTemplates.a.byId[templateId]&&(customTemplateId=templateId,templateId=void 0),this.overrideReportSuite&&(overrideReportSuite=this.overrideReportSuite,this.overrideReportSuite=null);var routeState={id:projectId,template:templateId,jobId:jobId,pasteId:pasteId,customTemplateId:customTemplateId,legacyId:legacyId,legacyReportName:Object(bundle_module.A)(location.hash).legacyReportName};!force&&bundle_module.q.isEqual(routeState,bundle_module.q.pick(this.oldRouteState,Object.keys(routeState)))||(routeState.overrideReportSuite=overrideReportSuite,this.view.project&&this.view.project.clearAutosavedEntryFromLocalStorage(),this.app.suppressAlertsForGlobalHttpErrors=!0,this.controller.routeState=routeState,this.view.loadProject(routeState,null,force).then(function(){return _this3.app.suppressAlertsForGlobalHttpErrors=!1}).catch(function(e){_this3.app.suppressAlertsForGlobalHttpErrors=!1,_this3.app.addAlert({variant:"error",contents:Object(l10nify_build_bundle_module.a)("There was a problem loading your project. Please refresh the page and try again"),autoHide:!1}),console.error&&console.error("Unable to load project",e)}),this.oldRouteState=routeState)}},{key:"leftRail",value:function(){var _this4=this;if(this.app.serverRender)return null;var panels=[{id:"panels",icon:"page","data-tooltip":Object(l10nify_build_bundle_module.a)("Panels"),contents:this.shouldRenderShellComponents?react_default.a.createElement(Workspace_PanelsPanel,null):react_default.a.createElement(ui_core_build_bundle_module.qb,{size:"L",centered:!0})},{id:"visualizations",icon:"graphBarVertical","data-tooltip":Object(l10nify_build_bundle_module.a)("Visualizations"),contents:this.shouldRenderShellComponents?react_default.a.createElement(ui_build_bundle_module.G,{shrinkButton:!0,items:build_bundle_module.Nc.all,disableInfiniteScroll:!0,disableSorting:!0,panelTitle:Object(l10nify_build_bundle_module.a)("visualizations"),iconName:"graphBarVertical",searchPlaceholder:Object(l10nify_build_bundle_module.a)("Search Visualizations")}):react_default.a.createElement(ui_core_build_bundle_module.qb,{size:"L",centered:!0})},{id:"workspace-tab-navigator",icon:"curate","data-tooltip":Object(l10nify_build_bundle_module.a)("Components"),contents:this.shouldRenderShellComponents?react_default.a.createElement(ReportSuiteContext.a,null,function(_ref){var reportSuite=_ref.reportSuite;return react_default.a.createElement(WorkspaceDraggableStack_DraggableStack,{view:_this4.view,reportSuite:reportSuite})}):react_default.a.createElement(ui_core_build_bundle_module.qb,{size:"L",centered:!0})}];return(build_bundle_module.db.isActive("debugPanel")||this.app.isLocalDev)&&panels.push({id:"workspace-debugger",icon:"bug","data-tooltip":Object(l10nify_build_bundle_module.a)("Debugger"),contents:this.shouldRenderShellComponents?react_default.a.createElement(DebugPanel_DebugPanel,{view:this.view}):react_default.a.createElement(ui_core_build_bundle_module.qb,{size:"L",centered:!0})}),{useDarkTheme:!1,activePanelIndex:2,panels:panels}}},{key:"viewHeaders",value:function(){return this.app.serverRender?[]:this.shouldRenderShellComponents?[react_default.a.createElement(WorkspaceHeader_WorkspaceHeader,{view:this.view,controller:this.controller,key:"workspaceHeader"})]:[react_default.a.createElement("div",{className:"an-workspace-header",style:{height:"55px"},key:"workspaceFauxHeader"})]}},{key:"contentHeaders",value:function(){var _this5=this;return this.app.serverRender||!this.shouldRenderShellComponents?[]:[react_default.a.createElement(react_drag_drop_build_bundle_module.d.Consumer,{key:"contentHeadersDragManagerProvider"},function(dragManager){return react_default.a.createElement(CurateComponents_CurateComponents,{view:_this5.view,dragManager:dragManager})})]}},{key:"getDefaultHotkeys",value:function(){return[new build_bundle_module.yb({id:"goToPaneOne",letter:"1",modifiers:["altKey","shiftKey"],action:function(e){ui_build_bundle_module.P.updateProps({activePanelIndex:0})}}),new build_bundle_module.yb({id:"goToPaneTwo",letter:"2",modifiers:["altKey","shiftKey"],action:function(e){ui_build_bundle_module.P.updateProps({activePanelIndex:1})}}),new build_bundle_module.yb({id:"goToPaneThree",letter:"3",modifiers:["altKey","shiftKey"],action:function(e){ui_build_bundle_module.P.updateProps({activePanelIndex:2})}})]}},{key:"addHotkeys",value:function(hotkeys){this.hotkeys=this.getDefaultHotkeys().concat(hotkeys),this.forceUpdate()}},{key:"onWorkspaceTabClick",value:function(e){e.preventDefault(),this.controller.openProjectsList()}},{key:"reloadCurrentRoute",value:function(){var _this6=this,reloadRoute=function(){return _this6.loadView(_this6.getLoadParams(_this6.props),!0)};if(this.hasUnsavedChanges&&!build_bundle_module.db.isActive("prototypeMode")){var confirmMessage,project=this.view.project;confirmMessage=project.id&&!project.companyTemplate?Object(l10nify_build_bundle_module.a)(Workspace_templateObject(),project.name):project.id&&project.companyTemplate?Object(l10nify_build_bundle_module.a)(Workspace_templateObject2(),project.name):Object(l10nify_build_bundle_module.a)("There are unsaved changes. If you reload you will lose all of your current progress.");var actionButtons=[{label:Object(l10nify_build_bundle_module.a)("Cancel"),variant:"quiet",reject:!0},{label:Object(l10nify_build_bundle_module.a)("Reload")}];ui_core_build_bundle_module.o.confirm(confirmMessage,{actionButtons:actionButtons}).then(reloadRoute).catch(function(){})}else reloadRoute()}},{key:"onBeforeUnload",value:function(e){if(!this.app.isLocalDev&&this.hasUnsavedChanges&&!this.app.isRedirectingFromSessionTimeout&&!build_bundle_module.db.isActive("prototypeMode"))return e.returnValue=this.unsavedChangesMessage,this.unsavedChangesMessage}},{key:"onUnload",value:function(){this.app.isRedirectingFromSessionTimeout&&this.hasUnsavedChanges&&!build_bundle_module.db.isActive("prototypeMode")||this.view.project&&this.view.project.clearAutosavedEntryFromLocalStorage()}},{key:"onBeforeRouteChange",value:function(){var _onBeforeRouteChange=Object(asyncToGenerator.a)(regenerator_default.a.mark(function _callee(location){var app,project,projectName,saveDialog,canSaveProject,save,saveAs,discardChanges,confirmMessage,_this7=this;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!this.hasUnsavedChanges||!this.controller.canPerformAnySaveOperation()){_context.next=12;break}return app=this.app,project=this.view.project,projectName=bundle_module.q.get(project,"name",Object(l10nify_build_bundle_module.a)("New Project")),canSaveProject=this.controller.canSaveProject(),save=function(){ui_core_build_bundle_module.P.closePopover(saveDialog,!0),bundle_module.q.get(project,"id")?app.repo.save(project).then(function(res){_this7.app.addAlert({variant:"success",contents:Object(l10nify_build_bundle_module.a)("Successfully saved: %s",[projectName])})}):_this7.controller.saveProject(project,project.isCustomTemplate)},saveAs=function(){ui_core_build_bundle_module.P.closePopover(saveDialog,!0),_this7.controller.saveProjectAs(project,project.isCustomTemplate)},discardChanges=function(){ui_core_build_bundle_module.P.closePopover(saveDialog,!0),project.clearAutosavedEntryFromLocalStorage()},confirmMessage=project.companyTemplate?Object(l10nify_build_bundle_module.a)(Workspace_templateObject3(),projectName):Object(l10nify_build_bundle_module.a)(Workspace_templateObject4(),projectName),_context.next=11,ui_core_build_bundle_module.o.show(react_default.a.createElement("div",{className:"an-UnsavedChangesDialog","data-test-id":"unsavedChangesDialog-dialog"},react_default.a.createElement("span",null,confirmMessage),react_default.a.createElement(ui_core_build_bundle_module.o.Footer,null,react_default.a.createElement(ui_core_build_bundle_module.f,{label:Object(l10nify_build_bundle_module.a)("Discard Changes"),onClick:discardChanges,variant:"quiet","data-test-id":"unsavedChangesDialog-discard-changes-button"}),bundle_module.q.get(this,"view.project.id")&&react_default.a.createElement(ui_core_build_bundle_module.f,{label:Object(l10nify_build_bundle_module.a)("Save As"),onClick:saveAs,variant:canSaveProject?"default":"primary"}),canSaveProject?react_default.a.createElement(ui_core_build_bundle_module.f,{label:Object(l10nify_build_bundle_module.a)("Save"),onClick:save,variant:"primary","data-test-id":"unsavedChangesDialog-save-button"}):null)),{title:Object(l10nify_build_bundle_module.a)("Save Changes?"),closeOnClickOutside:!1,variant:"warning"});case 11:saveDialog=_context.sent;case 12:bundle_module.q.get(this,"view.project")&&this.view.project.clearAutosavedEntryFromLocalStorage();case 13:case"end":return _context.stop()}},_callee,this)}));return function(_x){return _onBeforeRouteChange.apply(this,arguments)}}()},{key:"render",value:function(){return react_default.a.createElement(ui_build_bundle_module.cb,{leftRail:this.leftRail(),viewHeaders:this.viewHeaders(),contentHeaders:this.contentHeaders(),className:"WorkspacePage-shell",hotkeys:this.hotkeys,app:this.app},react_default.a.createElement("div",{className:"aw-report-content"},this.view.project&&react_default.a.createElement(react.Fragment,null,this.app.serverRender&&react_default.a.createElement(PrintHeader_PrintHeader,{view:this.view}),react_default.a.createElement(ui_build_bundle_module.x.Workspace,null,react_default.a.createElement(Project_Project,{view:this.view})))))}},{key:"app",get:function(){return this.props.app}},{key:"reportSuite",get:function(){return this.app.reportSuite}},{key:"shouldRenderShellComponents",get:function(){return Boolean(this.view.project)}},{key:"hasUnsavedChanges",get:function(){return this.view.hasUnsavedChanges()}}]),Workspace}(react_essence_build_bundle_module.a);__webpack_exports__.default=Object(withRouter.a)(Workspace_Workspace);"undefined"!==typeof window&&window.Cypress&&(window.analyticsui=window.analyticsui||{},window.analyticsui.model=window.analyticsui.model||{},window.analyticsui.model.FreeformModelUtil=build_bundle_module.kb)},714:function(module,__webpack_exports__,__webpack_require__){"use strict";var objectSpread=__webpack_require__(51),taggedTemplateLiteral=__webpack_require__(64),classCallCheck=__webpack_require__(19),possibleConstructorReturn=__webpack_require__(22),getPrototypeOf=__webpack_require__(15),createClass=__webpack_require__(17),inherits=__webpack_require__(21),react=__webpack_require__(1),react_default=__webpack_require__.n(react),bundle_module=__webpack_require__(2),build_bundle_module=__webpack_require__(3),ui_build_bundle_module=__webpack_require__(23),model_build_bundle_module=__webpack_require__(5),classnames=__webpack_require__(6),classnames_default=__webpack_require__.n(classnames),defineProperty=__webpack_require__(140),react_essence_build_bundle_module=__webpack_require__(27),StarterPlayerCloserInput_StarterPlayerCloserInput=function(_Component){function StarterPlayerCloserInput(context,props){var _this;return Object(classCallCheck.a)(this,StarterPlayerCloserInput),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(StarterPlayerCloserInput).call(this,context,props))).state={starter:_this.props.starter,player:_this.props.player,closer:_this.props.closer},_this}return Object(inherits.a)(StarterPlayerCloserInput,_Component),Object(createClass.a)(StarterPlayerCloserInput,[{key:"onInputChange",value:function(touch,weight){this.setState(Object(defineProperty.a)({},touch,weight)),weight&&Number(weight)>=0&&Number(weight)<=999?this.props.onChange(touch,Number(weight)):this.props.onInvalidInput()}},{key:"render",value:function(){var _this2=this,_this$state=this.state,starter=_this$state.starter,player=_this$state.player,closer=_this$state.closer;return react_default.a.createElement("div",{className:"an-AttributionSettingsDialog-customSetting"},react_default.a.createElement("div",{className:"an-AttributionSettingsDialog-customTouch"},react_default.a.createElement("div",{className:"an-AttributionSettingsDialog-settingLabel"},react_default.a.createElement("label",null,Object(bundle_module.a)("Starter"))),react_default.a.createElement(build_bundle_module.K,{step:"0.00001",type:"number",className:"an-AttributionSettingsDialog-touchInputField",requireValue:!0,min:0,max:999,value:starter,onChange:function(e){_this2.onInputChange("starter",e.target.value)}})),react_default.a.createElement("div",{className:"an-AttributionSettingsDialog-plus"},"+"),react_default.a.createElement("div",{className:"an-AttributionSettingsDialog-customTouch"},react_default.a.createElement("div",{className:"an-AttributionSettingsDialog-settingLabel"},react_default.a.createElement("label",null,Object(bundle_module.a)("Player"))),react_default.a.createElement(build_bundle_module.K,{step:"0.00001",type:"number",className:"an-AttributionSettingsDialog-touchInputField",requireValue:!0,min:0,max:999,value:player,onChange:function(e){_this2.onInputChange("player",e.target.value)}})),react_default.a.createElement("div",{className:"an-AttributionSettingsDialog-plus"},"+"),react_default.a.createElement("div",{className:"an-AttributionSettingsDialog-customTouch"},react_default.a.createElement("div",{className:"an-AttributionSettingsDialog-settingLabel"},react_default.a.createElement("label",null,Object(bundle_module.a)("Closer"))),react_default.a.createElement(build_bundle_module.K,{step:"0.00001",type:"number",className:"an-AttributionSettingsDialog-touchInputField",requireValue:!0,min:0,max:999,value:closer,onChange:function(e){_this2.onInputChange("closer",e.target.value)}})),react_default.a.createElement(build_bundle_module.C.Help,{className:"an-AttributionSettingsDialog-helpIcon",style:{}}),react_default.a.createElement(build_bundle_module.kb,{position:"right",hoverable:!0},Object(bundle_module.a)("Specify the weights that should be used for a custom attribution model. Any combination is allowed. "),react_default.a.createElement(build_bundle_module.F,{label:Object(bundle_module.a)("Learn more."),target:"_blank",href:"https://experiencecloud.adobe.com/resources/help/".concat(bundle_module.a.config.currentLocale,"/analytics/analysis-workspace/attribution.html")})))}}]),StarterPlayerCloserInput}(react_essence_build_bundle_module.a),granularityOptions=(__webpack_require__(9),[{value:"minute",label:Object(bundle_module.a)("Minute")},{value:"hour",label:Object(bundle_module.a)("Hour")},{value:"day",label:Object(bundle_module.a)("Day")},{value:"week",label:Object(bundle_module.a)("Week")},{value:"month",label:Object(bundle_module.a)("Month")},{value:"quarter",label:Object(bundle_module.a)("Quarter")},{value:"year",label:Object(bundle_module.a)("Year")}]),TimeDecayInput_TimeDecayInput=function(_Component){function TimeDecayInput(context,props){var _this;return Object(classCallCheck.a)(this,TimeDecayInput),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(TimeDecayInput).call(this,context,props))).state={amount:_this.props.amount},_this}return Object(inherits.a)(TimeDecayInput,_Component),Object(createClass.a)(TimeDecayInput,[{key:"onInputChange",value:function(amount){this.setState({amount:amount}),amount&&Number(amount)>=1&&Number(amount)!==1/0?this.props.onAmountChange(Number(amount)):this.props.onInvalidInput()}},{key:"render",value:function(){var _this2=this,granularity=this.props.granularity,selectedOption=granularityOptions.find(function(option){return option.value===granularity});return react_default.a.createElement("div",null,react_default.a.createElement("div",{className:"an-AttributionSettingsDialog-settingLabel"},react_default.a.createElement("label",null,Object(bundle_module.a)("Half-life"))),react_default.a.createElement("div",{className:"an-AttributionSettingsDialog-halfLife"},react_default.a.createElement(build_bundle_module.M,{min:1,value:this.state.amount,className:"an-AttributionSettingsDialog-halfLifeAmount","data-test-id":"attribution-halflife-input",onChange:function(e){return _this2.onInputChange(e.value)}}),react_default.a.createElement(build_bundle_module.W,{options:granularityOptions,value:selectedOption,onChange:function(e){return _this2.props.onGranularityChange(e)},clearable:!1,size:"M",className:"an-AttributionSettingsDialog-halfLifeGranularitySelector"})))}}]),TimeDecayInput}(react_essence_build_bundle_module.a);__webpack_require__(748);function _templateObject(){var data=Object(taggedTemplateLiteral.a)(["(Reporting Window)"]);return _templateObject=function(){return data},data}__webpack_require__.d(__webpack_exports__,"a",function(){return AttributionSettingsDialog_AttributionSettingsDialog});var AttributionSettingsDialog_AttributionSettingsDialog=function(_AppComponent){function AttributionSettingsDialog(props,context){var _this;return Object(classCallCheck.a)(this,AttributionSettingsDialog),(_this=Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(AttributionSettingsDialog).call(this,props,context))).state={selectedAttribution:_this.props.selectedAttribution?_this.props.selectedAttribution.copy():null,applyButtonEnabled:!0},_this}return Object(inherits.a)(AttributionSettingsDialog,_AppComponent),Object(createClass.a)(AttributionSettingsDialog,null,[{key:"propTypes",get:function(){return{selectedAttribution:build_bundle_module.R.instanceOf(model_build_bundle_module.j),applySettings:build_bundle_module.R.func,customEdit:build_bundle_module.R.bool}}}]),Object(createClass.a)(AttributionSettingsDialog,[{key:"cache",value:function(){return["attributionTemplates"]}},{key:"applySettings",value:function(e,selectedAttribution){this.props.applySettings(selectedAttribution),build_bundle_module.lb.trackAction(null,"Change Attribution Model",{attributionModel:selectedAttribution.getLabelForTracking()}),build_bundle_module.P.closeAll()}},{key:"onCancel",value:function(e){build_bundle_module.P.close(e)}},{key:"changeContext",value:function(newContext){var selectedAttribution=this.state.selectedAttribution;selectedAttribution||(selectedAttribution=this.getLastTouchAttributionModel()),selectedAttribution.definition.context=newContext,this.setState({selectedAttribution:selectedAttribution})}},{key:"onModelTypeChange",value:function(newType){var newModel=model_build_bundle_module.j.fromTemplate(newType);newModel.definition.context&&this.state.selectedAttribution&&this.state.selectedAttribution.definition.context&&(newModel.definition.context=this.state.selectedAttribution.definition.context),this.setState({selectedAttribution:newModel})}},{key:"onInvalidInput",value:function(){this.setState({applyButtonEnabled:!1})}},{key:"customWeightChange",value:function(touch,weight){var selectedAttribution=this.state.selectedAttribution;selectedAttribution.definition[touch]=Number(weight),this.setState({selectedAttribution:selectedAttribution,applyButtonEnabled:!0})}},{key:"halfLifeNumPeriodsChange",value:function(amount){var selectedAttribution=this.state.selectedAttribution;selectedAttribution.definition.halfLifeNumPeriods=Number(amount),this.setState({selectedAttribution:selectedAttribution,applyButtonEnabled:!0})}},{key:"halfLifeGranularityChange",value:function(e){var selectedAttribution=this.state.selectedAttribution;selectedAttribution.definition.halfLifeGranularity=e.value,this.setState({selectedAttribution:selectedAttribution})}},{key:"renderAttributionSelector",value:function(selectedAttribution){var templatesAvailableToCompany=this.app.featureAccess.attributionIQ.models,filteredTemplates=this.state.attributionTemplates.filter(function(template){return templatesAvailableToCompany.find(function(id){return id===model_build_bundle_module.l.attributionFeatureAccessMap[template.id]})});return react_default.a.createElement(build_bundle_module.W,{className:"an-AttributionSettingsDialog-selector",clearable:!1,options:filteredTemplates,optionComponent:AttributionSettingsDialog_ModelSelectOption,value:selectedAttribution,valueComponent:ModelSelectValue,labelKey:"name",valueKey:"modelType",onChange:this.onModelTypeChange.bind(this)})}},{key:"getLastTouchAttributionModel",value:function(){return model_build_bundle_module.j.fromTemplate(this.state.attributionTemplates.find(function(attribution){return"allocation-lastTouch"===attribution.id}))}},{key:"render",value:function(){var _this2=this;if(this.state.attributionTemplates){var lastTouch=this.getLastTouchAttributionModel(),selectedAttribution=this.state.selectedAttribution||lastTouch,definition=selectedAttribution.definition;return react_default.a.createElement("div",{className:"an-AttributionSettingsDialog"},react_default.a.createElement("div",{className:"an-AttributionSettingsDialog-setting"},!this.props.customEdit&&react_default.a.createElement("div",{className:"an-AttributionSettingsDialog-settingLabel"},react_default.a.createElement("label",null,Object(bundle_module.a)("Model")),react_default.a.createElement(build_bundle_module.C.Help,{className:"an-AttributionSettingsDialog-helpIcon",style:{}}),react_default.a.createElement(build_bundle_module.kb,{position:"right",hoverable:!0},Object(bundle_module.a)("Select an attribution model for the metric. "),react_default.a.createElement(build_bundle_module.F,{label:Object(bundle_module.a)("Learn more."),target:"_blank",href:"https://experiencecloud.adobe.com/resources/help/".concat(bundle_module.a.config.currentLocale,"/analytics/analysis-workspace/attribution.html")}))),!this.props.customEdit&&this.renderAttributionSelector(selectedAttribution)),"allocation-positionBased"===selectedAttribution.template.id&&react_default.a.createElement(StarterPlayerCloserInput_StarterPlayerCloserInput,{starter:definition.firstWeight,player:definition.middleWeight,closer:definition.lastWeight,onChange:this.customWeightChange.bind(this),onInvalidInput:this.onInvalidInput.bind(this)}),"allocation-timeDecay"===selectedAttribution.template.id&&react_default.a.createElement(TimeDecayInput_TimeDecayInput,{amount:selectedAttribution.definition.halfLifeNumPeriods,onAmountChange:this.halfLifeNumPeriodsChange.bind(this),granularity:selectedAttribution.definition.halfLifeGranularity,onGranularityChange:this.halfLifeGranularityChange.bind(this),onInvalidInput:this.onInvalidInput.bind(this)}),!this.props.customEdit&&react_default.a.createElement("div",{className:"an-AttributionSettingsDialog-setting"},react_default.a.createElement("div",{className:"an-AttributionSettingsDialog-settingLabel"},react_default.a.createElement("label",null,Object(bundle_module.a)("Lookback Window")),react_default.a.createElement(build_bundle_module.C.Help,{className:"an-AttributionSettingsDialog-helpIcon",style:{}}),react_default.a.createElement(build_bundle_module.kb,{position:"right",hoverable:!0},Object(bundle_module.a)("This setting determines the window of data attribution that will be applied to for each conversion. "),react_default.a.createElement(build_bundle_module.F,{label:Object(bundle_module.a)("Learn more."),target:"_blank",href:"https://experiencecloud.adobe.com/resources/help/".concat(bundle_module.a.config.currentLocale,"/analytics/analysis-workspace/attribution.html")}))),react_default.a.createElement(build_bundle_module.S,{label:Object(bundle_module.a)("Visit"),checked:"sessions"===definition.context,onChange:this.changeContext.bind(this,"sessions"),disabled:!definition.context,"data-test-id":"column-attribution-model-visit"}),react_default.a.createElement(build_bundle_module.S,{label:"".concat(this.reportSuite.visitorLabel," ").concat(Object(bundle_module.a)(_templateObject())),checked:"visitors"===definition.context,onChange:this.changeContext.bind(this,"visitors"),disabled:!definition.context,"data-test-id":"column-attribution-model-visitor"})),react_default.a.createElement(build_bundle_module.o.Footer,null,react_default.a.createElement(build_bundle_module.f,{className:"button-cancel",variant:"minimal",label:Object(bundle_module.a)("Cancel"),onClick:function(e){return _this2.onCancel(e)}}),react_default.a.createElement(build_bundle_module.f,{"data-test-id":"attribution-modal-apply-btn",className:"button-accept",variant:"primary",label:Object(bundle_module.a)("Apply"),disabled:!this.state.applyButtonEnabled,onClick:function(e){return _this2.applySettings(e,selectedAttribution)}})))}return react_default.a.createElement(build_bundle_module.qb,null)}},{key:"reportSuite",get:function(){return this.props.reportSuite}}],[{key:"show",value:function(props){build_bundle_module.P.show({isModal:!0,dialog:Object(objectSpread.a)({header:Object(bundle_module.a)("Column Attribution Model"),closable:!1,padded:!0,contents:react_default.a.createElement(AttributionSettingsDialog,Object.assign({reportSuite:props.reportSuite},props)),closeOnClickOutside:!1},props)})}}]),AttributionSettingsDialog}(ui_build_bundle_module.d),AttributionSettingsDialog_ModelSelectOption=function(_React$Component){function ModelSelectOption(){return Object(classCallCheck.a)(this,ModelSelectOption),Object(possibleConstructorReturn.a)(this,Object(getPrototypeOf.a)(ModelSelectOption).apply(this,arguments))}return Object(inherits.a)(ModelSelectOption,_React$Component),Object(createClass.a)(ModelSelectOption,[{key:"handleMouseDown",value:function(event){event.preventDefault(),event.stopPropagation(),this.props.onSelect(this.props.option,event)}},{key:"handleMouseEnter",value:function(event){this.props.onFocus(this.props.option,event)}},{key:"render",value:function(){var _this3=this,option=this.props.option;return react_default.a.createElement("div",{className:classnames_default()(this.props.className,"an-AttributionSettingsDialog-selectOption"),onMouseDown:function(e){return _this3.handleMouseDown(e)},onMouseEnter:function(e){return _this3.handleMouseEnter(e)}},react_default.a.createElement(build_bundle_module.C,{size:"XS",icon:option.icon}),react_default.a.createElement("span",{"data-title":!0,className:"an-AttributionSettingsDialog-selectOptionName"},option.name),react_default.a.createElement(build_bundle_module.C.Help,{label:this.props.option.description,className:"an-AttributionSettingsDialog-selectOptionHelpIcon"}))}}]),ModelSelectOption}(react_default.a.Component);function ModelSelectValue(props){return react_default.a.createElement("div",{className:"Select-value"},react_default.a.createElement("span",{className:"Select-value-label"},react_default.a.createElement(build_bundle_module.C,{size:"XS",icon:props.value.template.icon}),react_default.a.createElement("span",{style:{marginLeft:"5px"}},props.value.template.name)))}},748:function(module,exports,__webpack_require__){},749:function(module,exports,__webpack_require__){},849:function(module,exports,__webpack_require__){},850:function(module,exports,__webpack_require__){},851:function(module,exports,__webpack_require__){},852:function(module,exports,__webpack_require__){},853:function(module,exports,__webpack_require__){},854:function(module,exports,__webpack_require__){},855:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/100-stacked-graph-option.0262310f.png"},856:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/access-this-project-faster.33b40a5e.png"},857:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/add-dropdown-filters.be52c59e.png"},858:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/add-summary-visualizations.335025f6.png"},859:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/add-visual-context-to-data-tables.f9004334.png"},860:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/added-control-for-column-percentages.438e19b8.png"},861:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/attribution-iq-in-calculated-metrics.a408d230.png"},862:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/attribution-iq-in-freeform-tables.65cc2b7e.png"},863:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/attribution-iq-panel.f2fdffa3.png"},864:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/borrow-work-from-other-projects.c3f58cc8.png"},865:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/bring-your-data-to-life.02b9e281.png"},866:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/build-freeform-tables-faster.ca1fb3b1.png"},867:function(module,exports){module.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUAAAACgCAYAAAB9o7WcAAAlkklEQVR42u2dV3BUV7aGqXmZt+t5u1O3Zl6mampqquZl0sM8TE3dunNv2epWAASIHGwYg7FNMlGAhQFjMLZJtsE2OcMAtgCbZCOCRBAIZSShHFEWauWwbv9bHHW31H3Up3V6n3O611+1S+ogqXX6nK/XWnvtf48hljT19PTQixcvBkd7ezsfFDc1NzfTkydPKC8vj+rq6ni8HKWlpZSamkqFhYWGv0d4HTiPR6uuri6qqKgwfIzhyy746u/v9wBfa2srHxQ39fb2CvBlZGQw8NzG8+fPBXDS0tJM8161tbWJ16SHGIBhIJww7vDDxc5yKT8/X8CvsrKSoec2MjMzBWgcDofp3jO8Xw0NDSEBQQZgkNTZ2ekBPoT8LJeqqqrEhVRUVMTAcxsFBQUCfNXV1aZ+/0IlCmQABiGdcwcfIkCWS0j/Ab7c3FwGntsoLy8XUEH90wrCB1dJSYnlIcgA1FHu4MNgeSo9PV3Aj4HnOQA+DNSKrSS9okCk0wxACwuzue7g02OWLJSE2UuAD1EOA881srOzBURaWlos+b7if8DElZWjQAbgKIS6njv4UPdjuVRbWyvA9+zZMwae28AHAsCHDwSrC/9HR0fHqH9PX18fA9AqwpvlDj4zztQZHREDfIhwGHiugZluAAPHJZSCACtPiDAAAyjiu8PPanWbYCsrK0vADz1sDD3XQC+fXk3EZnzPEe1bEYIMQD+FMN8dfN3d3XxQ3ITVCgAfvjLwXAOz3QCfXn1zZk6F9RCiZAagiQTQuYNPj3pHKAkXNsCHhmYGnmsUFxcLKOBruHwAotZrtSiQAehDvHxt5A8GgA8rFhh4rlFTUyPAp9fsaDhGgbjeGIAGCpMa7vDDpAfLJaR1gB9WKzD0XAN9jnrNilpRTU1N9PjxY0tFgQxAN1l1+RqA/d133wX97+CEAfiwAoCB5xpYvQHwYeIn3KXX+mVkYAxASbK6TdW5c+coLi4uaL8fjboA39OnTxl4Xmyq9Kp9hYKQLVmpLSasAWilOh+iUyUVx+uGd54iNNTabDbdU3X8PoAPqR0DzzXQ8oGLXK90LxRLJDC7sAIEwxaAVrCpcm+dmDNnDu3bt0/ct3XrVgG8Dz/8UDyG126326msrEy3vw1XErap8m1TxZNiI6fCegggZQCGYZ0Pbw4g9/DhQ3H7+PHjFB0dLUB35MgRunTpknh89uzZIkWdOXMmffvtt6P+u5jYYJsq3zZVekU2oaomRw+VPO+knPxS3ZxtGIA6yIo2Vbdv3xbtJnjtkyZNopiYGFq4cOHg44BUVFQUTZs2jd566y16//33A/5bKFwDfDk5OQw8t4GLBOBD/ZOlElh09wnwuQ+9HG5Qk2cAjkJWtalCWwGgd+XKFVHzQy0uMjJSgM9d7733nogG33zzzYD+DnrWAD/Uthh6rvHo0SNxEXMblLpKazuHwQ+joKzB9BMiIQ1Aq9pU4VNz9erVtHbtWkpOThZwU9ZaAnYzZswY9sl64MABr/erCSBlmyrfNlXuE02s4Xre3O0VfB5RoPNDRK/jyAD0U1a2qbpw4QJNnTpV1PqwjAopMMD2xRdfiMeRusfGxtKhQ4fo6NGjg1BPSUkR9/sDeVzkbFM1fOADAeDTczIpJDOq9t4RwTc0FWYASpDZbap8pVK4X5mFxsWHut6qVas8IjVEgUq/2Z49e0QqPHfu3MGID0V6/Jwa7LFCAeCDewcDzzUwsYGLFMeF5VvdPf2awKeMjKw83bwPGYA+ZHabKkRyiOyGNs3euXNHNDEjert27Zq4D7O5iADdJ2o2btwo0l/39N69dQerENavX++znQdpHeCHtaoMveE2Vezuo67yuq6A4Kd3FIhSEANwSFRjFZuqhIQEWrly5eDtXbt2CdChpeWDDz4QEZxij45Z3U8++WTwuQAXnqvVVgkRJdtUDR+Y1cVFWV9fz3RTUX1Lz6jAp4zcZ5W6GcEyAMmaNlXosUMqq6wgOHz4sLBHx2wvevvw2DvvvCOiV9T0ALxAC8iNjY1sU+VlYB0zwDd0Jp3lKUdHry7gGxoF6hGgoM4dtgC0qk2VkpKfOHGCJk6cOJjeAtwA37vvviuWEOF7vDHQpk2baNmyZZpPDoAPrS0MvOE2VWglYvlWb1+/7uBTRmFFs+kmRCwFQKvaVGFWet68eeJCxOsG5BITE8Vjp0+fFhMaSu0OrS+4DWBqXaWCtA7wQ1GfoTfcpspqJheyVdnQFTT4KeNx2hPd3LHDBoBWtalSAI3XiwkQrOWF0GALCCIlvn//vkh10f6C2V18j4kRTSduZaUAH9pmGHiugfQf4EP0x1Ipl7T2BB18Zm2LMTUArWxTdf36dYqPjx+8jVofoIeviPbQwrJjxw4BxyVLloilbmh+1lKUZ5sq7wMTP7jI0BrE8q32rj6p4FNGZu4z3bYKCFkAWnX5miJcfACeezTnPguMYjweh8GBVicapMdsU+XbpgoRNkvl/MH5ZwD4ghEFIp0OKQBawabKmzCzi9YVuLMgyoNWrFjhYV6AVAzQA7ygs2fP0s2bNzUt0UMfIX4ebx5DzzXQxIyLyoofljJV09htOPww8opqdJuQCgkAWnX5Gmah4doCsKGvb8GCBcKdBVBDbQ73Y6LDPSocP368ZjcawBPgA1wZeK6BDwSAD8ea5VvNjl5TgG9oFKhH+xpq7ZYFoBVtqtwFU1JA7euvvx4E+bhx48SEBqTM8r7xxhvieaj7aY2I2abKt00VWodYKhOI3X2mA58yiqochk+IGApAsy9f8yUU2dFqgk8eAGrs2LHCjUURQnvADoVePOfUqVNiuRuiNy3/I9tUeR8oN+DCsUp5xLDztLbTtPBTRlp6pm6bSVkGgFa1qcLqisWLFwu4YXz00UcCaLCsQpSHthYlJEfbS6AGpQAnwAfQMvBcA1EwwIeVMyzfqm3uNj34gjEhgjKIqQFoxeVrSv0NUJo+fTpt27ZN/B/oMQME0e6CSARmBps3b/aAvGJh5a/QAgPwoVbIwBtuU4X1zCzf0mpTZZaRnVesW8uSKQFodpsqRUhr9+/fP5imIjJFrx1aVbAkTVmidu/ePXEf0trJkyeL5+N5iAID+TTDhA/bVA0fiKhxPLEREcu3enr7LQm+YESB4IupAGiF5WsAGNpXENEBaEoqu2bNGuHQArAp0SoghdUaqFvg52BWunv37sHnI03WIqR1bFM1fOCY4KKwyqofo1RR32V5+GHkl9Tpts2oKQBoFZsqQAytK/DaG2raiMewHSUamBXt3LlTrOtVUnrswwHTgkAmUnCRoyGagTfcpgrfs1TKJS96QgJ8Q6NAvcxNDAOg1ZavnTx5kqZMmTJsIgbeZQAgVnIg4lN8+hRLK9T88HXDhg2a/h4K+AAftgxk4A23qVKayFk+MqrOvpADnzKKazqkt8XoBkAr2lThNaOOt3fvXo+Uffny5QJu8OSDEAHOnz9/MH1HGow9ObR49WGihG2qhg+UEnDSK6tjWL7q6P0hCz73kZ6Zo1tTuzQAWnX5GoAGAMKjTwEifPlgYoAGZkAQkFNmfANdwI1oj22qhg98GAB+Vmt+lz4519AVFvDTe0IE2VpQAWhVmyp3wYll0aJFHrVLCKk7JkCOHTsmbn/11Vd07tw5zbPKAB/aOBh4w22qlMkmlnfJtqkyy8gpKNNtI/qgANDqy9eG1uRQ40NKO3QSB+akqA9qBTuOCcCHZVoMPNfAJBPABwCyVCYQu/rCEnxDo0A9OkZwHesKQKvbVHkT1u0ixYUnH4xJsa4XtwFGrek8wIfBwPMcOKH1Sm1CWeEOPmUUlDVKmRDxG4BWrfP5q7t374qZ3ZiYGBH1waZKiyMNZi/Zpsq3TZUyi87yrpqmbgbfkPHo0WPdlj0GDECr2lTJEmYx2aZq+MDxAPiU1TMs72pp62XYGWifPyYc6nzBECZJAD70CzLwXAMtDDhpscKFpRJY9PQz4FQGZr4h+D1i0UCwIOgVgFa1qZIlrE0F/BD9MfSG21RZxd3HKJXVMeDUxtC5D72iQNjKqQLQqjZV0grUJSVsU+VlYLYbJ6nWddDhprpmrvOpDaxy8VVmQi05GFGgAKBVbapkCRuvGGFThT45M4MPjeEAHz4YWL7V2s51PrWBdc0jSS9jDAR1HgC0gk2VUULqj2I+Ul4j9rpAb6KZbaqwkoOlcrH1cp1PbcDJxl8hKAvGhMgYM9tUGS007hrVzIyQH96EZqszKjZV3A0wwkVW38WQUxn4cNAqfOBq2TfbHwiOMatNlRkECMlav4u64tWrVwV0ldlUABCrJswAPqxnBvhQSGaplEte9DDgVAZcq0cjvaPAMXzK+k5/sblRsOtwAB2iPKTaR48epcOHD4v0F48hBU5KSjIUfLChx0mH18TyrbZOXr6mNrBPiR5C3Rlr6/WCIANQRUh/lYjM3/HnP//Zr+chkgLcEOVhYG9hwBAuNLiNlpLz588LAwYjbarS0tL4RFBRXz8vX1Mb2JlOb+kVBWKVCQNwBGld1/vZZ5+JzZOG7mYGwMHhQrnv4sWLAnRIs7GrHL5/9OiRAM+VK1fE7YMHD9Lx48elww+TPjjJeFJMXdWN3NaiNrAncVDKDC+7MvQQA3AEIdxWUlItUSDCaxiqHjlyRMAM+wbjKyI8QA5O04gw8fsVGMKdWvkdgCEAiJRY1kQI2nwAPtQ9WSqRg4PrfGqj2RF8nwCcp3q4zTMAgxAFwlhh165doob3008/DQIMs1i4D1DEfZj4APgSExMFdADJH3/8cfD3oAYJCAa7DqnYVGGig+VbHd1c51MbNY3yJlTRz6dHKswA9EOo12lZ8wu4AWxnz571uukPHgPc4Djj3usHECLiw99TZl7xXK11SC0DkSZOJF7uqK5SBpzqMOLswTWJ3RQZgJKiQC1bVyIF/uabb+jBgwfDHgPkzpw5I34nAPfdd98JH0J87953iBUWuC8YO8fh5AH4tOxrEo56zjZVqqO9y9j+4dFGgQxAf9Ofjg7NqTDA5m0SA3VA7EOC7zETjPYX9AAOBR0iQWzCHgybqqFbgLI8xTZV6gN2/WYQzuPROIwzADUIM7boi/MXNqjrwV362rVrHsvIENVh4sMImypEfizfYpsq/2yqzKTRRIEMQAkTIqjzAUC4jb4+AFDmDnHo5cNJwqt+Rogm6nj5mtro7TNnnRhu46hlMwBlFMOdEaCW5WmoG2JHOaS9mBRRev9k2lShb4rlW3Ut3NaialPVYf7tL3CeB7JHEQNQQhSozOa6p8IybKoC3cc4XNTawXU+VZuqFuv4gaKLIZBUmAEYgGD8qcUiC5MZr776qthjOJjgQ7SJkwAtNizfQirHgPM9UAqwohBoaN2DhgE4iihQa4Oyv+uEAxmAHuDHZrbqqmzgOp/a6O6xdj+o1iiQARigMKGgNRVetWoVLVu2LCg2VWi+ZvkW21QF16bKLEJQgto3A1CCsKoDdTYjokAsowP4sH6X5VvtbFOlOp43h15nAK4Lf/ctZwDqkArL7OdDPRFvMOyyWGpFcbapUhultaHr6A0XI39TYQbgKIWiq7vNlQybKmxbylJJg9imyhCbKjMJva/+7FLIALRAFAg7LoAPzdRGqrikhLZ9upsmvx5Pe5MryGyXEWyYGHC+B2y8wkn+RIEMQB2ETnTMwuoNPkSXeBMRYUqvbz6r8wBcc1UR2Ww2WrFmJR3+cD5F2W10/q457LM6w8SmqrimI6Cfq24MzxVAWPeOhQumBiBeICIozNy0tbVZOgpUlrvpaVNlxG59zRUZZIsaTzmVTc404gWhseZsfCTZZm4QtkfPK6soOtJGkxbsNPy4o5YV6tArqm6nwqo2elbpEF9x218YhrvL2UhRoGEAVNI6LNNC0VLpZbNqOwc60fVIhRWbKuxXYJy6aff018gWPYPsdjulZlbQ6UWTKGLap7Q6Pp6io6OFzZeRwuxlOER8AF5eWQut+2Cb+FC6k5pH+eUvxP1qEMTsN2vAyxO1c9MAUNlsB20cwy677u6AFzWbQWhJQdgdCPhgje/ruMhNJ3uooaRApLsxzjT3cOLAbHN78b/Ffes+3uOabCjNoy07Tkt9fehXC5eaHSI9wO//XouiMWMGLlV83XfoDOWVNg9C0H3UNXeJrMF94MM5nA1v1faxlgZAZWd3GAGoCRGhlZdyaY0C4Qrjz3GRob6uKgG5G2Vt5KivpSsJcyli/BqRAlN/L7339iyKiHuPPvs+k75PShHPXbrmYzkxaW94LV8DzJDyZhfV03/+8r88IhpAMCO/RkAQz8EoqXaIixyPY68MlJPwFdddV1eX6ItTYBhuwnHxlQpLASD2wsALwBvhL7H12PDECGE9LnaB02JT5e9xCdoJ4tYz+tH6+fSv+I9e3nLQe5MiKH7rjZeEbKQvEuaQ3Qm+SGdqjPe1T8IFFY42VQBgQUUrZT6rpf945ReDEaASBf79H/9D6XnVdD+9iJqaWwa2eHTe7z7WrVsnvuJDFiuGkGEZUVM2g5S1+1IBqLiS1NfXa/u0d75Reu39aVQUqOzr4W1gVjeQ4xIMnTq8h8Yt/NAFw6qbIrI7lDPwAfTk9E6yRb9BPzovxPc3nCaguq9bThNtfRjbVCkRIACY/LjAA4AKBJWh3F6+fPlgtuXt+egfxbUVrumwN6YEBYBIY/HHRrODux4bnhglTOp4S4VheT/a46LL6+vooqaugYugo/yKAN76U64ldZePrqNxcdOooQPRQid9Ni9CPOeDjZslvT5evoaBGl9OUQM9zCyhf/z3/3pADUsq3W//+te/Hh4l/v3vHrdfe+01cW5iR7VwhCCuP9TogwZAZas6vTYttnIUiPRQ2c1NsanS67j4Vc/r66Wn1R3k2fraTzeuXRUws9niaMeDgU750/tWUXTcHGpuG3h2b3OeeM72Ky8Xlfc6SEY/BdtUeZ8EQap752GegJj76gZvUZ472Lw9juAENbFwTYWHMkU3ACrtG3rW7gAQKy/2B/CU+qfsmmb67fNOiMVQecPA362ra6DNx85RlN1O2ak36Pyet0QtL6P0BXU3ZgngzdmTQkhuC9Kuv5wFtgvTUBmqYpsqn20wiAJLy6vo1q1bHlBLSUnxuA2nIffbQ1cO/eY3vxGPwzk5XKNAfICg9q4bAJVNtYOVrlo5CkSvo8xVHDihz128Tc0I5PocVPgwiV60dRAQ9tPJdQJq+y/cfxkiOmhxTBRNTzgrblbkJFI0IsPYWaL3LzHxppwTspVtqtRGs6NHTJJhkgOLBgCw+Ph4j6gOG2/5KzwfWQnqhOEcBSqLLgIGIJZ/4ReNZks6f4R9a63cGygT4Jd2rhaQW3vk6kBJotNBcZE2OnvDCeGeJnrLFkEzt15y/UB3Ok1wPv/k3Wo8mxqyTtKRfdudaVJt0F8r9pNlwKnYVDW5lq+hhQUXLHpocb25R3kA2Z/+9Ce/jzv2pwn3KBDHU7kuNQNQ8d6XCaVANzwxg3DSyurxy0vaSzZn9DbJCbVb5WK+ln5YN4cixq8VvXydLx7QeOdjiakuwH25fjFNfPtDucVoBpzqGF7P7RN1O6RvKOT/6le/Glbf06K4uDgRUSKyDNcZYbSqwTxV01FU3IdlwyjQDU/MFAXq3euHY5Jc0uxxX13pQ7LbJtGXm+Ip9u2El/c6aOmkCFq//UcBxE+WvElxS3a4fqiniHIyMqQch5omtqlSGx1dfV7fZ0RqqCFjAuP3v/+96GkDAANJYf/4xz+Kn0ULVjhPhijXpV8ABCnxZK0bjuga3Tjha7QdVKBSVsHopT5HBb0x+w2yRU+m/ektg64tXU2VNM6Z8uZWP6NZznR3xYmBCaTHJz51PneeE4UAXj5Nc0aBHyeWSPv/2aYqMJsqwA/pGuD3yiuvCHBduHBhWA+gVuHnULvH7w1nAIJnqkdQcVbV4rEfKvU0vYXZYD0bn7cvnUxRMeNEze/LHx4JlxbqbaNJsdF0NaWYki9/7YTeJMqragGCafuM12jcrGNiQuTupWNS/ufObm5rUbep6hoxykfmgHq7N9jhvkAmH3fu3DnYGO2vdXyoyicAlWVaZjpAWNJjFhgbDfDa1PNkmzibKvJPi5rf5r2nxP1rp02gj8/85AwTW+ibOa9SxKTdhHJ6ZdoNskfGiF47GSqrZcCpDX/eBvfa329/+1v6+c9/7hWCWrVo0SIxowywhutEiE8AolMaF6o/dtJGQcSqn1pYGqjfKpBu+nT6azT3i2yqS90vIDhv2ZeUcXAhxb23VzyjraGIJkfbaO/ZW4gnpPyPtc1c51MbbRpsqpQIEJ0QSNd+8YuBNcHuq0Bu3Lih+T36wx/+MNhUHc4TIR4AVDbbGclBNdhaunQpbdmyZcS0nKNAZ1SXlSRS4OzyVqp+ckm0tEROme5Mfee8XAHSR9mJh6X8X+FkUxXIwLacWuVeA8QEiLIwQJkEef/99wO/8HkiZOA4KFYxaqaBsoRPo7/+9a/0ww8/qD4P6bmxhqGBCyeybkvielvpHbuNNvw7WdxsqcymuAnRTihGUomkhSc9vVznUxsV9aOb/XefBUYkiEAFIEQ/oLISROsOgcoESrg3RItjoWYWKFtYOYHwHlGezEjKiChQr6VxbYUDRqXJ1S8bZ/saqf65HBMJXNwMOd8DHw56SIkE4eSigBD9pSip3Lt3bxBoI13HyvNu374tjHcRRIR9BGjUH0bEObSf8PPPPxcXs7+wNDpdDzhqemkaoZdWL55FH3x+Strrr3/By9fURmu7/jVqxdVZASGCBGQTqA0iLd60aZOAm7ctJX73u9+Jx/75z3+KpZmAH9JfrC7hSRADhOIrUt2//OUvNG3aNDpw4ICA2eTJk2nt2rWG1NNkCmkM9tTQa/10ffr3Ul43CvgMON8DE0AypKTFSF8xkwvoYYUIVjegUfpnP/uZeN65c+cGoz48hgk49PQi8kMkid8RztGfoREgdPfuXVq9ejX97W9/EzBE+ov7tIDEDLVLLZHfzZs36c6dO5YCOFo2GHC+B1p+ZAsQBLwQDSKSU6JBLBhwb5TGMkxkS1hEoGxApljk94f7lnFkkn2B8WYgKrx8+bLmrTHNYCnvj7B2GvBzT/uVYraZxTZV6qOrx1iIKGkxokHUBhHhoS545swZAT7FkxLnHep9SsrL8DMRAEcjtQ1PzCCkHQCfr3qlWV97E9tUqdtUtZmnF1WBIAIBgA71PaTFAB9SZMBRSXcZfCEGQAjLzLxteGKkENECfCPtcIcT1Ex2Xx1sU6U6apq6TXkNuKfEAB4yKXxVNkJi8IUwAM0WSQF8GFpeuxnsvhhw2myqzAhBBYThvA1mWAJQ2ZDcSCHaA/i0LiM02u6Lbaq021SxGICmEmbAUPA1QuirAviG7jilRZi9k2031tLGy9fUBuz6WQxASwjNoN6aQIMp2AkBfHpFb7KiQMxcMuB8D8x8sxiAlhFmvzCRILOpE/2KgB+KzHoJLQzBtvsqq+O2FlWbqj6umTEALSS0mWAxuNb+wUCFjnqAL1jRZrDsvupauM6nNhwdXOdjAFpImPAALLAESIYQnQF8wd7mUm+7r1a2qVId9S+4zscAtFi6C0BkSNrIB71UAB+662UJdl+jNaQ12qaqsKYjpG2qWAxA6cK6RsAPUJKh+/fvC/jpZV2lNRUOVJUG21QVFpbS5Clv0uMKc8Kvu5frfCwLARDLyAAEmB/IENbnAnxG7kKHlhqtdl8NBttUFZQ20uY9J2jVsrm0YvMOyqtoNRX4XrT38hXPsg4AYdsD8GFRt6y6IsAnayNzvaJAo22q8stbKKfMQSUVz2i6zUb2yChKLzYP/GTZVLEYgLoI7Sy4+LVafQcqzLoCfHDKNZNGsvvqN4lN1cboCIqYuYueOb+/dy2RbPaxdC2t2vDXVVrbyVc4y1oARB8c4OePLb4eAmQBP5gSmFG+tiyobjS2reXJs0bKqR74Pic7k2KjbHTg22znbQftmf0qRUzYTgUGvr7Obm5rYVkIgKi34WLH3r8yhP0UAD5ZbTSBaqjdV5PDeJuqnNxCirLb6PMLD17e105Hlk6liHFrKQ+1wKJimhITQXuOP5ZvU+XgOh/LQgDEcjJc4MHur1ME00iAD60mVhHS4KrqWkOhl1vSQrczqim9BLW9Nto/P4ZsETPofrnynAZaEBtBq7fecH7fQSfj/0W28SspX5ZNVSPX+VgWAyCWrwF+six7bt26JeBnxX0QRNO3BJAU13TQ1ZwXHvdd+iGJIiOjxIZVNnskvbv7CRU7gffG+AhateXI4PMObd3ghN6/6L643UiFVQ4pr5kdn1iWAiCMC3BBIxqTITRNA3zYE8GqQqqemVMQdJhsWr+U5iz/cPB2+sO7AnyXriVT7tMCOrxjs/P2eLr4tIXObo93fj+Rvr5XR6l5lTQ9biItnjOJvv8xXQr42tmmimUlAGL9LMAH+ygZgj0WwCerjSYUosD8zOsCeDvvNInbx3atpYnT5rk9p52+WBxLtpi1VOS8vSN+1kBk6Bybtu5imyoWA3CosJICF292draUfwozyADfw4cPQ+rNwvK4R4/TdANJelYxLdt5adj9R/eto7ETp1J6WTud3LGFIqe+7fH4j5ePOoEXQzlVA6ludnoK5RXVBR18lWxTxbIaAOGSDPjpaRulpuTkZAE/K+wUF2gU+Ky8SR+olDyi8c7I7cvLJR73HzywX0R0689mUEHWLfH9shMlVPjy8a0r5pDdbqeiGnmTML1sU8WyEgDRZoKLFTtUyRD6BwE+vTYbN6vQtK1nKrxt5WKKnb9RfH/5egrNf+sdAbevdq0U4Lua66CLp3c6v7fTpLlLad6iePH4mStPJNlUcVsLy0IABPBwgQKAMgTgAXzBNhI1k+BJmFtQrg9kKp/SVCfoYifMFMD7YPO2gdngqiZ6fVYcvbP9hKj7PX18mbZvWk6bNm6hzGdVQQdfXQvX+VgWAiBSXIBvpG0g9RJSXIAPKW84Ss8o8MyhXaK9JbPEs23l6aNTAopHUlukpbrldVznY1kMgJjcwAUpyzYKkxuAn6zlcmYUNlBKz8rVBzzVFTTHCboZW5KGPbZlwzv0IKtcjk1VD9f5WBYCINpZAD5ZmxGhfxDgk717WjhEgQ8fXKIoJwS/vfdcvk1VG9f5WBYCIBqYcfEBSDKEuiLAp+aMEo7CZuq6QbCmmZZOiaPJK/ZLA99ztqliWQmAygbeWMImQ1iyBvBhCRvLdxSYX1qv04RIOttUsRiA3gSzAlxsMC+QIZgVAH6ylstxKsw2VSwG4DDBngoXmCx7eKx5BfhktdGEgmDhn51XYmrwwcaLxbIMAJXtGWX118GQFOCT5QLNUaCcUc02VSyrARAQwgUlyzYKVvSAXzA2BA8XoSH8SXqWqeDHNlUsSwEQrikAHzYjkiFsPgTwYTMilj5RYFF1m+HgwyZNLJZlAIjNd3DxaN2GMVChjw/gk9VGEy5qa2szNBXGtpwslqUAiAtG1jaQuEABvgcPHvCRD5KePHlCecVym5mxETuLZUkAyrKNSklJEfDztsMZS/9UWBb8enq50MeyeAocTKF/EOCrrq7moy1JRUVFlJVbGFTwtbJNFYsB6FtYHwzwwbqJFTpRYF0Lt7WwGIA+BVssgO/u3bt8dA0UZtYfp6WzTRWLJQuAiDoAP1nL5Vgjvx+FlaP38utimyoWA9C3CgsLBfhk7fbG8k+Y4BpNKtzCNlUsBqBvYZcygE+WCzRLu9Di9LRQm4X98yau87EYgD4FWyyALykpiY+gRVJhf+HHYjEAVYRGW8BP1nI51uiFFT4Z2fmq4OvoMnb5WktTA+0/xUYYLJMCEBcRwIceM1boRIFNreZYvrZn82Kav2orv1EscwEQtusAnywXaFZwhIj90aPHg+CrajS2rQXtUmVVrk20bh/8iKJnLuM3imUeAN65c0fAr6eHF7mHShT4rLyR+kzQ1bI1YSHZ7LG0/UYlIfluyjxPNttUYh8ZluEAxDaXAB9cYlihI/g7AoJGKct5Xq3e+Amt3J1E9V0ddPFgghN6UfTuwVTqcBSKPYhL2hmBLIMACPt7gC8vL4+PTIgKDt94n4Oa3jpHe1cvuQeap04cFIBLWPEWjY2OpDc/O++8t58q04/TpBg7Ldy2l2aNtdGRLN4DhiUZgB0dHQJ89+7d4yMSJqlwMISMYXXCRwJ0GGPf3kI/lXUL0C2ZN40qmxyiOfunxI/F44eTXu4z05FJ8XOixH1z92TwG8SSB0BAD/ADBFnhIWxwBZce3dTfTwkJCRQdHU1rli+kp+lJlH93PyUsmEC2qDmU3UbU2/nC+cQumjlzBr3++uu0a91imrBgg+tX9NTRN0vGUuzsr/kNYskDYLDTIZZ5o8B+nTbtqCu+RdHO6O1Q4p0hYGylA0ujyW6bT629RHvWLKUZy7YMpMb9ZTTB+TNvH8kffPq1w+tpbOwS4gV4LKkpMCv8BMMK3VLh/k5aN2sKTV19YDgc81JEapuaX0ufr5hCr7+9mCrrW+na9etki4ymq6mubRFSf/iaosdNJt5ShMUAZAVd6O3UbeP5nhyKc4Ju3/VyTzZ2NwsAnk3OpYbMyxT5sj44ccIEqm30dA3KT75In3+zn98YFgOQJS8V1kvHPllHsfNWe3Kx7bkA3pW0ATB2OeqovqqU+rz2lnLox2IAsiQKO/PpZmPWW0azbRG0+GDu4F1f7thMdttUau3kyh6LAcgK8Sgw9cZhihw7kbKKn9Px44coKmos3clmn0gWA5BlUmH/Fqz+0UV9TbTAGQXabHay2+1i9QmLxQBkmT4KhEGBHnLUJ1Mam2ewLKD/B+M1bJuB9qN5AAAAAElFTkSuQmCC"},868:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/convert-ad-hoc-analysis-projects.2b5c558b.png"},869:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/count-items-within-any-dimension.6b09cef7.png"},870:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/create-a-simpler-data-view.810298d2.png"},871:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/create-custom-date-ranges.88e8d4bd.png"},872:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/create-in-context-alerts.f81f0921.png"},873:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/create-metrics-on-the-fly.5001f359.png"},874:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/create-segments-on-the-fly.254178dd.png"},875:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/customize-your-color-palette.40a5a34c.png"},876:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/explore-anomalies-further.03625ff0.png"},877:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/explore-why-visitors-fallout.a6908252.png"},878:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/flow-is-multi-dimensional.ef2f9bb8.png"},879:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/focus-your-freeform-tables.ce9402a5.png"},880:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/generate-a-quick-trendline.6fbd8b6b.png"},881:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/how-do-these-segments-compare.55cec0f9.png"},882:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/integrate-search-engine-data.ad80cfdb.png"},883:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/link-to-a-specific-project.18b1d238.png"},884:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/link-to-a-specific-visualization.a5990e7f.png"},885:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/map-changes-in-behavior.adb35a85.png"},886:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/measure-audio-consumption.4d2c2fed.png"},887:function(module,exports){module.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUAAAACgCAYAAAB9o7WcAAAiIUlEQVR42u2d+Xtb5ZXH/Y/NbzMD1AmEAilDgUKBpkxLh055eNo+Q6dMgZYlgUCgxFmcfSGJtUu2ZMvyJsuLvK+y5VWyJXmTN1n7mXuuLFs2tiNLulfve3W+z3OexPGSa+m+n3vOec85bxnkIZ/PB5OTkxAKhYDEh1ZWVrh7vxoaGuCHH35gzvC63G73se2c/RR81vIkWYY96Poop9cyXyvL5YYMBoMi+JaXl4koHGpxcRESiQTz1zkyMsIk+DKtv78/68Vm7r9KsDvCmAdgJBIRwef1eokiHGtjYwPW1taY9lJZB1/aqqurs1ho4wQ4RiGYNQCnp6dF+PHgOZAer6WlJYjH48xdl1qt5gZ+aevu7j50gRHUOAdgIBAQwYdeA0k5CofDIgRZUWtrK3fgS5tKpYKxsbE9C+s7xy8IaBxA8FAArq+vi+BbWFggWihUmMONRqNFvYaJiQluwZdpDodDXFCO4WqCWJ7WMVxbPADGYjERfLOzs0QIhQvTGfiASyaTsv/fm5ubigBfphG8+PMC9wDQ4/GI8Cu2V0CST7ijjzCSU0ajkcBHdqRdav+1fADEsggEH8s7gyTpJFdZjNPpVBT4vql7g2DFuRdYhuDz+/1EgRIWeoDoCUoljCyUBL47jyoJUAqBYBktfxJKirIYzCdTno+MAEhiXpj3xVC4UBsidXV1ygJf81MEJAVCkABI2hGWxWB9YD7C1jAlge9i9fsEoSKbdeA2AZAkvdD7y9ULxIJ5JYHv3oM7BJ8S8AKZAKDH4yP6MCKsBDhu18/Dhw8pz0cmqX1lf16pAFyDt069BqvbH40G40ShIivbspimpiZFge+LpqcJNiXmBTLhAfY33oLyX3wIp06dgqqGDiJQkYXzAnEiy2EaHR1VFPiuGj4iwJQoBIsOwHhoFU6eLIdny8uhfSxA9GG4LAZrBamshawY9mkzhx6gP7gJsUM+F0HPT/g8ZpvCG0GIrLbC0699BWFiDxPCGr7MPmGtVkvgIyuKDYx1cbgJkgjBbwWvrmFwbr/PB3//6CN4/zcvw+9fPA3Pnn4XGhYQkwk4/+4ZuKzvI/owVBZjt9sVBb4vbf9BUOHE9APf81YInYRqbRW0BLb9vogTnv3F57CV8RW2++fhf89W7HzsUl2AV97/MPVBdAR+/uIfgSYPFl9TU1OKAt9N4T4jqPBh5x0/Y/tMkKM0r/kb/PabOzsfX/zz7+Drh107H//pzefAFUrVnM3MzMALL7wAer1x5/Omys/gnU8NsLa5CWe+rCISFWEDhPJ8ZDQROg99/d+n4d5EZDuZNAav/OwPsL79ub//4VW43D4PZ86cgYqKClhdXd2XHJyDj8p/AuXlp6CzZ4CIJKPwfAsCH1kxzDnayM+pcI/TSscj+Pnv/gjpfoJ6Iex98yOD+HFH5YfwzEuvgtvl2rvDODcJ/q3UdyRjGDTTTEK5hGdaKAl8F2rPEFQ4sfvdnxQFfJIBML5NPfM/XoFP+7bPn4374O1nfg4z67jHuwWfvfQsnHP4IZpIilCcnnTDi+UnwDG5QjSSUXNzc4oC392H1wkqnNgX9pNFBZ8kAHx05glQ906Jf9/yDsGJE+UwsZ7qKPCM6OHJt66Ift36ZBM8L3yuvFywp1+GZ545BR4PnT0il7C+j/J8ZKV0/q8sAIxuzsPrz7wOc9vR6/TVN+GPVY7tDeIQfPCz50HfPrkd5oYhODsKs5MjEAlvEZVkktVqVRT4Pm8uJ6hwYi0jRqbglzUAcZT5J2e/hTfe+ww+qZuFdJfo3Ycq8K9F95TBNP/tDJy7Vb3zL+/98qdQP58ui+mFF57/T3jr3U+p4FlmDQ4OKgp8FaY/EVQ4sUrn75kDX1YAxHaoCxcuwDvvvAPOJgMsDNng1eefhbuNQ6laseazcPrLln3ftQkfnH4RRradOn/1Ofj1ZxXgCyxAOA4w33IXludpBL9cwsEGSgLf/Qd3CSrc2FPMgi8rAJ479TS8p+3eOx8u0gP//tr5lL8XXYVfvvIC1A7t3bwYefQd/Pb9r3Y+rnjvBSg/cRJWYzTpRU5VVVVRno+sKDY6PsQ8/B4LwEB/A5w4eRKmNzJGI21Nwr+/8ymsbEe+kfHb8NyfK/d+Y2wZXvzJc9C2vg3OeAgS8QgRSSY1Nzcra0xV4ymCCidWO3SXC/BlmQOMgf6Nf4U/qVMjqsxmC7z81ivw5ksvwEsnfgYvf1wPMYFxX/3ff8Jfvt0NhWt11+F//vJn+P6f95jb/cSwXqkaGxtTFPgq9f8gqHBiF9pe4wp8WW+CJBNB+NWzT8Hp08+K3RupOS5YyzIB//Pk02CdFICyPghnTpbDqdfPwtsffAy/fONNZiGBE05w0omShFOcqayFrChjqhgra5FkF9jx+e/hrY8u/OjffT134F8+TPXxRpfGwW2tBI9rEOIM5/pw0jFCUCnS6/UEPrKiWJ+rg2v4HaMOcBP+9uITcGN8bx7vm4/+CF/fa+IOGjjtGJv+eVZ7e7uiwPdV/SsEFU5M0/cN9+A7diH0uKESXjzzX2IpC6rFZoZf/PpdiMWTXAKEVy9wenpaUeC7VfU9QYUT+7L1ecWAL4dOkAhUvvpv8Il9Ht5++2146aWXuPag8OQzHPHOi/C8XsrzkVH7WmEM512ijtUKtzTZBT89WQ4TExOKyJ/x4gWazWYCH1lRrGO0XnHwi0R2U3nH7AVOgpIUjUaZhmBraytcvHgRrl27pgjwfWv5DUGFE7vT/aHiwHdQxFcGJS4EIIKQJc3Ozorgy7R79+5xC757D28SVDixz1tOKA58Xq/30LVW8gBkKRTGlsP94Evb1atXKdwlozxfDuEuHu5FADxC6BrjpkgxpdPpDoVf2m7fvs3RmKoTBBVOrGlYqzjwZZa5YaPA5uYmAZBFLxDH0T8OfGm7fPky8+C7ZPyAoMKJXe58R3HgO6jVFVtgcX1jEwQB8BDhEwMLpOVSIBDIGnyZduPGDTbHVP1wj6BCY6qKZh6P5+hWDsEDXF9fJwA+zgvcM/pLIlVWVuYEP7RLly7B/fv3Kc9HlpMNj/crDn4HeXYHlvEJ3uH+DU8CYIZwSIKUobDFYskZfJnGSlnM2cbnCCqcWM3AdcWB77h5+62trR+VwhAA9wknKGPXRSE1NDRUEPBl2t27d4sGvuuacwQVTuybtpcVB758nBQEIIKQACjDhgge+l5o8BW7LIagwos9oTjwzczMFKT5AUPhdKqLAHiAcNv8oITpcXTnzh3J4Je2W7duEfjIfmQ9Lofi4FfIGZ64ttPhMwGwwF5gY2Oj5OCTsyzmvPU1ggonVtV7TnHgwyiq0MJNE0x1YXkMAfCIhOlRFeT7hW+WXODLtOvXr0sCvttVFQQVTuys/ZTiwOfz+SQve8NIjwD4GC8QnxJHCTdMigG+tFVUVBS8LIagQu1rxbLJyUnZ1jc6OATAI5SuID9MeOxkMeGXNqwrJPCVlrWN1CoOfoWuvnic8P8jAGbxlMjcNke1tbUxAb5Mw02XXMH3nfl3BBVO7KvaX4nvWX+/cgqa5ezAok6QPDZEsN2GNfCl7cqVK8cfU/XgFkGFl9PXmp/a896ZTCbuwTc3N1f0tU0AzHLbHHNtrMIvbTdv3qRwV4H2ww8H53i7urq4hR8rIgBmqZ6eHuYBiH3Cjx1T1XSSoMKJXdF+duR7iTlol8vF7ZgqAiBHKvZub75lMZcNfyWo8FLWUv9S1p48HpvA65gqAiBnwpwF6wDEUH3P+PwH9wkqvFjzkzltYmGvOavgw+MdWBYB8BjC/kG84ViHYLoshqDC0SFED3MvaLdarUzC73E1tARADoVb9qwD8HPrTwkqnNj3xg8KUsPZ29vLDPjy7aMnADIum83GJPi+vfkxQYUXa/hpQbt3DAZD0cGHU855EwEwB+F4bdbgR1DhqaxFmsEVTqezKOCbnp7mdi0TAHOUFENOCXzKtptVFyWd3PPgwQMYHR2VFX6snalNAJRJ+MYXszj6XPWrBBVepjJXvyvb3Mbm5mZux1QRADkTtsjJDb5/VtI4em7a15rKizK1e3BwkNsxVQRAzqRWqyncJZMtz5eN4eFbPI+pIgByJCnP/Ujbp80EFF6sUn2eiRP7sHWzUPDbPw2JAEjaI7vdLgn4vtL+hqDCiX1Z9wZTZzVrtdq8wXeciegEwBIWNngXEnzfX/qOoMLNmKonmQJfpnV0dOQEPq/XWzJrlwBYII2Pj1Oer8Ts/oO7zMIvbSMjI8eCX/q4SAIg6VjCY/uuXbuWe/taI42p4sUu6z5hHnxpw1MKswEfFveXogiABRSO/Dku+L754U8EFU7si/oXuQFfph01Ph+PhyxlEQALLKPRmCX8vieocJPne4JL8KWtpqaGuzFVBEBOhWeNUp5POXb7USXX8Etbd3c3V2OqCIAcq7Oz80DwfWF9nqDCiX1n/LMiwJc2LNhndSozAVBhwsLRPWOqbvydoMKLNZ5SFPjQ8BjXRCIh5vvI+yMAyqKZmRkKd6l9rejF0PvTMzwNKyUAcix84hJU+LAbqn8qDn7BYPDQSgUs2SIRACUXthIRYNi1r2t+qzjw4TGZRwm7lg6DIwGQVHB92/EywYa5MVU/URz4mpqasr4n8VybSCRCi5MAKL0w50LQoTyfVPbw4cNj35M4zBc3REqt7Y0AWCQ1uh8QfIpsVzVnFQe/fA4hwjAYw2ECIElyYbhBECqOnbO+pjjwDQwM5H1PovdHZTEEQNk0H/AQkOTM8ykw3K2rqyt4egZLYwiAJMmFT1wCkzx278FtxcFPqtIVrFTg/WQ3AiAnwrwLAUo6q9D/n+LA5/F4JL0nsWsJd4UJgCRZVNn9XwSrAtvnttOKAx8eci6XEIDhcLg0ASj1E4a0Vzh4kqBFeb7DzGQyyX5PYniNR7xi91KpKJxIlQCV4XF31Bojr7qn6wlgedqtR1cUB79iTmXG0w1LZSp0j70eVCo9rArYK8MEqFLP/GRV+JoTxHKzb03vKw58ExMTTNyXWBajdGdo2TclwE8FGrUKWt3zqRwgToelKRHy32wEtOOMqTqpOPC1trYydU9ubGyInqCSFVuaAmdXP0TdTQIItbubIOQFyq8v7CcIbCXYvqbRaNj1kEqoLMZep98FICZB82mtIeWWdyHAHW7XVRcUBz/WS05wN7gUDkRHReYH9pbBkBcovx4Ofkyw22fnzW8rDnx4Pi8vwnpVrA8sBZXtzwHgJGOSfMKGdIKecsdUNTQ0cHdPYn9wqZTF/KgQGr1AmhUmr0a8XZTnUxj4Hjx4wPU9iT3C6BCVHACR/hQKy//ELVXwXdF+rjj4+f1+RdyXpTA+/8BWOK/Xq/jtcBZvttIaU/WK4sDX19enqHsSC6OVPj7/0F5g8gLl1/m2F6h9jUOzWCyKvSdx11rJZTFlR3kkPp+PqCRz3kXJ8Lv78Kbi4Ef5coUCkLzA4qh6tEJx4Luo/6viwIfdUySFAxBLNAiC8goLURUzpqrhOcWBr7Ozk27SUgFg2gsslaJIVjTtc3EOvycUBz6DwUA3ZikCkEJh+YUFqLzC72ZVheLgR4NCpNdmOAJNjn5wBiIQZQ2A8/PzJdMfyIpw940n8F0w/UFx4HO73XQjyhHxjA6II6rqjBrQCH8a7CNsAZC8wDyUjENfXz+M55BF+GfH68yD7x+N5YoDn91up/tWRlmrdWATvD9RwSEwCBC0d4+yBUAsiJybm6N36/gEBJPwhlr6l479ndiKxPTu7sWLot28qYzyFvRCSBKvhmQSwpEIjM0uQDw1lR7qBc/P0b/rbbu67KDSmCDIEgDTXmApnRuQqxb9fmiwD8HW9pnTPRYNqM0dOf0s+4SGOfB9c+PjHfihXbp0iXv4Yd0rSXrZ6q2picyCqXXVMCVQ0NlcC9q6toyvCkGtugrM7dNsARBLNCgUPlxL61FY2wiDb6pffJPVJjv4txLgGWwCtbYa4jn8TCy0ZQZ+xtf2gC/Trl27xiX4hoaG6MaVSaG1gLAu1OBdXBZgsgr9Vq348eKyG7QY9rp3hy8MtNaA3tQISZYAKCYsp6dLYkrEcRSPhqG1pUWEHpqjZxwiWz4w6zVQpauHnkk3qNRa2Izn9vP9gfnitq81P3ko+DLt3r173IDPZrPRjSuxEokkLK+uw3o8FTWuB6aFdaCG1e3QKBlaAbVaBSbnJEwMNQthrwGGljYgEotBs0UHNTbpjwzI6VzgUvYCxz0+0JttYG7oBPd2EsPVZhafZJjfWBx2ivmL1e38X3ejcRuMaljJlYCCPmt5qjh5vorvs4If2tWrV6mshZTGnwA39Y5T0DY5C8mNgPh31/LuoJXQeIO4NvzJLRi1ana+Hg3XE5MAxNH5eKhPKcnlcolntqqFN6axxggWXZX4JtlG5iGxOg/BtU3o6XKCVqsBs04FRnPHdsgbg9mRlHfoDeZ+7CBuQskJvq/ufpA1+DLt9u3bzIIPy7nEHK1w71IuW1o5G2vBaLFBaHMZZjvrxHXTPhyAiQatEBXZIDOG1Ale4PDsmlgxEVlbguUFD0RkOqi9LNdvLCUvcG5sSATYwMBAxr9GYbWvVvz30YUwrHjc4t+nvT7Y8M0If9dA7/L22xzfFD836MtvX+tGz3vSh7uW0zmBL22XL19mDnw9PT17c1GhEPNnc/CuxhotNDp3S1n6O+tBbaiDhBDe1ujUUNM+BOgOxDaXxA2R6UBxxm7lDECcXFI6DeFbYNVWgbH5x4WxTRYdmOw9sDRoTbnyW1EIriyKwOsa2n59hCebXvi4YSy/Q6dwPptk8Msyz5eN3bhxgwnwmc3mQ19L3PXFQbSkfPN8CVhd24CFjRhk+tRdLbWgr8+ofIjOgU5YA7WDKxCZ7gaD4PWp1DpxnVgsdUW7/rJ8vhm9QKVPjE1rcW5M3MhYWdtb0TzssEGVvg6iG6tgEJ5squ28h8e3t6yiWqMC3/Jm3tfRP9tccPh9d+V8weDHSllM+DEhFN63eO6FHHkmJQt7pNM5O3Pb4M6/R+YHxShoNOOWn3RUg0ZXJ+7sJmJLsOjthaW52aKmI/ICIN5EpRMKR6FFVwWa2r1TfzsazKAzN257ehuwthSAeDRy4PcXQviaF2wq84M/FBR8LJTFYJVCtsL2Thr0kbum+x2g0ZuEyES476d7xCintrlvp3TF1V4DGkMNbGylnKRee50AQAuw5HeX5fsDMAzGcLgUFBeeWnrBdXdNp/qiF3zeVG5w3COvN7q4mF/7mu1pycCXaXfv3pUNfO3t7Tm/lrQhkp3QWV4N7UZ8fW11YKzdbRv0jPWJYW0gmvqaxLofzOpUBYS5sV1cK90DY0z9TmWF+CFK9gKT+z7qa6oFdU0rjI6Npdx+a1NRruts69N5ta/JYXKUxeh0urxeRyyJKZUHeF755+DCTqir1ddAcCMKU4NOUOkz86xhaNBWwSNLDyTiMXB0DUIiugXu9gawW83g9y0w8/uko9eCABCfolgaozThITe1ffvftA0wa1I3QjEXDh5adaxpLdc+kxV+abt165Zk8CvU648bIuQFHuUFxMCgVUN7dz8E5yahGkGotkAg5BM3Nsyu3URf0Nshro2t5BbUaarA4phi7tfxeDwi/PCsk7JC/VBevUDvwjIE1kJ7vYIFv7iDqNVqYWrix7/X2jIbsNcMn338VGbNmaKAT8qymLGxwoZRuGFC494Oz1rHwqtiHZ93NZUvxRw3lrI0DrhhYTYFvMnFVHHzzHBXCoCxpBASt4PWWAMxRvaZ8EGHnMo88bJgAMT2uOMkoIviNW3sbk4k41FobW4GjeDN1Vpa94W6IRh0djB/g2IC//AxVT8pKvikKItpFt4vKReHkk8/O47c7olUuKs2QefIHCSjIdAL62RkZve84/ku7ODQwXIiBE5jKiIymBvEP1sdztQq8k+DqcYCsURxCYjlYwi+g85rLivkf4T/SVimCu5sldh+8RcnR0FlqBfLHoKRKMy7B8SSlYNzffxobK63qHm+bKyiogLu37+fM/gePXok+euINYFUFiNEN94JcdNidmYQ+hypyS0NQwvgrDWCuqZ9Tz4cx7w5RlIdYctjTuhqEsLiOW/mq1rcyF14L5FJU1OHh+FlhYVNgqlQ2D8zBCqtAUIR4Y2I+cV8hVpnEt5ULQTcQ+Kf1dYGMFnqxKdX3wJ/hbG4cNPg+/rm35iDX9oqKytzgp+cLZfYbohdIqWs8S4b6GqsOw7B1LBdWENGCG0ti7Ws9q7d7g6TEAbb+71M/h44uzQbh6xMiv+YldPkE5sBGB8ehlA0Ab5J97Zbr4GV9dSLMjtoB0dDDQw4W6DVagBtdd3OkEaehOEbq+DLtDt37mQNvsHBwaK8lqVWFuNf3ruRNDPiBLXesrsO4stifZ+2xQ0zA52pXeDqJmjr6RU9xfkltiZDYYsjgi/bVscyKS6CFS8Q38NoKDWBwrO6DsnwijhuW1PXv9eLEsJkV59D3N5PcBoB1dTUMA/AK1euPBZ8Vqu1qK8j5rIzk+TKVVJ46JvE3dxMhMWWpkSw9QZ36/3WpuxiV8eGsDZWfGPQYDaCra4WlpaDzPw2mA9H7qQHXmQrSQCIO2rHvZB8FQjufRI5e/pALTypIBkBq0kHxrbUQSuR1T5xR2tsJvWEcBg1oFanxvCshPht68N6Nh68wKPKYljpzS2FPuGgu1u8560GDTQ69g6FneutFYHnX0uth9D6lPi1QUa9A8zxIfxyyd+WSXVRcnmBUzMeqNEKoa2+eacZu7m+DvR6Hcy6XbAeigKEXeLEib75kDiYoKnOKG6I2JpboHc9CgHfHEQjEe5v6u7ubuYBeFCfsNfLVh4Jp3AjBJW8IRKPhMHvD8CyuBlogMyAMbG1CiatGlSaarD3T0BzYx2odWZmyll2wne/X+QM7vLmKskAmHZJpVR4cVZ8UgWTIdgQPCDv4gbEwuuih+fyr8DCagi8gTWIxRPQ12EFnXW7bSfigcZqHTgcDtiMKucmx4QvD17g9evXRfAhsFkVRjERBTwUs1FfrQY0Ojuk45/AwiIkklvQ02SBGr0G7HYHrG+xUyKEKQpkSyHOcSmT8kLxIiXdVYuviK55b1B4ExvrQW1qwX+ENpNGhKB6Z7qsERY3veIusM2t7GnA6E2xDkCEH+vCjRDcECmFspjQkl/M+4nFzMkNMVqqGWFvXiLWaSJTsJOjUCrz+XwgNQQLpQG3B/anp83imQL4O2yARVMFjV04gy8J0S3hCR4OQWRtGbTC17i9S+CdcCh++gcuWKy5YxV+PJ0ng55GPuEVT5pq1Aohrw1wdax4nGJkxVJB0MzMjMiSQudmy5CmUiZ8EbCFajOy6NSgqW4EX8ZDub9eByqTQ/z7rKsHVLoaMeQV39T5RejoTLXqrIbCUCrCEgDWwDc6Osrla1kqZTHJZAIsejUsrW5AZH1FjJ6C4eJvCmJxOoJPqnNcRAAW0qWU1Atc94DdoAa1Rg9T28NFfeNtoFYbtvsWU9MoNPXCYgvPgFGjBru9GYLB0pv2UV9fzwT4il3Wkq/QA2SlrlU+GoZhZtJd1EtA4CE3EIBSageAUrr6eAMVbKcvtgLOmlRur2fcC6sBr9jStradr15bnhGfXv7lTShlYahZ7P5fpYjG58snfJ0RfBjyyqEdAMrhBRbsJkrGYHK7T7G+qU38M7CaDnHjsLm2SneSIOymKAb8CrE7x5Iw+U59wtILnSTkhJy773sAKOWNi79Uocti/K5eccdKPJnNH6Q76ICFKyf4cH6iUoV5bPICpfOw94+pKgoApfYC0a0t9C7gxuI82O12uosOEXouUoPPaDTSC006trBEDsEndSXKsQCIwwykDoVJ8go9ZKm6Okik4yqbMVVFAyCalIMhcXS+1Ds7pL3CTahCw0/qByVJmcIZAQg/VupxDwQgN2UxpKzV0tJSEPDlevoaiR7CuO5ZO3rgUABKVXiIwp+Nx2mS5M235AM+DKNJpOMK+9MRfKxGDIcCUA4vkM5gkFd4mFAu8KP3SR4pbY8ZzwjCdc5yJ82RAJRyHHn6XE6SfMLXHEfTZwu+iYkJetEkV1JMT+AwApVGByb7GPD+uCnEmCq5rvNIAErtBeLPp0Op5RU+1B4HvqamJnqhZJJ3vF8AnwEWFzzgd6WOlLQO8XnGNq5lBJ+c57jke52PBSBtiChPBoPhQPDdu3ePXhw5PPHk7imEw/U6UOsadj4XGqkXITixxM8sQinGVMl1nVkBUMqjLpHCB53XSZL2CbgffuSJy7EAw2Cqrga1Rgv6hj5AP2nNZds5b0MMiBMxsFZrwdLJx/Qc3MxEqGB6hcfrzAqA5AUqTx0dHSL4hoeH6cWQSRaDDhraO2F+2gl1BjXo69sgtrUJRq0KBqd3z9Dx9TYJYXEN02dVo+OC65b1B+fjrjNrAErZp4fJUhaqwktJWIjKWk2WkpXcSk0vn1nfxtrGpDih3OKYAm97LajUJhheSXkniwIgVRo9sLh3iq2sCBRsaGBZ2V5n1gCUwwuUMtQm/VjYkUMN/tJoZXkJqrR41rQV+jcRZTEReI6J3TnL0y67uAGyGYlDZ71BgKAeNDV2EZSmumamfh8sZcE1iqUtLOu413ksAEpJ/XR/IEk+IfyoLbHwim14xJmUg10O6LHqRaCNLCzDgL0ajHVNu4eORxdTcy1xdmUyBrOuNrDp1TDmntyZas6CijGmSq7rPBYA0aQsasRq8WxPdCcVRhgGK/2cFLk11dsAKn16EnYMXFY8d1oHHt+0WO9nm0hPRIqCSQBgs8vL7L2BQGF9InY+13lsANKGiDJDYVLhlNrZ1UNkN7yBWsGzs/WOQmDQJnqHFucI9I+5U6exBdnyrFgYUyXXdeYEQCmPukQPECdGkOQT9mYXYxgl79pcXxM3KzT6augN7q6JaGQRdGoVjM/sRjMzXZjvM2PiAVYHasGiSw3yXfSztZmAQOHBCSnUdeYEQDm8QBo/Tl4g04oEQCNArs/ZBn31etGr69spZUlCb4MZVKZmSDeDReeHU/V+O3tOCSz6Y+bXQS9K8nO8GbzOnAEoZa4Oc1IUCsu8niMR5luYmFqILgeodObtj+Iw0VIjAE4LMzvp1A2oE7w8ndkG47ML0NvRCFqjmbnfg9UxVXJdZ84AlNoLxLpA1p9GSvQCWa/oL4YwGvF6/WCotkFTr0vM7UVnWsSNjczto0ajGiyO7hT+NsMQC05Di0knnltjNpthdZOdzab0GT0FO62R0+vMC4BSJ0nJC5R/oVMo/GO52mxivq7VagSD8KfeYoN4Yg2MGAK7dnN480PdoNKYIJGIg1mvgV63RwyHQfg4yVC4y8OYKrmuMy8AoknpMSBglXbEIuvC1AbrY4zkUjiWykNbDBqwDaU8kHhwRixoVtePwkhHE6iMtp08X2xpUtzVxYYOj1OApsHG1O+DdbwIlEIfTMbzdeYNQCqLUWYoXMrC0wu1Wi30+DZED86mqwJd625nwfJ8p+gRzi8tgk2vEnN7YzN+GOprA41u+4S86DyoVRpYYmAvj8cxVXKpIACUktRYnsH6mB2lCT1A1otfJVE8AhoBfFqdFnp7e3ZDsS4LqDV62Ezv4CY2Qa9VQ22/B5Jrc9Ci14o7wng86Mra7lqYGO4t6q+THjrM+vETxbzO/wd5qH9NtL3g3QAAAABJRU5ErkJggg=="},888:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/mr-2018-06.0eebf777.png"},889:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/navigate-workspace-faster.808480f9.png"},890:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/put-your-data-in-perspective.45bcabd3.png"},891:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/search-components-by-tags.c60f941c.png"},892:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/set-workspace-as-your-landing-page.e8991aa1.png"},893:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/simplify-with-column-settings.4782bbbc.png"},894:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/sneak-peek-components.c8812520.png"},895:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/speed-up-your-breakdowns.6e63b990.png"},896:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/submit-srupport-tickets-in-the-ui.dd352bdb.png"},897:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/tell-a-data-story-with-text-boxes.299c136a.png"},898:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/trend-your-fallout-visualization.f235c589.png"},899:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/unsure-where-to-begin.025174be.png"},900:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/validate-your-implementation.840fa126.png"},901:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/view-distribution-with-histograms.be2fa79e.png"},902:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/view-overlap-with-venn-diagrams.fa50a8fb.png"},903:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/visualize-fallout-across-segments.92caa44d.png"},904:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/when-in-doubt-right-click.45bcabd3.png"},905:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/debug-workspace.39b1cc65.png"},906:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/retention-analysis-cohort-table.2c858445.png"},907:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/latency-cohort-table.4114c883.png"},908:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/churn-analysis-cohort-table.23ff7ae9.png"},909:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/retention-by-any-dimension.2a70fa6e.png"},910:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/rolling-calculation-cohort.8799ff82.png"},911:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/view-density.f1ab3045.png"},912:function(module,exports,__webpack_require__){},913:function(module,exports,__webpack_require__){var _objectSpread=__webpack_require__(914);module.exports=function(){if("undefined"!==typeof window){window.analyticsui||alert("You need to go to workspace to use this bookmark");var f=document.createElement("form");f.setAttribute("method","post"),f.setAttribute("target","_blank"),f.setAttribute("action","http://localhost:8080/localdev/switch-environment");var i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name","customSession");var settings=_objectSpread({},window.analyticsui.app.settings);settings.locationHref=window.location.href,i.setAttribute("value",JSON.stringify(settings)),f.appendChild(i);var i2=document.createElement("input");i2.setAttribute("type","hidden"),i2.setAttribute("name","hash"),i2.setAttribute("value",document.location.hash),f.appendChild(i2);var i3=document.createElement("input");i3.setAttribute("type","hidden"),i3.setAttribute("name","environment"),i3.setAttribute("value","custom"),f.appendChild(i3),document.body.appendChild(f),f.submit()}}},916:function(module,exports,__webpack_require__){},917:function(module,exports,__webpack_require__){},918:function(module,exports,__webpack_require__){},951:function(module,exports,__webpack_require__){},952:function(module,exports,__webpack_require__){},953:function(module,exports,__webpack_require__){},954:function(module,exports,__webpack_require__){},955:function(module,exports,__webpack_require__){},956:function(module,exports,__webpack_require__){},957:function(module,exports,__webpack_require__){},958:function(module,exports,__webpack_require__){},959:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/blank-freeform.9414d788.gif"},960:function(module,exports,__webpack_require__){},961:function(module,exports,__webpack_require__){},962:function(module,exports,__webpack_require__){},963:function(module,exports,__webpack_require__){},964:function(module,exports,__webpack_require__){},967:function(module,exports,__webpack_require__){},968:function(module,exports,__webpack_require__){},969:function(module,exports,__webpack_require__){},970:function(module,exports,__webpack_require__){},971:function(module,exports,__webpack_require__){},972:function(module,exports,__webpack_require__){},973:function(module,exports,__webpack_require__){},974:function(module,exports,__webpack_require__){},975:function(module,exports,__webpack_require__){},976:function(module,exports,__webpack_require__){},977:function(module,exports,__webpack_require__){},978:function(module,exports,__webpack_require__){},979:function(module,exports,__webpack_require__){},980:function(module,exports,__webpack_require__){},981:function(module,exports,__webpack_require__){},982:function(module,exports,__webpack_require__){},983:function(module,exports,__webpack_require__){}}]);
//# sourceMappingURL=workspace.96ede674.chunk.js.map